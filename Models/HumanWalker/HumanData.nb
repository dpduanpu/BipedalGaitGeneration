Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", \
"Section",ExpressionUUID->"996c692c-ebf2-4ec1-9b5e-1c01a05d498e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<BipedalLocomotion`HumanWalker`\>\"", ",", " ", 
    RowBox[{"{", "\"\<RigidBodyDynamics`\>\"", "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"98c8779e-ffda-484e-b0c8-e98c7ad7c11e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load Dumas' et al. excel file", \
"Section",ExpressionUUID->"8d07251a-a46c-4645-bdeb-de6cbedcac53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fil", " ", "=", " ", "\"\<HumanWalker/human.xlsx\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"fil", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"fil", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1c", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"fil", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2c", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"fil", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Data\>\"", ",", "5"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"dcebc895-bfc4-44bb-98c1-671afd1abee8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert Quantities", \
"Section",ExpressionUUID->"5f74f35f-ddd0-4858-9ea4-f4d186a06abe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"mm", " ", "to", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], ",", " ", 
        RowBox[{"#", "/", "1000"}], ",", " ", "#"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"4", ";;", "48"}], ",", "  ", 
       RowBox[{"3", ";;", "8"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"4", ";;", "48"}], ",", "  ", 
         RowBox[{"3", ";;", "8"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T1c", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "6"}], ",", "  ", 
       RowBox[{"3", ";;", "8"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"T1c", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"3", ";;", "6"}], ",", "  ", 
         RowBox[{"3", ";;", "8"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "35"}], ",", " ", "5"}], "\[RightDoubleBracket]"}], 
     " ", "=", " ", 
     RowBox[{"f", " ", "/@", " ", 
      RowBox[{"T2", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"3", ";;", "35"}], ",", " ", "5"}], 
       "\[RightDoubleBracket]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2c", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "4"}], ",", " ", "5"}], "\[RightDoubleBracket]"}], 
     " ", "=", " ", 
     RowBox[{"f", " ", "/@", " ", 
      RowBox[{"T2c", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"3", ";;", "4"}], ",", " ", "5"}], 
       "\[RightDoubleBracket]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"i", " ", "to", " ", "I"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringQ", "@", "#"}], " ", "&&", " ", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", " ", "\"\<i\>\""}], "]"}]}], ",", " ", 
        RowBox[{"N", "@", 
         RowBox[{"ToExpression", "@", 
          RowBox[{"ToUpperCase", "@", "#"}]}]}], ",", " ", "#"}], "]"}], 
      "&"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "35"}], ",", "  ", 
       RowBox[{"10", ";;", "15"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"3", ";;", "35"}], ",", "  ", 
         RowBox[{"10", ";;", "15"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2c", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "4"}], ",", "  ", 
       RowBox[{"10", ";;", "15"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"T2c", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"3", ";;", "4"}], ",", "  ", 
         RowBox[{"10", ";;", "15"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"%", " ", "to", " ", "frac"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], ",", " ", 
        RowBox[{"#", "/", "100"}], ",", " ", "#"}], "]"}], "&"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "35"}], ",", "  ", 
       RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"3", ";;", "35"}], ",", "  ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"T2c", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", ";;", "4"}], ",", "  ", 
       RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}], " ", "=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"T2c", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"3", ";;", "4"}], ",", "  ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[14]:=",ExpressionUUID->"19ea9dc2-f670-4407-92be-5ec47acad264"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Joint Centers", \
"Section",ExpressionUUID->"0702053b-35e1-44c8-9c28-bf99eb451934"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"joint", " ", "centers"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JC", " ", "=", " ", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"pelvis", ":", " ", 
     RowBox[{"ljc", " ", "to", " ", "hjc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<LJC to HJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"33", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"pelvis", ":", " ", 
     RowBox[{"ljc", " ", "to", " ", "cjc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<LJC to CJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"T1", "\[LeftDoubleBracket]", 
       RowBox[{"12", ",", " ", 
        RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"torso", ":", " ", 
     RowBox[{"cjc", " ", "to", " ", "sjc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<CJC to SJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"11", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"arm", ":", " ", 
     RowBox[{"sjc", " ", "to", " ", "ejc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"midpoint", " ", "of"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<SJC to EJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"15", ";;", "16"}], ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
      "2"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"forearm", ":", " ", 
     RowBox[{"ejc", " ", "to", " ", "wjc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"midpoint", " ", "of"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<EJC to WJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"19", ";;", "20"}], ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
      "2"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"thigh", ":", " ", 
     RowBox[{"hjc", " ", "to", " ", "kjc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"midpoint", " ", "of"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<HJC to KJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"36", ";;", "37"}], ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
      "2"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"leg", ":", " ", 
     RowBox[{"kjc", " ", "to", " ", "ajc"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"midpoint", " ", "of"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JC", "[", "\"\<KJC to AJC\>\"", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"41", ";;", "42"}], ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
      "2"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[25]:=",ExpressionUUID->"3d8873ff-2b44-4b82-91d8-04a9165f3d18"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Points of Interest", \
"Section",ExpressionUUID->"1aa3b79a-c56e-4664-a1cd-3612fe7cc7e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"points", " ", "of", " ", "interest"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"POI", " ", "=", " ", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"head", " ", "&"}], " ", 
     RowBox[{"neck", ":", " ", 
      RowBox[{"cjc", " ", "to", " ", "hv"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"POI", "[", "\"\<CJC to HV\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1c", "\[LeftDoubleBracket]", 
      RowBox[{"3", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"hand", ":", " ", 
     RowBox[{"wjc", " ", "to", " ", "ft3"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"POI", "[", "\"\<WJC to FT3\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"26", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"pelvis", ":", " ", "width"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"difference", " ", "of"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T1", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"30", ";;", "31"}], ",", " ", 
      RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"torso", ":", " ", 
     RowBox[{"thorax", " ", "width"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"difference", " ", "of"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T1", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"8", ";;", "9"}], ",", " ", 
      RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"ankle", ":", " ", 
      RowBox[{"ajc", " ", "to", " ", "tt"}]}], ",", " ", "cal", ",", " ", 
     RowBox[{"&", " ", "mh"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"POI", "[", "\"\<AJC to CAL\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"44", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"POI", "[", "\"\<AJC to MH1\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"45", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"POI", "[", "\"\<AJC to MH5\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"46", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"POI", "[", "\"\<AJC to TT2\>\"", "]"}], " ", "=", " ", 
     RowBox[{"T1", "\[LeftDoubleBracket]", 
      RowBox[{"47", ",", " ", 
       RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[33]:=",ExpressionUUID->"42de7d82-384c-4865-853a-945459cae5a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Segment Lengths", \
"Section",ExpressionUUID->"f0f2763d-623f-4f79-beee-9ba7b909a7d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"segment", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SL", " ", "=", " ", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Head & Neck\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"POI", "[", "\"\<CJC to HV\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Torso\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"JC", "[", "\"\<LJC to CJC\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Arm\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"JC", "[", "\"\<SJC to EJC\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Forearm\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"JC", "[", "\"\<EJC to WJC\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Hand\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"T1", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"24", ";;", "25"}], ",", " ", 
          RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Pelvis\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "]"}], ".", 
       RowBox[{"JC", "[", "\"\<LJC to HJC\>\"", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Thigh\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"JC", "[", "\"\<HJC to KJC\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Leg\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"JC", "[", "\"\<KJC to AJC\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Foot\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"T1", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"45", ";;", "46"}], ",", " ", 
          RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "]"}], "/", 
       "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"torso", " ", "width", " ", 
     RowBox[{"(", 
      RowBox[{"middle", " ", "of", " ", "chest", " ", "to", " ", "shoulder"}],
       ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Torso - Alt.\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{"8", ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "-", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{"9", ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"hand", " ", "width", " ", 
     RowBox[{"(", 
      RowBox[{"glove", " ", "size"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Hand - Alt.\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{"POI", "[", "\"\<WJC to FT3\>\"", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"pelvis", " ", "width"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Pelvis - Alt.\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{"30", ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}], "-", 
       RowBox[{"T1", "\[LeftDoubleBracket]", 
        RowBox[{"31", ",", " ", 
         RowBox[{"3", ";;", "5"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"foot", " ", "width", " ", 
     RowBox[{"(", 
      RowBox[{"shoe", " ", "size"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SL", "[", "\"\<Foot - Alt.\>\"", "]"}], " ", "=", " ", 
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"POI", "[", "\"\<AJC to CAL\>\"", "]"}], "-", 
       RowBox[{"POI", "[", "\"\<AJC to TT2\>\"", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[42]:=",ExpressionUUID->"d4047aa5-9d83-4233-b3a6-dba6ccdddd1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Body Segment Inertia Parameters", \
"Section",ExpressionUUID->"4d79654b-9369-4c59-8fcc-0971bd642143"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mcI", "[", 
    RowBox[{"mtot_", ",", " ", "Lseg_", ",", " ", "dat_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", " ", "c", ",", " ", "r", ",", " ", "I"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"body", " ", "segment", " ", "mass"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", " ", "=", " ", 
       RowBox[{
        RowBox[{"dat", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
         " ", "mtot"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"body", " ", "segment", " ", "COM"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{
        RowBox[{"dat", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "Lseg"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"body", " ", "segment", " ", "%", " ", "I"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"dat", "\[LeftDoubleBracket]", 
        RowBox[{"5", ";;", "10"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"I", " ", "about", " ", "JC"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"I", " ", "=", " ", 
       RowBox[{"m", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "4", ",", " ", "5"}], "}"}], 
              "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"4", ",", " ", "2", ",", " ", "6"}], "}"}], 
              "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"5", ",", " ", "6", ",", " ", "3"}], "}"}], 
              "\[RightDoubleBracket]"}]}], "}"}], " ", "Lseg"}], ")"}], "^", 
         "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"I", " ", "about", " ", "COM"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"I", " ", "=", " ", 
         RowBox[{"I", " ", "+", " ", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"c", ".", "c"}], " ", 
              RowBox[{"IdentityMatrix", "[", "3", "]"}]}], " ", "-", " ", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", " ", "c", ",", " ", "c"}], "]"}]}], 
            ")"}]}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Chop", "@", 
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "c", ",", " ", "I"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[56]:=",ExpressionUUID->"240cc57c-c84e-4f24-b278-dff0981e6437"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"body", " ", "segment", " ", "inertia", " ", "parameters"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mtot", " ", "=", " ", "63.9"}], " ", ";"}], 
   RowBox[{"(*", " ", "kg", " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BSIP", " ", "=", " ", 
     RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Head & Neck\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Head & Neck\>\"", "]"}], ",", " ", 
       RowBox[{"T2c", "\[LeftDoubleBracket]", 
        RowBox[{"3", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Torso\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Torso\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"5", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Arm\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Arm\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"7", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Forearm\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Forearm\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"9", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Hand\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Hand\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"11", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Pelvis\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Pelvis\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"13", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Thigh\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Thigh\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"15", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Leg\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Leg\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"17", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BSIP", "[", "\"\<Foot\>\"", "]"}], " ", "=", " ", 
     RowBox[{"mcI", "[", 
      RowBox[{"mtot", ",", " ", 
       RowBox[{"SL", "[", "\"\<Foot\>\"", "]"}], ",", " ", 
       RowBox[{"T2", "\[LeftDoubleBracket]", 
        RowBox[{"19", ",", " ", 
         RowBox[{"6", ";;", "15"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[57]:=",ExpressionUUID->"bc6b3446-474e-4baa-b292-9932279d74b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biped", \
"Section",ExpressionUUID->"914aa82e-c1f3-468b-bdd4-34d75ead300d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Link", "[", 
    RowBox[{"n_", ",", " ", "p_", ",", " ", "S_", ",", " ", "f_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "b", ",", " ", "c", ",", " ", "R"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"n", ",", " ", "p", ",", " ", "S"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringQ", "[", "f", "]"}], ",", " ", 
           RowBox[{"JC", "[", "f", "]"}], ",", " ", "f"}], "]"}], ",", " ", 
         "nm"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"BSIP", "[", 
        RowBox[{
         RowBox[{"StringSplit", "[", 
          RowBox[{"n", ",", " ", 
           RowBox[{"\"\<Right \>\"", "|", "\"\<Left \>\""}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"PadLeft", "[", 
        RowBox[{
         RowBox[{"c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", " ", "nm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"flip", " ", "z"}], "-", 
        RowBox[{"axis", " ", "of", " ", "frame", " ", "and", " ", "COM"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"n", ",", " ", "\"\<Left\>\""}], "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"b", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}],
           " ", "=", " ", 
          RowBox[{"-", 
           RowBox[{
           "b", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"c", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "6"}], "\[RightDoubleBracket]"}], " ", "=", 
          " ", 
          RowBox[{"-", 
           RowBox[{"c", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", " ", "6"}], "\[RightDoubleBracket]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"rotate", " ", "about", " ", "z", " ", 
           RowBox[{"b", "/", "c"}], " ", "product", " ", "of", " ", 
           "inertias", " ", "change", " ", "sign", " ", 
           RowBox[{"w", ".", "r", ".", "t"}], " ", "z", " ", "coord"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", " ", "=", " ", 
          RowBox[{"RotationMatrix", "[", 
           RowBox[{"\[Pi]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"c", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           " ", "=", " ", 
          RowBox[{"R", ".", 
           RowBox[{
           "c", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ".", 
           RowBox[{"R", "\[Transpose]"}]}]}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], 
         RowBox[{"Diagonal", "[", " ", 
          RowBox[{"c", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[68]:=",ExpressionUUID->"1f086517-c812-4dc2-9cae-3aa54cb2030e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WM", " ", "=", " ", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Pelvis\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Pelvis\>\"", ",", " ", "Root", ",", " ", "\"\<pln\>\"", ",", " ", 
      "z3"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Torso\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Torso\>\"", ",", " ", "\"\<Pelvis\>\"", ",", " ", "\"\<rz\>\"", ",",
       " ", "\"\<LJC to CJC\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Left Thigh\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Left Thigh\>\"", ",", " ", "\"\<Pelvis\>\"", ",", " ", "\"\<rz\>\"", 
     ",", " ", "\"\<LJC to HJC\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Right Thigh\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Right Thigh\>\"", ",", " ", "\"\<Pelvis\>\"", ",", " ", 
      "\"\<rz\>\"", ",", " ", "\"\<LJC to HJC\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Left Leg\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Left Leg\>\"", ",", " ", "\"\<Left Thigh\>\"", ",", " ", 
     "\"\<rz\>\"", ",", " ", "\"\<HJC to KJC\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Right Leg\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Right Leg\>\"", ",", " ", "\"\<Right Thigh\>\"", ",", " ", 
      "\"\<rz\>\"", ",", " ", "\"\<HJC to KJC\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Left Foot\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Left Foot\>\"", ",", " ", "\"\<Left Leg\>\"", ",", " ", "\"\<rz\>\"",
      ",", " ", "\"\<KJC to AJC\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Right Foot\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Right Foot\>\"", ",", " ", "\"\<Right Leg\>\"", ",", " ", 
      "\"\<rz\>\"", ",", " ", "\"\<KJC to AJC\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Head & Neck\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Head & Neck\>\"", ",", " ", "\"\<Torso\>\"", ",", " ", "\"\<rz\>\"",
       ",", " ", "z3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Left Arm\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Left Arm\>\"", ",", " ", "\"\<Torso\>\"", ",", " ", "\"\<rz\>\"", 
     ",", " ", "\"\<CJC to SJC\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Right Arm\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Right Arm\>\"", ",", " ", "\"\<Torso\>\"", ",", " ", "\"\<rz\>\"", 
      ",", " ", "\"\<CJC to SJC\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Left Forearm\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Left Forearm\>\"", ",", " ", "\"\<Left Arm\>\"", ",", " ", 
     "\"\<rz\>\"", ",", " ", "\"\<SJC to EJC\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "[", "\"\<Right Forearm\>\"", "]"}], " ", "=", " ", 
    RowBox[{"Link", "[", 
     RowBox[{
     "\"\<Right Forearm\>\"", ",", " ", "\"\<Right Arm\>\"", ",", " ", 
      "\"\<rz\>\"", ",", " ", "\"\<SJC to EJC\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Left Hand\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Left Hand\>\"", ",", " ", "\"\<Left Forearm\>\"", ",", " ", 
     "\"\<rz\>\"", ",", " ", "\"\<SJC to EJC\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "[", "\"\<Right Hand\>\"", "]"}], " ", "=", " ", 
   RowBox[{"Link", "[", 
    RowBox[{
    "\"\<Right Hand\>\"", ",", " ", "\"\<Right Forearm\>\"", ",", " ", 
     "\"\<rz\>\"", ",", " ", "\"\<SJC to EJC\>\""}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[69]:=",ExpressionUUID->"2860eb7c-855e-4d1b-91b6-3679e4f29afe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WM", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", 
     RowBox[{"RBDindex", "[", "\"\<f[x]\>\"", "]"}]}], 
    "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", " ", 
      RowBox[{"RBDindex", "[", "\"\<c[x]\>\"", "]"}]}], 
     "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WM", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", 
     RowBox[{"RBDindex", "[", "\"\<f[z]\>\"", "]"}]}], 
    "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WM", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", " ", 
      RowBox[{"RBDindex", "[", "\"\<c[z]\>\"", "]"}]}], 
     "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"POI", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
   "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"POI", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", " ", "3"}], "\[RightDoubleBracket]"}], " ", "=", " ",
     "0"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"feet", " ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<Left Foot\>\"", ",", " ", "\"\<Right Foot\>\""}], "}"}],
         ",", " ", 
        RowBox[{"{", 
         RowBox[{"z3", ",", " ", "z3"}], "}"}]}], "}"}], "\[Transpose]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feet", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Left Leg\>\"", ",", " ", "\"\<Right Leg\>\""}], "}"}], 
      ",", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"JC", "[", "\"\<KJC to AJC\>\"", "]"}], ",", " ", "2"}], 
       "]"}]}], "}"}], "\[Transpose]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KeyDropFrom", "[", 
   RowBox[{"WM", ",", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<Left Foot\>\"", ",", " ", "\"\<Right Foot\>\""}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[85]:=",ExpressionUUID->"3df9c830-6b47-417c-a9f7-07cc1995a5d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->
  True,ExpressionUUID->"632b512a-512e-471b-8eb1-a0a7b2398aca"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"5a7c29a1-505d-4a05-8b70-208f6339fe9d"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718, 715},
WindowMargins->{{0, Automatic}, {Automatic, 60}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
