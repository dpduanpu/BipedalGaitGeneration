(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91352,       1735]
NotebookOptionsPosition[     88390,       1649]
NotebookOutlinePosition[     88764,       1665]
CellTagsIndexPosition[     88721,       1662]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 
  3.591487004222381*^9}},ExpressionUUID->"39e9dbc5-5d7b-4441-82c6-\
0811eadac5b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<BipedalLocomotion`Rabbit`\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<GlobalVariables`\>\"", ",", " ", "\"\<RigidBodyDynamics`\>\"", ",", 
      " ", "\"\<BipedalLocomotion`\>\"", ",", " ", 
      "\"\<BipedalLocomotion`Model`\>\""}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367625062662*^9, 3.5933676251720285`*^9}, {
   3.704468357519539*^9, 3.704468459841198*^9}, {3.7044685529026203`*^9, 
   3.704468620873731*^9}, {3.7044692938575964`*^9, 3.704469294201355*^9}, {
   3.7044693718565884`*^9, 3.7044694237922263`*^9}, 3.7044696047095137`*^9, {
   3.704469723121451*^9, 3.7044697494763565`*^9}, {3.7044713775105753`*^9, 
   3.7044713779682055`*^9}, {3.71007627184459*^9, 3.7100763129700594`*^9}, {
   3.710085252492481*^9, 3.710085269273345*^9}, {3.710085701211694*^9, 
   3.710085704820245*^9}, {3.71008573624848*^9, 3.7100857468419538`*^9}, {
   3.7100858618232365`*^9, 3.710085866727702*^9}, {3.710085919261855*^9, 
   3.7100859355283422`*^9}, {3.7100860101270795`*^9, 3.710086010815563*^9}, {
   3.7100862247653303`*^9, 3.7100862253687563`*^9}, {3.7100876279638534`*^9, 
   3.7100876368821716`*^9}, {3.710247193222289*^9, 3.710247196972357*^9}, {
   3.710249077736276*^9, 3.710249078486265*^9}, {3.719112887775036*^9, 
   3.719112914478425*^9}, {3.719112998854257*^9, 3.719113000323023*^9}, {
   3.7191136395085473`*^9, 3.719113649164892*^9}, 3.719114879496228*^9, {
   3.7192011247884035`*^9, 3.7192011277727957`*^9}, {3.7192296580574007`*^9, 
   3.719229673151224*^9}, {3.7192816589156504`*^9, 3.7192816633531713`*^9}, {
   3.7193169534786367`*^9, 3.719316953853657*^9}, {3.719336319403597*^9, 
   3.719336334153718*^9}, {3.7193364584516335`*^9, 3.719336463561051*^9}, {
   3.71950185152522*^9, 3.719501861181549*^9}, {3.7195019833075695`*^9, 
   3.7195020203343954`*^9}, {3.719530068564412*^9, 3.7195300955490136`*^9}, {
   3.7195306954134054`*^9, 3.719530696085286*^9}, {3.7196226368983707`*^9, 
   3.7196226373983574`*^9}, {3.719622769920648*^9, 3.7196227709987993`*^9}, {
   3.719622836655593*^9, 3.7196228393431067`*^9}, {3.7196228809997025`*^9, 
   3.7196229038124104`*^9}, {3.719773624383868*^9, 3.7197736245088606`*^9}, {
   3.730568997087141*^9, 3.730569001727793*^9}, {3.7311743011693115`*^9, 
   3.7311743044505663`*^9}, {3.731174808928243*^9, 3.7311748090845404`*^9}, {
   3.73123061499946*^9, 3.7312306178900967`*^9}, {3.7312306513434887`*^9, 
   3.731230651359113*^9}, {3.731251515822839*^9, 
   3.7312515186822367`*^9}},ExpressionUUID->"a8cfd402-edec-4f05-84ae-\
1d8662f3b1e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHC 1", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731382286987784*^9, 
  3.7313822913940797`*^9}, {3.731382399317076*^9, 
  3.73138240106708*^9}},ExpressionUUID->"a37a045c-eda3-4c7a-b220-\
791d1c2a1f8d"],

Cell[CellGroupData[{

Cell["stance leg is relatively straight; swing leg bends.", "Subsection",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
   3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
   3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
   3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731382286987784*^9, 
   3.7313822913940797`*^9}, 
   3.731382391707608*^9},ExpressionUUID->"c5938be3-40a4-406d-ac9a-\
84440b79803f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VHC", "[", "0", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"continuation", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}]}], "|>"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcon", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qrm", "[", "s_", "]"}], " ", ":=", " ", "\"\<none\>\""}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vrm", "[", "s_", "]"}], " ", ":=", " ", "\"\<none\>\""}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RabbitP", "[", 
        RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
       RowBox[{"BLP", "[", 
        RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114957825127*^9, 3.719114994512991*^9}, {
   3.719115071641429*^9, 3.7191150718289304`*^9}, {3.719115766052431*^9, 
   3.7191157663493085`*^9}, {3.7192025676144285`*^9, 3.719202577161398*^9}, {
   3.7193360677608843`*^9, 3.719336120058194*^9}, {3.7193362079964304`*^9, 
   3.719336222715287*^9}, {3.719581349109211*^9, 3.719581354156126*^9}, {
   3.7195975443072824`*^9, 3.7195975447291613`*^9}, {3.719597587088908*^9, 
   3.7195976826678324`*^9}, {3.719606284722884*^9, 3.7196062941292105`*^9}, {
   3.719616657925231*^9, 3.7196166688003054`*^9}, {3.7196220053931046`*^9, 
   3.719622013705658*^9}, {3.719773638305861*^9, 3.719773710290879*^9}, {
   3.719774660737048*^9, 3.7197746739715605`*^9}, {3.719778151737618*^9, 
   3.719778162815843*^9}, 3.719778240629066*^9, 3.7198425122584114`*^9, 
   3.7198428792976723`*^9, {3.720197894870371*^9, 3.72019789766726*^9}, {
   3.7201999727545166`*^9, 3.720199976285802*^9}, {3.720201050340228*^9, 
   3.720201050699592*^9}, {3.7202018066755266`*^9, 3.7202018481759367`*^9}, {
   3.7202217053639784`*^9, 3.720221705770234*^9}, {3.7202227020596013`*^9, 
   3.7202227022783475`*^9}, {3.7204184861079655`*^9, 3.720418493295533*^9}, {
   3.720510315249448*^9, 3.7205103203432603`*^9}, 3.7205117451675615`*^9, 
   3.7205117955899067`*^9, {3.7205127605289297`*^9, 3.720512760638305*^9}, {
   3.7205163106937494`*^9, 3.7205163152562733`*^9}, {3.7205357320072384`*^9, 
   3.7205357366947584`*^9}, {3.7205371629590197`*^9, 
   3.7205371676621885`*^9}, {3.7205372579442606`*^9, 3.720537259538026*^9}, {
   3.7205402128880014`*^9, 3.7205402146067667`*^9}, {3.720540963097971*^9, 
   3.720540966613628*^9}, {3.7205441323466063`*^9, 3.72054413351851*^9}, {
   3.720544408036622*^9, 3.7205444091616335`*^9}, {3.7205764745669413`*^9, 
   3.720576481582631*^9}, {3.720577009870885*^9, 3.7205770159959416`*^9}, {
   3.720581180575188*^9, 3.7205811817783403`*^9}, {3.7205818580906906`*^9, 
   3.720581861215719*^9}, {3.72079345655674*^9, 3.720793457806735*^9}, {
   3.7207948586982927`*^9, 3.7207948612920504`*^9}, {3.720806907071228*^9, 
   3.7208069078212333`*^9}, {3.7219998599416685`*^9, 3.7219998619573116`*^9}, 
   3.72200036420527*^9, 3.7220006043936195`*^9, {3.7220018663983574`*^9, 
   3.7220018707109165`*^9}, {3.7220063086138945`*^9, 
   3.7220063229111567`*^9}, {3.722006394323783*^9, 3.7220063954800453`*^9}, {
   3.72201084977713*^9, 3.722010854433425*^9}, {3.7220113876095314`*^9, 
   3.722011388734538*^9}, {3.7220143841797247`*^9, 3.7220143863828726`*^9}, {
   3.7220225191326065`*^9, 3.722022520257635*^9}, {3.7220344406143675`*^9, 
   3.7220344407237453`*^9}, {3.7220347797982106`*^9, 
   3.7220347826945457`*^9}, {3.7220350121834755`*^9, 
   3.7220350140272408`*^9}, {3.722035358501729*^9, 3.7220353609080224`*^9}, {
   3.722035810079729*^9, 3.722035816798565*^9}, {3.722036181660059*^9, 
   3.722036185144472*^9}, {3.722036802255605*^9, 3.7220368083114853`*^9}, {
   3.722037345761135*^9, 3.7220373504174194`*^9}, 3.7220388589250197`*^9, {
   3.7220396117052965`*^9, 3.722039611877163*^9}, {3.722039925093557*^9, 
   3.722039925218554*^9}, {3.7220403870318484`*^9, 3.722040399406987*^9}, 
   3.722040886505741*^9, {3.7220449869333224`*^9, 3.7220450361682005`*^9}, {
   3.7220451603726025`*^9, 3.7220451757321324`*^9}, {3.722089433043927*^9, 
   3.7220894455842*^9}, {3.722089900392234*^9, 3.7220899010484924`*^9}, {
   3.722091756585374*^9, 3.722091763507305*^9}, {3.722093244053013*^9, 
   3.722093248053053*^9}, {3.722093624429129*^9, 3.72209363153858*^9}, {
   3.7220940586473303`*^9, 3.7220940998821115`*^9}, {3.7243698178277683`*^9, 
   3.724369821755304*^9}, {3.7243771597230186`*^9, 3.724377159829077*^9}, {
   3.7304652880955896`*^9, 3.7304652887518773`*^9}, {3.730570085792858*^9, 
   3.730570100011771*^9}, 3.7305702364821053`*^9, {3.730570596771381*^9, 
   3.730570599380788*^9}, 3.730570954031128*^9, {3.730571389570566*^9, 
   3.7305714063675747`*^9}, {3.7305721317015424`*^9, 3.730572135842202*^9}, 
   3.7305724080194716`*^9, {3.7305725795391135`*^9, 3.7305725811172066`*^9}, {
   3.7305734370865784`*^9, 3.7305734385084915`*^9}, {3.7305736641688137`*^9, 
   3.730573664387565*^9}, {3.7305986500527225`*^9, 3.730598670412298*^9}, {
   3.730623616617629*^9, 3.730623650992876*^9}, {3.7306302062857323`*^9, 
   3.7306302094576597`*^9}, 3.7306320334865875`*^9, 3.7306323765794187`*^9, {
   3.7306332581056185`*^9, 3.7306332639337535`*^9}, {3.7307281760622454`*^9, 
   3.730728194632934*^9}, {3.7307307403452816`*^9, 3.7307307631715508`*^9}, {
   3.7307316072252073`*^9, 3.730731622147172*^9}, {3.730731922647436*^9, 
   3.730731928694354*^9}, 3.7311696404331512`*^9, {3.7311696707458935`*^9, 
   3.7311697615278683`*^9}, {3.7311698000906935`*^9, 3.731169813481393*^9}, {
   3.731171220919318*^9, 3.7311713404827833`*^9}, {3.731171377529971*^9, 
   3.7311713807955923`*^9}, {3.731171467284692*^9, 3.7311714899723907`*^9}, {
   3.731171529128953*^9, 3.731171544566576*^9}, {3.7311718093110113`*^9, 
   3.731171823108008*^9}, {3.7311718635614557`*^9, 3.7311718973586006`*^9}, {
   3.7311719491090145`*^9, 3.7311719716716943`*^9}, {3.731172081141317*^9, 
   3.731172106391565*^9}, {3.731172203989427*^9, 3.7311722043488493`*^9}, {
   3.7311722430366135`*^9, 3.7311722695055747`*^9}, {3.7311724515226526`*^9, 
   3.731172483835416*^9}, {3.7311725472421665`*^9, 3.731172550382817*^9}, {
   3.7311725853049536`*^9, 3.731172589055016*^9}, 3.7311726498836083`*^9, {
   3.7311732485256605`*^9, 3.731173273572736*^9}, {3.7311733050260944`*^9, 
   3.7311733666203675`*^9}, {3.7311734111675835`*^9, 3.731173414620736*^9}, {
   3.7311734533710284`*^9, 3.731173455519209*^9}, {3.7311735012097983`*^9, 
   3.7311735245068545`*^9}, 3.7311736931800766`*^9, 3.731188496426447*^9, 
   3.731189203819954*^9, {3.7311915552048397`*^9, 3.731191567564313*^9}, {
   3.731192936024188*^9, 3.731192940321098*^9}, {3.731223311439047*^9, 
   3.731223343361196*^9}, {3.731223400158552*^9, 3.7312234142367287`*^9}, 
   3.7312237151745825`*^9, {3.731224733346987*^9, 3.731224751268984*^9}, {
   3.7312248120663433`*^9, 3.731224838519679*^9}, {3.7312248743949647`*^9, 
   3.731224886191953*^9}, {3.7312254683463593`*^9, 3.731225470862053*^9}, {
   3.7312273296502495`*^9, 3.7312273381347136`*^9}, {3.731227675316327*^9, 
   3.731227682378824*^9}, {3.731229653491791*^9, 3.7312296574761796`*^9}, {
   3.731229840868306*^9, 3.7312298618528275`*^9}, {3.7312299699318113`*^9, 
   3.731229989416348*^9}, {3.7312302325120363`*^9, 3.731230235527668*^9}, {
   3.731230444294963*^9, 3.7312304460762405`*^9}, {3.731230736687936*^9, 
   3.7312307558443537`*^9}, {3.731251455291165*^9, 3.731251455884861*^9}, {
   3.731252807069333*^9, 3.7312528551322145`*^9}, {3.7312530311336284`*^9, 
   3.731253031883625*^9}, {3.731380010685237*^9, 3.7313800220446854`*^9}, {
   3.731381156105651*^9, 3.731381157246287*^9}, 3.7313817428102407`*^9, {
   3.731427754286146*^9, 3.7314277863490024`*^9}, {3.737143551279714*^9, 
   3.7371435698253193`*^9}, {3.744902805770978*^9, 3.7449028503146014`*^9}, {
   3.7449028847495728`*^9, 
   3.7449029051074767`*^9}},ExpressionUUID->"702c02dd-1448-4c77-b558-\
4ceb957f4faf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VHC", "[", "1", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"continuation", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "0", ",", " ", "1", ",", " ", "1"}], "}"}],
            "]"}]}], ",", " ", 
         RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", "1", ",", " ", "1"}], "}"}],
            "]"}]}]}], "|>"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcon", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"post", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "+"}], "]"}], "/", "c"}]}], "+"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"virtual", " ", "constraints"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{"3", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<fem\>\"", "|", " ", "\"\<tib\>\""}], "}"}], 
             "}"}]}], "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "configurations"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "velocities"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RabbitP", "[", 
        RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j", ",", " ", "n", ",", " ", "M"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", " ", "=", " ", 
           RowBox[{"BLP", "[", 
            RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"BLbiped", "[", 
              RowBox[{"\"\<c\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], 
              "]"}]}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", "2", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", "5", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", " ", 
             RowBox[{"j", "+", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"next", " ", "pre"}], "-", 
            RowBox[{"impact", " ", "state"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<x-\>\"", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", "4", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", "7", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", " ", 
             RowBox[{"j", "+", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"first", " ", "post"}], "-", 
            RowBox[{"impact", " ", "state"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{
            "\"\<x+\>\"", ",", " ", "2", ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", "5", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", "8", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", " ", 
             RowBox[{"j", "+", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"initial", " ", "pre"}], "-", 
            RowBox[{"impact", " ", "state"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{
            "\"\<x-\>\"", ",", " ", "1", ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114957825127*^9, 3.719114994512991*^9}, {
   3.719115071641429*^9, 3.7191150718289304`*^9}, {3.719115766052431*^9, 
   3.7191157663493085`*^9}, {3.7192025676144285`*^9, 3.719202577161398*^9}, {
   3.7193360677608843`*^9, 3.719336120058194*^9}, {3.7193362079964304`*^9, 
   3.719336222715287*^9}, {3.719581349109211*^9, 3.719581354156126*^9}, {
   3.7195975443072824`*^9, 3.7195975447291613`*^9}, {3.719597587088908*^9, 
   3.7195976826678324`*^9}, {3.719606284722884*^9, 3.7196062941292105`*^9}, {
   3.719616657925231*^9, 3.7196166688003054`*^9}, {3.7196220053931046`*^9, 
   3.719622013705658*^9}, {3.719773638305861*^9, 3.719773710290879*^9}, {
   3.719774660737048*^9, 3.7197746739715605`*^9}, {3.719778151737618*^9, 
   3.719778162815843*^9}, 3.719778240629066*^9, 3.7198425122584114`*^9, 
   3.7198428792976723`*^9, {3.720197894870371*^9, 3.72019789766726*^9}, {
   3.7201999727545166`*^9, 3.720199976285802*^9}, {3.720201050340228*^9, 
   3.720201050699592*^9}, {3.7202018066755266`*^9, 3.7202018481759367`*^9}, {
   3.7202217053639784`*^9, 3.720221705770234*^9}, {3.7202227020596013`*^9, 
   3.7202227022783475`*^9}, {3.7204184861079655`*^9, 3.720418493295533*^9}, {
   3.720510315249448*^9, 3.7205103203432603`*^9}, 3.7205117451675615`*^9, 
   3.7205117955899067`*^9, {3.7205127605289297`*^9, 3.720512760638305*^9}, {
   3.7205163106937494`*^9, 3.7205163152562733`*^9}, {3.7205357320072384`*^9, 
   3.7205357366947584`*^9}, {3.7205371629590197`*^9, 
   3.7205371676621885`*^9}, {3.7205372579442606`*^9, 3.720537259538026*^9}, {
   3.7205402128880014`*^9, 3.7205402146067667`*^9}, {3.720540963097971*^9, 
   3.720540966613628*^9}, {3.7205441323466063`*^9, 3.72054413351851*^9}, {
   3.720544408036622*^9, 3.7205444091616335`*^9}, {3.7205764745669413`*^9, 
   3.720576481582631*^9}, {3.720577009870885*^9, 3.7205770159959416`*^9}, {
   3.720581180575188*^9, 3.7205811817783403`*^9}, {3.7205818580906906`*^9, 
   3.720581861215719*^9}, {3.72079345655674*^9, 3.720793457806735*^9}, {
   3.7207948586982927`*^9, 3.7207948612920504`*^9}, {3.720806907071228*^9, 
   3.7208069078212333`*^9}, {3.7219998599416685`*^9, 3.7219998619573116`*^9}, 
   3.72200036420527*^9, 3.7220006043936195`*^9, {3.7220018663983574`*^9, 
   3.7220018707109165`*^9}, {3.7220063086138945`*^9, 
   3.7220063229111567`*^9}, {3.722006394323783*^9, 3.7220063954800453`*^9}, {
   3.72201084977713*^9, 3.722010854433425*^9}, {3.7220113876095314`*^9, 
   3.722011388734538*^9}, {3.7220143841797247`*^9, 3.7220143863828726`*^9}, {
   3.7220225191326065`*^9, 3.722022520257635*^9}, {3.7220344406143675`*^9, 
   3.7220344407237453`*^9}, {3.7220347797982106`*^9, 
   3.7220347826945457`*^9}, {3.7220350121834755`*^9, 
   3.7220350140272408`*^9}, {3.722035358501729*^9, 3.7220353609080224`*^9}, {
   3.722035810079729*^9, 3.722035816798565*^9}, {3.722036181660059*^9, 
   3.722036185144472*^9}, {3.722036802255605*^9, 3.7220368083114853`*^9}, {
   3.722037345761135*^9, 3.7220373504174194`*^9}, 3.7220388589250197`*^9, {
   3.7220396117052965`*^9, 3.722039611877163*^9}, {3.722039925093557*^9, 
   3.722039925218554*^9}, {3.7220403870318484`*^9, 3.722040399406987*^9}, 
   3.722040886505741*^9, {3.7220449869333224`*^9, 3.7220450361682005`*^9}, {
   3.7220451603726025`*^9, 3.7220451757321324`*^9}, {3.722089433043927*^9, 
   3.7220894455842*^9}, {3.722089900392234*^9, 3.7220899010484924`*^9}, {
   3.722091756585374*^9, 3.722091763507305*^9}, {3.722093244053013*^9, 
   3.722093248053053*^9}, {3.722093624429129*^9, 3.72209363153858*^9}, {
   3.7220940586473303`*^9, 3.7220940998821115`*^9}, {3.7243698178277683`*^9, 
   3.724369821755304*^9}, {3.7243771597230186`*^9, 3.724377159829077*^9}, {
   3.7304652880955896`*^9, 3.7304652887518773`*^9}, {3.730570085792858*^9, 
   3.730570100011771*^9}, 3.7305702364821053`*^9, {3.730570596771381*^9, 
   3.730570599380788*^9}, 3.730570954031128*^9, {3.730571389570566*^9, 
   3.7305714063675747`*^9}, {3.7305721317015424`*^9, 3.730572135842202*^9}, 
   3.7305724080194716`*^9, {3.7305725795391135`*^9, 3.7305725811172066`*^9}, {
   3.7305734370865784`*^9, 3.7305734385084915`*^9}, {3.7305736641688137`*^9, 
   3.730573664387565*^9}, {3.7305986500527225`*^9, 3.730598670412298*^9}, {
   3.730623616617629*^9, 3.730623650992876*^9}, {3.7306302062857323`*^9, 
   3.7306302094576597`*^9}, 3.7306320334865875`*^9, 3.7306323765794187`*^9, {
   3.7306332581056185`*^9, 3.7306332639337535`*^9}, {3.7307281760622454`*^9, 
   3.730728194632934*^9}, {3.7307307403452816`*^9, 3.7307307631715508`*^9}, {
   3.7307316072252073`*^9, 3.730731622147172*^9}, {3.730731922647436*^9, 
   3.730731928694354*^9}, 3.7311696404331512`*^9, {3.7311696707458935`*^9, 
   3.7311697615278683`*^9}, {3.7311698000906935`*^9, 3.731169813481393*^9}, {
   3.731171220919318*^9, 3.7311713404827833`*^9}, {3.731171377529971*^9, 
   3.7311713807955923`*^9}, {3.731171467284692*^9, 3.7311714899723907`*^9}, {
   3.731171529128953*^9, 3.731171544566576*^9}, {3.7311718093110113`*^9, 
   3.731171823108008*^9}, {3.7311718635614557`*^9, 3.7311718973586006`*^9}, {
   3.7311719491090145`*^9, 3.7311719716716943`*^9}, {3.731172081141317*^9, 
   3.731172106391565*^9}, {3.731172203989427*^9, 3.7311722043488493`*^9}, {
   3.7311722430366135`*^9, 3.7311722695055747`*^9}, {3.7311724515226526`*^9, 
   3.731172483835416*^9}, {3.7311725472421665`*^9, 3.731172550382817*^9}, {
   3.7311725853049536`*^9, 3.731172589055016*^9}, 3.7311726498836083`*^9, {
   3.7311732485256605`*^9, 3.731173273572736*^9}, {3.7311733050260944`*^9, 
   3.7311733666203675`*^9}, {3.7311734111675835`*^9, 3.731173414620736*^9}, {
   3.7311734533710284`*^9, 3.731173455519209*^9}, {3.7311735012097983`*^9, 
   3.7311735245068545`*^9}, 3.7311736931800766`*^9, 3.731188496426447*^9, 
   3.731189203819954*^9, {3.7311915552048397`*^9, 3.731191567564313*^9}, {
   3.731192936024188*^9, 3.731192940321098*^9}, {3.731223311439047*^9, 
   3.731223343361196*^9}, {3.731223400158552*^9, 3.7312234142367287`*^9}, 
   3.7312237151745825`*^9, {3.731224733346987*^9, 3.731224751268984*^9}, {
   3.7312248120663433`*^9, 3.731224838519679*^9}, {3.7312248743949647`*^9, 
   3.731224886191953*^9}, {3.7312254683463593`*^9, 3.731225470862053*^9}, {
   3.7312273296502495`*^9, 3.7312273381347136`*^9}, {3.731227675316327*^9, 
   3.731227682378824*^9}, {3.731229653491791*^9, 3.7312296574761796`*^9}, {
   3.731229840868306*^9, 3.7312298618528275`*^9}, {3.7312299699318113`*^9, 
   3.731229989416348*^9}, {3.7312302325120363`*^9, 3.731230235527668*^9}, {
   3.731230444294963*^9, 3.7312304460762405`*^9}, {3.731230736687936*^9, 
   3.7312307558443537`*^9}, {3.731251455291165*^9, 3.731251455884861*^9}, {
   3.731252807069333*^9, 3.7312528551322145`*^9}, {3.7312530311336284`*^9, 
   3.731253031883625*^9}, {3.731380010685237*^9, 3.7313800220446854`*^9}, {
   3.731381156105651*^9, 3.731381157246287*^9}, 3.7313817428102407`*^9, {
   3.731427754286146*^9, 3.7314277863490024`*^9}, {3.737143551279714*^9, 
   3.7371435698253193`*^9}},ExpressionUUID->"46c9eda1-2ad0-424b-87ee-\
5705eac0a869"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHC 2", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
   3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
   3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
   3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731382286987784*^9, 
   3.7313822913940797`*^9}, {3.731382362691682*^9, 3.7313823721292825`*^9}, 
   3.731382420332903*^9},ExpressionUUID->"5aa908a2-39b2-49d8-82d5-\
dc13d8b9b67e"],

Cell[CellGroupData[{

Cell["swing leg is relatively straight; stance leg bends.", "Subsection",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
   3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
   3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
   3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731382286987784*^9, 
   3.7313822913940797`*^9}, {3.731382362691682*^9, 3.7313823721292825`*^9}, 
   3.7313824171922464`*^9},ExpressionUUID->"29981341-e22b-489c-bcf6-\
90632177c5e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VHC", "[", "2", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"continuation", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "0", ",", " ", "1", ",", " ", "1"}], "}"}],
            "]"}]}], ",", " ", 
         RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "1", ",", " ", "1", ",", " ", "1"}], "}"}],
            "]"}]}]}], "|>"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcon", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"post", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "+"}], "]"}], "/", "c"}]}], "+"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"virtual", " ", "constraints"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{"3", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<fem\>\"", "|", " ", "\"\<tib\>\""}], "}"}], 
             "}"}]}], "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "configurations"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "velocities"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RabbitP", "[", 
        RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j", ",", " ", "n", ",", " ", "M"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", " ", "=", " ", 
           RowBox[{"BLP", "[", 
            RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"BLbiped", "[", 
              RowBox[{"\"\<c\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], 
              "]"}]}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"zero", " ", "next", " ", "pre"}], "-", 
            RowBox[{"impact", " ", "state"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"2", ",", " ", "4", ",", " ", "5"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"5", ",", " ", "7", ",", " ", "8"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", " ", 
             RowBox[{"j", "+", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<x-\>\"", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114957825127*^9, 3.719114994512991*^9}, {
   3.719115071641429*^9, 3.7191150718289304`*^9}, {3.719115766052431*^9, 
   3.7191157663493085`*^9}, {3.7192025676144285`*^9, 3.719202577161398*^9}, {
   3.7193360677608843`*^9, 3.719336120058194*^9}, {3.7193362079964304`*^9, 
   3.719336222715287*^9}, {3.719581349109211*^9, 3.719581354156126*^9}, {
   3.7195975443072824`*^9, 3.7195975447291613`*^9}, {3.719597587088908*^9, 
   3.7195976826678324`*^9}, {3.719606284722884*^9, 3.7196062941292105`*^9}, {
   3.719616657925231*^9, 3.7196166688003054`*^9}, {3.7196220053931046`*^9, 
   3.719622013705658*^9}, {3.719773638305861*^9, 3.719773710290879*^9}, {
   3.719774660737048*^9, 3.7197746739715605`*^9}, {3.719778151737618*^9, 
   3.719778162815843*^9}, 3.719778240629066*^9, 3.7198425122584114`*^9, 
   3.7198428792976723`*^9, {3.720197894870371*^9, 3.72019789766726*^9}, {
   3.7201999727545166`*^9, 3.720199976285802*^9}, {3.720201050340228*^9, 
   3.720201050699592*^9}, {3.7202018066755266`*^9, 3.7202018481759367`*^9}, {
   3.7202217053639784`*^9, 3.720221705770234*^9}, {3.7202227020596013`*^9, 
   3.7202227022783475`*^9}, {3.7204184861079655`*^9, 3.720418493295533*^9}, {
   3.720510315249448*^9, 3.7205103203432603`*^9}, 3.7205117451675615`*^9, 
   3.7205117955899067`*^9, {3.7205127605289297`*^9, 3.720512760638305*^9}, {
   3.7205163106937494`*^9, 3.7205163152562733`*^9}, {3.7205357320072384`*^9, 
   3.7205357366947584`*^9}, {3.7205371629590197`*^9, 
   3.7205371676621885`*^9}, {3.7205372579442606`*^9, 3.720537259538026*^9}, {
   3.7205402128880014`*^9, 3.7205402146067667`*^9}, {3.720540963097971*^9, 
   3.720540966613628*^9}, {3.7205441323466063`*^9, 3.72054413351851*^9}, {
   3.720544408036622*^9, 3.7205444091616335`*^9}, {3.7205764745669413`*^9, 
   3.720576481582631*^9}, {3.720577009870885*^9, 3.7205770159959416`*^9}, {
   3.720581180575188*^9, 3.7205811817783403`*^9}, {3.7205818580906906`*^9, 
   3.720581861215719*^9}, {3.72079345655674*^9, 3.720793457806735*^9}, {
   3.7207948586982927`*^9, 3.7207948612920504`*^9}, {3.720806907071228*^9, 
   3.7208069078212333`*^9}, {3.7219998599416685`*^9, 3.7219998619573116`*^9}, 
   3.72200036420527*^9, 3.7220006043936195`*^9, {3.7220018663983574`*^9, 
   3.7220018707109165`*^9}, {3.7220063086138945`*^9, 
   3.7220063229111567`*^9}, {3.722006394323783*^9, 3.7220063954800453`*^9}, {
   3.72201084977713*^9, 3.722010854433425*^9}, {3.7220113876095314`*^9, 
   3.722011388734538*^9}, {3.7220143841797247`*^9, 3.7220143863828726`*^9}, {
   3.7220225191326065`*^9, 3.722022520257635*^9}, {3.7220344406143675`*^9, 
   3.7220344407237453`*^9}, {3.7220347797982106`*^9, 
   3.7220347826945457`*^9}, {3.7220350121834755`*^9, 
   3.7220350140272408`*^9}, {3.722035358501729*^9, 3.7220353609080224`*^9}, {
   3.722035810079729*^9, 3.722035816798565*^9}, {3.722036181660059*^9, 
   3.722036185144472*^9}, {3.722036802255605*^9, 3.7220368083114853`*^9}, {
   3.722037345761135*^9, 3.7220373504174194`*^9}, 3.7220388589250197`*^9, {
   3.7220396117052965`*^9, 3.722039611877163*^9}, {3.722039925093557*^9, 
   3.722039925218554*^9}, {3.7220403870318484`*^9, 3.722040399406987*^9}, 
   3.722040886505741*^9, {3.7220449869333224`*^9, 3.7220450361682005`*^9}, {
   3.7220451603726025`*^9, 3.7220451757321324`*^9}, {3.722089433043927*^9, 
   3.7220894455842*^9}, {3.722089900392234*^9, 3.7220899010484924`*^9}, {
   3.722091756585374*^9, 3.722091763507305*^9}, {3.722093244053013*^9, 
   3.722093248053053*^9}, {3.722093624429129*^9, 3.72209363153858*^9}, {
   3.7220940586473303`*^9, 3.7220940998821115`*^9}, {3.7243698178277683`*^9, 
   3.724369821755304*^9}, {3.7243771597230186`*^9, 3.724377159829077*^9}, {
   3.7304652880955896`*^9, 3.7304652887518773`*^9}, {3.730570085792858*^9, 
   3.730570100011771*^9}, 3.7305702364821053`*^9, {3.730570596771381*^9, 
   3.730570599380788*^9}, 3.730570954031128*^9, {3.730571389570566*^9, 
   3.7305714063675747`*^9}, {3.7305721317015424`*^9, 3.730572135842202*^9}, 
   3.7305724080194716`*^9, {3.7305725795391135`*^9, 3.7305725811172066`*^9}, {
   3.7305734370865784`*^9, 3.7305734385084915`*^9}, {3.7305736641688137`*^9, 
   3.730573664387565*^9}, {3.7305986500527225`*^9, 3.730598670412298*^9}, {
   3.730623616617629*^9, 3.730623650992876*^9}, {3.7306302062857323`*^9, 
   3.7306302094576597`*^9}, 3.7306320334865875`*^9, 3.7306323765794187`*^9, {
   3.7306332581056185`*^9, 3.7306332639337535`*^9}, {3.7307281760622454`*^9, 
   3.730728194632934*^9}, {3.7307307403452816`*^9, 3.7307307631715508`*^9}, {
   3.7307316072252073`*^9, 3.730731622147172*^9}, {3.730731922647436*^9, 
   3.730731928694354*^9}, 3.7311696404331512`*^9, {3.7311696707458935`*^9, 
   3.7311697615278683`*^9}, {3.7311698000906935`*^9, 3.731169813481393*^9}, {
   3.731171220919318*^9, 3.7311713404827833`*^9}, {3.731171377529971*^9, 
   3.7311713807955923`*^9}, {3.731171467284692*^9, 3.7311714899723907`*^9}, {
   3.731171529128953*^9, 3.731171544566576*^9}, {3.7311718093110113`*^9, 
   3.731171823108008*^9}, {3.7311718635614557`*^9, 3.7311718973586006`*^9}, {
   3.7311719491090145`*^9, 3.7311719716716943`*^9}, {3.731172081141317*^9, 
   3.731172106391565*^9}, {3.731172203989427*^9, 3.7311722043488493`*^9}, {
   3.7311722430366135`*^9, 3.7311722695055747`*^9}, {3.7311724515226526`*^9, 
   3.731172483835416*^9}, {3.7311725472421665`*^9, 3.731172550382817*^9}, {
   3.7311725853049536`*^9, 3.731172589055016*^9}, 3.7311726498836083`*^9, {
   3.7311732485256605`*^9, 3.731173273572736*^9}, {3.7311733050260944`*^9, 
   3.7311733666203675`*^9}, {3.7311734111675835`*^9, 3.731173414620736*^9}, {
   3.7311734533710284`*^9, 3.731173455519209*^9}, {3.7311735012097983`*^9, 
   3.7311735245068545`*^9}, 3.7311736931800766`*^9, 3.731188496426447*^9, 
   3.731189203819954*^9, {3.7311915552048397`*^9, 3.731191567564313*^9}, {
   3.731192936024188*^9, 3.731192940321098*^9}, {3.731223311439047*^9, 
   3.731223343361196*^9}, {3.731223400158552*^9, 3.7312234142367287`*^9}, 
   3.7312237151745825`*^9, {3.731224733346987*^9, 3.731224751268984*^9}, {
   3.7312248120663433`*^9, 3.731224838519679*^9}, {3.7312248743949647`*^9, 
   3.731224886191953*^9}, {3.7312254683463593`*^9, 3.731225470862053*^9}, {
   3.7312273296502495`*^9, 3.7312273381347136`*^9}, {3.731227675316327*^9, 
   3.731227682378824*^9}, {3.731229653491791*^9, 3.7312296574761796`*^9}, {
   3.731229840868306*^9, 3.7312298618528275`*^9}, {3.7312299699318113`*^9, 
   3.731229989416348*^9}, {3.7312302325120363`*^9, 3.731230235527668*^9}, {
   3.731230444294963*^9, 3.7312304460762405`*^9}, {3.731230736687936*^9, 
   3.7312307558443537`*^9}, {3.731251455291165*^9, 3.731251455884861*^9}, {
   3.731252807069333*^9, 3.7312528551322145`*^9}, {3.7312530311336284`*^9, 
   3.731253031883625*^9}, {3.731380010685237*^9, 3.7313800220446854`*^9}, {
   3.731381156105651*^9, 3.731381157246287*^9}, 3.7313817428102407`*^9, {
   3.7313823380664186`*^9, 3.7313823507227993`*^9}, 3.731382406989015*^9, {
   3.737142610862115*^9, 3.737142613190079*^9}, {3.7371435150478177`*^9, 
   3.7371435212192707`*^9}},ExpressionUUID->"25a75edd-1974-4f71-82b3-\
d20ca201ea0c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHC 3 - Stance knee is locked; can\[CloseCurlyQuote]t walk on flat \
ground", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7312531253657274`*^9, 3.7312531457408905`*^9}, {3.731382424551693*^9, 
  3.7313824246454287`*^9}},ExpressionUUID->"a37a045c-eda3-4c7a-b220-\
791d1c2a1f8d"],

Cell[CellGroupData[{

Cell["Stance knee is locked; can\[CloseCurlyQuote]t walk on flat ground", \
"Subsection",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7312531253657274`*^9, 3.7312531457408905`*^9}, {3.731382424551693*^9, 
  3.731382432426777*^9}},ExpressionUUID->"2257b149-4182-4cbc-a361-\
7d1a534fac2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VHC", "[", "3", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"continuation", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}]}], "|>"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcon", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"post", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "+"}], "]"}], "/", "c"}]}], "+"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"virtual", " ", "constraints"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"t", "  ", "<>", " ", "\"\< tib\>\""}], "}"}], "}"}]}],
             ",", " ", 
            RowBox[{"3", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"w", " ", "<>", " ", "\"\< fem\>\""}], ")"}], "|"}],
                 "*)"}], " ", 
               RowBox[{"(", 
                RowBox[{"w", "  ", "<>", " ", "\"\< tib\>\""}], ")"}], "}"}], 
              "}"}]}]}], "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "configurations"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<tib\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "velocities"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"t", " ", "<>", " ", "\"\< tib\>\""}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RabbitP", "[", 
        RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j", ",", " ", "n", ",", " ", "M"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", " ", "=", " ", 
           RowBox[{"BLP", "[", 
            RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"BLbiped", "[", "\"\<x[p]\>\"", "]"}]}], "/", "2"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", "7", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"nq", "+", "7"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{
            "\"\<x+\>\"", ",", " ", "2", ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "M"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114957825127*^9, 3.719114994512991*^9}, {
   3.719115071641429*^9, 3.7191150718289304`*^9}, {3.719115766052431*^9, 
   3.7191157663493085`*^9}, {3.7192025676144285`*^9, 3.719202577161398*^9}, {
   3.7193360677608843`*^9, 3.719336120058194*^9}, {3.7193362079964304`*^9, 
   3.719336222715287*^9}, {3.719581349109211*^9, 3.719581354156126*^9}, {
   3.7195975443072824`*^9, 3.7195975447291613`*^9}, {3.719597587088908*^9, 
   3.7195976826678324`*^9}, {3.719606284722884*^9, 3.7196062941292105`*^9}, {
   3.719616657925231*^9, 3.7196166688003054`*^9}, {3.7196220053931046`*^9, 
   3.719622013705658*^9}, {3.719773638305861*^9, 3.719773710290879*^9}, {
   3.719774660737048*^9, 3.7197746739715605`*^9}, {3.719778151737618*^9, 
   3.719778162815843*^9}, 3.719778240629066*^9, 3.7198425122584114`*^9, 
   3.7198428792976723`*^9, {3.720197894870371*^9, 3.72019789766726*^9}, {
   3.7201999727545166`*^9, 3.720199976285802*^9}, {3.720201050340228*^9, 
   3.720201050699592*^9}, {3.7202018066755266`*^9, 3.7202018481759367`*^9}, {
   3.7202217053639784`*^9, 3.720221705770234*^9}, {3.7202227020596013`*^9, 
   3.7202227022783475`*^9}, {3.7204184861079655`*^9, 3.720418493295533*^9}, {
   3.720510315249448*^9, 3.7205103203432603`*^9}, 3.7205117451675615`*^9, 
   3.7205117955899067`*^9, {3.7205127605289297`*^9, 3.720512760638305*^9}, {
   3.7205163106937494`*^9, 3.7205163152562733`*^9}, {3.7205357320072384`*^9, 
   3.7205357366947584`*^9}, {3.7205371629590197`*^9, 
   3.7205371676621885`*^9}, {3.7205372579442606`*^9, 3.720537259538026*^9}, {
   3.7205402128880014`*^9, 3.7205402146067667`*^9}, {3.720540963097971*^9, 
   3.720540966613628*^9}, {3.7205441323466063`*^9, 3.72054413351851*^9}, {
   3.720544408036622*^9, 3.7205444091616335`*^9}, {3.7205764745669413`*^9, 
   3.720576481582631*^9}, {3.720577009870885*^9, 3.7205770159959416`*^9}, {
   3.720581180575188*^9, 3.7205811817783403`*^9}, {3.7205818580906906`*^9, 
   3.720581861215719*^9}, {3.72079345655674*^9, 3.720793457806735*^9}, {
   3.7207948586982927`*^9, 3.7207948612920504`*^9}, {3.720806907071228*^9, 
   3.7208069078212333`*^9}, {3.7219998599416685`*^9, 3.7219998619573116`*^9}, 
   3.72200036420527*^9, 3.7220006043936195`*^9, {3.7220018663983574`*^9, 
   3.7220018707109165`*^9}, {3.7220063086138945`*^9, 
   3.7220063229111567`*^9}, {3.722006394323783*^9, 3.7220063954800453`*^9}, {
   3.72201084977713*^9, 3.722010854433425*^9}, {3.7220113876095314`*^9, 
   3.722011388734538*^9}, {3.7220143841797247`*^9, 3.7220143863828726`*^9}, {
   3.7220225191326065`*^9, 3.722022520257635*^9}, {3.7220344406143675`*^9, 
   3.7220344407237453`*^9}, {3.7220347797982106`*^9, 
   3.7220347826945457`*^9}, {3.7220350121834755`*^9, 
   3.7220350140272408`*^9}, {3.722035358501729*^9, 3.7220353609080224`*^9}, {
   3.722035810079729*^9, 3.722035816798565*^9}, {3.722036181660059*^9, 
   3.722036185144472*^9}, {3.722036802255605*^9, 3.7220368083114853`*^9}, {
   3.722037345761135*^9, 3.7220373504174194`*^9}, 3.7220388589250197`*^9, {
   3.7220396117052965`*^9, 3.722039611877163*^9}, {3.722039925093557*^9, 
   3.722039925218554*^9}, {3.7220403870318484`*^9, 3.722040399406987*^9}, 
   3.722040886505741*^9, {3.7220449869333224`*^9, 3.7220450361682005`*^9}, {
   3.7220451603726025`*^9, 3.7220451757321324`*^9}, {3.722089433043927*^9, 
   3.7220894455842*^9}, {3.722089900392234*^9, 3.7220899010484924`*^9}, {
   3.722091756585374*^9, 3.722091763507305*^9}, {3.722093244053013*^9, 
   3.722093248053053*^9}, {3.722093624429129*^9, 3.72209363153858*^9}, {
   3.7220940586473303`*^9, 3.7220940998821115`*^9}, {3.7243698178277683`*^9, 
   3.724369821755304*^9}, {3.7243771597230186`*^9, 3.724377159829077*^9}, {
   3.7304652880955896`*^9, 3.7304652887518773`*^9}, {3.730570085792858*^9, 
   3.730570100011771*^9}, 3.7305702364821053`*^9, {3.730570596771381*^9, 
   3.730570599380788*^9}, 3.730570954031128*^9, {3.730571389570566*^9, 
   3.7305714063675747`*^9}, {3.7305721317015424`*^9, 3.730572135842202*^9}, 
   3.7305724080194716`*^9, {3.7305725795391135`*^9, 3.7305725811172066`*^9}, {
   3.7305734370865784`*^9, 3.7305734385084915`*^9}, {3.7305736641688137`*^9, 
   3.730573664387565*^9}, {3.7305986500527225`*^9, 3.730598670412298*^9}, {
   3.730623616617629*^9, 3.730623650992876*^9}, {3.7306302062857323`*^9, 
   3.7306302094576597`*^9}, 3.7306320334865875`*^9, 3.7306323765794187`*^9, {
   3.7306332581056185`*^9, 3.7306332639337535`*^9}, {3.7307281760622454`*^9, 
   3.730728194632934*^9}, {3.7307307403452816`*^9, 3.7307307631715508`*^9}, {
   3.7307316072252073`*^9, 3.730731622147172*^9}, {3.730731922647436*^9, 
   3.730731928694354*^9}, 3.7311696404331512`*^9, {3.7311696707458935`*^9, 
   3.7311697615278683`*^9}, {3.7311698000906935`*^9, 3.731169813481393*^9}, {
   3.731171220919318*^9, 3.7311713404827833`*^9}, {3.731171377529971*^9, 
   3.7311713807955923`*^9}, {3.731171467284692*^9, 3.7311714899723907`*^9}, {
   3.731171529128953*^9, 3.731171544566576*^9}, {3.7311718093110113`*^9, 
   3.731171823108008*^9}, {3.7311718635614557`*^9, 3.7311718973586006`*^9}, {
   3.7311719491090145`*^9, 3.7311719716716943`*^9}, {3.731172081141317*^9, 
   3.731172106391565*^9}, {3.731172203989427*^9, 3.7311722043488493`*^9}, {
   3.7311722430366135`*^9, 3.7311722695055747`*^9}, {3.7311724515226526`*^9, 
   3.731172483835416*^9}, {3.7311725472421665`*^9, 3.731172550382817*^9}, {
   3.7311725853049536`*^9, 3.731172589055016*^9}, 3.7311726498836083`*^9, {
   3.7311732485256605`*^9, 3.731173273572736*^9}, {3.7311733050260944`*^9, 
   3.7311733666203675`*^9}, {3.7311734111675835`*^9, 3.731173414620736*^9}, {
   3.7311734533710284`*^9, 3.731173455519209*^9}, {3.7311735012097983`*^9, 
   3.7311735245068545`*^9}, 3.7311736931800766`*^9, 3.731188496426447*^9, 
   3.731189203819954*^9, {3.7311915552048397`*^9, 3.731191567564313*^9}, {
   3.731192936024188*^9, 3.731192940321098*^9}, {3.731223311439047*^9, 
   3.731223343361196*^9}, {3.731223400158552*^9, 3.7312234142367287`*^9}, 
   3.7312237151745825`*^9, {3.731224733346987*^9, 3.731224751268984*^9}, {
   3.7312248120663433`*^9, 3.731224838519679*^9}, {3.7312248743949647`*^9, 
   3.731224886191953*^9}, {3.7312254683463593`*^9, 3.731225470862053*^9}, {
   3.7312273296502495`*^9, 3.7312273381347136`*^9}, {3.731227675316327*^9, 
   3.731227682378824*^9}, {3.731229653491791*^9, 3.7312296574761796`*^9}, {
   3.731229840868306*^9, 3.7312298618528275`*^9}, {3.7312299699318113`*^9, 
   3.731229989416348*^9}, {3.7312302325120363`*^9, 3.731230235527668*^9}, {
   3.731230444294963*^9, 3.7312304460762405`*^9}, {3.73125164519888*^9, 
   3.7312516457301264`*^9}, {3.731252888523106*^9, 3.7312529065076237`*^9}, {
   3.7312530456337347`*^9, 3.73125304686812*^9}, {3.731254212605814*^9, 
   3.7312542133245296`*^9}, 3.7313596474839616`*^9, {3.731380151233494*^9, 
   3.731380160077351*^9}, {3.7313811466993027`*^9, 3.731381147464937*^9}, 
   3.7313824267392178`*^9, 
   3.7371427824128914`*^9},ExpressionUUID->"c3e6f73c-710e-4b3f-9552-\
dd9ad301996e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHC 4 - ankles only", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
   3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
   3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
   3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731359704515849*^9, 
   3.7313597265472803`*^9}, 
   3.7313824377080793`*^9},ExpressionUUID->"29f52a87-df35-4861-aa2f-\
e8c080c4e84d"],

Cell[CellGroupData[{

Cell["ankles only", "Subsection",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731359704515849*^9, 
  3.7313597265472803`*^9}, {3.7313824377080793`*^9, 
  3.731382448130047*^9}},ExpressionUUID->"6dd1007a-b079-4925-bf42-\
644228039544"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VHC", "[", "4", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"continuation", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}]}], "|>"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcon", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"post", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "+"}], "]"}], "/", "c"}]}], "+"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"virtual", " ", "constraints"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{"3", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"{", "\"\<tib\>\"", "}"}], "}"}]}], "|>"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "configurations"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "velocities"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RabbitP", "[", 
        RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j", ",", " ", "n", ",", " ", "M"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", " ", "=", " ", 
           RowBox[{"BLP", "[", 
            RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"BLbiped", "[", 
              RowBox[{"\"\<c\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], 
              "]"}]}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"4", ",", "5"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"7", ",", " ", "8"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", " ", 
             RowBox[{"j", "+", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<x-\>\"", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "M"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114957825127*^9, 3.719114994512991*^9}, {
   3.719115071641429*^9, 3.7191150718289304`*^9}, {3.719115766052431*^9, 
   3.7191157663493085`*^9}, {3.7192025676144285`*^9, 3.719202577161398*^9}, {
   3.7193360677608843`*^9, 3.719336120058194*^9}, {3.7193362079964304`*^9, 
   3.719336222715287*^9}, {3.719581349109211*^9, 3.719581354156126*^9}, {
   3.7195975443072824`*^9, 3.7195975447291613`*^9}, {3.719597587088908*^9, 
   3.7195976826678324`*^9}, {3.719606284722884*^9, 3.7196062941292105`*^9}, {
   3.719616657925231*^9, 3.7196166688003054`*^9}, {3.7196220053931046`*^9, 
   3.719622013705658*^9}, {3.719773638305861*^9, 3.719773710290879*^9}, {
   3.719774660737048*^9, 3.7197746739715605`*^9}, {3.719778151737618*^9, 
   3.719778162815843*^9}, 3.719778240629066*^9, 3.7198425122584114`*^9, 
   3.7198428792976723`*^9, {3.720197894870371*^9, 3.72019789766726*^9}, {
   3.7201999727545166`*^9, 3.720199976285802*^9}, {3.720201050340228*^9, 
   3.720201050699592*^9}, {3.7202018066755266`*^9, 3.7202018481759367`*^9}, {
   3.7202217053639784`*^9, 3.720221705770234*^9}, {3.7202227020596013`*^9, 
   3.7202227022783475`*^9}, {3.7204184861079655`*^9, 3.720418493295533*^9}, {
   3.720510315249448*^9, 3.7205103203432603`*^9}, 3.7205117451675615`*^9, 
   3.7205117955899067`*^9, {3.7205127605289297`*^9, 3.720512760638305*^9}, {
   3.7205163106937494`*^9, 3.7205163152562733`*^9}, {3.7205357320072384`*^9, 
   3.7205357366947584`*^9}, {3.7205371629590197`*^9, 
   3.7205371676621885`*^9}, {3.7205372579442606`*^9, 3.720537259538026*^9}, {
   3.7205402128880014`*^9, 3.7205402146067667`*^9}, {3.720540963097971*^9, 
   3.720540966613628*^9}, {3.7205441323466063`*^9, 3.72054413351851*^9}, {
   3.720544408036622*^9, 3.7205444091616335`*^9}, {3.7205764745669413`*^9, 
   3.720576481582631*^9}, {3.720577009870885*^9, 3.7205770159959416`*^9}, {
   3.720581180575188*^9, 3.7205811817783403`*^9}, {3.7205818580906906`*^9, 
   3.720581861215719*^9}, {3.72079345655674*^9, 3.720793457806735*^9}, {
   3.7207948586982927`*^9, 3.7207948612920504`*^9}, {3.720806907071228*^9, 
   3.7208069078212333`*^9}, {3.7219998599416685`*^9, 3.7219998619573116`*^9}, 
   3.72200036420527*^9, 3.7220006043936195`*^9, {3.7220018663983574`*^9, 
   3.7220018707109165`*^9}, {3.7220063086138945`*^9, 
   3.7220063229111567`*^9}, {3.722006394323783*^9, 3.7220063954800453`*^9}, {
   3.72201084977713*^9, 3.722010854433425*^9}, {3.7220113876095314`*^9, 
   3.722011388734538*^9}, {3.7220143841797247`*^9, 3.7220143863828726`*^9}, {
   3.7220225191326065`*^9, 3.722022520257635*^9}, {3.7220344406143675`*^9, 
   3.7220344407237453`*^9}, {3.7220347797982106`*^9, 
   3.7220347826945457`*^9}, {3.7220350121834755`*^9, 
   3.7220350140272408`*^9}, {3.722035358501729*^9, 3.7220353609080224`*^9}, {
   3.722035810079729*^9, 3.722035816798565*^9}, {3.722036181660059*^9, 
   3.722036185144472*^9}, {3.722036802255605*^9, 3.7220368083114853`*^9}, {
   3.722037345761135*^9, 3.7220373504174194`*^9}, 3.7220388589250197`*^9, {
   3.7220396117052965`*^9, 3.722039611877163*^9}, {3.722039925093557*^9, 
   3.722039925218554*^9}, {3.7220403870318484`*^9, 3.722040399406987*^9}, 
   3.722040886505741*^9, {3.7220449869333224`*^9, 3.7220450361682005`*^9}, {
   3.7220451603726025`*^9, 3.7220451757321324`*^9}, {3.722089433043927*^9, 
   3.7220894455842*^9}, {3.722089900392234*^9, 3.7220899010484924`*^9}, {
   3.722091756585374*^9, 3.722091763507305*^9}, {3.722093244053013*^9, 
   3.722093248053053*^9}, {3.722093624429129*^9, 3.72209363153858*^9}, {
   3.7220940586473303`*^9, 3.7220940998821115`*^9}, {3.7243698178277683`*^9, 
   3.724369821755304*^9}, {3.7243771597230186`*^9, 3.724377159829077*^9}, {
   3.7304652880955896`*^9, 3.7304652887518773`*^9}, {3.730570085792858*^9, 
   3.730570100011771*^9}, 3.7305702364821053`*^9, {3.730570596771381*^9, 
   3.730570599380788*^9}, 3.730570954031128*^9, {3.730571389570566*^9, 
   3.7305714063675747`*^9}, {3.7305721317015424`*^9, 3.730572135842202*^9}, 
   3.7305724080194716`*^9, {3.7305725795391135`*^9, 3.7305725811172066`*^9}, {
   3.7305734370865784`*^9, 3.7305734385084915`*^9}, {3.7305736641688137`*^9, 
   3.730573664387565*^9}, {3.7305986500527225`*^9, 3.730598670412298*^9}, {
   3.730623616617629*^9, 3.730623650992876*^9}, {3.7306302062857323`*^9, 
   3.7306302094576597`*^9}, 3.7306320334865875`*^9, 3.7306323765794187`*^9, {
   3.7306332581056185`*^9, 3.7306332639337535`*^9}, {3.7307281760622454`*^9, 
   3.730728194632934*^9}, {3.7307307403452816`*^9, 3.7307307631715508`*^9}, {
   3.7307316072252073`*^9, 3.730731622147172*^9}, {3.730731922647436*^9, 
   3.730731928694354*^9}, 3.7311696404331512`*^9, {3.7311696707458935`*^9, 
   3.7311697615278683`*^9}, {3.7311698000906935`*^9, 3.731169813481393*^9}, {
   3.731171220919318*^9, 3.7311713404827833`*^9}, {3.731171377529971*^9, 
   3.7311713807955923`*^9}, {3.731171467284692*^9, 3.7311714899723907`*^9}, {
   3.731171529128953*^9, 3.731171544566576*^9}, {3.7311718093110113`*^9, 
   3.731171823108008*^9}, {3.7311718635614557`*^9, 3.7311718973586006`*^9}, {
   3.7311719491090145`*^9, 3.7311719716716943`*^9}, {3.731172081141317*^9, 
   3.731172106391565*^9}, {3.731172203989427*^9, 3.7311722043488493`*^9}, {
   3.7311722430366135`*^9, 3.7311722695055747`*^9}, {3.7311724515226526`*^9, 
   3.731172483835416*^9}, {3.7311725472421665`*^9, 3.731172550382817*^9}, {
   3.7311725853049536`*^9, 3.731172589055016*^9}, 3.7311726498836083`*^9, {
   3.7311732485256605`*^9, 3.731173273572736*^9}, {3.7311733050260944`*^9, 
   3.7311733666203675`*^9}, {3.7311734111675835`*^9, 3.731173414620736*^9}, {
   3.7311734533710284`*^9, 3.731173455519209*^9}, {3.7311735012097983`*^9, 
   3.7311735245068545`*^9}, 3.7311736931800766`*^9, 3.731188496426447*^9, 
   3.731189203819954*^9, {3.7311915552048397`*^9, 3.731191567564313*^9}, {
   3.731192936024188*^9, 3.731192940321098*^9}, {3.731223311439047*^9, 
   3.731223343361196*^9}, {3.731223400158552*^9, 3.7312234142367287`*^9}, 
   3.7312237151745825`*^9, {3.731224733346987*^9, 3.731224751268984*^9}, {
   3.7312248120663433`*^9, 3.731224838519679*^9}, {3.7312248743949647`*^9, 
   3.731224886191953*^9}, {3.7312254683463593`*^9, 3.731225470862053*^9}, {
   3.7312273296502495`*^9, 3.7312273381347136`*^9}, {3.731227675316327*^9, 
   3.731227682378824*^9}, {3.731229653491791*^9, 3.7312296574761796`*^9}, {
   3.731229840868306*^9, 3.7312298618528275`*^9}, {3.7312299699318113`*^9, 
   3.731229989416348*^9}, {3.7312302325120363`*^9, 3.731230235527668*^9}, {
   3.731230444294963*^9, 3.7312304460762405`*^9}, {3.731230736687936*^9, 
   3.7312307558443537`*^9}, {3.731251455291165*^9, 3.731251455884861*^9}, {
   3.731252807069333*^9, 3.7312528551322145`*^9}, {3.7312530311336284`*^9, 
   3.731253031883625*^9}, {3.731359711843998*^9, 3.7313597764384146`*^9}, 
   3.731378236262412*^9, {3.731379869849106*^9, 3.73137997421605*^9}, {
   3.7313800356073556`*^9, 3.731380039623036*^9}, 3.731382439551864*^9, 
   3.7371427921934557`*^9, 
   3.7448972631303596`*^9},ExpressionUUID->"83bdefc8-8583-4e98-9f11-\
d944be8a6dad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHC 5 - default set of controls found in literature", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
   3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
   3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
   3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731359704515849*^9, 
   3.7313597265472803`*^9}, 3.7313824377080793`*^9, {3.7439459788703127`*^9, 
   3.7439460109133472`*^9}},ExpressionUUID->"a81f9b14-f7ee-40e5-bb42-\
e3e54ef1ad83"],

Cell[CellGroupData[{

Cell["used with GHM", "Subsection",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7312530840685225`*^9, 3.731253108834345*^9}, {3.731359704515849*^9, 
  3.7313597265472803`*^9}, {3.7313824377080793`*^9, 3.731382448130047*^9}, {
  3.7439460127413445`*^9, 
  3.743946016444252*^9}},ExpressionUUID->"d45d666d-d0e5-49a7-b9ee-\
e884f4bb029d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VHC", "[", "5", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"continuation", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", "}"}]}]}], "|>"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vcon", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"post", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "+"}], "]"}], "/", "c"}]}], "+"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"virtual", " ", "constraints"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"<|", 
           RowBox[{"5", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\"\<fem\>\"", "|", " ", "\"\<tib\>\""}], "}"}], 
             "}"}]}], "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "configurations"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vrm", "[", "s_", "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"pre", "-", 
           RowBox[{"impact", " ", 
            RowBox[{"stance", "/", "swing"}], " ", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"0", "-"}], "]"}], "/", "c"}]}], "-"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "w"}], "}"}], " ", "=", " ", 
           RowBox[{"stsw", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"remove", " ", "following", " ", "velocities"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\"\<none\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RabbitP", "[", 
        RowBox[{"m_String", ",", " ", "cp_", ",", " ", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "j", ",", " ", "n", ",", " ", "M"}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", " ", "=", " ", 
           RowBox[{"BLP", "[", 
            RowBox[{"m", ",", " ", "cp", ",", " ", "opts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"BLbiped", "[", 
              RowBox[{"\"\<c\>\"", ",", " ", "m", ",", " ", "\"\<x\>\""}], 
              "]"}]}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"2", ",", " ", "3", ",", " ", "4", ",", " ", "5"}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"i", " ", "+", " ", "n"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"5", ",", " ", "6", ",", " ", "7", ",", " ", "8"}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"j", ",", " ", 
             RowBox[{"j", "+", "nq"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<R\>\"", ",", " ", "All", ",", " ", "i"}], 
            "\[RightDoubleBracket]"}], " ", "=", " ", 
           RowBox[{"M", "\[LeftDoubleBracket]", 
            RowBox[{"\"\<x-\>\"", ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "All", ",", " ", "j"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", "M"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114957825127*^9, 3.719114994512991*^9}, {
   3.719115071641429*^9, 3.7191150718289304`*^9}, {3.719115766052431*^9, 
   3.7191157663493085`*^9}, {3.7192025676144285`*^9, 3.719202577161398*^9}, {
   3.7193360677608843`*^9, 3.719336120058194*^9}, {3.7193362079964304`*^9, 
   3.719336222715287*^9}, {3.719581349109211*^9, 3.719581354156126*^9}, {
   3.7195975443072824`*^9, 3.7195975447291613`*^9}, {3.719597587088908*^9, 
   3.7195976826678324`*^9}, {3.719606284722884*^9, 3.7196062941292105`*^9}, {
   3.719616657925231*^9, 3.7196166688003054`*^9}, {3.7196220053931046`*^9, 
   3.719622013705658*^9}, {3.719773638305861*^9, 3.719773710290879*^9}, {
   3.719774660737048*^9, 3.7197746739715605`*^9}, {3.719778151737618*^9, 
   3.719778162815843*^9}, 3.719778240629066*^9, 3.7198425122584114`*^9, 
   3.7198428792976723`*^9, {3.720197894870371*^9, 3.72019789766726*^9}, {
   3.7201999727545166`*^9, 3.720199976285802*^9}, {3.720201050340228*^9, 
   3.720201050699592*^9}, {3.7202018066755266`*^9, 3.7202018481759367`*^9}, {
   3.7202217053639784`*^9, 3.720221705770234*^9}, {3.7202227020596013`*^9, 
   3.7202227022783475`*^9}, {3.7204184861079655`*^9, 3.720418493295533*^9}, {
   3.720510315249448*^9, 3.7205103203432603`*^9}, 3.7205117451675615`*^9, 
   3.7205117955899067`*^9, {3.7205127605289297`*^9, 3.720512760638305*^9}, {
   3.7205163106937494`*^9, 3.7205163152562733`*^9}, {3.7205357320072384`*^9, 
   3.7205357366947584`*^9}, {3.7205371629590197`*^9, 
   3.7205371676621885`*^9}, {3.7205372579442606`*^9, 3.720537259538026*^9}, {
   3.7205402128880014`*^9, 3.7205402146067667`*^9}, {3.720540963097971*^9, 
   3.720540966613628*^9}, {3.7205441323466063`*^9, 3.72054413351851*^9}, {
   3.720544408036622*^9, 3.7205444091616335`*^9}, {3.7205764745669413`*^9, 
   3.720576481582631*^9}, {3.720577009870885*^9, 3.7205770159959416`*^9}, {
   3.720581180575188*^9, 3.7205811817783403`*^9}, {3.7205818580906906`*^9, 
   3.720581861215719*^9}, {3.72079345655674*^9, 3.720793457806735*^9}, {
   3.7207948586982927`*^9, 3.7207948612920504`*^9}, {3.720806907071228*^9, 
   3.7208069078212333`*^9}, {3.7219998599416685`*^9, 3.7219998619573116`*^9}, 
   3.72200036420527*^9, 3.7220006043936195`*^9, {3.7220018663983574`*^9, 
   3.7220018707109165`*^9}, {3.7220063086138945`*^9, 
   3.7220063229111567`*^9}, {3.722006394323783*^9, 3.7220063954800453`*^9}, {
   3.72201084977713*^9, 3.722010854433425*^9}, {3.7220113876095314`*^9, 
   3.722011388734538*^9}, {3.7220143841797247`*^9, 3.7220143863828726`*^9}, {
   3.7220225191326065`*^9, 3.722022520257635*^9}, {3.7220344406143675`*^9, 
   3.7220344407237453`*^9}, {3.7220347797982106`*^9, 
   3.7220347826945457`*^9}, {3.7220350121834755`*^9, 
   3.7220350140272408`*^9}, {3.722035358501729*^9, 3.7220353609080224`*^9}, {
   3.722035810079729*^9, 3.722035816798565*^9}, {3.722036181660059*^9, 
   3.722036185144472*^9}, {3.722036802255605*^9, 3.7220368083114853`*^9}, {
   3.722037345761135*^9, 3.7220373504174194`*^9}, 3.7220388589250197`*^9, {
   3.7220396117052965`*^9, 3.722039611877163*^9}, {3.722039925093557*^9, 
   3.722039925218554*^9}, {3.7220403870318484`*^9, 3.722040399406987*^9}, 
   3.722040886505741*^9, {3.7220449869333224`*^9, 3.7220450361682005`*^9}, {
   3.7220451603726025`*^9, 3.7220451757321324`*^9}, {3.722089433043927*^9, 
   3.7220894455842*^9}, {3.722089900392234*^9, 3.7220899010484924`*^9}, {
   3.722091756585374*^9, 3.722091763507305*^9}, {3.722093244053013*^9, 
   3.722093248053053*^9}, {3.722093624429129*^9, 3.72209363153858*^9}, {
   3.7220940586473303`*^9, 3.7220940998821115`*^9}, {3.7243698178277683`*^9, 
   3.724369821755304*^9}, {3.7243771597230186`*^9, 3.724377159829077*^9}, {
   3.7304652880955896`*^9, 3.7304652887518773`*^9}, {3.730570085792858*^9, 
   3.730570100011771*^9}, 3.7305702364821053`*^9, {3.730570596771381*^9, 
   3.730570599380788*^9}, 3.730570954031128*^9, {3.730571389570566*^9, 
   3.7305714063675747`*^9}, {3.7305721317015424`*^9, 3.730572135842202*^9}, 
   3.7305724080194716`*^9, {3.7305725795391135`*^9, 3.7305725811172066`*^9}, {
   3.7305734370865784`*^9, 3.7305734385084915`*^9}, {3.7305736641688137`*^9, 
   3.730573664387565*^9}, {3.7305986500527225`*^9, 3.730598670412298*^9}, {
   3.730623616617629*^9, 3.730623650992876*^9}, {3.7306302062857323`*^9, 
   3.7306302094576597`*^9}, 3.7306320334865875`*^9, 3.7306323765794187`*^9, {
   3.7306332581056185`*^9, 3.7306332639337535`*^9}, {3.7307281760622454`*^9, 
   3.730728194632934*^9}, {3.7307307403452816`*^9, 3.7307307631715508`*^9}, {
   3.7307316072252073`*^9, 3.730731622147172*^9}, {3.730731922647436*^9, 
   3.730731928694354*^9}, 3.7311696404331512`*^9, {3.7311696707458935`*^9, 
   3.7311697615278683`*^9}, {3.7311698000906935`*^9, 3.731169813481393*^9}, {
   3.731171220919318*^9, 3.7311713404827833`*^9}, {3.731171377529971*^9, 
   3.7311713807955923`*^9}, {3.731171467284692*^9, 3.7311714899723907`*^9}, {
   3.731171529128953*^9, 3.731171544566576*^9}, {3.7311718093110113`*^9, 
   3.731171823108008*^9}, {3.7311718635614557`*^9, 3.7311718973586006`*^9}, {
   3.7311719491090145`*^9, 3.7311719716716943`*^9}, {3.731172081141317*^9, 
   3.731172106391565*^9}, {3.731172203989427*^9, 3.7311722043488493`*^9}, {
   3.7311722430366135`*^9, 3.7311722695055747`*^9}, {3.7311724515226526`*^9, 
   3.731172483835416*^9}, {3.7311725472421665`*^9, 3.731172550382817*^9}, {
   3.7311725853049536`*^9, 3.731172589055016*^9}, 3.7311726498836083`*^9, {
   3.7311732485256605`*^9, 3.731173273572736*^9}, {3.7311733050260944`*^9, 
   3.7311733666203675`*^9}, {3.7311734111675835`*^9, 3.731173414620736*^9}, {
   3.7311734533710284`*^9, 3.731173455519209*^9}, {3.7311735012097983`*^9, 
   3.7311735245068545`*^9}, 3.7311736931800766`*^9, 3.731188496426447*^9, 
   3.731189203819954*^9, {3.7311915552048397`*^9, 3.731191567564313*^9}, {
   3.731192936024188*^9, 3.731192940321098*^9}, {3.731223311439047*^9, 
   3.731223343361196*^9}, {3.731223400158552*^9, 3.7312234142367287`*^9}, 
   3.7312237151745825`*^9, {3.731224733346987*^9, 3.731224751268984*^9}, {
   3.7312248120663433`*^9, 3.731224838519679*^9}, {3.7312248743949647`*^9, 
   3.731224886191953*^9}, {3.7312254683463593`*^9, 3.731225470862053*^9}, {
   3.7312273296502495`*^9, 3.7312273381347136`*^9}, {3.731227675316327*^9, 
   3.731227682378824*^9}, {3.731229653491791*^9, 3.7312296574761796`*^9}, {
   3.731229840868306*^9, 3.7312298618528275`*^9}, {3.7312299699318113`*^9, 
   3.731229989416348*^9}, {3.7312302325120363`*^9, 3.731230235527668*^9}, {
   3.731230444294963*^9, 3.7312304460762405`*^9}, {3.731230736687936*^9, 
   3.7312307558443537`*^9}, {3.731251455291165*^9, 3.731251455884861*^9}, {
   3.731252807069333*^9, 3.7312528551322145`*^9}, {3.7312530311336284`*^9, 
   3.731253031883625*^9}, {3.731359711843998*^9, 3.7313597764384146`*^9}, 
   3.731378236262412*^9, {3.731379869849106*^9, 3.73137997421605*^9}, {
   3.7313800356073556`*^9, 3.731380039623036*^9}, 3.731382439551864*^9, 
   3.7371427921934557`*^9, {3.742917212862397*^9, 3.742917213003011*^9}, 
   3.742917257093447*^9, {3.742917356554821*^9, 3.7429173571641407`*^9}, {
   3.7429176587028832`*^9, 3.742917673873645*^9}, 
   3.7429245814679947`*^9},ExpressionUUID->"95a5991b-3e85-4cc6-8772-\
2d9d634017d6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.672922910157816*^9, 
  3.6729229104546924`*^9}},ExpressionUUID->"89ca9acb-4053-4b62-ae07-\
011985e5c6d0"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231090809507`*^9, 
  3.6729231097997046`*^9}},ExpressionUUID->"4658df9e-a842-4ee0-aa85-\
339f6974490e"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718, 715},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 70, "Section", "ExpressionUUID" -> \
"39e9dbc5-5d7b-4441-82c6-0811eadac5b2"],
Cell[743, 27, 3819, 57, 123, "Input", "ExpressionUUID" -> \
"a8cfd402-edec-4f05-84ae-1d8662f3b1e6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4599, 89, 451, 7, 70, "Section", "ExpressionUUID" -> \
"a37a045c-eda3-4c7a-b220-791d1c2a1f8d"],
Cell[CellGroupData[{
Cell[5075, 100, 482, 7, 49, "Subsection", "ExpressionUUID" -> \
"c5938be3-40a4-406d-ac9a-84440b79803f"],
Cell[5560, 109, 8762, 135, 256, "Input", "ExpressionUUID" -> \
"702c02dd-1448-4c77-b558-4ceb957f4faf",
 InitializationCell->True],
Cell[14325, 246, 16035, 302, 1055, "Input", "ExpressionUUID" -> \
"46c9eda1-2ad0-424b-87ee-5705eac0a869",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30409, 554, 481, 7, 70, "Section", "ExpressionUUID" -> \
"5aa908a2-39b2-49d8-82d5-dc13d8b9b67e"],
Cell[CellGroupData[{
Cell[30915, 565, 532, 7, 49, "Subsection", "ExpressionUUID" -> \
"29981341-e22b-489c-bcf6-90632177c5e7"],
Cell[31450, 574, 13765, 253, 789, "Input", "ExpressionUUID" -> \
"25a75edd-1974-4f71-82b3-d20ca201ea0c",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45264, 833, 475, 7, 70, "Section", "ExpressionUUID" -> \
"a37a045c-eda3-4c7a-b220-791d1c2a1f8d"],
Cell[CellGroupData[{
Cell[45764, 844, 468, 7, 49, "Subsection", "ExpressionUUID" -> \
"2257b149-4182-4cbc-a361-7d1a534fac2d"],
Cell[46235, 853, 13044, 240, 675, "Input", "ExpressionUUID" -> \
"c3e6f73c-710e-4b3f-9552-dd9ad301996e",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59328, 1099, 449, 7, 70, "Section", "ExpressionUUID" -> \
"29f52a87-df35-4861-aa2f-e8c080c4e84d"],
Cell[CellGroupData[{
Cell[59802, 1110, 463, 7, 49, "Subsection", "ExpressionUUID" -> \
"6dd1007a-b079-4925-bf42-644228039544"],
Cell[60268, 1119, 13062, 238, 712, "Input", "ExpressionUUID" -> \
"83bdefc8-8583-4e98-9f11-d944be8a6dad",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73379, 1363, 531, 7, 70, "Section", "ExpressionUUID" -> \
"a81f9b14-f7ee-40e5-bb42-e3e54ef1ad83"],
Cell[CellGroupData[{
Cell[73935, 1374, 516, 8, 49, "Subsection", "ExpressionUUID" -> \
"d45d666d-d0e5-49a7-b9ee-e884f4bb029d"],
Cell[74454, 1384, 13380, 243, 713, "Input", "ExpressionUUID" -> \
"95a5991b-3e85-4cc6-8772-2d9d634017d6",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87883, 1633, 236, 5, 70, "Section", "ExpressionUUID" -> \
"89ca9acb-4053-4b62-ae07-011985e5c6d0",
 InitializationCell->True],
Cell[88122, 1640, 252, 6, 66, "Input", "ExpressionUUID" -> \
"4658df9e-a842-4ee0-aa85-339f6974490e",
 InitializationCell->True]
}, Open  ]]
}
]
*)

