(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33037,        641]
NotebookOptionsPosition[     31065,        595]
NotebookOutlinePosition[     31439,        611]
CellTagsIndexPosition[     31396,        608]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"RigidBodyDerivatives", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{"High", "-", 
      RowBox[{
      "level", " ", "functions", " ", "used", " ", "to", " ", "define", " ", 
       "a", " ", "rigid", " ", 
       RowBox[{"body", ".", "\n", "Copyright"}], " ", 
       RowBox[{"(", "C", ")"}], " ", "2016", " ", "Nelson", " ", "Rosa", " ", 
       RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", 
       " ", "free", " ", "software"}]}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103714917959795`*^9, 3.6103715279410496`*^9}, {
  3.6901267523786774`*^9, 
  3.6901267578419495`*^9}},ExpressionUUID->"36a9df72-93f1-4f0b-8886-\
624339e55a43"],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<RigidBodyDynamics`\>\"", ",", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<GlobalVariables`\>\"", ",", " ", "\"\<Derivatives`\>\""}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.592241768075292*^9, 3.5922417692471714`*^9}, {3.592242084931059*^9, 
   3.5922420876966925`*^9}, 3.5922421309311514`*^9, {3.592255703284815*^9, 
   3.592255706497998*^9}, {3.59225574155902*^9, 3.592255745349224*^9}, {
   3.5922557821253295`*^9, 3.592255815751254*^9}, {3.5922559034172745`*^9, 
   3.5922559113667307`*^9}, {3.5922800860555387`*^9, 3.592280103747531*^9}, {
   3.59275716675933*^9, 3.5927571696474915`*^9}, 3.5927838101231008`*^9, {
   3.5933676479376955`*^9, 3.5933676483126965`*^9}, 3.602872256432743*^9, 
   3.7176821984137764`*^9, {3.717758497261009*^9, 3.717758501136052*^9}, {
   3.7187196832742367`*^9, 3.718719690727435*^9}, 3.718833095581786*^9, {
   3.7188920998304434`*^9, 3.718892100408574*^9}, {3.7188962231842155`*^9, 
   3.7188962363275127`*^9}},ExpressionUUID->"843a85ac-1946-4e13-a70d-\
bea387282b3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Post processing", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 
  3.6807923571497283`*^9}},ExpressionUUID->"c8ff25cd-87d0-457f-862e-\
452857ac9f35"],

Cell["\<\
add a few extra functions to FixCommonFunctions that require extra info to \
work\
\>", "Text",
 CellChangeTimes->{{3.6901276838739614`*^9, 3.69012777405702*^9}, {
  3.6901278478242683`*^9, 3.6901282667236605`*^9}, {3.6901282973038006`*^9, 
  3.690128339329451*^9}, {3.7177585226049995`*^9, 3.717758533761359*^9}, {
  3.717758696903536*^9, 
  3.717758702481697*^9}},ExpressionUUID->"63983ef8-f897-42e3-8ce1-\
e98b140c068e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"common", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"FixFunctionsWithFlatten", ",", " ", "FixFunctionsWithSelect"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FixFunctions", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Derivatives`Private`common", " ", "=", " ", 
       "Derivatives`Private`common"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Derivatives`Private`common", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"common", ",", " ", "Derivatives`Private`common"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"FixCommonFunctions", "[", "expr", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.6807505175450974`*^9, 3.6807505182146254`*^9}, {3.680750750540885*^9, 
   3.680750889755329*^9}, {3.6807512749702587`*^9, 3.680751347384269*^9}, {
   3.68075140250815*^9, 3.68075140282065*^9}, {3.6807514492622814`*^9, 
   3.6807515045940065`*^9}, {3.6807911430954466`*^9, 3.680791143389366*^9}, {
   3.680792308407544*^9, 3.6807923086940536`*^9}, {3.6807941775847745`*^9, 
   3.6807941778969946`*^9}, {3.681085448625431*^9, 3.6810854497916684`*^9}, {
   3.6811252503958178`*^9, 3.681125269259572*^9}, {3.681127071295232*^9, 
   3.681127102989649*^9}, {3.6811273431333065`*^9, 3.681127351836822*^9}, {
   3.69002849477006*^9, 3.6900284969071207`*^9}, {3.690028972793089*^9, 
   3.6900290169186945`*^9}, 3.690029148663006*^9, {3.690029187189972*^9, 
   3.6900291925629*^9}, {3.690029278545068*^9, 3.690029284995552*^9}, 
   3.690029378305349*^9, {3.690029439712564*^9, 3.690029441887326*^9}, {
   3.6900295413260174`*^9, 3.69002956583889*^9}, {3.6900299725790024`*^9, 
   3.6900299785523343`*^9}, {3.6900300323882575`*^9, 3.690030053380579*^9}, {
   3.6900319644361753`*^9, 3.690032025485417*^9}, {3.6900321300580645`*^9, 
   3.6900321380981913`*^9}, {3.6900322054491596`*^9, 3.6900322359952774`*^9}, 
   3.690032279519027*^9, {3.690033656812835*^9, 3.690033722011158*^9}, {
   3.6900338228192387`*^9, 3.690033843328258*^9}, {3.690127221904132*^9, 
   3.6901272226385717`*^9}, {3.717740823845194*^9, 3.7177408485173044`*^9}, {
   3.7177418896834373`*^9, 3.7177418903397045`*^9}, {3.717742005747055*^9, 
   3.717742140701459*^9}, {3.7177422232803726`*^9, 3.7177422238272533`*^9}, {
   3.7177442635653877`*^9, 3.7177442641278934`*^9}, {3.717744407473005*^9, 
   3.7177444183324795`*^9}, {3.7177445428024116`*^9, 
   3.7177445435992985`*^9}, {3.7177450004473863`*^9, 
   3.7177450010411463`*^9}, {3.717757523572733*^9, 3.7177575278071356`*^9}, {
   3.717758002921035*^9, 3.717758005467939*^9}, {3.717758035702602*^9, 
   3.7177581350629168`*^9}, {3.717758566558531*^9, 3.7177585674335546`*^9}, {
   3.7177586064026604`*^9, 3.717758641387385*^9}, {3.717907162294283*^9, 
   3.7179071631692915`*^9}, {3.7179081210792*^9, 3.7179081218760986`*^9}, 
   3.7183292207936783`*^9, {3.7183297506426816`*^9, 3.7183297514395475`*^9}, {
   3.7183304988940473`*^9, 3.718330499237814*^9}, {3.718330726086957*^9, 
   3.7183307270713267`*^9}, {3.718368730269418*^9, 3.7183687308631735`*^9}, {
   3.718369137738661*^9, 3.718369199395522*^9}, {3.718369248458506*^9, 
   3.7183692513647842`*^9}, {3.7183693580064483`*^9, 
   3.7183693841160793`*^9}, {3.7183694775701284`*^9, 3.718369479038893*^9}, {
   3.7183695349769616`*^9, 3.7183695543677783`*^9}, {3.7187217419993863`*^9, 
   3.7187217424681444`*^9}, {3.7187222780671883`*^9, 3.718722278379691*^9}, {
   3.718833061081444*^9, 
   3.7188330615970745`*^9}},ExpressionUUID->"b8969344-6c4a-4d7a-ab6d-\
a06897a8f903"],

Cell[CellGroupData[{

Cell["Flatten", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 
  3.6812140453781524`*^9}},ExpressionUUID->"c89ec7d3-d73f-43c5-95ca-\
57910f194c67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FixFunctionsWithFlatten", " ", "=", " ", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", " ", "e", ",", " ", "m"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", "#"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "max", " ", "derivative", " ", "order"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"e", " ", "=", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", 
          RowBox[{"Set", "[", 
           RowBox[{"x_", ",", " ", "_"}], "]"}], "]"}], " ", "\[RuleDelayed]",
          " ", 
         RowBox[{"DerivativeOrder", "[", "x", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"Max", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"f", ",", " ", "e", ",", " ", "Infinity"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"add", " ", "derivatives", " ", "to", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"...", "."}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"e", " ", "=", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", 
          RowBox[{"Flatten", "[", "x__", "]"}], "]"}], " ", "\[RuleDelayed]", 
         " ", 
         RowBox[{"Thread", "[", 
          RowBox[{"\[FormalP]", "[", "x", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e", " ", "=", " ", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"f", ",", " ", "e", ",", " ", "Infinity"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "e"}], " ", ">", " ", "0"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"CreateSymbol", "[", 
              RowBox[{
               RowBox[{"Evaluate", "@", "i"}], ",", " ", "j", ",", " ", 
               "Hold"}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "e"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", "0", ",", " ", "m"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"e", " ", "=", " ", 
           RowBox[{
            RowBox[{"\[FormalP]", "@", 
             RowBox[{"Evaluate", "@", "e"}]}], " ", "/.", " ", 
            RowBox[{
             RowBox[{"Hold", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
             "x"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"f", " ", "=", " ", 
           RowBox[{
            RowBox[{"f", " ", "/.", " ", 
             RowBox[{"_Flatten", " ", "\[Rule]", "   ", "e"}]}], " ", "/.", 
            " ", 
            RowBox[{"\[FormalP]", " ", "\[Rule]", " ", "Flatten"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "f"}]}], "\[IndentingNewLine]", "]"}], "&"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.680791151742377*^9, 3.6807911519645643`*^9}, {3.6807915366169214`*^9, 
   3.680791542872923*^9}, {3.680792314179553*^9, 3.6807923145203395`*^9}, {
   3.6810854760606966`*^9, 3.681085512435896*^9}, {3.6810855558572874`*^9, 
   3.6810855575135517`*^9}, {3.6810855958198104`*^9, 3.68108560194489*^9}, {
   3.681085640806343*^9, 3.681085650134595*^9}, {3.681085714760208*^9, 
   3.6810857161977196`*^9}, {3.681085889298527*^9, 3.681085909201172*^9}, {
   3.681085981956482*^9, 3.6810859973886995`*^9}, {3.6811220339905605`*^9, 
   3.6811221523978195`*^9}, {3.6811222349743056`*^9, 
   3.6811222659433064`*^9}, {3.6811228731656466`*^9, 
   3.6811229401228094`*^9}, {3.681123223375538*^9, 3.681123245406994*^9}, {
   3.681124525910554*^9, 3.681124530848101*^9}, 3.6811250921328125`*^9, {
   3.6811271507247815`*^9, 3.681127168755266*^9}, {3.6811273232640057`*^9, 
   3.681127324216811*^9}, {3.6811304033706493`*^9, 3.681130419198925*^9}, {
   3.681130462683713*^9, 3.681130516974806*^9}, {3.6811305652252617`*^9, 
   3.6811305672409067`*^9}, {3.681130631881152*^9, 3.681130722822518*^9}, {
   3.6811309753874173`*^9, 3.681131050835415*^9}, 3.681212174890258*^9, {
   3.7177410803320074`*^9, 3.7177410836289024`*^9}, {3.717741132301255*^9, 
   3.7177411644421864`*^9}, {3.717742864020821*^9, 3.71774290014618*^9}, {
   3.7177429385527973`*^9, 3.7177429491466417`*^9}, {3.7177429857407293`*^9, 
   3.7177429904751596`*^9}, {3.717743026694254*^9, 3.7177430347411947`*^9}, {
   3.7177430758040953`*^9, 3.717743076975971*^9}, 3.7177431173982444`*^9, {
   3.7177441861271477`*^9, 3.7177441867677655`*^9}, 3.7177442547059245`*^9, 
   3.7177442980344486`*^9, {3.717744357066271*^9, 3.7177443710664053`*^9}, {
   3.717757532729056*^9, 3.717757543744792*^9}, {3.717758205351974*^9, 
   3.7177582269928203`*^9}, {3.717758331884426*^9, 3.717758332868827*^9}, {
   3.718064545404565*^9, 3.718064545887908*^9}, {3.718328944775326*^9, 
   3.7183290026352854`*^9}, {3.7183290415419083`*^9, 3.718329141761648*^9}, {
   3.718329349310576*^9, 
   3.7183293555762634`*^9}},ExpressionUUID->"3faf6cff-7644-4ee5-9937-\
80e2b6040262"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Select", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 3.681214037278115*^9}, {3.681220503708869*^9, 
  3.681220504052619*^9}, {3.717907138950323*^9, 
  3.7179071416690893`*^9}},ExpressionUUID->"f8071461-1ca0-4b0f-af4c-\
46aaf800579b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"depth", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"x_", ",", " ", "__"}], "]"}], "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"depth", "[", "x", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FixFunctionsWithSelect", " ", "=", " ", 
    RowBox[{
     RowBox[{"#", "  ", "/.", " ", 
      RowBox[{"\"\<***Select***\>\"", " ", "\[Rule]", "  ", "Select"}]}], 
     "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Select", "[", "x__", "]"}], "]"}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"\"\<***Select***\>\"", "[", "x", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"_", ",", " ", 
        RowBox[{"Select", "[", "__", "]"}]}], "]"}], "]"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"{", "IgnoreCase", "}"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"_", ",", " ", 
        RowBox[{
         RowBox[{"Select", "[", "__", "]"}], "\[Transpose]"}]}], "]"}], "]"}],
      "]"}], " ", ":=", " ", 
    RowBox[{"{", "IgnoreCase", "}"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.6807505175450974`*^9, 3.6807505182146254`*^9}, {3.680750750540885*^9, 
   3.680750889755329*^9}, {3.6807512749702587`*^9, 3.680751347384269*^9}, {
   3.68075140250815*^9, 3.68075140282065*^9}, {3.6807514492622814`*^9, 
   3.6807515045940065`*^9}, {3.6807911430954466`*^9, 3.680791143389366*^9}, {
   3.680792308407544*^9, 3.6807923086940536`*^9}, {3.6807941775847745`*^9, 
   3.6807941778969946`*^9}, {3.681085448625431*^9, 3.6810854497916684`*^9}, {
   3.6811252503958178`*^9, 3.681125269259572*^9}, {3.681127071295232*^9, 
   3.681127102989649*^9}, {3.6811273431333065`*^9, 3.681127351836822*^9}, {
   3.681212203134983*^9, 3.6812122147973795`*^9}, {3.6812122500683107`*^9, 
   3.6812122776476493`*^9}, {3.681212372814324*^9, 3.681212540937428*^9}, {
   3.681212608790988*^9, 3.6812126101961994`*^9}, 3.6812126470025663`*^9, {
   3.681212691393663*^9, 3.6812127109512177`*^9}, 3.681212743735463*^9, {
   3.681212781958554*^9, 3.681212786763072*^9}, {3.6812131940813365`*^9, 
   3.681213197596634*^9}, {3.681213237650014*^9, 3.681213239182087*^9}, {
   3.681213368719591*^9, 3.6812133697183795`*^9}, 3.681213412917877*^9, {
   3.6812134998071017`*^9, 3.6812135232137985`*^9}, {3.681213591011466*^9, 
   3.6812136135794735`*^9}, 3.681213643923566*^9, 3.681213754525451*^9, {
   3.6812138595988617`*^9, 3.681213906438315*^9}, {3.6812140753417187`*^9, 
   3.681214140495446*^9}, 3.681214178312124*^9, {3.6812142668728724`*^9, 
   3.681214300882144*^9}, {3.6812143600056343`*^9, 3.681214361925047*^9}, {
   3.6812143945633097`*^9, 3.6812144015788126`*^9}, {3.6812144881235533`*^9, 
   3.681214493607336*^9}, {3.681214545445035*^9, 3.681214548511002*^9}, {
   3.68121466893202*^9, 3.681214716549539*^9}, {3.6812147762991943`*^9, 
   3.681214779423332*^9}, {3.6812148288130317`*^9, 3.6812148650236607`*^9}, {
   3.681214971207588*^9, 3.6812149922842836`*^9}, {3.681215129857127*^9, 
   3.6812151324196568`*^9}, {3.681215199134054*^9, 3.681215226925851*^9}, {
   3.6812153254789486`*^9, 3.6812153415980835`*^9}, {3.6812154917892447`*^9, 
   3.681215530793148*^9}, {3.6812155827759476`*^9, 3.6812155996631975`*^9}, {
   3.681215677045369*^9, 3.6812156862329254`*^9}, {3.681220509008939*^9, 
   3.681220533530229*^9}, {3.6812205906876726`*^9, 3.681220630613731*^9}, {
   3.681220711763172*^9, 3.681220741202752*^9}, 3.6812207816585026`*^9, {
   3.6812208138650455`*^9, 3.681220871437789*^9}, {3.681220907904131*^9, 
   3.6812209511165886`*^9}, {3.6812210435760756`*^9, 
   3.6812210478261566`*^9}, {3.6812211204694624`*^9, 
   3.6812211222976093`*^9}, {3.681221198740054*^9, 3.6812212128279114`*^9}, {
   3.68122128380884*^9, 3.6812212858539515`*^9}, 3.7128573285249205`*^9, {
   3.717742192014452*^9, 3.7177421984207573`*^9}, {3.717744460879756*^9, 
   3.7177444636141605`*^9}, {3.7177446274282165`*^9, 3.717744631178257*^9}, {
   3.7179064723502407`*^9, 3.717906542163406*^9}, {3.717907146591026*^9, 
   3.7179071735443916`*^9}, 3.7179074230931215`*^9, {3.717907471265458*^9, 
   3.7179074863749743`*^9}, 3.717907614719943*^9, 3.717907696783222*^9, {
   3.717907980702877*^9, 3.7179079854216595`*^9}, 3.7183230358565526`*^9, {
   3.7183281844451885`*^9, 3.718328229258131*^9}, {3.7183282633053436`*^9, 
   3.718328348149932*^9}, {3.7191024979964523`*^9, 3.719102624560197*^9}, {
   3.719102702795334*^9, 3.7191027121860557`*^9}, {3.719102754030217*^9, 
   3.7191027597333984`*^9}, {3.7191028719688945`*^9, 
   3.7191028874690347`*^9}, {3.719103083799101*^9, 3.7191030849085035`*^9}, {
   3.7191032972230864`*^9, 3.719103319801444*^9}, {3.7191033525361323`*^9, 
   3.719103364848754*^9}, {3.7191034027553773`*^9, 3.719103469240411*^9}, 
   3.7191035718508005`*^9, {3.719103660351674*^9, 3.7191036790862346`*^9}, {
   3.7191040901692657`*^9, 3.719104120216421*^9}, {3.719104187092083*^9, 
   3.719104206046905*^9}, {3.719104237094097*^9, 3.7191043538296137`*^9}, {
   3.7191043863455596`*^9, 3.7191043868924413`*^9}, 3.719104568506217*^9, {
   3.7191047528361645`*^9, 3.7191047575237103`*^9}, {3.719104862464864*^9, 
   3.7191048727305894`*^9}, {3.719105078763876*^9, 3.7191051370300794`*^9}, {
   3.719105168764776*^9, 3.719105210343315*^9}, {3.7191052478905487`*^9, 
   3.7191052607969284`*^9}, {3.7191054529058795`*^9, 
   3.7191054576403017`*^9}, {3.7697398060938177`*^9, 
   3.7697398193716345`*^9}, {3.7697398831372013`*^9, 
   3.7697398872140965`*^9}, {3.7697399589123507`*^9, 
   3.7697399601566916`*^9}},ExpressionUUID->"59f1208d-c57e-477b-b856-\
980d0b577454"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ba & Length", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 3.681214037278115*^9}, {3.681220503708869*^9, 
  3.681220504052619*^9}, {3.717907138950323*^9, 3.7179071416690893`*^9}, {
  3.718330267282395*^9, 3.71833026729801*^9}, {3.718833030987397*^9, 
  3.7188330360968227`*^9}},ExpressionUUID->"58a67fb7-dc3d-4b40-9e85-\
fbfa5e32ed03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"x_", ",", " ", 
        RowBox[{
        "ba", "\[LeftDoubleBracket]", "y__", "\[RightDoubleBracket]"}]}], 
       "]"}], "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", "IgnoreCase", "}"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"_", ",", " ", 
        RowBox[{"Length", "[", "_", "]"}]}], "]"}], "]"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"{", "IgnoreCase", "}"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.6807505175450974`*^9, 3.6807505182146254`*^9}, {3.680750750540885*^9, 
   3.680750889755329*^9}, {3.6807512749702587`*^9, 3.680751347384269*^9}, {
   3.68075140250815*^9, 3.68075140282065*^9}, {3.6807514492622814`*^9, 
   3.6807515045940065`*^9}, {3.6807911430954466`*^9, 3.680791143389366*^9}, {
   3.680792308407544*^9, 3.6807923086940536`*^9}, {3.6807941775847745`*^9, 
   3.6807941778969946`*^9}, {3.681085448625431*^9, 3.6810854497916684`*^9}, {
   3.6811252503958178`*^9, 3.681125269259572*^9}, {3.681127071295232*^9, 
   3.681127102989649*^9}, {3.6811273431333065`*^9, 3.681127351836822*^9}, {
   3.681212203134983*^9, 3.6812122147973795`*^9}, {3.6812122500683107`*^9, 
   3.6812122776476493`*^9}, {3.681212372814324*^9, 3.681212540937428*^9}, {
   3.681212608790988*^9, 3.6812126101961994`*^9}, 3.6812126470025663`*^9, {
   3.681212691393663*^9, 3.6812127109512177`*^9}, 3.681212743735463*^9, {
   3.681212781958554*^9, 3.681212786763072*^9}, {3.6812131940813365`*^9, 
   3.681213197596634*^9}, {3.681213237650014*^9, 3.681213239182087*^9}, {
   3.681213368719591*^9, 3.6812133697183795`*^9}, 3.681213412917877*^9, {
   3.6812134998071017`*^9, 3.6812135232137985`*^9}, {3.681213591011466*^9, 
   3.6812136135794735`*^9}, 3.681213643923566*^9, 3.681213754525451*^9, {
   3.6812138595988617`*^9, 3.681213906438315*^9}, {3.6812140753417187`*^9, 
   3.681214140495446*^9}, 3.681214178312124*^9, {3.6812142668728724`*^9, 
   3.681214300882144*^9}, {3.6812143600056343`*^9, 3.681214361925047*^9}, {
   3.6812143945633097`*^9, 3.6812144015788126`*^9}, {3.6812144881235533`*^9, 
   3.681214493607336*^9}, {3.681214545445035*^9, 3.681214548511002*^9}, {
   3.68121466893202*^9, 3.681214716549539*^9}, {3.6812147762991943`*^9, 
   3.681214779423332*^9}, {3.6812148288130317`*^9, 3.6812148650236607`*^9}, {
   3.681214971207588*^9, 3.6812149922842836`*^9}, {3.681215129857127*^9, 
   3.6812151324196568`*^9}, {3.681215199134054*^9, 3.681215226925851*^9}, {
   3.6812153254789486`*^9, 3.6812153415980835`*^9}, {3.6812154917892447`*^9, 
   3.681215530793148*^9}, {3.6812155827759476`*^9, 3.6812155996631975`*^9}, {
   3.681215677045369*^9, 3.6812156862329254`*^9}, {3.681220509008939*^9, 
   3.681220533530229*^9}, {3.6812205906876726`*^9, 3.681220630613731*^9}, {
   3.681220711763172*^9, 3.681220741202752*^9}, 3.6812207816585026`*^9, {
   3.6812208138650455`*^9, 3.681220871437789*^9}, {3.681220907904131*^9, 
   3.6812209511165886`*^9}, {3.6812210435760756`*^9, 
   3.6812210478261566`*^9}, {3.6812211204694624`*^9, 
   3.6812211222976093`*^9}, {3.681221198740054*^9, 3.6812212128279114`*^9}, {
   3.68122128380884*^9, 3.6812212858539515`*^9}, 3.7128573285249205`*^9, {
   3.717742192014452*^9, 3.7177421984207573`*^9}, {3.717744460879756*^9, 
   3.7177444636141605`*^9}, {3.7177446274282165`*^9, 3.717744631178257*^9}, {
   3.7179064723502407`*^9, 3.717906542163406*^9}, {3.717907146591026*^9, 
   3.7179071735443916`*^9}, 3.7179074230931215`*^9, {3.717907471265458*^9, 
   3.7179074863749743`*^9}, 3.717907614719943*^9, 3.717907696783222*^9, {
   3.717907980702877*^9, 3.7179080089843845`*^9}, {3.717908040172182*^9, 
   3.7179081124541283`*^9}, {3.718328124897725*^9, 3.718328137147847*^9}, {
   3.7183283319622717`*^9, 3.7183283428217535`*^9}, {3.718367758726682*^9, 
   3.718367766336131*^9}, {3.7186737890884275`*^9, 
   3.718673816869954*^9}},ExpressionUUID->"3a7d0bbf-eefc-40a0-98dd-\
094c28d6d717"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 
  3.5914868026208353`*^9}},ExpressionUUID->"2143a952-ac86-44ce-80d6-\
af271244e104"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718, 718},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2937, 59, 285, "Code",ExpressionUUID->"36a9df72-93f1-4f0b-8886-624339e55a43",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3520, 83, 100, 1, 67, "Section",ExpressionUUID->"4084db6e-7d11-4a84-8f9a-eb4b619a366b"],
Cell[3623, 86, 2168, 33, 64, "Input",ExpressionUUID->"843a85ac-1946-4e13-a70d-bea387282b3f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5828, 124, 464, 7, 67, "Section",ExpressionUUID->"c8ff25cd-87d0-457f-862e-452857ac9f35"],
Cell[6295, 133, 433, 9, 34, "Text",ExpressionUUID->"63983ef8-f897-42e3-8ce1-e98b140c068e"],
Cell[6731, 144, 4399, 72, 159, "Input",ExpressionUUID->"b8969344-6c4a-4d7a-ab6d-a06897a8f903",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[11155, 220, 513, 8, 44, "Subsubsection",ExpressionUUID->"c89ec7d3-d73f-43c5-95ca-57910f194c67"],
Cell[11671, 230, 5972, 116, 364, "Input",ExpressionUUID->"3faf6cff-7644-4ee5-9937-80e2b6040262",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[17680, 351, 607, 9, 44, "Subsubsection",ExpressionUUID->"f8071461-1ca0-4b0f-af4c-46aaf800579b"],
Cell[18290, 362, 6814, 120, 197, "Input",ExpressionUUID->"59f1208d-c57e-477b-b856-980d0b577454",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[25141, 487, 708, 10, 44, "Subsubsection",ExpressionUUID->"58a67fb7-dc3d-4b40-9e85-fbfa5e32ed03"],
Cell[25852, 499, 4848, 79, 83, "Input",ExpressionUUID->"3a7d0bbf-eefc-40a0-98dd-094c28d6d717",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30749, 584, 30, 0, 67, "Section",ExpressionUUID->"0b8642e5-91b9-4306-964d-da71bdb1c411"],
Cell[30782, 586, 267, 6, 64, "Input",ExpressionUUID->"2143a952-ac86-44ce-80d6-af271244e104",
 InitializationCell->True]
}, Open  ]]
}
]
*)

