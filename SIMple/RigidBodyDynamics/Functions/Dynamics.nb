(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     43415,        892]
NotebookOptionsPosition[     40920,        820]
NotebookOutlinePosition[     41295,        836]
CellTagsIndexPosition[     41252,        833]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"PackageVariables", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
     "Lists", " ", "global", " ", "variables", " ", "used", " ", "by", " ", 
      "the", " ", "NLinks", " ", 
      RowBox[{"package", ".", "\n", "Copyright"}], " ", 
      RowBox[{"(", "C", ")"}], " ", "2014", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 
  3.6103712828520317`*^9}},ExpressionUUID->"96f1530e-e5b4-45ee-9451-\
2118fe68c73c"],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", 
  RowBox[{
  "\"\<RigidBodyDynamics`\>\"", ",", " ", "\"\<GlobalVariables`\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.592290865938843*^9, 3.592290866173859*^9}, {
   3.5923240589825273`*^9, 3.592324059334548*^9}, {3.7173717115807986`*^9, 
   3.7173717524874687`*^9}, {3.717371813519357*^9, 3.7173718485197163`*^9}, {
   3.7173718820200496`*^9, 3.7173719810054393`*^9}, {3.7173720131151433`*^9, 
   3.717372014130781*^9}, {3.717372051443678*^9, 3.717372076553296*^9}, {
   3.7173721748511963`*^9, 3.717372175273059*^9}, {3.717372217367241*^9, 
   3.7173722335861588`*^9}, {3.717372263852104*^9, 3.7173722969930687`*^9}, {
   3.7174059848678765`*^9, 3.7174059945554767`*^9}, {3.7175319731848936`*^9, 
   3.7175320114509125`*^9}, {3.7175523279823484`*^9, 3.717552328966734*^9}, 
   3.7188962179658127`*^9},ExpressionUUID->"751af5ad-8043-4517-b9ef-\
40132f72aa50"],

Cell[CellGroupData[{

Cell["Joint-space control input", "Subsubsection",
 CellChangeTimes->{{3.5933089835092435`*^9, 3.5933090010874166`*^9}, {
   3.593309056915639*^9, 3.5933090681969247`*^9}, {3.5933094424007688`*^9, 
   3.5933094456820354`*^9}, {3.593309899792288*^9, 3.5933099105579348`*^9}, {
   3.5933125775901875`*^9, 3.593312597199603*^9}, {3.6031518612218003`*^9, 
   3.6031519006930585`*^9}, 3.6033039255600357`*^9, {3.6153769130788374`*^9, 
   3.6153769238757343`*^9}, {3.6803430911219788`*^9, 
   3.6803430920601635`*^9}, {3.6803432373736687`*^9, 3.680343239100657*^9}, {
   3.6803480899991155`*^9, 3.680348109620889*^9}, 3.6808133941899033`*^9, {
   3.6808266160715117`*^9, 3.6808266199621735`*^9}, {3.681047128145233*^9, 
   3.681047139239089*^9}, {3.718111644045761*^9, 
   3.718111659170912*^9}},ExpressionUUID->"dd652110-436c-4b18-bf29-\
7999c37abc2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ufun", " ", "=", " ", 
   RowBox[{"zq", "&"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.680343116076213*^9, 3.680343117333536*^9}, {
   3.6803431544203987`*^9, 3.680343157042062*^9}, {3.6803431888096433`*^9, 
   3.680343189465274*^9}, {3.680343242879412*^9, 3.6803432452459536`*^9}, 
   3.6803436927580814`*^9, {3.6803467299571505`*^9, 3.680346765838033*^9}, {
   3.6803468609182315`*^9, 3.6803468622405457`*^9}, {3.6803471354591246`*^9, 
   3.6803471373261814`*^9}, {3.6803472301677027`*^9, 
   3.6803472319066257`*^9}, {3.6803481169297295`*^9, 3.680348117315014*^9}, {
   3.680349086312585*^9, 3.680349086539831*^9}, {3.680349800746522*^9, 
   3.6803498211654835`*^9}, {3.6803500174202323`*^9, 3.680350049319228*^9}, 
   3.6803502326442747`*^9, {3.680350277350572*^9, 3.680350277418611*^9}, {
   3.680350440574564*^9, 3.680350442118965*^9}, {3.6803589438329573`*^9, 
   3.680358957990719*^9}, {3.680381112510645*^9, 3.6803811452488794`*^9}, 
   3.680381919812785*^9, {3.6804303990155196`*^9, 3.68043044937348*^9}, {
   3.680430519254566*^9, 3.6804305594550533`*^9}, {3.6804377890543876`*^9, 
   3.6804378013155785`*^9}, {3.6804378771910295`*^9, 
   3.6804378807848206`*^9}, {3.680437911769655*^9, 3.680437944898512*^9}, {
   3.680437994796789*^9, 3.6804380875961533`*^9}, {3.6804381964865236`*^9, 
   3.6804381991816406`*^9}, {3.680438231916393*^9, 3.6804382626447473`*^9}, {
   3.680438845351944*^9, 3.6804388970917416`*^9}, {3.680439238745102*^9, 
   3.6804392401160216`*^9}, {3.680439932118587*^9, 3.680439932645955*^9}, {
   3.680439990045418*^9, 3.680440034870399*^9}, {3.680440204485181*^9, 
   3.680440272978504*^9}, {3.680440327089495*^9, 3.6804403349657044`*^9}, 
   3.6804404263282385`*^9, {3.68044114715638*^9, 3.6804411580314646`*^9}, 
   3.6804415488031893`*^9, {3.6804416254133883`*^9, 3.680441636314975*^9}, {
   3.680441700655346*^9, 3.6804417138344297`*^9}, {3.6804417903903713`*^9, 
   3.6804417933279047`*^9}, {3.680442016079856*^9, 3.6804420246620035`*^9}, {
   3.680442063319504*^9, 3.680442069844035*^9}, {3.68044212808074*^9, 
   3.6804421289463263`*^9}, {3.6804422907313566`*^9, 3.6804422926063786`*^9}, 
   3.6804425154605703`*^9, 3.68044296825439*^9, 3.680443208825221*^9, {
   3.6804437378925896`*^9, 3.6804437378925896`*^9}, {3.6804516549040127`*^9, 
   3.680451709663627*^9}, {3.6804517538041835`*^9, 3.6804517891815825`*^9}, {
   3.680451831780925*^9, 3.6804518366872306`*^9}, {3.6804518778754773`*^9, 
   3.680451885010442*^9}, {3.6804520268476377`*^9, 3.680452075820692*^9}, {
   3.680452305439218*^9, 3.6804523189647408`*^9}, {3.680452414395815*^9, 
   3.6804524287549176`*^9}, {3.680468858174943*^9, 3.6804688943542676`*^9}, {
   3.6804690851014423`*^9, 3.6804691172470016`*^9}, {3.680469166458989*^9, 
   3.680469168213783*^9}, {3.680469716012228*^9, 3.680469730443261*^9}, 
   3.680469783167206*^9, {3.6804701007599783`*^9, 3.6804701056348553`*^9}, {
   3.680470151432337*^9, 3.6804701546331334`*^9}, {3.6804730011872745`*^9, 
   3.68047305694178*^9}, 3.6804731104801097`*^9, {3.680473570595617*^9, 
   3.680473577605901*^9}, {3.6804839461629753`*^9, 3.6804839492733097`*^9}, {
   3.680484859196686*^9, 3.6804848614375896`*^9}, {3.680484918921301*^9, 
   3.6804849193553915`*^9}, {3.680492155381386*^9, 3.6804921862821827`*^9}, {
   3.68054269050568*^9, 3.680542700089585*^9}, {3.680542802476817*^9, 
   3.680542816750945*^9}, 3.6805428815253897`*^9, {3.680543356972186*^9, 
   3.6805433779329133`*^9}, {3.6805440167612257`*^9, 
   3.6805440387272844`*^9}, {3.6805443292745247`*^9, 3.680544342052143*^9}, 
   3.6805458269016075`*^9, {3.68054959775673*^9, 3.6805496129605265`*^9}, {
   3.6805497045683784`*^9, 3.6805497126491427`*^9}, {3.6805497782878075`*^9, 
   3.6805497983356433`*^9}, {3.680550084256939*^9, 3.680550092953209*^9}, {
   3.680550312684742*^9, 3.6805503291957054`*^9}, {3.6805504287692757`*^9, 
   3.6805504715195637`*^9}, {3.680550513098035*^9, 3.68055052595752*^9}, {
   3.6805507432130547`*^9, 3.680550753806611*^9}, {3.680550907466468*^9, 
   3.6805509094841924`*^9}, {3.6805510567020426`*^9, 3.680551065579381*^9}, {
   3.6805511522581964`*^9, 3.680551157234046*^9}, {3.680551298857839*^9, 
   3.680551340200565*^9}, 3.6805514074195457`*^9, {3.6805533485936747`*^9, 
   3.6805533844906497`*^9}, {3.6805535237750793`*^9, 3.680553603013539*^9}, {
   3.680646433076372*^9, 3.680646444738082*^9}, {3.680648938297825*^9, 
   3.6806489386358857`*^9}, {3.680657404327191*^9, 3.6806574137059135`*^9}, {
   3.6806574457687864`*^9, 3.6806574543701577`*^9}, {3.6806575403701935`*^9, 
   3.6806575522502174`*^9}, {3.6806580449389014`*^9, 3.680658050346503*^9}, {
   3.6807485970753317`*^9, 3.6807486022159996`*^9}, {3.6807486433355393`*^9, 
   3.680748644100243*^9}, {3.6807488928805637`*^9, 3.680748893130566*^9}, {
   3.6807494934611187`*^9, 3.680749493994174*^9}, {3.680749645835928*^9, 
   3.680749646370681*^9}, {3.6807509250948267`*^9, 3.680750948061112*^9}, {
   3.6807914064476385`*^9, 3.6807914429925833`*^9}, {3.680791490890425*^9, 
   3.680791491243702*^9}, {3.680791550247636*^9, 3.6807915524789815`*^9}, {
   3.680791646459034*^9, 3.680791675282999*^9}, {3.680791717020008*^9, 
   3.680791749455398*^9}, {3.6807929575335293`*^9, 3.6807929630640745`*^9}, {
   3.680793015240152*^9, 3.680793113925267*^9}, {3.6807933008502197`*^9, 
   3.680793307938409*^9}, 3.680812477808548*^9, {3.6808262345082874`*^9, 
   3.6808262493052826`*^9}, {3.6808269420804496`*^9, 3.680826950330519*^9}, 
   3.680959415160469*^9, {3.6809730878983364`*^9, 3.680973102070058*^9}, {
   3.6810471121607094`*^9, 3.6810471127857146`*^9}, {3.6915345173027906`*^9, 
   3.6915345358443823`*^9}, {3.6915353524107203`*^9, 3.691535357186364*^9}, 
   3.691541327854374*^9, {3.7009134762509136`*^9, 3.7009134852867165`*^9}, {
   3.700913642646663*^9, 3.7009137042808857`*^9}, 3.7009140774995236`*^9, {
   3.7174102424284143`*^9, 3.717410242881545*^9}, {3.71741027461623*^9, 
   3.717410304007167*^9}, {3.7175307523724475`*^9, 3.7175307525443144`*^9}, {
   3.7175308623266907`*^9, 3.7175308944520206`*^9}, {3.7175309461088*^9, 
   3.7175309803747773`*^9}, {3.7175310330315657`*^9, 3.717531241406105*^9}, {
   3.717531516820836*^9, 3.717531519445863*^9}, {3.717531554977476*^9, 
   3.7175315560712504`*^9}, {3.7175330358758717`*^9, 
   3.7175330528760443`*^9}, {3.7175332284715977`*^9, 
   3.7175332305028687`*^9}, {3.717702043018608*^9, 3.7177020671594696`*^9}, {
   3.7177356743243217`*^9, 3.7177356780118475`*^9}, {3.7181113700899467`*^9, 
   3.7181113712774525`*^9}, {3.718111548029189*^9, 3.718111548435458*^9}, {
   3.7181115916233845`*^9, 3.718111592092123*^9}, {3.7181116613897004`*^9, 
   3.7181116636709557`*^9}},ExpressionUUID->"58b75736-0c03-4621-b793-\
431993007c5d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Joint-space internal forces, mass matrix, and accelerations", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.591667897763588*^9, 3.591667900579752*^9}, {3.603136879308838*^9, 
   3.6031368796018543`*^9}, {3.6031476530248113`*^9, 3.6031476619223156`*^9}, 
   3.60314781540911*^9, {3.6031478657479925`*^9, 3.6031478688131695`*^9}, {
   3.7177376939973016`*^9, 
   3.7177377164037704`*^9}},ExpressionUUID->"6dc462a8-e942-4d1b-a99f-\
4f9416804dc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RBDb", "[", 
     RowBox[{
      RowBox[{"x_:", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\[Lambda]_:", 
       RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", " ", "===", " ", 
           RowBox[{"{", "}"}]}], ",", " ", 
          RowBox[{"Array", "[", 
           RowBox[{"\[DoubleStruckX]", ",", " ", "nq", ",", " ", 
            RowBox[{"nq", "+", "1"}]}], "]"}], ",", " ", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"nq", "+", "1"}], ";;", "nx"}], 
           "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qdd", " ", "=", " ", "zq"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ag", " ", "=", " ", 
        RowBox[{"agfun", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"sfun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sdot", " ", "=", " ", 
        RowBox[{"sdotfun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"XL", " ", "=", " ", 
        RowBox[{"XLfun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
        RowBox[{"\[DoubleStruckCapitalI]fun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RNEA", "[", "]"}], ";", "\[IndentingNewLine]", "uJ"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RBDM", "[", 
     RowBox[{
      RowBox[{"x_:", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\[Lambda]_:", 
       RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"sfun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"XL", " ", "=", " ", 
        RowBox[{"XLfun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
        RowBox[{"\[DoubleStruckCapitalI]fun", "[", 
         RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CRB", "[", "]"}], ";", "\[IndentingNewLine]", "M"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RBDqdd", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"qd", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Array", "[", 
          RowBox[{"\[DoubleStruckX]", ",", " ", "nq", ",", " ", 
           RowBox[{"nq", "+", "1"}]}], "]"}], ",", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"nq", "+", "1"}], ";;", "nx"}], 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ag", " ", "=", " ", 
       RowBox[{"agfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"sfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sdot", " ", "=", " ", 
       RowBox[{"sdotfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"XL", " ", "=", " ", 
       RowBox[{"XLfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
       RowBox[{"\[DoubleStruckCapitalI]fun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"ufun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ABA", "[", "]"}], ";", "\[IndentingNewLine]", "qdd"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717734306938265*^9, 3.7177343202040052`*^9}, {
   3.7177344335332055`*^9, 3.7177344338769712`*^9}, {3.7177345995808315`*^9, 
   3.717734618799753*^9}, 3.7177346575813684`*^9, 3.717734750644767*^9, {
   3.7177352686485825`*^9, 3.717735279070573*^9}, {3.7177354505878105`*^9, 
   3.717735461994169*^9}, {3.7177354971195145`*^9, 3.717735508275875*^9}, {
   3.7177355511981583`*^9, 3.717735555416934*^9}, {3.717735594214176*^9, 
   3.717735602933009*^9}, {3.717735663777335*^9, 3.717735664308609*^9}, {
   3.7177359537332335`*^9, 3.7177359569988737`*^9}, {3.717736694552757*^9, 
   3.7177367186623635`*^9}, {3.7177369186798873`*^9, 
   3.7177369280237427`*^9}, {3.717736976836692*^9, 3.717736987946187*^9}, 
   3.7177374207875147`*^9, {3.7178019327630744`*^9, 3.717801945528838*^9}, {
   3.717801992123026*^9, 3.7178019981387124`*^9}, {3.7178020343577895`*^9, 
   3.717802035389067*^9}, {3.717802141686947*^9, 3.717802169280947*^9}, {
   3.717802207750079*^9, 3.717802278297621*^9}, {3.717804263347122*^9, 
   3.7178042915661564`*^9}, {3.717804327394605*^9, 3.71780434414478*^9}, {
   3.7178045881627254`*^9, 3.7178045928346276`*^9}, {3.7178046933981004`*^9, 
   3.717804725476513*^9}, {3.7178047990866003`*^9, 3.7178048006178694`*^9}, {
   3.7178048579187627`*^9, 3.71780486024691*^9}, {3.717804981013683*^9, 
   3.7178050200453033`*^9}, {3.7178051245889797`*^9, 3.717805124901495*^9}, {
   3.7178061802084026`*^9, 3.717806182427177*^9}, {3.7178125439477654`*^9, 
   3.717812556994751*^9}, {3.7178138357569127`*^9, 3.717813837663181*^9}, {
   3.717815080799999*^9, 3.717815122956656*^9}, {3.717815154816311*^9, 
   3.7178153246460667`*^9}, {3.7178452012979393`*^9, 
   3.7178452027042017`*^9}, {3.7178497276761093`*^9, 3.717849777692194*^9}, {
   3.7178516846165676`*^9, 3.7178516904916215`*^9}, {3.7178517648829703`*^9, 
   3.717851772726779*^9}, {3.7178518605713625`*^9, 3.7178518707277117`*^9}, {
   3.717857577891321*^9, 3.7178575840945225`*^9}, {3.717858822328656*^9, 
   3.717858888860524*^9}, {3.7178589208920774`*^9, 3.7178589521111355`*^9}, {
   3.717859328911581*^9, 3.717859335036637*^9}, {3.7178597309466515`*^9, 
   3.7178597379623537`*^9}, {3.7178653678093576`*^9, 3.717865380543866*^9}, {
   3.7178699960928*^9, 3.7178699988115788`*^9}, {3.718222197398473*^9, 
   3.718222232476942*^9}, 3.718629090089304*^9, {3.7219941251798077`*^9, 
   3.7219941258673162`*^9}, {3.722082966439998*^9, 
   3.7220829702525373`*^9}},ExpressionUUID->"5a38ccfd-5f97-4e92-9776-\
ff5b5ffc3429"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraints", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.591667897763588*^9, 3.591667900579752*^9}, {3.603136879308838*^9, 
   3.6031368796018543`*^9}, {3.6031476530248113`*^9, 3.6031476619223156`*^9}, 
   3.60314781540911*^9, {3.6031478657479925`*^9, 3.6031478688131695`*^9}, {
   3.7177376939973016`*^9, 3.7177377164037704`*^9}, {3.7186290993393965`*^9, 
   3.718629100776925*^9}},ExpressionUUID->"5ddc6e2a-97d9-4e40-92c4-\
9ed438cda79f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RBDJ", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "vJ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"sfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sdot", " ", "=", " ", 
       RowBox[{"sdotfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"XL", " ", "=", " ", 
       RowBox[{"XLfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"rfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rdot", " ", "=", " ", 
       RowBox[{"rdotfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Tcb", " ", "=", " ", 
       RowBox[{"Tcbfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"J", " ", "=", " ", 
       RowBox[{"Jfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", " ", "=", " ", 
       RowBox[{"\[Phi]fun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", " ", "=", " ", 
       RowBox[{"\[Eta]fun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"K", " ", "=", " ", 
       RowBox[{"Kfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"bo", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<bo\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ba", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<ba\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bs", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<bs\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bx", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<bx\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"for", " ", "computing", " ", "Xdot"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"qd", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Array", "[", 
          RowBox[{"\[DoubleStruckX]", ",", " ", "nq", ",", " ", 
           RowBox[{"nq", "+", "1"}]}], "]"}], ",", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"nq", "+", "1"}], ";;", "nx"}], 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"V", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"X0", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"rs0", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"JOSIM", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"J", ",", " ", "\[Phi]"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717734306938265*^9, 3.7177343202040052`*^9}, {
   3.7177344335332055`*^9, 3.7177344338769712`*^9}, {3.7177345995808315`*^9, 
   3.717734618799753*^9}, 3.7177346575813684`*^9, 3.717734750644767*^9, {
   3.7177352686485825`*^9, 3.717735279070573*^9}, {3.7177354505878105`*^9, 
   3.717735461994169*^9}, {3.7177354971195145`*^9, 3.717735508275875*^9}, {
   3.7177355511981583`*^9, 3.717735555416934*^9}, {3.717735594214176*^9, 
   3.717735602933009*^9}, {3.717735663777335*^9, 3.717735664308609*^9}, {
   3.7177359537332335`*^9, 3.7177359569988737`*^9}, {3.717736694552757*^9, 
   3.7177367186623635`*^9}, {3.7177369186798873`*^9, 
   3.7177369280237427`*^9}, {3.717736976836692*^9, 3.717736987946187*^9}, 
   3.7177374207875147`*^9, {3.7178019327630744`*^9, 3.717801945528838*^9}, {
   3.717801992123026*^9, 3.7178019981387124`*^9}, {3.7178020343577895`*^9, 
   3.717802035389067*^9}, {3.717802141686947*^9, 3.717802169280947*^9}, {
   3.717802207750079*^9, 3.717802278297621*^9}, {3.717804263347122*^9, 
   3.7178042915661564`*^9}, {3.717804327394605*^9, 3.71780434414478*^9}, {
   3.7178045881627254`*^9, 3.7178045928346276`*^9}, {3.7178046933981004`*^9, 
   3.717804725476513*^9}, {3.7178047990866003`*^9, 3.7178048006178694`*^9}, {
   3.7178048579187627`*^9, 3.71780486024691*^9}, {3.717804981013683*^9, 
   3.7178050200453033`*^9}, {3.7178051245889797`*^9, 3.717805124901495*^9}, {
   3.7178061802084026`*^9, 3.717806182427177*^9}, {3.7178125439477654`*^9, 
   3.717812556994751*^9}, {3.7178138357569127`*^9, 3.717813837663181*^9}, {
   3.717815080799999*^9, 3.717815122956656*^9}, {3.717815154816311*^9, 
   3.7178153246460667`*^9}, {3.7178452012979393`*^9, 
   3.7178452027042017`*^9}, {3.7178497276761093`*^9, 3.717849777692194*^9}, {
   3.7178516846165676`*^9, 3.7178516904916215`*^9}, {3.7178517648829703`*^9, 
   3.717851772726779*^9}, {3.7178518605713625`*^9, 3.7178518707277117`*^9}, {
   3.717857577891321*^9, 3.7178575840945225`*^9}, {3.717858822328656*^9, 
   3.717858888860524*^9}, {3.7178589208920774`*^9, 3.7178589521111355`*^9}, {
   3.717859328911581*^9, 3.717859335036637*^9}, {3.7178597309466515`*^9, 
   3.7178597379623537`*^9}, {3.7178653678093576`*^9, 3.717865380543866*^9}, {
   3.7178699960928*^9, 3.7178699988115788`*^9}, {3.718222197398473*^9, 
   3.718222232476942*^9}, 3.718629090089304*^9, {3.719085511288026*^9, 
   3.7190855477727766`*^9}},ExpressionUUID->"c72de08d-3c39-4afd-8ec7-\
acdc54bfd256"]
}, Open  ]],

Cell[CellGroupData[{

Cell["EOM", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.591667897763588*^9, 3.591667900579752*^9}, {3.603136879308838*^9, 
   3.6031368796018543`*^9}, {3.6031476530248113`*^9, 3.6031476619223156`*^9}, 
   3.60314781540911*^9, {3.6031478657479925`*^9, 3.6031478688131695`*^9}, {
   3.7177376939973016`*^9, 3.7177377164037704`*^9}, {3.7186290993393965`*^9, 
   3.7186291084801273`*^9}},ExpressionUUID->"9751e969-a689-4d75-9f28-\
e41b1ed7d916"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RBDEOM", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "vJ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pcons", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<p\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vcons", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<v\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ucons", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<u\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"u", " ", "=", " ", 
       RowBox[{"ufun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RBDM", "[", 
       RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RBDb", "[", 
       RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RBDJ", "[", 
       RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"EOM", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "Ab"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717734306938265*^9, 3.7177343202040052`*^9}, {
   3.7177344335332055`*^9, 3.7177344338769712`*^9}, {3.7177345995808315`*^9, 
   3.717734618799753*^9}, 3.7177346575813684`*^9, 3.717734750644767*^9, {
   3.7177352686485825`*^9, 3.717735279070573*^9}, {3.7177354505878105`*^9, 
   3.717735461994169*^9}, {3.7177354971195145`*^9, 3.717735508275875*^9}, {
   3.7177355511981583`*^9, 3.717735555416934*^9}, {3.717735594214176*^9, 
   3.717735602933009*^9}, {3.717735663777335*^9, 3.717735664308609*^9}, {
   3.7177359537332335`*^9, 3.7177359569988737`*^9}, {3.717736694552757*^9, 
   3.7177367186623635`*^9}, {3.7177369186798873`*^9, 
   3.7177369280237427`*^9}, {3.717736976836692*^9, 3.717736987946187*^9}, 
   3.7177374207875147`*^9, {3.7178019327630744`*^9, 3.717801945528838*^9}, {
   3.717801992123026*^9, 3.7178019981387124`*^9}, {3.7178020343577895`*^9, 
   3.717802035389067*^9}, {3.717802141686947*^9, 3.717802169280947*^9}, {
   3.717802207750079*^9, 3.717802278297621*^9}, {3.717804263347122*^9, 
   3.7178042915661564`*^9}, {3.717804327394605*^9, 3.71780434414478*^9}, {
   3.7178045881627254`*^9, 3.7178045928346276`*^9}, {3.7178046933981004`*^9, 
   3.717804725476513*^9}, {3.7178047990866003`*^9, 3.7178048006178694`*^9}, {
   3.7178048579187627`*^9, 3.71780486024691*^9}, {3.717804981013683*^9, 
   3.7178050200453033`*^9}, {3.7178051245889797`*^9, 3.717805124901495*^9}, {
   3.7178061802084026`*^9, 3.717806182427177*^9}, {3.7178125439477654`*^9, 
   3.717812556994751*^9}, {3.7178138357569127`*^9, 3.717813837663181*^9}, {
   3.717815080799999*^9, 3.717815122956656*^9}, {3.717815154816311*^9, 
   3.7178153246460667`*^9}, {3.7178452012979393`*^9, 
   3.7178452027042017`*^9}, {3.7178497276761093`*^9, 3.717849777692194*^9}, {
   3.7178516846165676`*^9, 3.7178516904916215`*^9}, {3.7178517648829703`*^9, 
   3.717851772726779*^9}, {3.7178518605713625`*^9, 3.7178518707277117`*^9}, {
   3.717857577891321*^9, 3.7178575840945225`*^9}, {3.717858822328656*^9, 
   3.717858888860524*^9}, {3.7178589208920774`*^9, 3.7178589521111355`*^9}, {
   3.717859328911581*^9, 3.717859335036637*^9}, {3.7178597309466515`*^9, 
   3.7178597379623537`*^9}, {3.7178653678093576`*^9, 3.717865380543866*^9}, {
   3.7178699960928*^9, 3.7178699988115788`*^9}, {3.718222197398473*^9, 
   3.718222232476942*^9}, 3.718629090089304*^9, {3.7186291459648576`*^9, 
   3.7186291473398814`*^9}, {3.7186291779651737`*^9, 
   3.7186292234500127`*^9}, {3.7186293198415756`*^9, 
   3.7186293283572845`*^9}, {3.718629415030015*^9, 3.71862942304572*^9}, {
   3.718629456108548*^9, 3.718629465264903*^9}, {3.718629596203698*^9, 
   3.718629616922635*^9}, {3.7186296558136444`*^9, 3.718629656298024*^9}, {
   3.718629831410738*^9, 3.7186298327388887`*^9}, {3.7186345036338534`*^9, 
   3.7186345446030064`*^9}, {3.7186345837127705`*^9, 
   3.7186346111349316`*^9}, {3.718634705198346*^9, 3.7186347052452226`*^9}, 
   3.7186366994168143`*^9, 3.718636731573381*^9, 3.7188317973798385`*^9, {
   3.7188331705512776`*^9, 3.7188331706919036`*^9}, {3.7188339250725193`*^9, 
   3.718833942572692*^9}, {3.718834017839073*^9, 3.718834024073498*^9}, {
   3.718834188012619*^9, 3.718834199043994*^9}, {3.718834376639495*^9, 
   3.718834459280925*^9}, {3.7188346692176*^9, 3.7188346873427625`*^9}, {
   3.7188353281928463`*^9, 3.7188353317241306`*^9}, {3.719586983266153*^9, 
   3.71958700878199*^9}},ExpressionUUID->"f56ecd26-51ad-444d-bd19-\
b4f83a0ce104"]
}, Open  ]],

Cell[CellGroupData[{

Cell["IME", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.591667897763588*^9, 3.591667900579752*^9}, {3.603136879308838*^9, 
   3.6031368796018543`*^9}, {3.6031476530248113`*^9, 3.6031476619223156`*^9}, 
   3.60314781540911*^9, {3.6031478657479925`*^9, 3.6031478688131695`*^9}, {
   3.7177376939973016`*^9, 3.7177377164037704`*^9}, {3.7186290993393965`*^9, 
   3.7186291084801273`*^9}, {3.7195869163437138`*^9, 
   3.71958691654683*^9}},ExpressionUUID->"bfe80e46-fa36-4d54-90c9-\
a0136531a977"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RBDIME", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "vJ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pcons", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<p\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vcons", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<v\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ucons", " ", "=", " ", 
       RowBox[{"rb", "[", 
        RowBox[{"C", ",", " ", "\"\<u\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RBDM", "[", 
       RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RBDJ", "[", 
       RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IME", "[", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "Ab"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717734306938265*^9, 3.7177343202040052`*^9}, {
   3.7177344335332055`*^9, 3.7177344338769712`*^9}, {3.7177345995808315`*^9, 
   3.717734618799753*^9}, 3.7177346575813684`*^9, 3.717734750644767*^9, {
   3.7177352686485825`*^9, 3.717735279070573*^9}, {3.7177354505878105`*^9, 
   3.717735461994169*^9}, {3.7177354971195145`*^9, 3.717735508275875*^9}, {
   3.7177355511981583`*^9, 3.717735555416934*^9}, {3.717735594214176*^9, 
   3.717735602933009*^9}, {3.717735663777335*^9, 3.717735664308609*^9}, {
   3.7177359537332335`*^9, 3.7177359569988737`*^9}, {3.717736694552757*^9, 
   3.7177367186623635`*^9}, {3.7177369186798873`*^9, 
   3.7177369280237427`*^9}, {3.717736976836692*^9, 3.717736987946187*^9}, 
   3.7177374207875147`*^9, {3.7178019327630744`*^9, 3.717801945528838*^9}, {
   3.717801992123026*^9, 3.7178019981387124`*^9}, {3.7178020343577895`*^9, 
   3.717802035389067*^9}, {3.717802141686947*^9, 3.717802169280947*^9}, {
   3.717802207750079*^9, 3.717802278297621*^9}, {3.717804263347122*^9, 
   3.7178042915661564`*^9}, {3.717804327394605*^9, 3.71780434414478*^9}, {
   3.7178045881627254`*^9, 3.7178045928346276`*^9}, {3.7178046933981004`*^9, 
   3.717804725476513*^9}, {3.7178047990866003`*^9, 3.7178048006178694`*^9}, {
   3.7178048579187627`*^9, 3.71780486024691*^9}, {3.717804981013683*^9, 
   3.7178050200453033`*^9}, {3.7178051245889797`*^9, 3.717805124901495*^9}, {
   3.7178061802084026`*^9, 3.717806182427177*^9}, {3.7178125439477654`*^9, 
   3.717812556994751*^9}, {3.7178138357569127`*^9, 3.717813837663181*^9}, {
   3.717815080799999*^9, 3.717815122956656*^9}, {3.717815154816311*^9, 
   3.7178153246460667`*^9}, {3.7178452012979393`*^9, 
   3.7178452027042017`*^9}, {3.7178497276761093`*^9, 3.717849777692194*^9}, {
   3.7178516846165676`*^9, 3.7178516904916215`*^9}, {3.7178517648829703`*^9, 
   3.717851772726779*^9}, {3.7178518605713625`*^9, 3.7178518707277117`*^9}, {
   3.717857577891321*^9, 3.7178575840945225`*^9}, {3.717858822328656*^9, 
   3.717858888860524*^9}, {3.7178589208920774`*^9, 3.7178589521111355`*^9}, {
   3.717859328911581*^9, 3.717859335036637*^9}, {3.7178597309466515`*^9, 
   3.7178597379623537`*^9}, {3.7178653678093576`*^9, 3.717865380543866*^9}, {
   3.7178699960928*^9, 3.7178699988115788`*^9}, {3.718222197398473*^9, 
   3.718222232476942*^9}, 3.718629090089304*^9, {3.7186291459648576`*^9, 
   3.7186291473398814`*^9}, {3.7186291779651737`*^9, 
   3.7186292234500127`*^9}, {3.7186293198415756`*^9, 
   3.7186293283572845`*^9}, {3.718629415030015*^9, 3.71862942304572*^9}, {
   3.718629456108548*^9, 3.718629465264903*^9}, {3.718629596203698*^9, 
   3.718629616922635*^9}, {3.7186296558136444`*^9, 3.718629656298024*^9}, {
   3.718629831410738*^9, 3.7186298327388887`*^9}, {3.7186345036338534`*^9, 
   3.7186345446030064`*^9}, {3.7186345837127705`*^9, 
   3.7186346111349316`*^9}, {3.718634705198346*^9, 3.7186347052452226`*^9}, 
   3.7186366994168143`*^9, 3.718636731573381*^9, 3.7188317973798385`*^9, {
   3.7188331705512776`*^9, 3.7188331706919036`*^9}, {3.7188339250725193`*^9, 
   3.718833942572692*^9}, {3.718834017839073*^9, 3.718834024073498*^9}, {
   3.718834188012619*^9, 3.718834199043994*^9}, {3.718834376639495*^9, 
   3.718834459280925*^9}, {3.7188346692176*^9, 3.7188346873427625`*^9}, {
   3.7188353281928463`*^9, 3.7188353317241306`*^9}, {3.719586921328127*^9, 
   3.7195869442189517`*^9}, {3.7195870167039323`*^9, 
   3.7195870291415195`*^9}, {3.71958706893874*^9, 
   3.7195870694699836`*^9}},ExpressionUUID->"1c5b382b-6042-414b-b196-\
e20f21e03422"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mechanical Quantities", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.591667897763588*^9, 3.591667900579752*^9}, {3.603136879308838*^9, 
   3.6031368796018543`*^9}, {3.6031476530248113`*^9, 3.6031476619223156`*^9}, 
   3.60314781540911*^9, {3.6031478657479925`*^9, 3.6031478688131695`*^9}, {
   3.7177376939973016`*^9, 3.7177377164037704`*^9}, {3.7186290993393965`*^9, 
   3.7186291084801273`*^9}, {3.7195869163437138`*^9, 3.71958691654683*^9}, {
   3.7219939385186944`*^9, 
   3.7219939415030856`*^9}},ExpressionUUID->"19e89bd0-de20-4101-b8d8-\
228abfe4c081"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RBDMQ", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "vJ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"qd", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Array", "[", 
          RowBox[{"\[DoubleStruckX]", ",", " ", "nq", ",", " ", 
           RowBox[{"nq", "+", "1"}]}], "]"}], ",", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"nq", "+", "1"}], ";;", "nx"}], 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qdd", " ", "=", " ", "zq"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ag", " ", "=", " ", 
       RowBox[{"agfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"sfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"XL", " ", "=", " ", 
       RowBox[{"XLfun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[DoubleStruckCapitalI]", " ", "=", " ", 
       RowBox[{"\[DoubleStruckCapitalI]fun", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RBDMechanicalQuantities", "[", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.721993954803059*^9, 3.72199396780321*^9}, 
   3.721994007881731*^9, {3.721994119007882*^9, 3.7219941492894316`*^9}, {
   3.721994254962406*^9, 3.721994259243701*^9}, 3.7219949691849594`*^9, {
   3.7220828931267858`*^9, 3.722082896517461*^9}, {3.7220829310802984`*^9, 
   3.722082937267875*^9}},ExpressionUUID->"672996be-39c2-4fd6-a683-\
957bc5cdf7da"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",ExpressionUUID->"bd416742-0fca-4abf-9e40-9469cd9c9781"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.59227983916838*^9, 3.592279842929595*^9}, {
  3.5922799781203375`*^9, 
  3.5922799926971717`*^9}},ExpressionUUID->"7428c663-54a3-4c9a-9c81-\
d2aa40d23b12"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718, 718},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2703, 55, 285, "Code", "ExpressionUUID" -> \
"96f1530e-e5b4-45ee-9451-2118fe68c73c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3285, 79, 100, 1, 70, "Section", "ExpressionUUID" -> \
"09f8a0d7-89c9-43a0-8b39-721e60c15083"],
Cell[3388, 82, 1016, 17, 66, "Input", "ExpressionUUID" -> \
"751af5ad-8043-4517-b9ef-40132f72aa50",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4429, 103, 847, 12, 39, "Subsubsection", "ExpressionUUID" -> \
"dd652110-436c-4b18-bf29-7999c37abc2a"],
Cell[5279, 117, 6763, 94, 46, "Input", "ExpressionUUID" -> \
"58b75736-0c03-4621-b793-431993007c5d",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12091, 217, 488, 7, 70, "Section", "ExpressionUUID" -> \
"6dc462a8-e942-4d1b-a99f-4f9416804dc0"],
Cell[12582, 226, 7460, 163, 655, "Input", "ExpressionUUID" -> \
"5a38ccfd-5f97-4e92-9776-ff5b5ffc3429",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20079, 394, 488, 7, 70, "Section", "ExpressionUUID" -> \
"5ddc6e2a-97d9-4e40-92c4-9ed438cda79f"],
Cell[20570, 403, 6159, 127, 541, "Input", "ExpressionUUID" -> \
"c72de08d-3c39-4afd-8ec7-acdc54bfd256",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26766, 535, 482, 7, 70, "Section", "ExpressionUUID" -> \
"9751e969-a689-4d75-9f28-e41b1ed7d916"],
Cell[27251, 544, 4979, 90, 275, "Input", "ExpressionUUID" -> \
"f56ecd26-51ad-444d-bd19-b4f83a0ce104",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[32267, 639, 533, 8, 70, "Section", "ExpressionUUID" -> \
"bfe80e46-fa36-4d54-90c9-a0136531a977"],
Cell[32803, 649, 4816, 85, 237, "Input", "ExpressionUUID" -> \
"1c5b382b-6042-414b-b196-e20f21e03422",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[37656, 739, 605, 9, 70, "Section", "ExpressionUUID" -> \
"19e89bd0-de20-4101-b8d8-228abfe4c081"],
Cell[38264, 750, 2180, 52, 237, "Input", "ExpressionUUID" -> \
"672996be-39c2-4fd6-a683-957bc5cdf7da",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[40481, 807, 85, 0, 70, "Section", "ExpressionUUID" -> \
"bd416742-0fca-4abf-9e40-9469cd9c9781"],
Cell[40569, 809, 335, 8, 66, "Input", "ExpressionUUID" -> \
"7428c663-54a3-4c9a-9c81-d2aa40d23b12",
 InitializationCell->True]
}, Open  ]]
}
]
*)

