(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32283,        673]
NotebookOptionsPosition[     29923,        619]
NotebookOutlinePosition[     30290,        635]
CellTagsIndexPosition[     30247,        632]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"RigidBodyDerivatives", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{"High", "-", 
      RowBox[{
      "level", " ", "functions", " ", "used", " ", "to", " ", "define", " ", 
       "a", " ", "rigid", " ", 
       RowBox[{"body", ".", "\n", "Copyright"}], " ", 
       RowBox[{"(", "C", ")"}], " ", "2016", " ", "Nelson", " ", "Rosa", " ", 
       RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", 
       " ", "free", " ", "software"}]}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103714917959795`*^9, 3.6103715279410496`*^9}, {
  3.6901267523786774`*^9, 
  3.6901267578419495`*^9}},ExpressionUUID->"52f316c7-725b-4e45-b7db-\
0035f85949f4"],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 
  3.591487004222381*^9}},ExpressionUUID->"31be24c8-e8f8-4e51-8834-\
5d8368d76333"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Derivatives`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixCommonFunctions", "::", "usage"}], " ", "=", " ", 
    "\"\<\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717345257519829*^9, 3.7173453005358953`*^9}, {
   3.7173454177921476`*^9, 3.717345419417161*^9}, {3.717346295966098*^9, 
   3.7173463089974813`*^9}, 3.717346349779165*^9, {3.71771906625355*^9, 
   3.717719071722337*^9}, {3.717741470648205*^9, 3.7177414956796913`*^9}, {
   3.7177418236203084`*^9, 3.7177418380110703`*^9}, {3.717741906902362*^9, 
   3.717741910043021*^9}, {3.717742053685007*^9, 
   3.7177420611538324`*^9}},ExpressionUUID->"dec9cbe4-7c51-49a2-9755-\
5fa8d65169bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Post processing", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 
  3.6807923571497283`*^9}},ExpressionUUID->"fbfb90e8-04a5-409e-a7dc-\
53e518fe074e"],

Cell["\<\
The routines in DifferentiateFunction takes in inputs and outputs that lead \
to undesirable results.  For example, LinearSolve becomes dLinearSolve.  To \
further complicate issues, derivatives inside a LinearSolve have a specific \
form that DifferentiateFunction cannot be expected to know about.  Hence, the \
following post processing functions.  Post processing usually works in three \
steps:

1) Add a specific TransformExpression function that knows how to \
differentiate the new method, like LinearSolve.  A workaround to avoid \
differentiating methods is to replace the symbol with a string version of the \
method.  The convention used converts a symbol Method to the string \
\[OpenCurlyDoubleQuote]***Method***\[CloseCurlyDoubleQuote].

2) Add a CreateSymbol for symbolically representing the expression.  Care has \
to be taken that variables are kept in their unevaluated state.  Keep in mind \
that Part and Transpose are considered regular symbols and do not evaluate as \
expected.

3) Fix the differentiated function by replacing the string version of the \
method name with the symbolic form of the method name.  Fix-style functions \
may also perform extra computations as needed.\
\>", "Text",
 CellChangeTimes->{{3.6901276838739614`*^9, 3.69012777405702*^9}, {
  3.6901278478242683`*^9, 3.6901282667236605`*^9}, {3.6901282973038006`*^9, 
  3.690128339329451*^9}},ExpressionUUID->"26cdc679-1a13-48c4-ae65-\
1e905680834d"],

Cell[CellGroupData[{

Cell["Wrapper Function for common Fixes", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 3.6812140182421093`*^9}, {3.7177419876062546`*^9, 
  3.7177419981219664`*^9}},ExpressionUUID->"dc0317e1-4e88-4f8e-950b-\
15bc74d9266e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"common", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "FixFunctionsWithLinearSolve", ",", " ", "FixFunctionsWithLeastSquares", 
      ",", " ", "FixFunctionsWithOuter", ",", " ", "FixFunctionsWithJoin"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FixCommonFunctions", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#2", "[", "#1", "]"}], "&"}], ",", " ", "expr", ",", " ", 
     "common"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.6807505175450974`*^9, 3.6807505182146254`*^9}, {3.680750750540885*^9, 
   3.680750889755329*^9}, {3.6807512749702587`*^9, 3.680751347384269*^9}, {
   3.68075140250815*^9, 3.68075140282065*^9}, {3.6807514492622814`*^9, 
   3.6807515045940065`*^9}, {3.6807911430954466`*^9, 3.680791143389366*^9}, {
   3.680792308407544*^9, 3.6807923086940536`*^9}, {3.6807941775847745`*^9, 
   3.6807941778969946`*^9}, {3.681085448625431*^9, 3.6810854497916684`*^9}, {
   3.6811252503958178`*^9, 3.681125269259572*^9}, {3.681127071295232*^9, 
   3.681127102989649*^9}, {3.6811273431333065`*^9, 3.681127351836822*^9}, {
   3.69002849477006*^9, 3.6900284969071207`*^9}, {3.690028972793089*^9, 
   3.6900290169186945`*^9}, 3.690029148663006*^9, {3.690029187189972*^9, 
   3.6900291925629*^9}, {3.690029278545068*^9, 3.690029284995552*^9}, 
   3.690029378305349*^9, {3.690029439712564*^9, 3.690029441887326*^9}, {
   3.6900295413260174`*^9, 3.69002956583889*^9}, {3.6900299725790024`*^9, 
   3.6900299785523343`*^9}, {3.6900300323882575`*^9, 3.690030053380579*^9}, {
   3.6900319644361753`*^9, 3.690032025485417*^9}, {3.6900321300580645`*^9, 
   3.6900321380981913`*^9}, {3.6900322054491596`*^9, 3.6900322359952774`*^9}, 
   3.690032279519027*^9, {3.690033656812835*^9, 3.690033722011158*^9}, {
   3.6900338228192387`*^9, 3.690033843328258*^9}, {3.690127221904132*^9, 
   3.6901272226385717`*^9}, {3.717740823845194*^9, 3.7177408485173044`*^9}, {
   3.7177418896834373`*^9, 3.7177418903397045`*^9}, {3.717742005747055*^9, 
   3.717742140701459*^9}, {3.7177422232803726`*^9, 3.7177422238272533`*^9}, {
   3.7177442635653877`*^9, 3.7177442641278934`*^9}, {3.717744407473005*^9, 
   3.7177444183324795`*^9}, {3.7177445428024116`*^9, 
   3.7177445435992985`*^9}, {3.7177450004473863`*^9, 
   3.7177450010411463`*^9}, {3.717757523572733*^9, 3.7177575278071356`*^9}, {
   3.717758002921035*^9, 3.717758005467939*^9}, {3.717758035702602*^9, 
   3.7177581350629168`*^9}, {3.7177585488864994`*^9, 3.717758580043049*^9}, {
   3.7179031250277834`*^9, 3.71790312580904*^9}, {3.717907775315219*^9, 
   3.7179077757214727`*^9}, {3.718329384592175*^9, 3.718329385248431*^9}, {
   3.7183294389677114`*^9, 3.718329439280215*^9}, {3.7183694825858197`*^9, 
   3.718369498351596*^9}, {3.7183696630719795`*^9, 
   3.718369663790718*^9}},ExpressionUUID->"276a25da-139c-4fa5-9853-\
4c5fdf19e5c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outer", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 
  3.6812140182421093`*^9}},ExpressionUUID->"b3f01446-a9ab-46e2-943b-\
db3233cc1f1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FixFunctionsWithOuter", " ", "=", " ", 
    RowBox[{
     RowBox[{"#", " ", "/.", " ", 
      RowBox[{"\"\<***Outer***\>\"", " ", "\[Rule]", " ", "Outer"}]}], 
     "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "@", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "y_", ",", " ", "z_"}], "]"}]}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"d", ",", " ", "i"}], "]"}], 
       RowBox[{"\"\<***Outer***\>\"", "[", 
        RowBox[{"Times", ",", " ", 
         RowBox[{"CreateSymbol", "[", 
          RowBox[{"y", ",", " ", "i"}], "]"}], ",", " ", 
         RowBox[{"CreateSymbol", "[", 
          RowBox[{"z", ",", " ", 
           RowBox[{"d", "-", "i"}]}], "]"}]}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "0", ",", " ", "d"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"x_", ",", " ", 
        RowBox[{"Outer", "[", 
         RowBox[{"Times", ",", " ", "y_", ",", " ", "z_"}], "]"}]}], "]"}], 
      "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TransformExpression", "[", "x", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"\[FormalP]", "[", 
        RowBox[{"Outer", "[", 
         RowBox[{"Times", ",", " ", "y", ",", " ", "z"}], "]"}], "]"}], "[", 
       "\[FormalR]", "]"}]}], "}"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.6807505175450974`*^9, 3.6807505182146254`*^9}, {3.680750750540885*^9, 
   3.680750889755329*^9}, {3.6807512749702587`*^9, 3.680751347384269*^9}, {
   3.68075140250815*^9, 3.68075140282065*^9}, {3.6807514492622814`*^9, 
   3.6807515045940065`*^9}, {3.6807911430954466`*^9, 3.680791143389366*^9}, {
   3.680792308407544*^9, 3.6807923086940536`*^9}, {3.6807941775847745`*^9, 
   3.6807941778969946`*^9}, {3.681085448625431*^9, 3.6810854497916684`*^9}, {
   3.6811252503958178`*^9, 3.681125269259572*^9}, {3.681127071295232*^9, 
   3.681127102989649*^9}, {3.6811273431333065`*^9, 3.681127351836822*^9}, {
   3.69002849477006*^9, 3.6900284969071207`*^9}, {3.690028972793089*^9, 
   3.6900290169186945`*^9}, 3.690029148663006*^9, {3.690029187189972*^9, 
   3.6900291925629*^9}, {3.690029278545068*^9, 3.690029284995552*^9}, 
   3.690029378305349*^9, {3.690029439712564*^9, 3.690029441887326*^9}, {
   3.6900295413260174`*^9, 3.69002956583889*^9}, {3.6900299725790024`*^9, 
   3.6900299785523343`*^9}, {3.6900300323882575`*^9, 3.690030053380579*^9}, {
   3.6900319644361753`*^9, 3.690032025485417*^9}, {3.6900321300580645`*^9, 
   3.6900321380981913`*^9}, {3.6900322054491596`*^9, 3.6900322359952774`*^9}, 
   3.690032279519027*^9, {3.690033656812835*^9, 3.690033722011158*^9}, {
   3.6900338228192387`*^9, 3.690033843328258*^9}, {3.690127221904132*^9, 
   3.6901272226385717`*^9}, {3.717740823845194*^9, 3.7177408485173044`*^9}, {
   3.7177418896834373`*^9, 3.7177418903397045`*^9}, {3.717744561443218*^9, 
   3.7177445655995083`*^9}, {3.717757741324804*^9, 3.7177577712938347`*^9}, {
   3.71775780930982*^9, 
   3.717757907279502*^9}},ExpressionUUID->"00fd6476-f5eb-4762-9a80-\
4880d84987dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LeastSquares", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 
  3.681214025639532*^9}},ExpressionUUID->"62357d07-d819-49e0-9a92-\
a0f15bb33cf4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FixFunctionsWithLeastSquares", " ", "=", " ", 
    RowBox[{
     RowBox[{"#", "  ", "/.", " ", 
      RowBox[{
      "\"\<***LeastSquares***\>\"", " ", "\[Rule]", "  ", "LeastSquares"}]}], 
     "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "@", 
       RowBox[{"LeastSquares", "[", 
        RowBox[{"A_", ",", " ", "b_", ",", " ", "x_"}], "]"}]}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"CreateSymbol", "[", 
      RowBox[{
       RowBox[{"LinearSolve", "[", 
        RowBox[{"A", ",", " ", "b", ",", " ", "x"}], "]"}], ",", " ", "d"}], 
      "]"}], " ", "/.", " ", 
     RowBox[{
     "\"\<***LinearSolve***\>\"", " ", "\[Rule]", " ", 
      "\"\<***LeastSquares***\>\""}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"x_", ",", " ", 
        RowBox[{"LeastSquares", "[", 
         RowBox[{"A_", ",", " ", "b_"}], "]"}]}], "]"}], "]"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TransformExpression", "[", "x", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"\[FormalP]", "[", 
        RowBox[{"LeastSquares", "[", 
         RowBox[{"A", ",", " ", "b", ",", " ", "x"}], "]"}], "]"}], "[", 
       "\[FormalR]", "]"}]}], "}"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.680791151742377*^9, 3.6807911519645643`*^9}, {3.6807915366169214`*^9, 
   3.680791542872923*^9}, {3.680792314179553*^9, 3.6807923145203395`*^9}, {
   3.6811251348050947`*^9, 3.6811251802603893`*^9}, {3.6811271181929684`*^9, 
   3.681127126130826*^9}, {3.6811272964632998`*^9, 3.681127312475035*^9}, {
   3.6900343493285866`*^9, 3.690034352172877*^9}, {3.6900344299108*^9, 
   3.690034556698414*^9}, {3.6901272402012453`*^9, 3.690127241811446*^9}, {
   3.697757357611729*^9, 3.697757369607718*^9}, 3.7118995228388042`*^9, {
   3.714493467132481*^9, 3.7144934780388327`*^9}, {3.714495645974639*^9, 
   3.714495668030574*^9}, {3.7177408932208543`*^9, 3.7177409175335855`*^9}, {
   3.717741747947717*^9, 3.7177417987763224`*^9}, {3.7177419184493465`*^9, 
   3.717741923933774*^9}, {3.7177445801621294`*^9, 
   3.7177445890528555`*^9}},ExpressionUUID->"c7bcb921-1cdc-46b4-b88f-\
8dc4cd581dbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LinearSolve", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 3.681214025639532*^9}, {3.687828860678608*^9, 
  3.687828862149001*^9}},ExpressionUUID->"b9d52ab0-b3f8-433b-b5c4-\
f4687ff14e35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FixFunctionsWithLinearSolve", " ", "=", " ", 
    RowBox[{
     RowBox[{"#", "  ", "/.", " ", 
      RowBox[{
      "\"\<***LinearSolve***\>\"", " ", "\[Rule]", "  ", "LinearSolve"}]}], 
     "&"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "@", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"A_", ",", " ", "b_", ",", " ", "x_"}], "]"}]}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"\"\<***LinearSolve***\>\"", "[", 
     RowBox[{"A", ",", " ", 
      RowBox[{
       RowBox[{"CreateSymbol", "[", 
        RowBox[{"b", ",", " ", "d"}], "]"}], " ", "-", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{"d", ",", " ", "i"}], "]"}], 
          RowBox[{
           RowBox[{"CreateSymbol", "[", 
            RowBox[{"A", ",", " ", "i"}], "]"}], ".", 
           RowBox[{"CreateSymbol", "[", 
            RowBox[{"x", ",", " ", 
             RowBox[{"d", "-", "i"}]}], "]"}]}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "d"}], "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"x_", ",", " ", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A_", ",", " ", "b_"}], "]"}]}], "]"}], "]"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TransformExpression", "[", "x", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"\[FormalP]", "[", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A", ",", " ", "b", ",", " ", "x"}], "]"}], "]"}], "[", 
       "\[FormalR]", "]"}]}], "}"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.680791151742377*^9, 3.6807911519645643`*^9}, {3.6807915366169214`*^9, 
   3.680791542872923*^9}, {3.680792314179553*^9, 3.6807923145203395`*^9}, {
   3.6811251348050947`*^9, 3.6811251802603893`*^9}, {3.6811271181929684`*^9, 
   3.681127126130826*^9}, {3.6811272964632998`*^9, 3.681127312475035*^9}, {
   3.687828876308541*^9, 3.687828881430484*^9}, {3.687828923078392*^9, 
   3.687828937738982*^9}, {3.6878289823573666`*^9, 3.687828985366643*^9}, {
   3.687829488356921*^9, 3.6878295238856616`*^9}, {3.6878295566047773`*^9, 
   3.6878295708623466`*^9}, 3.6878386361521044`*^9, {3.6900346799496193`*^9, 
   3.6900346998905735`*^9}, {3.690127635476554*^9, 3.690127664280024*^9}, {
   3.6901276949812155`*^9, 3.690127695715596*^9}, {3.6977573005024824`*^9, 
   3.6977573370667753`*^9}, 3.711899529182603*^9, 3.712108661679304*^9, 
   3.712108751992544*^9, {3.712108819493124*^9, 3.7121089233846006`*^9}, {
   3.7121089959519377`*^9, 3.7121089969206953`*^9}, {3.712109031421753*^9, 
   3.712109038093684*^9}, {3.7121090966097975`*^9, 3.712109170829167*^9}, {
   3.7144930222515807`*^9, 3.7144930469706583`*^9}, {3.714493212858967*^9, 
   3.7144932192422757`*^9}, {3.714493421069494*^9, 3.7144934302727165`*^9}, {
   3.7177409521745405`*^9, 3.7177409693778315`*^9}, {3.717744606990522*^9, 
   3.7177446110530605`*^9}},ExpressionUUID->"7a287056-8f76-4307-a465-\
461e0dcfadea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Join", "Subsubsection",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.680791614725898*^9, 
  3.6807916174856215`*^9}, {3.680792342551761*^9, 3.6807923571497283`*^9}, {
  3.681214017163973*^9, 3.681214037278115*^9}, {3.681220503708869*^9, 
  3.681220504052619*^9}},ExpressionUUID->"ecd1d649-efd6-4102-87a0-\
567126f96a2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FixFunctionsWithJoin", " ", "=", " ", 
    RowBox[{
     RowBox[{"#", "  ", "/.", " ", 
      RowBox[{"\"\<***Join***\>\"", " ", "\[Rule]", "  ", "Join"}]}], "&"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Join", "[", "x__", "]"}], "]"}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"\"\<***Join***\>\"", "@@", 
     RowBox[{"Thread", "@", 
      RowBox[{"Unevaluated", "@", 
       RowBox[{"CreateSymbol", "[", 
        RowBox[{
         RowBox[{"{", "x", "}"}], ",", " ", "d"}], "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"Set", "[", 
       RowBox[{"x_", ",", " ", 
        RowBox[{"Join", "[", "y__", "]"}]}], "]"}], "]"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TransformExpression", "[", "x", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"\[FormalP]", "[", 
        RowBox[{"Join", "[", "y", "]"}], "]"}], "[", "\[FormalR]", "]"}]}], 
     "}"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6806562718511963`*^9, 3.6806562929478674`*^9}, 
   3.680656392114231*^9, {3.6806564243254733`*^9, 3.6806564297725554`*^9}, 
   3.6806575063581467`*^9, {3.68065756659416*^9, 3.680657580119317*^9}, {
   3.680657641997039*^9, 3.6806577624352226`*^9}, {3.68065782965186*^9, 
   3.68065791454307*^9}, {3.6806579612609644`*^9, 3.6806579824141035`*^9}, {
   3.68065815410554*^9, 3.68065816943112*^9}, {3.680658205297534*^9, 
   3.680658251643213*^9}, {3.680658312488303*^9, 3.680658321756996*^9}, {
   3.6806598657223206`*^9, 3.680659872173291*^9}, {3.6806599117042336`*^9, 
   3.6806599127052193`*^9}, {3.680660179936395*^9, 3.6806601808439507`*^9}, {
   3.6807505175450974`*^9, 3.6807505182146254`*^9}, {3.680750750540885*^9, 
   3.680750889755329*^9}, {3.6807512749702587`*^9, 3.680751347384269*^9}, {
   3.68075140250815*^9, 3.68075140282065*^9}, {3.6807514492622814`*^9, 
   3.6807515045940065`*^9}, {3.6807911430954466`*^9, 3.680791143389366*^9}, {
   3.680792308407544*^9, 3.6807923086940536`*^9}, {3.6807941775847745`*^9, 
   3.6807941778969946`*^9}, {3.681085448625431*^9, 3.6810854497916684`*^9}, {
   3.6811252503958178`*^9, 3.681125269259572*^9}, {3.681127071295232*^9, 
   3.681127102989649*^9}, {3.6811273431333065`*^9, 3.681127351836822*^9}, {
   3.681212203134983*^9, 3.6812122147973795`*^9}, {3.6812122500683107`*^9, 
   3.6812122776476493`*^9}, {3.681212372814324*^9, 3.681212540937428*^9}, {
   3.681212608790988*^9, 3.6812126101961994`*^9}, 3.6812126470025663`*^9, {
   3.681212691393663*^9, 3.6812127109512177`*^9}, 3.681212743735463*^9, {
   3.681212781958554*^9, 3.681212786763072*^9}, {3.6812131940813365`*^9, 
   3.681213197596634*^9}, {3.681213237650014*^9, 3.681213239182087*^9}, {
   3.681213368719591*^9, 3.6812133697183795`*^9}, 3.681213412917877*^9, {
   3.6812134998071017`*^9, 3.6812135232137985`*^9}, {3.681213591011466*^9, 
   3.6812136135794735`*^9}, 3.681213643923566*^9, 3.681213754525451*^9, {
   3.6812138595988617`*^9, 3.681213906438315*^9}, {3.6812140753417187`*^9, 
   3.681214140495446*^9}, 3.681214178312124*^9, {3.6812142668728724`*^9, 
   3.681214300882144*^9}, {3.6812143600056343`*^9, 3.681214361925047*^9}, {
   3.6812143945633097`*^9, 3.6812144015788126`*^9}, {3.6812144881235533`*^9, 
   3.681214493607336*^9}, {3.681214545445035*^9, 3.681214548511002*^9}, {
   3.68121466893202*^9, 3.681214716549539*^9}, {3.6812147762991943`*^9, 
   3.681214779423332*^9}, {3.6812148288130317`*^9, 3.6812148650236607`*^9}, {
   3.681214971207588*^9, 3.6812149922842836`*^9}, {3.681215129857127*^9, 
   3.6812151324196568`*^9}, {3.681215199134054*^9, 3.681215226925851*^9}, {
   3.6812153254789486`*^9, 3.6812153415980835`*^9}, {3.6812154917892447`*^9, 
   3.681215530793148*^9}, {3.6812155827759476`*^9, 3.6812155996631975`*^9}, {
   3.681215677045369*^9, 3.6812156862329254`*^9}, {3.681220509008939*^9, 
   3.681220533530229*^9}, {3.6812205906876726`*^9, 3.681220630613731*^9}, {
   3.681220711763172*^9, 3.681220741202752*^9}, 3.6812207816585026`*^9, {
   3.6812208138650455`*^9, 3.681220871437789*^9}, {3.681220907904131*^9, 
   3.6812209511165886`*^9}, {3.6812210435760756`*^9, 
   3.6812210478261566`*^9}, {3.6812211204694624`*^9, 
   3.6812211222976093`*^9}, {3.681221198740054*^9, 3.6812212128279114`*^9}, {
   3.68122128380884*^9, 3.6812212858539515`*^9}, 3.7128573285249205`*^9, {
   3.717742192014452*^9, 3.7177421984207573`*^9}, {3.717744460879756*^9, 
   3.7177444636141605`*^9}, {3.7177446274282165`*^9, 3.717744631178257*^9}, {
   3.7179064723502407`*^9, 3.717906542163406*^9}, {3.7179077449086976`*^9, 
   3.717907746705572*^9}},ExpressionUUID->"0253268e-0d90-4559-91f9-\
8b49f5751796"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",ExpressionUUID->"9c2f215c-a969-43a7-92df-442fba380067"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 
  3.5914868026208353`*^9}},ExpressionUUID->"9fc14ecf-2e25-4ffd-9195-\
74a55267b069"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1373, 1509},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2937, 59, 547, "Code",ExpressionUUID->"52f316c7-725b-4e45-b7db-0035f85949f4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3520, 83, 160, 3, 95, "Section",ExpressionUUID->"31be24c8-e8f8-4e51-8834-5d8368d76333"],
Cell[3683, 88, 905, 18, 222, "Input",ExpressionUUID->"dec9cbe4-7c51-49a2-9755-5fa8d65169bc",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4625, 111, 464, 7, 95, "Section",ExpressionUUID->"fbfb90e8-04a5-409e-a7dc-53e518fe074e"],
Cell[5092, 120, 1456, 26, 612, "Text",ExpressionUUID->"26cdc679-1a13-48c4-ae65-1e905680834d"],
Cell[CellGroupData[{
Cell[6573, 150, 589, 8, 64, "Subsubsection",ExpressionUUID->"dc0317e1-4e88-4f8e-950b-15bc74d9266e"],
Cell[7165, 160, 3645, 59, 182, "Input",ExpressionUUID->"276a25da-139c-4fa5-9853-4c5fdf19e5c8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10847, 224, 511, 8, 64, "Subsubsection",ExpressionUUID->"b3f01446-a9ab-46e2-943b-db3233cc1f1c"],
Cell[11361, 234, 4182, 83, 356, "Input",ExpressionUUID->"00fd6476-f5eb-4762-9a80-4880d84987dd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15580, 322, 516, 8, 64, "Subsubsection",ExpressionUUID->"62357d07-d819-49e0-9a92-a0f15bb33cf4"],
Cell[16099, 332, 3185, 68, 356, "Input",ExpressionUUID->"c7bcb921-1cdc-46b4-b88f-8dc4cd581dbd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[19321, 405, 561, 8, 64, "Subsubsection",ExpressionUUID->"b9d52ab0-b3f8-433b-b5c4-f4687ff14e35"],
Cell[19885, 415, 4030, 83, 396, "Input",ExpressionUUID->"7a287056-8f76-4307-a465-461e0dcfadea",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[23952, 503, 554, 8, 64, "Subsubsection",ExpressionUUID->"ecd1d649-efd6-4102-87a0-567126f96a2c"],
Cell[24509, 513, 4994, 89, 316, "Input",ExpressionUUID->"0253268e-0d90-4559-91f9-8b49f5751796",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29552, 608, 85, 0, 95, "Section",ExpressionUUID->"9c2f215c-a969-43a7-92df-442fba380067"],
Cell[29640, 610, 267, 6, 102, "Input",ExpressionUUID->"9fc14ecf-2e25-4ffd-9195-74a55267b069",
 InitializationCell->True]
}, Open  ]]
}
]
*)

