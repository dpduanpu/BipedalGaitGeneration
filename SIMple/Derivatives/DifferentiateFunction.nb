(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    260688,       4603]
NotebookOptionsPosition[    255548,       4467]
NotebookOutlinePosition[    255923,       4483]
CellTagsIndexPosition[    255880,       4480]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"DifferentiateFunction", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
     "A", " ", "list", " ", "of", " ", "routines", " ", "that", " ", "will", 
      " ", "differentiate", " ", "various", " ", "NLink", " ", "functions", 
      " ", "to", " ", "C", " ", 
      RowBox[{"code", ".", "\n", "Copyright"}], " ", 
      RowBox[{"(", "C", ")"}], " ", "2016", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", "the", " ", "Free", " ", "Software", " ", 
      "Foundation"}]}]}], ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 CellChangeTimes->{{3.6731965303701305`*^9, 
  3.6731965402290993`*^9}},ExpressionUUID->"285b5be0-4653-45f0-a326-\
77e4a9dd6480"],

Cell["\<\
Note: any subfunctions in CreateSymbolString should contain no states.  The \
Block in one of the functions can mess with the local variables in the \
subfunction.

Note: Functions passed to DifferentiateFunction and friends should not use \
set statements where the lhs appears in the rhs.  This will lead to a subtle \
bug that produces the wrong derivative.  For example, the original CRB code \
as written in Featherstone\[CloseCurlyQuote]s RBD book has a line similar to

f = X.f;

The line is correctly differentiated as

f = X.f;
df = dX.f + X.df;

but this leads to the wrong derivative as the value of f expected in df needs \
to be the value before the assignment of the previous line.  The correct \
order would be

df = dX.f + X.df;
f = X.f;

or an introduction of new variable, fTemp, for example

fTemp = f;
f = X.fTemp;\
\>", "Text",
 CellChangeTimes->{{3.674848288600943*^9, 3.674848324267538*^9}, {
  3.6748484932222033`*^9, 3.67484855198199*^9}, {3.68027023444153*^9, 
  3.6802702467080774`*^9}, {3.6802753890025234`*^9, 3.680275403454358*^9}, {
  3.6802820387234187`*^9, 3.680282090534379*^9}, {3.680291644906829*^9, 
  3.6802916613235855`*^9}, {3.6804611356529713`*^9, 3.6804615159551077`*^9}, {
  3.6804651571858907`*^9, 3.680465161901642*^9}, {3.6804651946982627`*^9, 
  3.6804651949974546`*^9}, {3.6804652265244017`*^9, 
  3.6804652434173307`*^9}},ExpressionUUID->"d9a0edb2-dcac-486c-bd2d-\
201209e38aec"],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Derivatives`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOrder", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateSymbolString", "::", "usage"}], " ", "=", " ", "\"\<\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateSymbol", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TransformExpression", "::", "usage"}], " ", "=", " ", 
   "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockExpression", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DifferentiateFunction", "::", "usage"}], " ", "=", " ", 
   "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MergeFunctions", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.717345257519829*^9, 3.7173453005358953`*^9}, {
   3.7173454177921476`*^9, 3.717345419417161*^9}, {3.717346295966098*^9, 
   3.7173463089974813`*^9}, 3.717346349779165*^9, {3.71771906625355*^9, 
   3.717719071722337*^9}, {3.7177589303177834`*^9, 3.7177589487085824`*^9}, {
   3.7177590781004367`*^9, 3.7177590847567506`*^9}, {3.7180701046503153`*^9, 
   3.7180701134003983`*^9}, {3.7183290304793153`*^9, 
   3.7183290345887136`*^9}},ExpressionUUID->"f59f84c0-b48f-4372-8e17-\
5a1474dbdc4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dummy Hold Variable", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731965721044188`*^9}, {
  3.674608797201888*^9, 3.674608798233142*^9}, {3.675974814135728*^9, 
  3.6759748222920523`*^9}},ExpressionUUID->"98efe4b4-e822-4290-8973-\
17108c3ad40b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"\[FormalP]", ",", " ", "HoldAll"}], "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"32288a83-7fe1-4da6-9175-2cefd97af4cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["derivative type operations", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731965721044188`*^9}, {
  3.71164154216206*^9, 
  3.7116415467870617`*^9}},ExpressionUUID->"6198731d-17f5-4fa8-8990-\
0e6211c5bea0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"DerivativeOrder", ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOrder", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"ToString", "@", 
        RowBox[{"Unevaluated", "@", "x"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"Last", "@", 
        RowBox[{"StringSplit", "[", 
         RowBox[{"s", ",", " ", "\"\<`\>\""}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Max", "@", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"s", ",", " ", 
          RowBox[{"StartOfString", "~~", 
           RowBox[{"\"\<d\>\"", ".."}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"s", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], " ", "\[Equal]", " ", "\"\<d\>\""}], 
        ",", " ", 
        RowBox[{
         RowBox[{"n", "--"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Max", "[", 
       RowBox[{"n", ",", " ", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7116414771927667`*^9, 3.7116415366619763`*^9}, {
   3.71164156667789*^9, 3.7116416249126987`*^9}, {3.7116416717880907`*^9, 
   3.7116417816484365`*^9}, {3.711641861680358*^9, 3.71164194108722*^9}, {
   3.7116419880407343`*^9, 3.7116419886032786`*^9}, {3.711642094791681*^9, 
   3.7116421185574703`*^9}, {3.7116421499483385`*^9, 3.711642159385917*^9}, {
   3.7116422084488277`*^9, 3.7116422242302103`*^9}, {3.711642317678336*^9, 
   3.711642318115839*^9}, 3.711642377178832*^9, {3.7116426387278953`*^9, 
   3.71164263927483*^9}},ExpressionUUID->"54921280-b6a3-4c55-8686-\
1fcca14196df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Symbols", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731966061576476`*^9}, {
  3.67319669842465*^9, 3.6731966990809608`*^9}, {3.6731979878874626`*^9, 
  3.6731979898964663`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"enforce", " ", "derivative", " ", "naming", " ", "convention"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CreateSymbolString", "[", 
      RowBox[{"x_String", ",", " ", 
       RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"d", " ", ">", " ", "0"}], ",", " ", 
       RowBox[{"StringInsert", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"StringRepeat", "[", 
          RowBox[{"\"\<d\>\"", ",", " ", "d"}], "]"}], ",", " ", 
         RowBox[{"Last", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"StringPosition", "[", 
            RowBox[{
             RowBox[{"\"\<`\>\"", " ", "<>", " ", "x"}], ",", " ", 
             "\"\<`\>\""}], "]"}]}]}]}], "]"}], ",", " ", "x"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateSymbolString", "[", 
      RowBox[{"x_Symbol", ",", " ", 
       RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"CreateSymbolString", "[", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Unevaluated", "@", "x"}]}], ",", " ", "d"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateSymbolString", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "d_", "]"}], "[", "x_", "]"}], ",", " ", 
       RowBox[{"e_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
     RowBox[{"CreateSymbolString", "[", 
      RowBox[{
       RowBox[{"Unevaluated", "@", "x"}], ",", " ", 
       RowBox[{"d", "+", "e"}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.674609820943552*^9, 3.6746098319358397`*^9}, 
   3.6747445932992125`*^9, {3.674744907160124*^9, 3.674744913800845*^9}, 
   3.6747449495667686`*^9, {3.6747450223266983`*^9, 3.674745025279848*^9}, {
   3.675772449082122*^9, 3.6757724644259553`*^9}, {3.6757725176764965`*^9, 
   3.6757725182702513`*^9}, {3.6757732270201845`*^9, 
   3.6757732814738607`*^9}, {3.6757737076536474`*^9, 3.675773731240962*^9}, {
   3.6757765039140415`*^9, 3.6757765123359895`*^9}, 3.6757765978975897`*^9, {
   3.6757772793534327`*^9, 3.6757773811670294`*^9}, 3.675777461581417*^9, {
   3.675777497450675*^9, 3.675777498460661*^9}, {3.675777603379558*^9, 
   3.6757776818174224`*^9}, {3.6757778302198925`*^9, 
   3.6757778374074593`*^9}, {3.6757800764235287`*^9, 3.675780084323101*^9}, {
   3.6757803515546103`*^9, 3.675780365289109*^9}, {3.675858402284685*^9, 
   3.675858476917317*^9}, {3.675860374193325*^9, 3.675860375450855*^9}, {
   3.6758606907392945`*^9, 3.675860700156578*^9}, {3.675879495994484*^9, 
   3.6758794965101137`*^9}, {3.675879530729175*^9, 3.675879534510459*^9}, {
   3.6758795653389406`*^9, 3.675879620433197*^9}, {3.680274057149744*^9, 
   3.680274089451107*^9}, {3.680274324183465*^9, 3.680274376601764*^9}, 
   3.6802744093813267`*^9, {3.6802744807324514`*^9, 3.680274514029896*^9}, {
   3.680274581717346*^9, 3.680274588795933*^9}, {3.680274651918189*^9, 
   3.6802746918462663`*^9}, {3.6802747253402057`*^9, 3.680274752269745*^9}, {
   3.680274787106058*^9, 3.68027483938447*^9}, {3.68027488977464*^9, 
   3.6802749181554317`*^9}, {3.680274974605379*^9, 3.6802750650141106`*^9}, {
   3.6802751088209763`*^9, 3.680275115388324*^9}, 3.6802753818461633`*^9, {
   3.680282213732027*^9, 3.680282215560141*^9}, {3.6802908030246296`*^9, 
   3.6802908568215823`*^9}, {3.6802912215788555`*^9, 
   3.6802912906341333`*^9}, {3.6802913228046155`*^9, 3.680291333627512*^9}, {
   3.6805744290822945`*^9, 3.6805745004484344`*^9}, 3.68057528405134*^9, {
   3.680575321320416*^9, 3.680575324955192*^9}, {3.680599487784174*^9, 
   3.6805994886165023`*^9}, {3.680600613736164*^9, 3.6806006288540673`*^9}, {
   3.680600878647878*^9, 3.6806008864435663`*^9}, 3.6806009318767204`*^9, {
   3.6806009792599363`*^9, 3.680600989503357*^9}, {3.680601461777213*^9, 
   3.680601479449834*^9}, {3.680601573663968*^9, 3.6806015770521903`*^9}, {
   3.680601713317074*^9, 3.680601779183304*^9}, {3.6806018180008335`*^9, 
   3.6806018579506855`*^9}, {3.6806018979760942`*^9, 
   3.6806019255136395`*^9}, {3.6806020143834553`*^9, 3.6806020285045853`*^9}, 
   3.680602079659773*^9, {3.6806022607687893`*^9, 3.6806023201970215`*^9}, {
   3.6806024023034506`*^9, 3.6806024062477865`*^9}, {3.680602459457079*^9, 
   3.6806024599181128`*^9}, 3.6806024968073626`*^9, {3.68060259007939*^9, 
   3.6806026101084285`*^9}, 3.6806040126623898`*^9, 3.6806041451875987`*^9, {
   3.6806218990439973`*^9, 3.6806219024805737`*^9}, {3.6806221036094*^9, 
   3.680622109083638*^9}, 3.68062231987393*^9, {3.680622418534404*^9, 
   3.6806224313356133`*^9}, {3.680622515258529*^9, 3.6806225187262683`*^9}, {
   3.68062452649179*^9, 3.68062456619614*^9}, {3.680624720095382*^9, 
   3.68062472645713*^9}, {3.680624804695845*^9, 3.6806248130520973`*^9}, {
   3.680625224866005*^9, 3.680625238759714*^9}, {3.6806261303481693`*^9, 
   3.680626145051933*^9}, {3.680627394911595*^9, 3.6806274236435537`*^9}, 
   3.6806274750810356`*^9, {3.680627894286705*^9, 3.680627896552327*^9}, {
   3.680627942022585*^9, 3.6806279516397104`*^9}, {3.680628098199011*^9, 
   3.6806280983494577`*^9}, {3.6806293137886534`*^9, 
   3.6806293224375277`*^9}, {3.680629379159173*^9, 3.680629400240416*^9}, 
   3.680630163559594*^9, {3.690279433731442*^9, 3.690279454355339*^9}, {
   3.7115555101659107`*^9, 
   3.711555526025412*^9}},ExpressionUUID->"617be577-fd44-476e-9055-\
38b6624e59e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"CreateSymbol", ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "default", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"CreateSymbol", "[", 
     RowBox[{"x", ",", "0", ",", " ", "Hold"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "symbols", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{"x_Symbol", ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"d", "  ", ">", " ", "0"}], ",", " ", 
      RowBox[{"Symbol", "[", 
       RowBox[{"CreateSymbolString", "[", 
        RowBox[{
         RowBox[{"Unevaluated", "@", "x"}], ",", " ", "d"}], "]"}], "]"}], 
      ",", " ", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "functions", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"\[FormalP]", "[", "x_", "]"}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"CreateSymbol", "[", 
     RowBox[{"x", ",", " ", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"x_", ",", " ", "y___"}], "]"}]}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"CreateSymbol", "[", 
       RowBox[{"x", ",", " ", "d"}], "]"}], ",", " ", "y"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"HoldPattern", "@", 
       RowBox[{"Part", "[", 
        RowBox[{"x_", ",", " ", "y___"}], "]"}]}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"CreateSymbol", "[", 
        RowBox[{"x", ",", " ", "d"}], "]"}], ",", " ", "y"}], "]"}], " ", "//.",
      " ", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Part", "[", 
        RowBox[{
         RowBox[{"Part", "[", 
          RowBox[{"a_", ",", " ", "b__"}], "]"}], ",", " ", "c__"}], "]"}], 
       "]"}], " ", "\[RuleDelayed]", " ", 
      RowBox[{"Part", "[", 
       RowBox[{"a", ",", " ", "b", ",", " ", "c"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"f_", "[", "x___", "]"}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{
     RowBox[{"CreateSymbol", "[", 
      RowBox[{"f", ",", " ", "d"}], "]"}], "[", 
     RowBox[{"CreateArguments", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", " ", "d"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"f_Symbol", "[", "x___", "]"}], ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{
     RowBox[{"Symbol", "[", 
      RowBox[{"CreateSymbolString", "[", 
       RowBox[{
        RowBox[{"Unevaluated", "@", "f"}], ",", " ", "d"}], "]"}], "]"}], "[", 
     RowBox[{"CreateArguments", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", " ", "d"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "derivatives", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "d_", "]"}], "[", "x_", "]"}], ",", " ", 
      RowBox[{"e_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{"CreateSymbol", "[", 
     RowBox[{"x", ",", " ", 
      RowBox[{"d", "+", "e"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "d_", "]"}], "[", 
       RowBox[{"f_", "[", "x___", "]"}], "]"}], ",", " ", 
      RowBox[{"e_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",", " ", 
      RowBox[{"d", "+", "e"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "d_", "]"}], "[", "f_", "]"}], "[", "x___",
        "]"}], ",", " ", 
      RowBox[{"e_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
    RowBox[{"CreateSymbol", "[", 
     RowBox[{
      RowBox[{"f", "[", "x", "]"}], ",", " ", 
      RowBox[{"d", "+", "e"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"does", " ", "not", " ", "work", " ", "with", " ", "e"}], " ", 
    ">", " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "solution", " ", "is", " ", "to", " ", "precall", " ", "or", " ", 
    "postcall", " ", "CreateSymbol", " ", "with", " ", "e"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "depending", " ", "on", " ", "what", " ", "it", " ", "means", " ", "to", 
    " ", "diff", " ", "by", " ", "e", " ", "only"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CreateSymbol", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "d__", "]"}], "[", "x_", "]"}], ",", " ", 
       RowBox[{"e_Integer:", "0"}]}], "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", " ", "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "=", 
         RowBox[{"Plus", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"List", "@", 
          RowBox[{"CreateIndices", "[", 
           RowBox[{"Length", "@", 
            RowBox[{"{", "d", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"CreateSymbol", "[", 
          RowBox[{"x", ",", " ", "n"}], "]"}], " ", "/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{"i", ",", " ", "n"}], "]"}], " ", "\[Rule]", " ", 
           RowBox[{"Pick", "[", 
            RowBox[{"i", ",", " ", 
             RowBox[{"{", "d", "}"}], ",", " ", "1"}], "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6737752075217705`*^9, 3.6737752237142305`*^9}, {
   3.673775346449882*^9, 3.673775452389614*^9}, {3.6737754901868753`*^9, 
   3.673775546531165*^9}, {3.673775623235116*^9, 3.673775660615316*^9}, {
   3.673775697098228*^9, 3.6737756974888577`*^9}, {3.6737757801341896`*^9, 
   3.673775780899822*^9}, {3.6737759208543453`*^9, 3.6737759371670523`*^9}, {
   3.673775973245551*^9, 3.67377597388618*^9}, 3.6737799704665446`*^9, 
   3.6737800484942694`*^9, {3.673794797634432*^9, 3.6737948230409384`*^9}, {
   3.673795043513568*^9, 3.6737950643419075`*^9}, {3.6737951331082344`*^9, 
   3.6737951743832383`*^9}, {3.6737954606126666`*^9, 3.673795483861678*^9}, {
   3.673795521612008*^9, 3.673795530278427*^9}, 3.673795564676546*^9, {
   3.6737955989893937`*^9, 3.6737956057863026`*^9}, {3.6737956660838366`*^9, 
   3.6737956858340373`*^9}, 3.673795754706541*^9, {3.6737959235832744`*^9, 
   3.673795924880163*^9}, {3.673796215029808*^9, 3.6737962897805967`*^9}, {
   3.6737963760667915`*^9, 3.6737964208594756`*^9}, {3.673796452969143*^9, 
   3.673796456844225*^9}, {3.6737965235011168`*^9, 3.673796523922995*^9}, {
   3.673797207210251*^9, 3.673797210304031*^9}, {3.6738855265096807`*^9, 
   3.673885526697178*^9}, {3.6738855773695774`*^9, 3.6738855830593653`*^9}, {
   3.6738856137002897`*^9, 3.6738856382842007`*^9}, {3.6738860576256104`*^9, 
   3.6738860850675306`*^9}, {3.673886123630392*^9, 3.673886171880924*^9}, {
   3.673886277882703*^9, 3.6738862925859985`*^9}, {3.6738864169941473`*^9, 
   3.673886417259779*^9}, {3.6738873631818895`*^9, 3.6738873876941566`*^9}, {
   3.673888765079525*^9, 3.6738887687423315`*^9}, {3.6739585531379128`*^9, 
   3.673958558013003*^9}, {3.673958607435384*^9, 3.6739586479721537`*^9}, {
   3.673958709597747*^9, 3.673958754583924*^9}, {3.673958858526533*^9, 
   3.6739589288103437`*^9}, {3.673958967268575*^9, 3.673958984753089*^9}, {
   3.6739590344880157`*^9, 3.673959293440839*^9}, {3.6739594015086823`*^9, 
   3.6739594104150257`*^9}, {3.673959451090667*^9, 3.6739594778409433`*^9}, {
   3.6739596031766605`*^9, 3.6739596202706027`*^9}, {3.6739596620609665`*^9, 
   3.6739596819674053`*^9}, {3.6739597159288726`*^9, 3.673959716741381*^9}, {
   3.673959789071333*^9, 3.6739598523376064`*^9}, {3.6739599470054264`*^9, 
   3.6739599504273367`*^9}, {3.6739599888593016`*^9, 3.673959989703114*^9}, {
   3.6739601222947917`*^9, 3.67396014565073*^9}, {3.6739602334506607`*^9, 
   3.6739602335972376`*^9}, {3.673960342812605*^9, 3.6739603453824353`*^9}, {
   3.673960377913246*^9, 3.673960406508582*^9}, {3.6739605189106183`*^9, 
   3.6739605196763625`*^9}, {3.673960554044932*^9, 3.6739605758983965`*^9}, {
   3.6739606621018853`*^9, 3.6739606623230314`*^9}, {3.67396074951875*^9, 
   3.6739607651578217`*^9}, 3.6739608003758087`*^9, {3.6739608309238358`*^9, 
   3.6739608923054633`*^9}, {3.6739609228653135`*^9, 3.673960952675433*^9}, {
   3.6739610730196896`*^9, 3.6739610734279795`*^9}, {3.6739611142172585`*^9, 
   3.6739611271223965`*^9}, {3.673961215362084*^9, 3.673961239925948*^9}, {
   3.6739612997390113`*^9, 3.6739613055771427`*^9}, {3.6739614347725005`*^9, 
   3.6739614351928167`*^9}, {3.673961707192651*^9, 3.673961707995201*^9}, {
   3.673966823266259*^9, 3.673966838865396*^9}, {3.6739669780776787`*^9, 
   3.6739670661352005`*^9}, {3.6739671435412855`*^9, 
   3.6739671494119864`*^9}, {3.673967236716508*^9, 3.6739672923371677`*^9}, {
   3.673967368978699*^9, 3.6739673723891115`*^9}, {3.6739674441681967`*^9, 
   3.6739674457005215`*^9}, {3.6739678230641937`*^9, 
   3.6739678478810234`*^9}, {3.6739679123084316`*^9, 
   3.6739679124855566`*^9}, {3.6739679858194447`*^9, 3.673968045251151*^9}, {
   3.673968233797269*^9, 3.6739682362369957`*^9}, {3.673968291331209*^9, 
   3.673968292630464*^9}, 3.6739685230883436`*^9, {3.6739686432611074`*^9, 
   3.6739686609796486`*^9}, {3.673968716215867*^9, 3.673968723677152*^9}, {
   3.673969149662871*^9, 3.6739691498309746`*^9}, {3.6739691966778245`*^9, 
   3.6739693257335367`*^9}, 3.673969371998455*^9, {3.67396942342133*^9, 
   3.673969475993932*^9}, {3.6739695306305943`*^9, 3.673969535552066*^9}, {
   3.6739696372790723`*^9, 3.673969724196949*^9}, {3.6739697561220074`*^9, 
   3.673969791606324*^9}, {3.673969828187126*^9, 3.673969838881569*^9}, {
   3.6739699272010336`*^9, 3.6739699334624643`*^9}, {3.6739699725492954`*^9, 
   3.6739699780622044`*^9}, {3.6739700186042604`*^9, 
   3.6739700489399614`*^9}, {3.673970203145501*^9, 3.673970232118738*^9}, {
   3.6739702778327103`*^9, 3.673970345139363*^9}, {3.673970431612547*^9, 
   3.6739704811846275`*^9}, {3.6739705484040365`*^9, 
   3.6739706030465713`*^9}, {3.6739706625336685`*^9, 3.673970689976085*^9}, {
   3.6739707277173586`*^9, 3.6739707635917463`*^9}, {3.6739709562746754`*^9, 
   3.6739710109110937`*^9}, {3.6739712547372074`*^9, 3.673971277194564*^9}, {
   3.673971391622418*^9, 3.673971394260285*^9}, {3.67397190253568*^9, 
   3.6739719028879128`*^9}, {3.6739719471121855`*^9, 
   3.6739720680060015`*^9}, {3.6739721391417475`*^9, 
   3.6739721574680986`*^9}, {3.673972353179961*^9, 3.6739724003243294`*^9}, {
   3.6739725680715184`*^9, 3.673972591589943*^9}, {3.673972628709941*^9, 
   3.6739727920707045`*^9}, {3.6739730064022427`*^9, 
   3.6739730354934063`*^9}, {3.6739752498520555`*^9, 
   3.6739752514111586`*^9}, {3.67397546897766*^9, 3.673975488328012*^9}, {
   3.673975526159814*^9, 3.6739755314728503`*^9}, {3.6740499731264524`*^9, 
   3.6740500796072702`*^9}, 3.6740555507887745`*^9, {3.6740555815183525`*^9, 
   3.674055601239813*^9}, {3.674055969014518*^9, 3.674055985861971*^9}, {
   3.674056565694069*^9, 3.674056573889284*^9}, {3.6740834056948586`*^9, 
   3.6740834122887187`*^9}, {3.674083679379135*^9, 3.6740837144934764`*^9}, {
   3.6740837864679565`*^9, 3.6740837894229965`*^9}, {3.674094065241339*^9, 
   3.67409407741335*^9}, 3.6740941138215566`*^9, {3.6740947103837276`*^9, 
   3.6740947109150248`*^9}, {3.6740949076143413`*^9, 3.674094978771393*^9}, {
   3.6740950391939335`*^9, 3.6740950395064373`*^9}, 3.674131521720171*^9, {
   3.6741324692471895`*^9, 3.6741325027631817`*^9}, {3.6741325791858997`*^9, 
   3.6741325797171583`*^9}, {3.674132638155302*^9, 3.674132647889779*^9}, {
   3.6741361928057795`*^9, 3.674136202752822*^9}, {3.674136324271484*^9, 
   3.674136344638443*^9}, {3.6741364636880445`*^9, 3.674136550059143*^9}, {
   3.674136595036003*^9, 3.6741366168917675`*^9}, {3.6741368630246167`*^9, 
   3.674136931584176*^9}, {3.6741370242228107`*^9, 3.674137080017968*^9}, {
   3.6741371121025705`*^9, 3.6741372326387596`*^9}, {3.6741373308842344`*^9, 
   3.6741373351872873`*^9}, {3.6741374558583813`*^9, 
   3.6741374583981643`*^9}, {3.674137585616272*^9, 3.6741375920398226`*^9}, {
   3.674137686031395*^9, 3.6741377370579166`*^9}, {3.674137816978996*^9, 
   3.674137824550782*^9}, {3.6741378839732*^9, 3.674137884337453*^9}, {
   3.6741380645033937`*^9, 3.6741380657846355`*^9}, {3.6741381764459057`*^9, 
   3.674138202252847*^9}, 3.6741382781562295`*^9, {3.674138562091731*^9, 
   3.6741385917508507`*^9}, {3.674138754666978*^9, 3.674138834011633*^9}, {
   3.674139299319475*^9, 3.674139316617753*^9}, {3.674139412749478*^9, 
   3.674139414091428*^9}, {3.6741398956629047`*^9, 3.6741399035561056`*^9}, 
   3.6741407429175577`*^9, {3.674140782593667*^9, 3.6741407973241024`*^9}, {
   3.6741408657338743`*^9, 3.6741408661151347`*^9}, {3.6741409009101505`*^9, 
   3.6741409215154443`*^9}, {3.6741421686186438`*^9, 
   3.6741421767255716`*^9}, {3.6741423323259106`*^9, 3.6741423477648726`*^9}, 
   3.674142379254033*^9, {3.6741424487235045`*^9, 3.6741424546739473`*^9}, {
   3.674142594762895*^9, 3.67414259793513*^9}, 3.67414330837022*^9, {
   3.674143376841564*^9, 3.674143406730744*^9}, {3.674143501373417*^9, 
   3.67414350279042*^9}, {3.674143569909083*^9, 3.6741435842869997`*^9}, 
   3.6741436904723063`*^9, 3.6741437307242026`*^9, {3.6742289531791224`*^9, 
   3.67422895383538*^9}, {3.6744156368194294`*^9, 3.674415637366309*^9}, {
   3.6744211364458036`*^9, 3.6744211369021263`*^9}, 3.674489842857273*^9, {
   3.6744898787013226`*^9, 3.6744899304204493`*^9}, {3.6745090510048423`*^9, 
   3.674509106507182*^9}, 3.6745092451090145`*^9, {3.674510660728283*^9, 
   3.6745106918811073`*^9}, 3.6745107763323574`*^9, {3.674555666026657*^9, 
   3.674555679104891*^9}, {3.674607834761834*^9, 3.674607920095368*^9}, {
   3.6746080310372887`*^9, 3.6746080357632513`*^9}, {3.67460851757587*^9, 
   3.674608536000453*^9}, {3.6746086100573463`*^9, 3.6746086116979885`*^9}, {
   3.6746088288896503`*^9, 3.674608829592741*^9}, {3.674608871852955*^9, 
   3.6746088725560865`*^9}, 3.6746097381578317`*^9, 3.67474483368079*^9, {
   3.6747450506273975`*^9, 3.674745058768092*^9}, {3.6747456111613593`*^9, 
   3.674745624145842*^9}, {3.68062392186922*^9, 3.6806239368485456`*^9}, {
   3.6899684386092467`*^9, 3.689968459912721*^9}, {3.689968657415332*^9, 
   3.689968664842352*^9}, {3.689968792188176*^9, 3.689968799098776*^9}, {
   3.6899689466361475`*^9, 3.6899689502100844`*^9}, {3.689969011399886*^9, 
   3.6899690118403373`*^9}, {3.6899690907862577`*^9, 3.689969148133891*^9}, {
   3.68999800537521*^9, 3.689998018997652*^9}, {3.68999820345702*^9, 
   3.6899982036611643`*^9}, {3.6899989328443317`*^9, 3.6899989615010996`*^9}, 
   3.689999741253454*^9, {3.6900002314983673`*^9, 3.6900002419020925`*^9}, {
   3.6900020979449205`*^9, 3.690002103409424*^9}, 3.6900023256965837`*^9, {
   3.690002400155896*^9, 3.6900024713908463`*^9}, {3.6900033058136454`*^9, 
   3.6900033411966295`*^9}, 3.6900034089233036`*^9, {3.6900034430867033`*^9, 
   3.690003444889807*^9}, {3.6900035331123676`*^9, 3.690003562523197*^9}, {
   3.6900037173180647`*^9, 3.690003719719142*^9}, {3.6900037593090763`*^9, 
   3.690003768344135*^9}, 3.6900037988969517`*^9, {3.6900044318253155`*^9, 
   3.6900044330212784`*^9}, {3.6901719416235285`*^9, 
   3.6901719576044855`*^9}, {3.690174782742403*^9, 3.6901747832267847`*^9}, {
   3.6901764945895267`*^9, 3.690176495948955*^9}, {3.6901765532776437`*^9, 
   3.690176560409643*^9}, {3.690177742589427*^9, 3.690177746995674*^9}, {
   3.7115556621984253`*^9, 3.7115556744485283`*^9}, {3.711556469298977*^9, 
   3.7115564703927016`*^9}, 3.7115565151743083`*^9, 
   3.7115569759553413`*^9},ExpressionUUID->"8dbb65ed-a9ed-449d-9edf-\
9797baf27ea3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "blocks", " ", "functions", " ", "and", " ", "variables", " ", "and", " ",
      "allows", " ", "for", " ", "post"}], "-", "processing"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CreateSymbol", "[", 
     RowBox[{"x_", ",", " ", "d_Integer", ",", " ", "fcn_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "s", ",", " ", "f", ",", " ", "n", ",", " ", "v", ",", " ", "dv", ",", 
        " ", "b", ",", " ", "w"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Part", ",", " ", "Transpose"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"\[FormalP]", " ", "/@", " ", "w"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"ToString", "@", 
           RowBox[{"Unevaluated", "[", "e", "]"}]}], ",", " ", 
          RowBox[{"{", "HoldAll", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"ExtractVariables", "[", 
         RowBox[{"x", ",", " ", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"ToString", "@", 
           RowBox[{"Unevaluated", "[", "e", "]"}]}], ",", " ", 
          RowBox[{"{", "HoldAll", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"ExtractSubfunctions", "[", 
         RowBox[{"x", ",", " ", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"find", " ", "max", " ", "derivative"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"\[FormalP]", "[", "e", "]"}], " ", ",", " ", 
          RowBox[{"{", "HoldAll", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"ExtractDerivatives", "[", 
         RowBox[{"x", ",", " ", "w"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", "n__", "]"}], "[", "___", "]"}], " ",
              "\[RuleDelayed]", " ", 
             RowBox[{"Plus", "[", "n", "]"}]}], ",", " ", "Infinity"}], "]"}],
           ",", " ", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"create", " ", "symbols"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"f", ",", " ", "True", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Values", "@", "v"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"e", ",", " ", 
          RowBox[{"CreateSymbolString", "[", 
           RowBox[{"e", ",", " ", "1"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"NestList", "[", 
           RowBox[{"w", ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"f", ",", " ", "v"}], "]"}], ",", " ", 
            RowBox[{"d", " ", "+", " ", "n"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"v", ",", " ", "InputForm", ",", " ", "\[FormalP]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"s", ",", " ", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"apply", " ", "fcn"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Hold", "[", 
         RowBox[{"Block", "[", 
          RowBox[{"b", ",", " ", 
           RowBox[{"fcn", "@", 
            RowBox[{"Evaluate", "@", 
             RowBox[{"CreateSymbol", "[", 
              RowBox[{"x", ",", " ", "d"}], "]"}]}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"f", " ", "/.", " ", 
          RowBox[{"b", " ", "\[Rule]", " ", "v"}]}], " ", "/.", " ", 
         RowBox[{
          RowBox[{"\[FormalP]", "[", "e_", "]"}], " ", "\[RuleDelayed]", " ", 
          "e"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6737752075217705`*^9, 3.6737752237142305`*^9}, {
   3.673775346449882*^9, 3.673775452389614*^9}, {3.6737754901868753`*^9, 
   3.673775546531165*^9}, {3.673775623235116*^9, 3.673775660615316*^9}, {
   3.673775697098228*^9, 3.6737756974888577`*^9}, {3.6737757801341896`*^9, 
   3.673775780899822*^9}, {3.6737759208543453`*^9, 3.6737759371670523`*^9}, {
   3.673775973245551*^9, 3.67377597388618*^9}, 3.6737799704665446`*^9, 
   3.6737800484942694`*^9, {3.673794797634432*^9, 3.6737948230409384`*^9}, {
   3.673795043513568*^9, 3.6737950643419075`*^9}, {3.6737951331082344`*^9, 
   3.6737951743832383`*^9}, {3.6737954606126666`*^9, 3.673795483861678*^9}, {
   3.673795521612008*^9, 3.673795530278427*^9}, 3.673795564676546*^9, {
   3.6737955989893937`*^9, 3.6737956057863026`*^9}, {3.6737956660838366`*^9, 
   3.6737956858340373`*^9}, 3.673795754706541*^9, {3.6737959235832744`*^9, 
   3.673795924880163*^9}, {3.673796215029808*^9, 3.6737962897805967`*^9}, {
   3.6737963760667915`*^9, 3.6737964208594756`*^9}, {3.673796452969143*^9, 
   3.673796456844225*^9}, {3.6737965235011168`*^9, 3.673796523922995*^9}, {
   3.673797207210251*^9, 3.673797210304031*^9}, {3.6738855265096807`*^9, 
   3.673885526697178*^9}, {3.6738855773695774`*^9, 3.6738855830593653`*^9}, {
   3.6738856137002897`*^9, 3.6738856382842007`*^9}, {3.6738860576256104`*^9, 
   3.6738860850675306`*^9}, {3.673886123630392*^9, 3.673886171880924*^9}, {
   3.673886277882703*^9, 3.6738862925859985`*^9}, {3.6738864169941473`*^9, 
   3.673886417259779*^9}, {3.6738873631818895`*^9, 3.6738873876941566`*^9}, {
   3.673888765079525*^9, 3.6738887687423315`*^9}, {3.6739585531379128`*^9, 
   3.673958558013003*^9}, {3.673958607435384*^9, 3.6739586479721537`*^9}, {
   3.673958709597747*^9, 3.673958754583924*^9}, {3.673958858526533*^9, 
   3.6739589288103437`*^9}, {3.673958967268575*^9, 3.673958984753089*^9}, {
   3.6739590344880157`*^9, 3.673959293440839*^9}, {3.6739594015086823`*^9, 
   3.6739594104150257`*^9}, {3.673959451090667*^9, 3.6739594778409433`*^9}, {
   3.6739596031766605`*^9, 3.6739596202706027`*^9}, {3.6739596620609665`*^9, 
   3.6739596819674053`*^9}, {3.6739597159288726`*^9, 3.673959716741381*^9}, {
   3.673959789071333*^9, 3.6739598523376064`*^9}, {3.6739599470054264`*^9, 
   3.6739599504273367`*^9}, {3.6739599888593016`*^9, 3.673959989703114*^9}, {
   3.6739601222947917`*^9, 3.67396014565073*^9}, {3.6739602334506607`*^9, 
   3.6739602335972376`*^9}, {3.673960342812605*^9, 3.6739603453824353`*^9}, {
   3.673960377913246*^9, 3.673960406508582*^9}, {3.6739605189106183`*^9, 
   3.6739605196763625`*^9}, {3.673960554044932*^9, 3.6739605758983965`*^9}, {
   3.6739606621018853`*^9, 3.6739606623230314`*^9}, {3.67396074951875*^9, 
   3.6739607651578217`*^9}, 3.6739608003758087`*^9, {3.6739608309238358`*^9, 
   3.6739608923054633`*^9}, {3.6739609228653135`*^9, 3.673960952675433*^9}, {
   3.6739610730196896`*^9, 3.6739610734279795`*^9}, {3.6739611142172585`*^9, 
   3.6739611271223965`*^9}, {3.673961215362084*^9, 3.673961239925948*^9}, {
   3.6739612997390113`*^9, 3.6739613055771427`*^9}, {3.6739614347725005`*^9, 
   3.6739614351928167`*^9}, {3.673961707192651*^9, 3.673961707995201*^9}, {
   3.673966823266259*^9, 3.673966838865396*^9}, {3.6739669780776787`*^9, 
   3.6739670661352005`*^9}, {3.6739671435412855`*^9, 
   3.6739671494119864`*^9}, {3.673967236716508*^9, 3.6739672923371677`*^9}, {
   3.673967368978699*^9, 3.6739673723891115`*^9}, {3.6739674441681967`*^9, 
   3.6739674457005215`*^9}, {3.6739678230641937`*^9, 
   3.6739678478810234`*^9}, {3.6739679123084316`*^9, 
   3.6739679124855566`*^9}, {3.6739679858194447`*^9, 3.673968045251151*^9}, {
   3.673968233797269*^9, 3.6739682362369957`*^9}, {3.673968291331209*^9, 
   3.673968292630464*^9}, 3.6739685230883436`*^9, {3.6739686432611074`*^9, 
   3.6739686609796486`*^9}, {3.673968716215867*^9, 3.673968723677152*^9}, {
   3.673969149662871*^9, 3.6739691498309746`*^9}, {3.6739691966778245`*^9, 
   3.6739693257335367`*^9}, 3.673969371998455*^9, {3.67396942342133*^9, 
   3.673969475993932*^9}, {3.6739695306305943`*^9, 3.673969535552066*^9}, {
   3.6739696372790723`*^9, 3.673969724196949*^9}, {3.6739697561220074`*^9, 
   3.673969791606324*^9}, {3.673969828187126*^9, 3.673969838881569*^9}, {
   3.6739699272010336`*^9, 3.6739699334624643`*^9}, {3.6739699725492954`*^9, 
   3.6739699780622044`*^9}, {3.6739700186042604`*^9, 
   3.6739700489399614`*^9}, {3.673970203145501*^9, 3.673970232118738*^9}, {
   3.6739702778327103`*^9, 3.673970345139363*^9}, {3.673970431612547*^9, 
   3.6739704811846275`*^9}, {3.6739705484040365`*^9, 
   3.6739706030465713`*^9}, {3.6739706625336685`*^9, 3.673970689976085*^9}, {
   3.6739707277173586`*^9, 3.6739707635917463`*^9}, {3.6739709562746754`*^9, 
   3.6739710109110937`*^9}, {3.6739712547372074`*^9, 3.673971277194564*^9}, {
   3.673971391622418*^9, 3.673971394260285*^9}, {3.67397190253568*^9, 
   3.6739719028879128`*^9}, {3.6739719471121855`*^9, 
   3.6739720680060015`*^9}, {3.6739721391417475`*^9, 
   3.6739721574680986`*^9}, {3.673972353179961*^9, 3.6739724003243294`*^9}, {
   3.6739725680715184`*^9, 3.673972591589943*^9}, {3.673972628709941*^9, 
   3.6739727920707045`*^9}, {3.6739730064022427`*^9, 
   3.6739730354934063`*^9}, {3.6739752498520555`*^9, 
   3.6739752514111586`*^9}, {3.67397546897766*^9, 3.673975488328012*^9}, {
   3.673975526159814*^9, 3.6739755314728503`*^9}, {3.6740499731264524`*^9, 
   3.6740500796072702`*^9}, 3.6740555507887745`*^9, {3.6740555815183525`*^9, 
   3.674055601239813*^9}, {3.674055969014518*^9, 3.674055985861971*^9}, {
   3.674056565694069*^9, 3.674056573889284*^9}, {3.6740834056948586`*^9, 
   3.6740834122887187`*^9}, {3.674083679379135*^9, 3.6740837144934764`*^9}, {
   3.6740837864679565`*^9, 3.6740837894229965`*^9}, {3.674094065241339*^9, 
   3.67409407741335*^9}, 3.6740941138215566`*^9, {3.6740947103837276`*^9, 
   3.6740947109150248`*^9}, {3.6740949076143413`*^9, 3.674094978771393*^9}, {
   3.6740950391939335`*^9, 3.6740950395064373`*^9}, 3.674131521720171*^9, {
   3.6741324692471895`*^9, 3.6741325027631817`*^9}, {3.6741325791858997`*^9, 
   3.6741325797171583`*^9}, {3.674132638155302*^9, 3.674132647889779*^9}, {
   3.6741361928057795`*^9, 3.674136202752822*^9}, {3.674136324271484*^9, 
   3.674136344638443*^9}, {3.6741364636880445`*^9, 3.674136550059143*^9}, {
   3.674136595036003*^9, 3.6741366168917675`*^9}, {3.6741368630246167`*^9, 
   3.674136931584176*^9}, {3.6741370242228107`*^9, 3.674137080017968*^9}, {
   3.6741371121025705`*^9, 3.6741372326387596`*^9}, {3.6741373308842344`*^9, 
   3.6741373351872873`*^9}, {3.6741374558583813`*^9, 
   3.6741374583981643`*^9}, {3.674137585616272*^9, 3.6741375920398226`*^9}, {
   3.674137686031395*^9, 3.6741377370579166`*^9}, {3.674137816978996*^9, 
   3.674137824550782*^9}, {3.6741378839732*^9, 3.674137884337453*^9}, {
   3.6741380645033937`*^9, 3.6741380657846355`*^9}, {3.6741381764459057`*^9, 
   3.674138202252847*^9}, 3.6741382781562295`*^9, {3.674138562091731*^9, 
   3.6741385917508507`*^9}, {3.674138754666978*^9, 3.674138834011633*^9}, {
   3.674139299319475*^9, 3.674139316617753*^9}, {3.674139412749478*^9, 
   3.674139414091428*^9}, {3.6741398956629047`*^9, 3.674139961933466*^9}, 
   3.674140094902833*^9, {3.6741402635511184`*^9, 3.674140361241271*^9}, {
   3.6741421266294537`*^9, 3.674142127791026*^9}, {3.6741426420199676`*^9, 
   3.67414264222409*^9}, 3.6741426777563353`*^9, 3.6741427463939705`*^9, 
   3.6741433506756735`*^9, 3.674146186580044*^9, {3.67414628683115*^9, 
   3.674146320818235*^9}, 3.67414637438415*^9, {3.6742207477118435`*^9, 
   3.674220759571376*^9}, {3.6742208349313726`*^9, 3.6742208556659713`*^9}, {
   3.674220921525921*^9, 3.674220940650824*^9}, {3.674221019050217*^9, 
   3.6742210582001467`*^9}, {3.674221092617381*^9, 3.6742211052268953`*^9}, {
   3.6742211475985336`*^9, 3.674221211272711*^9}, 3.674221413184474*^9, {
   3.674221559607686*^9, 3.674221575124629*^9}, {3.674221614453142*^9, 
   3.674221689452499*^9}, {3.6742217277028327`*^9, 3.6742217816012416`*^9}, {
   3.6742218394429464`*^9, 3.674221842996265*^9}, {3.674221877824658*^9, 
   3.674221977258808*^9}, {3.6742220304623985`*^9, 3.674222058396611*^9}, {
   3.674222101725156*^9, 3.6742221033189206`*^9}, {3.674222135834138*^9, 
   3.674222182665962*^9}, {3.6742222458030663`*^9, 3.6742223251475058`*^9}, {
   3.6742255106837606`*^9, 3.6742255108244457`*^9}, {3.6742255603008156`*^9, 
   3.674225560972698*^9}, {3.6742256215546045`*^9, 3.674225701070924*^9}, {
   3.6742258654545417`*^9, 3.674225886311721*^9}, {3.6742259299501934`*^9, 
   3.6742260188291245`*^9}, {3.6742260588405714`*^9, 
   3.6742260757313356`*^9}, {3.6742261143517656`*^9, 
   3.6742261265393715`*^9}, {3.6742262569310865`*^9, 3.674226301103372*^9}, {
   3.674226712214514*^9, 3.674226824183483*^9}, {3.674226859965103*^9, 
   3.6742268864536242`*^9}, {3.674226928636197*^9, 3.674226931464306*^9}, {
   3.6742270496529317`*^9, 3.6742271560524373`*^9}, {3.6742272359844913`*^9, 
   3.6742272489846015`*^9}, {3.674227279209446*^9, 3.6742272948033333`*^9}, {
   3.6742274554918365`*^9, 3.674227505623352*^9}, {3.674227631664957*^9, 
   3.6742276773145046`*^9}, {3.6742277384868746`*^9, 
   3.6742277602839804`*^9}, {3.6742278416279445`*^9, 
   3.6742278441285305`*^9}, {3.6744146989364567`*^9, 3.67441470326462*^9}, {
   3.674489973360666*^9, 3.674490003939086*^9}, {3.6745108533508167`*^9, 
   3.674510855145809*^9}, 3.674510968555752*^9, {3.674511086553774*^9, 
   3.6745111308154664`*^9}, {3.6745586492680693`*^9, 
   3.6745586792124705`*^9}, {3.674558964223284*^9, 3.674558998936411*^9}, {
   3.6745590330667744`*^9, 3.674559034655714*^9}, 3.6745590952042427`*^9, {
   3.6745591499546967`*^9, 3.674559255044944*^9}, {3.674559291420251*^9, 
   3.674559313139115*^9}, {3.674559370748971*^9, 3.674559372794505*^9}, {
   3.6745595119853916`*^9, 3.6745595141363325`*^9}, {3.67455959393531*^9, 
   3.674559609716688*^9}, {3.674559654498316*^9, 3.674559724134754*^9}, {
   3.674559795667215*^9, 3.6745597977922325`*^9}, {3.67456846522324*^9, 
   3.674568508378586*^9}, {3.6745685596916294`*^9, 3.6745686043452325`*^9}, {
   3.6745686369548798`*^9, 3.674568653328556*^9}, {3.674592554916816*^9, 
   3.674592602469204*^9}, {3.674744388195582*^9, 3.6747443921956377`*^9}, {
   3.674745581328828*^9, 3.674745589848678*^9}, {3.6747462986329875`*^9, 
   3.6747463022892685`*^9}, 3.6747464189338365`*^9, {3.6747466691974707`*^9, 
   3.674746669666224*^9}, {3.6747467077133636`*^9, 3.6747467077759156`*^9}, {
   3.6757705781721034`*^9, 3.675770589562889*^9}, {3.6757707933769007`*^9, 
   3.6757707972981873`*^9}, 3.6757713690421743`*^9, {3.6757716186225767`*^9, 
   3.675771679279419*^9}, {3.675771712670349*^9, 3.6757717140140705`*^9}, {
   3.6757717680302258`*^9, 3.675771770153266*^9}, {3.6757719199261365`*^9, 
   3.675771954544061*^9}, 3.6757719885080786`*^9, {3.6757720378366375`*^9, 
   3.67577207339069*^9}, {3.67577211475049*^9, 3.6757721214536324`*^9}, {
   3.675772160563409*^9, 3.6757721700791197`*^9}, 3.6757722495016804`*^9, {
   3.6757723615794425`*^9, 3.6757723824565134`*^9}, {3.6757725258796597`*^9, 
   3.6757725290984783`*^9}, {3.675772640490115*^9, 3.6757726435370193`*^9}, {
   3.6757726806311083`*^9, 3.675772681974842*^9}, {3.675772714334543*^9, 
   3.6757727234908752`*^9}, {3.675772760622547*^9, 3.675772794287079*^9}, {
   3.6757728371290593`*^9, 3.675772859457337*^9}, {3.6757730457827764`*^9, 
   3.6757730887675095`*^9}, {3.675773163539539*^9, 3.675773200318803*^9}, {
   3.675773288161422*^9, 3.6757733491463547`*^9}, {3.675773479741291*^9, 
   3.6757734869002547`*^9}, {3.675773519728676*^9, 3.6757735371208425`*^9}, {
   3.675773836476241*^9, 3.675773963769446*^9}, {3.6757741369344597`*^9, 
   3.6757741528702307`*^9}, {3.675774322418597*^9, 3.675774497343319*^9}, {
   3.6757745408905926`*^9, 3.675774544875004*^9}, {3.6757746100435295`*^9, 
   3.6757747919027557`*^9}, 3.67577482737179*^9, {3.675774859521158*^9, 
   3.675774875871264*^9}, {3.6757749122934694`*^9, 3.6757750343200192`*^9}, {
   3.6757750645547104`*^9, 3.67577509055028*^9}, {3.675775123595117*^9, 
   3.675775220328929*^9}, {3.6757752730637865`*^9, 3.6757754257209387`*^9}, {
   3.6757754657213*^9, 3.675775472451902*^9}, {3.675775507124282*^9, 
   3.6757755865547495`*^9}, {3.6757756231957173`*^9, 3.675775626555125*^9}, {
   3.675775766224976*^9, 3.6757757681312428`*^9}, {3.675775808069066*^9, 
   3.6757758665696*^9}, {3.675775910413789*^9, 3.675775921163886*^9}, {
   3.675776353473915*^9, 3.6757763559739385`*^9}, {3.6757764123963284`*^9, 
   3.675776422392927*^9}, {3.675776861618325*^9, 3.675776864930831*^9}, {
   3.6757802569774647`*^9, 3.6757802743994975`*^9}, {3.675781028919408*^9, 
   3.675781041669528*^9}, {3.675782930547036*^9, 3.675783009927327*^9}, {
   3.675783051187708*^9, 3.675783054122012*^9}, {3.6757831087125497`*^9, 
   3.6757831550517845`*^9}, {3.6757831857708144`*^9, 
   3.6757831873489137`*^9}, {3.675783253818306*^9, 3.6757832565839577`*^9}, 
   3.6757834130076227`*^9, {3.6757835935861597`*^9, 3.6757836043987584`*^9}, {
   3.6757836628524165`*^9, 3.6757836824932213`*^9}, {3.6757837639919825`*^9, 
   3.6757838132503347`*^9}, {3.675783871068635*^9, 3.675783897897005*^9}, {
   3.6757839312723074`*^9, 3.675783993132243*^9}, {3.6757840309138412`*^9, 
   3.675784084389863*^9}, {3.675784128199237*^9, 3.6757841794773517`*^9}, {
   3.6757842280559225`*^9, 3.6757842589244184`*^9}, {3.6757843209314566`*^9, 
   3.6757843233221254`*^9}, {3.6757843641506186`*^9, 
   3.6757843707288017`*^9}, {3.6757844210417633`*^9, 
   3.6757844211823473`*^9}, {3.675784498735611*^9, 3.6757845384078484`*^9}, {
   3.6806233149682055`*^9, 3.6806233168719425`*^9}, 3.680623408311277*^9, {
   3.6806234576879416`*^9, 3.6806234720577717`*^9}, {3.680623561975819*^9, 
   3.6806235629460735`*^9}, {3.68062764590633*^9, 3.680627660490895*^9}, {
   3.680627701609051*^9, 3.680627740204986*^9}, {3.6806284465062428`*^9, 
   3.680628453654925*^9}, {3.6900001480212307`*^9, 3.690000166109762*^9}, 
   3.711452004474148*^9},ExpressionUUID->"c77bcf6c-30c0-4f95-bf20-\
28ca0c182834"],

Cell["\<\
Be careful when calling RemoveSymbol;  it invalidates all functions that rely \
on that symbol\
\>", "Text",
 CellChangeTimes->{{3.6808110497690353`*^9, 3.6808110987437243`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"RemoveSymbol", ",", " ", 
     RowBox[{"{", 
      RowBox[{"HoldFirst", ",", " ", "Listable"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RemoveSymbol", "[", "var_Symbol", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"ToString", "@", 
         RowBox[{"Unevaluated", "[", "var", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RemoveSymbol", "[", 
        RowBox[{"Evaluate", "@", "v"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveSymbol", "[", "var_String", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "c", ",", " ", "v"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"separate", " ", "context", " ", "from", " ", "name"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ctxt", ":", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"___", " ", "~~", " ", "\"\<`\>\""}], ")"}], "..."}]}], 
         " ", "~~", " ", 
         RowBox[{"x", ":", 
          RowBox[{
           RowBox[{"(", "_", ")"}], ".."}]}]}], " ", "\[RuleDelayed]", " ", 
        RowBox[{"{", 
         RowBox[{"ctxt", ",", " ", "x"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"c", ",", " ", "n"}], "}"}], " ", "=", " ", 
       RowBox[{"First", "@", 
        RowBox[{"StringCases", "[", 
         RowBox[{"var", ",", " ", "v"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "all", " ", "variables", " ", "that", " ", "end", " ", 
        "in", " ", "var"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"c", " ", "<>", " ", "\"\<d*\>\"", " ", "<>", " ", "n"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"Names", "@", "v"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "search", " ", "for", " ", "variables", " ", "with", " ", "derivative",
         " ", "naming", " ", "scheme"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"StringCases", "[", 
        RowBox[{"v", ",", " ", 
         RowBox[{"StartOfString", " ", "~~", " ", "c", " ", "~~", " ", 
          RowBox[{"\"\<d\>\"", ".."}], " ", "~~", " ", "n"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"Flatten", "@", "v"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"remove", " ", "derivative", " ", "names"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Remove", " ", "/@", " ", "v"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "return", " ", "symbols", " ", "removed", " ", "as", " ", "list", " ", 
        "of", " ", "strings"}], " ", "*)"}], "\[IndentingNewLine]", "v"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6737752075217705`*^9, 3.6737752237142305`*^9}, {
   3.673775346449882*^9, 3.673775452389614*^9}, {3.6737754901868753`*^9, 
   3.673775546531165*^9}, {3.673775623235116*^9, 3.673775660615316*^9}, {
   3.673775697098228*^9, 3.6737756974888577`*^9}, {3.6737757801341896`*^9, 
   3.673775780899822*^9}, {3.6737759208543453`*^9, 3.6737759371670523`*^9}, {
   3.673775973245551*^9, 3.67377597388618*^9}, 3.6737799704665446`*^9, 
   3.6737800484942694`*^9, {3.673794797634432*^9, 3.6737948230409384`*^9}, {
   3.673795043513568*^9, 3.6737950643419075`*^9}, {3.6737951331082344`*^9, 
   3.6737951743832383`*^9}, {3.6737954606126666`*^9, 3.673795483861678*^9}, {
   3.673795521612008*^9, 3.673795530278427*^9}, 3.673795564676546*^9, {
   3.6737955989893937`*^9, 3.6737956057863026`*^9}, {3.6737956660838366`*^9, 
   3.6737956858340373`*^9}, 3.673795754706541*^9, {3.6737959235832744`*^9, 
   3.673795924880163*^9}, {3.673796215029808*^9, 3.6737962897805967`*^9}, {
   3.6737963760667915`*^9, 3.6737964208594756`*^9}, {3.673796452969143*^9, 
   3.673796456844225*^9}, {3.6737965235011168`*^9, 3.673796523922995*^9}, {
   3.673797207210251*^9, 3.673797210304031*^9}, {3.6738855265096807`*^9, 
   3.673885526697178*^9}, {3.6738855773695774`*^9, 3.6738855830593653`*^9}, {
   3.6738856137002897`*^9, 3.6738856382842007`*^9}, {3.6738860576256104`*^9, 
   3.6738860850675306`*^9}, {3.673886123630392*^9, 3.673886171880924*^9}, {
   3.673886277882703*^9, 3.6738862925859985`*^9}, {3.6738864169941473`*^9, 
   3.673886417259779*^9}, {3.6738873631818895`*^9, 3.6738873876941566`*^9}, {
   3.673888765079525*^9, 3.6738887687423315`*^9}, {3.6739585531379128`*^9, 
   3.673958558013003*^9}, {3.673958607435384*^9, 3.6739586479721537`*^9}, {
   3.673958709597747*^9, 3.673958754583924*^9}, {3.673958858526533*^9, 
   3.6739589288103437`*^9}, {3.673958967268575*^9, 3.673958984753089*^9}, {
   3.6739590344880157`*^9, 3.673959293440839*^9}, {3.6739594015086823`*^9, 
   3.6739594104150257`*^9}, {3.673959451090667*^9, 3.6739594778409433`*^9}, {
   3.6739596031766605`*^9, 3.6739596202706027`*^9}, {3.6739596620609665`*^9, 
   3.6739596819674053`*^9}, {3.6739597159288726`*^9, 3.673959716741381*^9}, {
   3.673959789071333*^9, 3.6739598523376064`*^9}, {3.6739599470054264`*^9, 
   3.6739599504273367`*^9}, {3.6739599888593016`*^9, 3.673959989703114*^9}, {
   3.6739601222947917`*^9, 3.67396014565073*^9}, {3.6739602334506607`*^9, 
   3.6739602335972376`*^9}, {3.673960342812605*^9, 3.6739603453824353`*^9}, {
   3.673960377913246*^9, 3.673960406508582*^9}, {3.6739605189106183`*^9, 
   3.6739605196763625`*^9}, {3.673960554044932*^9, 3.6739605758983965`*^9}, {
   3.6739606621018853`*^9, 3.6739606623230314`*^9}, {3.67396074951875*^9, 
   3.6739607651578217`*^9}, 3.6739608003758087`*^9, {3.6739608309238358`*^9, 
   3.6739608923054633`*^9}, {3.6739609228653135`*^9, 3.673960952675433*^9}, {
   3.6739610730196896`*^9, 3.6739610734279795`*^9}, {3.6739611142172585`*^9, 
   3.6739611271223965`*^9}, {3.673961215362084*^9, 3.673961239925948*^9}, {
   3.6739612997390113`*^9, 3.6739613055771427`*^9}, {3.6739614347725005`*^9, 
   3.6739614351928167`*^9}, {3.673961707192651*^9, 3.673961707995201*^9}, {
   3.673966823266259*^9, 3.673966838865396*^9}, {3.6739669780776787`*^9, 
   3.6739670661352005`*^9}, {3.6739671435412855`*^9, 
   3.6739671494119864`*^9}, {3.673967236716508*^9, 3.6739672923371677`*^9}, {
   3.673967368978699*^9, 3.6739673723891115`*^9}, {3.6739674441681967`*^9, 
   3.6739674457005215`*^9}, {3.6739678230641937`*^9, 
   3.6739678478810234`*^9}, {3.6739679123084316`*^9, 
   3.6739679124855566`*^9}, {3.6739679858194447`*^9, 3.673968045251151*^9}, {
   3.673968233797269*^9, 3.6739682362369957`*^9}, {3.673968291331209*^9, 
   3.673968292630464*^9}, 3.6739685230883436`*^9, {3.6739686432611074`*^9, 
   3.6739686609796486`*^9}, {3.673968716215867*^9, 3.673968723677152*^9}, {
   3.673969149662871*^9, 3.6739691498309746`*^9}, {3.6739691966778245`*^9, 
   3.6739693257335367`*^9}, 3.673969371998455*^9, {3.67396942342133*^9, 
   3.673969475993932*^9}, {3.6739695306305943`*^9, 3.673969535552066*^9}, {
   3.6739696372790723`*^9, 3.673969724196949*^9}, {3.6739697561220074`*^9, 
   3.673969791606324*^9}, {3.673969828187126*^9, 3.673969838881569*^9}, {
   3.6739699272010336`*^9, 3.6739699334624643`*^9}, {3.6739699725492954`*^9, 
   3.6739699780622044`*^9}, {3.6739700186042604`*^9, 
   3.6739700489399614`*^9}, {3.673970203145501*^9, 3.673970232118738*^9}, {
   3.6739702778327103`*^9, 3.673970345139363*^9}, {3.673970431612547*^9, 
   3.6739704811846275`*^9}, {3.6739705484040365`*^9, 
   3.6739706030465713`*^9}, {3.6739706625336685`*^9, 3.673970689976085*^9}, {
   3.6739707277173586`*^9, 3.6739707635917463`*^9}, {3.6739709562746754`*^9, 
   3.6739710109110937`*^9}, {3.6739712547372074`*^9, 3.673971277194564*^9}, {
   3.673971391622418*^9, 3.673971394260285*^9}, {3.67397190253568*^9, 
   3.6739719028879128`*^9}, {3.6739719471121855`*^9, 
   3.6739720680060015`*^9}, {3.6739721391417475`*^9, 
   3.6739721574680986`*^9}, {3.673972353179961*^9, 3.6739724003243294`*^9}, {
   3.6739725680715184`*^9, 3.673972591589943*^9}, {3.673972628709941*^9, 
   3.6739727920707045`*^9}, {3.6739730064022427`*^9, 
   3.6739730354934063`*^9}, {3.6739752498520555`*^9, 
   3.6739752514111586`*^9}, {3.67397546897766*^9, 3.673975488328012*^9}, {
   3.673975526159814*^9, 3.6739755314728503`*^9}, {3.6740499731264524`*^9, 
   3.6740500796072702`*^9}, 3.6740555507887745`*^9, {3.6740555815183525`*^9, 
   3.674055601239813*^9}, {3.674055969014518*^9, 3.674055985861971*^9}, {
   3.674056565694069*^9, 3.674056573889284*^9}, {3.6740834056948586`*^9, 
   3.6740834122887187`*^9}, {3.674083679379135*^9, 3.6740837144934764`*^9}, {
   3.6740837864679565`*^9, 3.6740837894229965`*^9}, {3.674094065241339*^9, 
   3.67409407741335*^9}, 3.6740941138215566`*^9, {3.6740947103837276`*^9, 
   3.6740947109150248`*^9}, {3.6740949076143413`*^9, 3.674094978771393*^9}, {
   3.6740950391939335`*^9, 3.6740950395064373`*^9}, 3.674131521720171*^9, {
   3.6741324692471895`*^9, 3.6741325027631817`*^9}, {3.6741325791858997`*^9, 
   3.6741325797171583`*^9}, {3.674132638155302*^9, 3.674132647889779*^9}, {
   3.6741361928057795`*^9, 3.674136202752822*^9}, {3.674136324271484*^9, 
   3.674136344638443*^9}, {3.6741364636880445`*^9, 3.674136550059143*^9}, {
   3.674136595036003*^9, 3.6741366168917675`*^9}, {3.6741368630246167`*^9, 
   3.674136931584176*^9}, {3.6741370242228107`*^9, 3.674137080017968*^9}, {
   3.6741371121025705`*^9, 3.6741372326387596`*^9}, {3.6741373308842344`*^9, 
   3.6741373351872873`*^9}, {3.6741374558583813`*^9, 
   3.6741374583981643`*^9}, {3.674137585616272*^9, 3.6741375920398226`*^9}, {
   3.674137686031395*^9, 3.6741377370579166`*^9}, {3.674137816978996*^9, 
   3.674137824550782*^9}, {3.6741378839732*^9, 3.674137884337453*^9}, {
   3.6741380645033937`*^9, 3.6741380657846355`*^9}, {3.6741381764459057`*^9, 
   3.674138202252847*^9}, 3.6741382781562295`*^9, {3.674138562091731*^9, 
   3.6741385917508507`*^9}, {3.674138754666978*^9, 3.674138834011633*^9}, {
   3.674139299319475*^9, 3.674139316617753*^9}, {3.674139412749478*^9, 
   3.674139414091428*^9}, {3.6741398956629047`*^9, 3.6741399035561056`*^9}, 
   3.6741407429175577`*^9, {3.674140782593667*^9, 3.6741407973241024`*^9}, {
   3.6741408657338743`*^9, 3.6741408661151347`*^9}, {3.6741409009101505`*^9, 
   3.6741409215154443`*^9}, {3.6741421686186438`*^9, 
   3.6741421767255716`*^9}, {3.6741423323259106`*^9, 3.6741423477648726`*^9}, 
   3.674142379254033*^9, {3.6741424487235045`*^9, 3.6741424546739473`*^9}, {
   3.674142594762895*^9, 3.67414259793513*^9}, 3.67414330837022*^9, {
   3.674143376841564*^9, 3.674143406730744*^9}, {3.674143501373417*^9, 
   3.67414350279042*^9}, {3.674143569909083*^9, 3.6741435842869997`*^9}, {
   3.6741436904723063`*^9, 3.674143717476016*^9}, {3.6743977369508753`*^9, 
   3.674397752341589*^9}, 3.67448847065062*^9, {3.6744897769348454`*^9, 
   3.674489788684944*^9}, {3.674490050611354*^9, 3.6744900508144813`*^9}, {
   3.674490093408531*^9, 3.674490119924434*^9}, 3.6744902217084465`*^9, {
   3.674490275302642*^9, 3.674490290474642*^9}, 3.674490471586581*^9, {
   3.6744905526965804`*^9, 3.6744905597591963`*^9}, {3.6744908917960577`*^9, 
   3.6744908951398315`*^9}, {3.6745088643657503`*^9, 
   3.6745088744812284`*^9}, {3.6745089124181266`*^9, 3.674508921255444*^9}, {
   3.674509803413085*^9, 3.67450988137139*^9}, {3.6745100942640147`*^9, 
   3.6745101051277223`*^9}, 3.67451075569634*^9, {3.674554984485078*^9, 
   3.674555073922599*^9}, {3.6745553902332077`*^9, 3.674555434285221*^9}, {
   3.6745554724157023`*^9, 3.6745554767594895`*^9}, {3.6745556187450523`*^9, 
   3.6745556248857265`*^9}, {3.674555945285783*^9, 3.6745559773954277`*^9}, {
   3.6745563335847287`*^9, 3.6745563358191233`*^9}, 3.6745566638478537`*^9, 
   3.6745567675925236`*^9, {3.6745568386865797`*^9, 3.6745568582274947`*^9}, 
   3.67455688845483*^9, {3.6747457401860647`*^9, 3.674745756967487*^9}, {
   3.674745807842934*^9, 3.6747458404994583`*^9}, {3.675770249651641*^9, 
   3.675770253268054*^9}, 3.675786307640068*^9, {3.6759747374419937`*^9, 
   3.6759747380878534`*^9}, {3.680270344086667*^9, 3.680270355292096*^9}, 
   3.680270394060491*^9, {3.6802705591246147`*^9, 3.680270563827787*^9}, {
   3.6802707111747723`*^9, 3.6802707640122476`*^9}, {3.6802708192090845`*^9, 
   3.680270877626829*^9}, {3.680270938407501*^9, 3.6802709644445767`*^9}, {
   3.6802710590716877`*^9, 3.6802711267744913`*^9}, 3.6802711996002483`*^9, {
   3.680271334731707*^9, 3.680271346079465*^9}, {3.6802714007294273`*^9, 
   3.680271536934873*^9}, {3.6802716173797693`*^9, 3.6802717418392057`*^9}, {
   3.6802718153402615`*^9, 3.6802719498124294`*^9}, {3.680272003314989*^9, 
   3.680272056050046*^9}, {3.680272113129386*^9, 3.6802721674089823`*^9}, {
   3.680272201871133*^9, 3.6802722257096496`*^9}, {3.6802722644510336`*^9, 
   3.6802722658523827`*^9}, {3.6802723520863047`*^9, 
   3.6802724564511137`*^9}, {3.6802725032664847`*^9, 
   3.6802725379155273`*^9}, {3.680272573947277*^9, 3.680272627862105*^9}, {
   3.680272668219139*^9, 3.6802726900954313`*^9}, {3.6802727701565847`*^9, 
   3.6802727885688443`*^9}, {3.680274262815241*^9, 3.6802742779474235`*^9}, {
   3.6802743080647645`*^9, 3.680274308689774*^9}, {3.6802913653683715`*^9, 
   3.6802913833440027`*^9}, {3.6802914527241054`*^9, 
   3.6802914533803005`*^9}, {3.680291606556071*^9, 3.6802916073142457`*^9}, {
   3.6804531393653507`*^9, 3.6804531430610447`*^9}, {3.6806281541759443`*^9, 
   3.6806282451763573`*^9}, {3.6806282790427723`*^9, 
   3.6806282810186844`*^9}, {3.6806295156626816`*^9, 
   3.6806295459517508`*^9}, {3.680629624645421*^9, 3.6806296427946725`*^9}, {
   3.680629815237889*^9, 3.680629907515896*^9}, {3.680629938360465*^9, 
   3.6806299455321083`*^9}, 3.6806300017509484`*^9, {3.680630192635589*^9, 
   3.6806301928148575`*^9}, {3.680811152878066*^9, 
   3.680811153423451*^9}},ExpressionUUID->"ddacbb74-b94a-47c8-a75e-\
54f0351aa4a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Helper Operation on Symbols", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731965721044188`*^9}, {
  3.6731969304344425`*^9, 3.6731969451064043`*^9}, {3.6747457640925713`*^9, 
  3.674745797077217*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateIndices", "[", "d_Integer", "]"}], " ", ":=", " ", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Symbol", "[", 
        RowBox[{"\"\<\[FormalD]\>\"", " ", "<>", " ", 
         RowBox[{"ToString", "@", "i"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "d"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"CreateArguments", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateArguments", "[", 
     RowBox[{"x_List", ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Flatten", "@", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"e", ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"CreateSymbol", "[", 
            RowBox[{"e", ",", " ", "j"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "0", ",", " ", "d"}], "}"}]}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldFirst"}], "}"}]}], "]"}], "[", 
       "x", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"CreateArgumentsString", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateArgumentsString", "[", 
     RowBox[{"x_List", ",", " ", 
      RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Flatten", "@", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"e", ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"CreateSymbolString", "[", 
            RowBox[{"e", ",", " ", "j"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "0", ",", " ", "d"}], "}"}]}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldFirst"}], "}"}]}], "]"}], "[", 
       "x", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"CreateFunctionArguments", ",", " ", "HoldFirst"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateFunctionArguments", "[", 
     RowBox[{
      RowBox[{"f_Symbol", "[", "x___", "]"}], ",", " ", 
      RowBox[{"d_Integer:", "0"}], ",", " ", 
      RowBox[{"fcn_:", "Identity"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"F", ",", " ", "a", ",", " ", "s"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"Unevaluated", "@", "#"}]}], "&"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F", " ", "=", " ", 
        RowBox[{"CreateSymbol", "[", 
         RowBox[{
          RowBox[{"f", "[", "]"}], ",", " ", "d", ",", " ", "s"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Thread", "@", 
         RowBox[{"\[FormalP]", "[", 
          RowBox[{"{", "x", "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"CreateSymbol", "[", 
            RowBox[{
             RowBox[{"Evaluate", "@", "i"}], ",", " ", "j", ",", " ", "s"}], 
            "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "a"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "0", ",", " ", "d"}], "}"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"StringRiffle", "[", 
         RowBox[{"a", ",", " ", "\"\<, \>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F", " ", "=", " ", 
        RowBox[{"StringInsert", "[", 
         RowBox[{"F", ",", " ", "a", ",", " ", 
          RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"F", ",", " ", "InputForm", ",", " ", "fcn"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"CreateDerivative", ",", " ", "HoldFirst"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDerivative", "[", 
    RowBox[{"x_", ",", " ", 
     RowBox[{"e_Integer:", " ", "0"}], ",", " ", 
     RowBox[{"d_Integer:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d", " ", "\[Equal]", " ", "0"}], ",", " ", "x", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"e", " ", "<", " ", 
      RowBox[{"2", "^", "d"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", " ", "=", " ", 
         RowBox[{"Derivative", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Reverse", "@", 
            RowBox[{"PadLeft", "[", 
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{"e", ",", " ", "2"}], "]"}], ",", " ", "d"}], 
             "]"}]}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CreateSymbol", "[", 
        RowBox[{
         RowBox[{"f", "[", "x", "]"}], ",", " ", "0"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "True", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Throw", "[", "$Failed", "]"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6737752075217705`*^9, 3.6737752237142305`*^9}, {
   3.673775346449882*^9, 3.673775452389614*^9}, {3.6737754901868753`*^9, 
   3.673775546531165*^9}, {3.673775623235116*^9, 3.673775660615316*^9}, {
   3.673775697098228*^9, 3.6737756974888577`*^9}, {3.6737757801341896`*^9, 
   3.673775780899822*^9}, {3.6737759208543453`*^9, 3.6737759371670523`*^9}, {
   3.673775973245551*^9, 3.67377597388618*^9}, 3.6737799704665446`*^9, 
   3.6737800484942694`*^9, {3.673794797634432*^9, 3.6737948230409384`*^9}, {
   3.673795043513568*^9, 3.6737950643419075`*^9}, {3.6737951331082344`*^9, 
   3.6737951743832383`*^9}, {3.6737954606126666`*^9, 3.673795483861678*^9}, {
   3.673795521612008*^9, 3.673795530278427*^9}, 3.673795564676546*^9, {
   3.6737955989893937`*^9, 3.6737956057863026`*^9}, {3.6737956660838366`*^9, 
   3.6737956858340373`*^9}, 3.673795754706541*^9, {3.6737959235832744`*^9, 
   3.673795924880163*^9}, {3.673796215029808*^9, 3.6737962897805967`*^9}, {
   3.6737963760667915`*^9, 3.6737964208594756`*^9}, {3.673796452969143*^9, 
   3.673796456844225*^9}, {3.6737965235011168`*^9, 3.673796523922995*^9}, {
   3.673797207210251*^9, 3.673797210304031*^9}, {3.6738855265096807`*^9, 
   3.673885526697178*^9}, {3.6738855773695774`*^9, 3.6738855830593653`*^9}, {
   3.6738856137002897`*^9, 3.6738856382842007`*^9}, {3.6738860576256104`*^9, 
   3.6738860850675306`*^9}, {3.673886123630392*^9, 3.673886171880924*^9}, {
   3.673886277882703*^9, 3.6738862925859985`*^9}, {3.6738864169941473`*^9, 
   3.673886417259779*^9}, {3.6738873631818895`*^9, 3.6738873876941566`*^9}, {
   3.673888765079525*^9, 3.6738887687423315`*^9}, {3.6739585531379128`*^9, 
   3.673958558013003*^9}, {3.673958607435384*^9, 3.6739586479721537`*^9}, {
   3.673958709597747*^9, 3.673958754583924*^9}, {3.673958858526533*^9, 
   3.6739589288103437`*^9}, {3.673958967268575*^9, 3.673958984753089*^9}, {
   3.6739590344880157`*^9, 3.673959293440839*^9}, {3.6739594015086823`*^9, 
   3.6739594104150257`*^9}, {3.673959451090667*^9, 3.6739594778409433`*^9}, {
   3.6739596031766605`*^9, 3.6739596202706027`*^9}, {3.6739596620609665`*^9, 
   3.6739596819674053`*^9}, {3.6739597159288726`*^9, 3.673959716741381*^9}, {
   3.673959789071333*^9, 3.6739598523376064`*^9}, {3.6739599470054264`*^9, 
   3.6739599504273367`*^9}, {3.6739599888593016`*^9, 3.673959989703114*^9}, {
   3.6739601222947917`*^9, 3.67396014565073*^9}, {3.6739602334506607`*^9, 
   3.6739602335972376`*^9}, {3.673960342812605*^9, 3.6739603453824353`*^9}, {
   3.673960377913246*^9, 3.673960406508582*^9}, {3.6739605189106183`*^9, 
   3.6739605196763625`*^9}, {3.673960554044932*^9, 3.6739605758983965`*^9}, {
   3.6739606621018853`*^9, 3.6739606623230314`*^9}, {3.67396074951875*^9, 
   3.6739607651578217`*^9}, 3.6739608003758087`*^9, {3.6739608309238358`*^9, 
   3.6739608923054633`*^9}, {3.6739609228653135`*^9, 3.673960952675433*^9}, {
   3.6739610730196896`*^9, 3.6739610734279795`*^9}, {3.6739611142172585`*^9, 
   3.6739611271223965`*^9}, {3.673961215362084*^9, 3.673961239925948*^9}, {
   3.6739612997390113`*^9, 3.6739613055771427`*^9}, {3.6739614347725005`*^9, 
   3.6739614351928167`*^9}, {3.673961707192651*^9, 3.673961707995201*^9}, {
   3.673966823266259*^9, 3.673966838865396*^9}, {3.6739669780776787`*^9, 
   3.6739670661352005`*^9}, {3.6739671435412855`*^9, 
   3.6739671494119864`*^9}, {3.673967236716508*^9, 3.6739672923371677`*^9}, {
   3.673967368978699*^9, 3.6739673723891115`*^9}, {3.6739674441681967`*^9, 
   3.6739674457005215`*^9}, {3.6739678230641937`*^9, 
   3.6739678478810234`*^9}, {3.6739679123084316`*^9, 
   3.6739679124855566`*^9}, {3.6739679858194447`*^9, 3.673968045251151*^9}, {
   3.673968233797269*^9, 3.6739682362369957`*^9}, {3.673968291331209*^9, 
   3.673968292630464*^9}, 3.6739685230883436`*^9, {3.6739686432611074`*^9, 
   3.6739686609796486`*^9}, {3.673968716215867*^9, 3.673968723677152*^9}, {
   3.673969149662871*^9, 3.6739691498309746`*^9}, {3.6739691966778245`*^9, 
   3.6739693257335367`*^9}, 3.673969371998455*^9, {3.67396942342133*^9, 
   3.673969475993932*^9}, {3.6739695306305943`*^9, 3.673969535552066*^9}, {
   3.6739696372790723`*^9, 3.673969724196949*^9}, {3.6739697561220074`*^9, 
   3.673969791606324*^9}, {3.673969828187126*^9, 3.673969838881569*^9}, {
   3.6739699272010336`*^9, 3.6739699334624643`*^9}, {3.6739699725492954`*^9, 
   3.6739699780622044`*^9}, {3.6739700186042604`*^9, 
   3.6739700489399614`*^9}, {3.673970203145501*^9, 3.673970232118738*^9}, {
   3.6739702778327103`*^9, 3.673970345139363*^9}, {3.673970431612547*^9, 
   3.6739704811846275`*^9}, {3.6739705484040365`*^9, 
   3.6739706030465713`*^9}, {3.6739706625336685`*^9, 3.673970689976085*^9}, {
   3.6739707277173586`*^9, 3.6739707635917463`*^9}, {3.6739709562746754`*^9, 
   3.6739710109110937`*^9}, {3.6739712547372074`*^9, 3.673971277194564*^9}, {
   3.673971391622418*^9, 3.673971394260285*^9}, {3.67397190253568*^9, 
   3.6739719028879128`*^9}, {3.6739719471121855`*^9, 
   3.6739720680060015`*^9}, {3.6739721391417475`*^9, 
   3.6739721574680986`*^9}, {3.673972353179961*^9, 3.6739724003243294`*^9}, {
   3.6739725680715184`*^9, 3.673972591589943*^9}, {3.673972628709941*^9, 
   3.6739727920707045`*^9}, {3.6739730064022427`*^9, 
   3.6739730354934063`*^9}, {3.6739752498520555`*^9, 
   3.6739752514111586`*^9}, {3.67397546897766*^9, 3.673975488328012*^9}, {
   3.673975526159814*^9, 3.6739755314728503`*^9}, {3.6740499731264524`*^9, 
   3.6740500796072702`*^9}, 3.6740555507887745`*^9, {3.6740555815183525`*^9, 
   3.674055601239813*^9}, {3.674055969014518*^9, 3.674055985861971*^9}, {
   3.674056565694069*^9, 3.674056573889284*^9}, {3.6740834056948586`*^9, 
   3.6740834122887187`*^9}, {3.674083679379135*^9, 3.6740837144934764`*^9}, {
   3.6740837864679565`*^9, 3.6740837894229965`*^9}, {3.674094065241339*^9, 
   3.67409407741335*^9}, 3.6740941138215566`*^9, {3.6740947103837276`*^9, 
   3.6740947109150248`*^9}, {3.6740949076143413`*^9, 3.674094978771393*^9}, {
   3.6740950391939335`*^9, 3.6740950395064373`*^9}, 3.674131521720171*^9, {
   3.6741324692471895`*^9, 3.6741325027631817`*^9}, {3.6741325791858997`*^9, 
   3.6741325797171583`*^9}, {3.674132638155302*^9, 3.674132647889779*^9}, {
   3.6741361928057795`*^9, 3.674136202752822*^9}, {3.674136324271484*^9, 
   3.674136344638443*^9}, {3.6741364636880445`*^9, 3.674136550059143*^9}, {
   3.674136595036003*^9, 3.6741366168917675`*^9}, {3.6741368630246167`*^9, 
   3.674136931584176*^9}, {3.6741370242228107`*^9, 3.674137080017968*^9}, {
   3.6741371121025705`*^9, 3.6741372326387596`*^9}, {3.6741373308842344`*^9, 
   3.6741373351872873`*^9}, {3.6741374558583813`*^9, 
   3.6741374583981643`*^9}, {3.674137585616272*^9, 3.6741375920398226`*^9}, {
   3.674137686031395*^9, 3.6741377370579166`*^9}, {3.674137816978996*^9, 
   3.674137824550782*^9}, {3.6741378839732*^9, 3.674137884337453*^9}, {
   3.6741380645033937`*^9, 3.6741380657846355`*^9}, {3.6741381764459057`*^9, 
   3.674138202252847*^9}, 3.6741382781562295`*^9, {3.674138562091731*^9, 
   3.6741385917508507`*^9}, {3.674138754666978*^9, 3.674138834011633*^9}, {
   3.674139299319475*^9, 3.674139316617753*^9}, {3.674139412749478*^9, 
   3.674139414091428*^9}, {3.6741398956629047`*^9, 3.6741399035561056`*^9}, 
   3.6741407429175577`*^9, {3.674140782593667*^9, 3.6741407973241024`*^9}, {
   3.6741408657338743`*^9, 3.6741408661151347`*^9}, {3.6741409009101505`*^9, 
   3.6741409215154443`*^9}, {3.6741421686186438`*^9, 
   3.6741421767255716`*^9}, {3.6741423323259106`*^9, 3.6741423477648726`*^9}, 
   3.674142379254033*^9, {3.6741424487235045`*^9, 3.6741424546739473`*^9}, {
   3.674142594762895*^9, 3.67414259793513*^9}, 3.67414330837022*^9, {
   3.674143376841564*^9, 3.674143406730744*^9}, {3.674143501373417*^9, 
   3.67414350279042*^9}, {3.674143569909083*^9, 3.6741435842869997`*^9}, {
   3.6741436904723063`*^9, 3.674143717476016*^9}, {3.6743977369508753`*^9, 
   3.674397752341589*^9}, 3.67448847065062*^9, {3.6744897769348454`*^9, 
   3.674489788684944*^9}, {3.674490050611354*^9, 3.6744900508144813`*^9}, {
   3.674490093408531*^9, 3.674490119924434*^9}, 3.6744902217084465`*^9, {
   3.674490275302642*^9, 3.674490290474642*^9}, 3.674490471586581*^9, {
   3.6744905526965804`*^9, 3.6744905597591963`*^9}, {3.6744908917960577`*^9, 
   3.6744908951398315`*^9}, {3.6745088643657503`*^9, 
   3.6745088744812284`*^9}, {3.6745089124181266`*^9, 3.674508921255444*^9}, {
   3.674509803413085*^9, 3.67450988137139*^9}, {3.6745100942640147`*^9, 
   3.6745101051277223`*^9}, 3.67451075569634*^9, {3.674554984485078*^9, 
   3.674555073922599*^9}, {3.6745553902332077`*^9, 3.674555434285221*^9}, {
   3.6745554724157023`*^9, 3.6745554767594895`*^9}, {3.6745556187450523`*^9, 
   3.6745556248857265`*^9}, {3.674555945285783*^9, 3.6745559773954277`*^9}, {
   3.6745563335847287`*^9, 3.6745563358191233`*^9}, 3.6745566638478537`*^9, 
   3.6745567675925236`*^9, {3.6745568386865797`*^9, 3.6745568582274947`*^9}, 
   3.67455688845483*^9, {3.6747457401860647`*^9, 3.674745756967487*^9}, {
   3.674745807842934*^9, 3.6747458404994583`*^9}, {3.675770249651641*^9, 
   3.675770253268054*^9}, 3.675786307640068*^9, {3.6759747374419937`*^9, 
   3.6759747380878534`*^9}, {3.680270344086667*^9, 3.680270355292096*^9}, {
   3.6802741179201374`*^9, 3.6802742391745787`*^9}, {3.6802821179095926`*^9, 
   3.6802821668609667`*^9}, {3.6802907697266474`*^9, 
   3.6802907822744865`*^9}, {3.6802917067167416`*^9, 3.680291707038537*^9}, {
   3.6900308372222195`*^9, 3.690030851968383*^9}, {3.6900309027294493`*^9, 
   3.690030904036872*^9}, {3.6900309699028006`*^9, 3.690030988615835*^9}, {
   3.690031041853674*^9, 3.6900310784789295`*^9}, {3.690031172670656*^9, 
   3.690031174362857*^9}, {3.690031211702496*^9, 3.6900312122518225`*^9}, {
   3.6900313266636667`*^9, 3.690031359425372*^9}, 3.6900315122819834`*^9, {
   3.6900315443794947`*^9, 3.6900315633838987`*^9}, {3.6900316184476657`*^9, 
   3.6900316285264688`*^9}, {3.6900316645850043`*^9, 
   3.6900317175154266`*^9}, {3.6900317630509686`*^9, 
   3.6900317649363117`*^9}, {3.690031804566496*^9, 3.6900318056596155`*^9}, {
   3.6900319109218116`*^9, 3.690031917380597*^9}, {3.6900320719487925`*^9, 
   3.6900320936798024`*^9}, {3.6900325711254797`*^9, 
   3.6900325717786536`*^9}, {3.6900327569007263`*^9, 
   3.6900328571799116`*^9}, {3.690032891640417*^9, 3.6900329209999866`*^9}, {
   3.6900330972138796`*^9, 3.690033098768771*^9}, {3.690033290478998*^9, 
   3.690033312141954*^9}, {3.6900333574384656`*^9, 3.690033357657527*^9}, 
   3.690033558242984*^9, {3.69003405381384*^9, 3.6900340556832795`*^9}, 
   3.690124910814717*^9, {3.690173331578236*^9, 3.690173341359583*^9}, {
   3.690173835661953*^9, 3.6901738365994635`*^9}, {3.690175432813879*^9, 
   3.6901755027979736`*^9}, {3.690175982402154*^9, 3.6901759831631956`*^9}, 
   3.6901762622050395`*^9, {3.690176450844133*^9, 3.6901764513285513`*^9}, {
   3.6901766228599653`*^9, 3.6901766283600173`*^9}, 3.690177084494856*^9, {
   3.6901774578691173`*^9, 3.690177469436447*^9}, 3.6901775816034603`*^9, {
   3.690178290295664*^9, 3.6901782948938*^9}, {3.6901783320296817`*^9, 
   3.690178376694784*^9}, {3.690178631808369*^9, 3.6901786577604856`*^9}, 
   3.690178694468111*^9, {3.690178754756912*^9, 3.690178788694527*^9}, {
   3.6901788620473337`*^9, 3.690178874929681*^9}, {3.690178929989312*^9, 
   3.690178932116807*^9}, 3.690179535746106*^9, {3.6901796537401505`*^9, 
   3.6901797111801596`*^9}, {3.6902884119747925`*^9, 
   3.6902885783549004`*^9}, {3.6902886167380576`*^9, 
   3.6902886204620657`*^9}, {3.6902886876537795`*^9, 
   3.6902888134332066`*^9}, {3.6902889052110696`*^9, 3.690288908062372*^9}, {
   3.690288966719201*^9, 3.6902890191060424`*^9}, {3.6902892080292363`*^9, 
   3.6902892144125423`*^9}, {3.6902892545011787`*^9, 
   3.6902893327552505`*^9}, {3.690289383870048*^9, 3.690289420738666*^9}, 
   3.690289529566307*^9, {3.6902895732845483`*^9, 3.690289626674752*^9}, {
   3.690289691045003*^9, 3.6902897102337117`*^9}, {3.6902897919917226`*^9, 
   3.690289792541278*^9}, {3.690289835585598*^9, 3.69028987303226*^9}, {
   3.690290175223054*^9, 3.690290257832358*^9}, 3.6902903117414265`*^9, {
   3.6902906533380804`*^9, 3.690290773028154*^9}, {3.6902908064831376`*^9, 
   3.6902909422810926`*^9}, {3.6902909802215924`*^9, 3.690290981377909*^9}, {
   3.6902911312231417`*^9, 3.690291160871073*^9}, {3.6902912164028716`*^9, 
   3.690291244325026*^9}, {3.6902912881067066`*^9, 3.6902913211049533`*^9}, {
   3.690291360986388*^9, 3.690291469716216*^9}, 3.690291500342491*^9, {
   3.690291782116509*^9, 3.6902919025250998`*^9}, {3.690291939822304*^9, 
   3.690292015057458*^9}, {3.690292069398548*^9, 3.690292093749915*^9}, {
   3.7115596237318316`*^9, 3.711559627903741*^9}, {3.7115672702001305`*^9, 
   3.711567297934737*^9}, {3.7115723291946287`*^9, 3.7115723371478195`*^9}, {
   3.711572386429483*^9, 3.711572441570567*^9}, {3.7115802775875835`*^9, 
   3.7115802943689566`*^9}, {3.7115803300724325`*^9, 3.71158033338491*^9}, 
   3.7115803912916403`*^9, {3.717346497811919*^9, 
   3.717346506155755*^9}},ExpressionUUID->"eceb5adb-4596-401a-a23d-\
5cd3c1be4d9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on a Function\[CloseCurlyQuote]s Argument List", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731965721044188`*^9}, {
  3.6731969304344425`*^9, 3.6731969451064043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DifferentiateFunctionArguments", "[", 
    RowBox[{"fcn_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "m", ",", " ", "a", ",", " ", "f", ",", " ", "g", ",", " ", "h"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "function", " ", "name"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"fcn", ",", " ", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{
            RowBox[{"_", "[", 
             RowBox[{"f_", "[", "___", "]"}], "]"}], " ", "\[RuleDelayed]", 
            " ", "_"}], "]"}], " ", "\[RuleDelayed]", " ", 
          RowBox[{"HoldPattern", "[", 
           RowBox[{"f", "[", "___", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "function", " ", "arguments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"fcn", ",", " ", 
         RowBox[{"First", "@", "f"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Extract", "[", 
        RowBox[{"fcn", ",", " ", "m", ",", " ", "Hold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Level", "[", 
        RowBox[{"a", ",", " ", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}], ",", " ", "Hold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"List", "@", 
        RowBox[{"ReleaseHold", "[", 
         RowBox[{"ToString", " ", "/@", " ", 
          RowBox[{"Unevaluated", " ", "/@", " ", "a"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "derivatives", " ", "of", " ", "function", " ", 
        "arguments"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"e", ",", " ", 
         RowBox[{"CreateSymbolString", "[", 
          RowBox[{"e", ",", " ", "1"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"NestList", "[", 
          RowBox[{"g", ",", " ", "a", ",", " ", "n"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", " ", "<>", " ", "\"\<_\>\""}], "&"}], " ", "/@", " ", 
        "a"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"#", ",", " ", "InputForm", ",", " ", "\[FormalP]"}], "]"}],
          "&"}], " ", "/@", " ", "a"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "name", " ", "derivative", " ", "of", " ", "function"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1", ",", "0"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"ToExpression", "[", 
        RowBox[{
         RowBox[{"CreateSymbolString", "[", 
          RowBox[{"f", ",", " ", "n"}], "]"}], ",", " ", "InputForm", ",", 
         " ", "\[FormalP]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"apply", " ", "changes"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"fcn", ",", " ", 
         RowBox[{"m", " ", "\[Rule]", " ", 
          RowBox[{"h", "[", 
           RowBox[{"Sequence", "@@", "a"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", " ", "/.", " ", 
        RowBox[{"h", "  ", "\[Rule]", " ", "f"}]}], " ", "/.", " ", 
       RowBox[{
        RowBox[{"\[FormalP]", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
        "x"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675852559095492*^9, 3.6758526005665092`*^9}, {
   3.675852638794781*^9, 3.6758527256703796`*^9}, {3.6758527643980584`*^9, 
   3.675852818752815*^9}, {3.6758529099131413`*^9, 3.675852966676566*^9}, {
   3.6758578249026623`*^9, 3.6758578250745354`*^9}, 3.675857862154739*^9, {
   3.675857900451767*^9, 3.675857969558747*^9}, {3.6758581815040193`*^9, 
   3.6758582055094147`*^9}, {3.67585823603784*^9, 3.6758583321746173`*^9}, {
   3.675879764795976*^9, 3.675879787858631*^9}, {3.675879865766116*^9, 
   3.675879877406808*^9}, {3.6758863349903274`*^9, 3.6758863379516673`*^9}, {
   3.6758863682310247`*^9, 3.675886375748584*^9}, {3.6758864112527*^9, 
   3.675886494023069*^9}, {3.6758865288626986`*^9, 3.6758865461481266`*^9}, {
   3.675886593640811*^9, 3.6758866756512003`*^9}, {3.6758867223140106`*^9, 
   3.6758867419783382`*^9}, {3.6758868052484355`*^9, 3.6758868599948063`*^9}, 
   3.675980165406312*^9, {3.6759812674454913`*^9, 3.675981270728127*^9}, 
   3.6759813236348577`*^9, {3.67598146854243*^9, 3.675981524364826*^9}, {
   3.675981989184648*^9, 3.6759819933803215`*^9}, {3.675982036393283*^9, 
   3.6759821162458982`*^9}, {3.67598216462138*^9, 3.675982247086104*^9}, {
   3.675982290554811*^9, 3.6759823048674445`*^9}, {3.675982348086548*^9, 
   3.675982383740429*^9}, {3.6759835508590326`*^9, 3.675983562489318*^9}, {
   3.675984151248223*^9, 3.675984151966982*^9}, {3.675984241990823*^9, 
   3.675984250072523*^9}, {3.6760063289413104`*^9, 3.6760064017259526`*^9}, {
   3.676006442096138*^9, 3.676006452535214*^9}, {3.6760065315976877`*^9, 
   3.676006540751976*^9}, {3.676006603485303*^9, 3.6760066640015554`*^9}, {
   3.676006723920705*^9, 3.6760067739893694`*^9}, {3.6760068924877634`*^9, 
   3.6760068926908903`*^9}, {3.676007639493997*^9, 3.6760077263555036`*^9}, {
   3.6760077866958275`*^9, 3.676007810124922*^9}, {3.6760078473219304`*^9, 
   3.6760078484275765`*^9}, {3.6760079642749453`*^9, 
   3.6760079746840925`*^9}, {3.676008041011874*^9, 3.676008068578596*^9}, {
   3.676008122095397*^9, 3.6760081650723248`*^9}, 3.676008214697836*^9, 
   3.676008249363363*^9, {3.6760082868324137`*^9, 3.676008306205616*^9}, {
   3.6760083472792535`*^9, 3.6760083783342514`*^9}, {3.676008456047983*^9, 
   3.6760085477161655`*^9}, {3.6802236951381454`*^9, 
   3.6802236984429483`*^9}, {3.6803967182176676`*^9, 3.680396721746566*^9}, {
   3.6803969428034906`*^9, 3.680396971609646*^9}, 3.680397124570052*^9, {
   3.680397245546956*^9, 3.6803972471698647`*^9}, {3.6803973385098767`*^9, 
   3.6803973409903097`*^9}, {3.680397372303419*^9, 3.6803974008254433`*^9}, 
   3.6901648698769903`*^9, {3.6901733126561747`*^9, 
   3.6901733253906717`*^9}},ExpressionUUID->"745e8d23-5e52-46b3-a28e-\
02053da667e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on a Function\[CloseCurlyQuote]s Local Argument List", \
"Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731965721044188`*^9}, {
  3.6731969304344425`*^9, 3.6731969451064043`*^9}, {3.6731970691884212`*^9, 
  3.673197069750886*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DifferentiateLocalArguments", "[", 
    RowBox[{"fcn_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "a", ",", " ", "f"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "globally", " ", "inspect", " ", "function", " ", "and", " ", "extract",
        " ", "symbols"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"ToString", "@", 
          RowBox[{"Unevaluated", "@", "x"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldFirst"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"fcn", ",", " ", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{"Module", "[", 
            RowBox[{"x_", ",", " ", "y_"}], "]"}], "]"}], " ", 
          "\[RuleDelayed]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"v", "[", "x", "]"}], ",", " ", 
            RowBox[{"ExtractVariables", "[", 
             RowBox[{"y", ",", " ", "v"}], "]"}]}], "}"}]}], ",", " ", 
         "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"separate", " ", "variables", " ", "and", " ", "indices"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "a"}], " ", ">", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "v"}], "}"}], " ", "=", " ", 
          RowBox[{"First", "@", "a"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"Thread", "@", "a"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"what", " ", "does", " ", "this", " ", 
           RowBox[{"do", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"v", " ", "=", " ", 
          RowBox[{"GroupBy", "[", 
           RowBox[{"a", ",", " ", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"v", "[", "True", "]"}], ",", " ", "#"}], "]"}], 
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"a", " ", "=", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{"v", ",", " ", "True", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"v", " ", "=", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{"v", ",", " ", "False", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"differentiate", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"e", ",", " ", 
         RowBox[{"CreateSymbolString", "[", 
          RowBox[{"e", ",", " ", "1"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"NestList", "[", 
          RowBox[{"f", ",", " ", "a", ",", " ", "n"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"ToExpression", "[", 
          RowBox[{"#", ",", " ", "InputForm", ",", " ", "\[FormalP]"}], "]"}],
          "&"}], " ", "/@", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"a", ",", " ", "v"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"modify", " ", "function"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"fcn", " ", "/.", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", 
          RowBox[{"Module", "[", 
           RowBox[{"_", ",", " ", "y_"}], "]"}], "]"}], " ", "\[RuleDelayed]",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{"a", ",", " ", "y"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "/.", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", "a", "]"}], " ", "\[Rule]", " ", "a"}]}],
        "  ", "/.", " ", 
       RowBox[{
        RowBox[{"\[FormalP]", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
        "x"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675852559095492*^9, 3.6758526005665092`*^9}, {
   3.675852638794781*^9, 3.6758527256703796`*^9}, {3.6758527643980584`*^9, 
   3.675852818752815*^9}, {3.6758529099131413`*^9, 3.675852966676566*^9}, {
   3.6758578249026623`*^9, 3.6758578250745354`*^9}, 3.675857862154739*^9, {
   3.675857900451767*^9, 3.675857969558747*^9}, {3.6758581815040193`*^9, 
   3.6758582055094147`*^9}, {3.67585823603784*^9, 3.6758583321746173`*^9}, {
   3.675879764795976*^9, 3.675879787858631*^9}, {3.675879865766116*^9, 
   3.675879877406808*^9}, {3.6758863349903274`*^9, 3.6758863379516673`*^9}, {
   3.6758863682310247`*^9, 3.675886375748584*^9}, {3.6758864112527*^9, 
   3.675886494023069*^9}, {3.6758865288626986`*^9, 3.6758865461481266`*^9}, {
   3.675886593640811*^9, 3.6758866756512003`*^9}, {3.6758867223140106`*^9, 
   3.6758867419783382`*^9}, {3.6758868052484355`*^9, 
   3.6758868599948063`*^9}, {3.6759017308160725`*^9, 
   3.6759017650694847`*^9}, {3.6759018263825397`*^9, 
   3.6759018266169233`*^9}, {3.6759019082553654`*^9, 3.675901918052294*^9}, {
   3.675902010756301*^9, 3.675902016553228*^9}, {3.6759020871978226`*^9, 
   3.6759021979396453`*^9}, {3.675902363206814*^9, 3.675902375769433*^9}, {
   3.675902471544259*^9, 3.6759024774942613`*^9}, {3.6759734802249823`*^9, 
   3.6759735684835086`*^9}, {3.675973619857312*^9, 3.6759736209198437`*^9}, {
   3.675973716742591*^9, 3.675973727771285*^9}, {3.675973797474278*^9, 
   3.6759738663013105`*^9}, {3.675973909200125*^9, 3.6759740588144093`*^9}, {
   3.675974327082424*^9, 3.6759743694799557`*^9}, {3.67597440869619*^9, 
   3.6759745480724525`*^9}, {3.6759801456092577`*^9, 
   3.6759801458592567`*^9}, {3.6759824449285355`*^9, 
   3.6759824471560593`*^9}, {3.675982491015834*^9, 3.675982542157648*^9}, {
   3.6759835327000227`*^9, 3.6759835408631287`*^9}, {3.6760068225923176`*^9, 
   3.676006852530034*^9}, {3.676006887065835*^9, 3.6760068874564686`*^9}, {
   3.6760069229567876`*^9, 3.676006928019333*^9}, {3.6760069593152637`*^9, 
   3.676006985378003*^9}, {3.7115728364332438`*^9, 3.7115728383707595`*^9}, 
   3.7115747961318493`*^9, {3.7115748937324862`*^9, 3.711574895076231*^9}, {
   3.7115749681080914`*^9, 3.711574987092642*^9}, {3.7115750224054203`*^9, 
   3.7115750296554947`*^9}, {3.711575308235936*^9, 3.7115753646582828`*^9}, 
   3.711575416877486*^9, {3.7115754677216454`*^9, 3.711575468299774*^9}, {
   3.7115755818521442`*^9, 3.7115756505870953`*^9}, {3.7115756845873785`*^9, 
   3.711575688665537*^9}, {3.7115759140580997`*^9, 
   3.7115759310894413`*^9}},ExpressionUUID->"f3805c01-9b62-4e37-b635-\
29b206040d55"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Subfunctions", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
   3.6729235256788254`*^9}, {3.6731965701825666`*^9, 
   3.6731965721044188`*^9}, {3.6731969304344425`*^9, 
   3.6731969451064043`*^9}, {3.6731973450357323`*^9, 
   3.6731973537233086`*^9}, {3.673197534746973*^9, 3.673197537325123*^9}, 
   3.673197872216854*^9, {3.6731980165476217`*^9, 3.6731980166726274`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ExtractSubfunctions", ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractSubfunctions", "[", 
    RowBox[{"expr_", ",", " ", 
     RowBox[{"fcn_:", "Identity"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", " ", "f"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "apply", " ", "fcn", " ", "and", " ", "convert", " ", "symbol", " ", 
       "to", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fcn", "@", "x"}], ",", " ", 
           RowBox[{"ToString", "@", 
            RowBox[{"Unevaluated", "@", "x"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"extract", " ", "all", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Hold", "@", "expr"}], ",", " ", 
         RowBox[{
          RowBox[{"f_Symbol", "[", "___", "]"}], " ", "\[RuleDelayed]", " ", 
          RowBox[{"h", "@", "f"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", "f", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "group", " ", "System", " ", "functions", " ", "under", " ", "False"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{
        RowBox[{"StringFreeQ", "[", 
         RowBox[{
          RowBox[{"Context", "[", 
           RowBox[{"Evaluate", "@", 
            RowBox[{"Last", "@", "#"}]}], "]"}], ",", " ", 
          RowBox[{"StartOfString", "~~", "\"\<System`\>\""}]}], "]"}], 
        "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"GroupBy", "[", 
         RowBox[{"f", ",", " ", "h"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "All", ",", " ", "1"}], 
        "\[RightDoubleBracket]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"make", " ", "Part", " ", "safe"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", " ", 
        RowBox[{"GroupBy", "[", 
         RowBox[{"f", ",", " ", "h"}], "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231473762894`*^9, 3.67292333059666*^9}, {
   3.672923569896279*^9, 3.6729235971152735`*^9}, {3.6729236576325245`*^9, 
   3.672923778232132*^9}, {3.67292382112319*^9, 3.672923822203421*^9}, {
   3.672933886099881*^9, 3.672933913901292*^9}, {3.6729339542354774`*^9, 
   3.672934116763858*^9}, {3.6729341568736563`*^9, 3.67293418242076*^9}, {
   3.6729346973963056`*^9, 3.672934708755745*^9}, {3.6729347744438443`*^9, 
   3.6729347795883484`*^9}, {3.6729348324603205`*^9, 3.672934876447199*^9}, {
   3.672934919614563*^9, 3.672934934793215*^9}, {3.6729350147431393`*^9, 
   3.672935044958498*^9}, {3.6729350802676315`*^9, 3.672935092689661*^9}, {
   3.6729351387809553`*^9, 3.672935159531186*^9}, {3.6729352126566706`*^9, 
   3.67293529614421*^9}, 3.6729353830951786`*^9, {3.672935639630994*^9, 
   3.6729357272039003`*^9}, 3.672937702423049*^9, {3.672937744922078*^9, 
   3.6729377903379717`*^9}, {3.67293788968925*^9, 3.672937939696617*^9}, {
   3.6729379844498577`*^9, 3.6729380008792334`*^9}, {3.672938083670993*^9, 
   3.6729381365376663`*^9}, {3.6729382059697833`*^9, 3.672938219413664*^9}, {
   3.672938301312541*^9, 3.672938321211969*^9}, {3.67293835304044*^9, 
   3.6729383760063505`*^9}, {3.672938550922858*^9, 3.672938619751956*^9}, {
   3.672938661564331*^9, 3.672938666142521*^9}, {3.6729387005211987`*^9, 
   3.6729387569056244`*^9}, {3.672938811214872*^9, 3.672938814326576*^9}, {
   3.672938971020873*^9, 3.672939001369969*^9}, {3.6729390483372555`*^9, 
   3.672939051813734*^9}, {3.672939110853039*^9, 3.672939116118719*^9}, {
   3.6729393516950064`*^9, 3.672939353493438*^9}, 3.672940702976226*^9, {
   3.672942002456709*^9, 3.672942010023283*^9}, {3.672942132038026*^9, 
   3.6729421651053705`*^9}, {3.6729423737093782`*^9, 3.6729424581562014`*^9}, 
   3.6729425192817574`*^9, {3.672942580859954*^9, 3.6729426141050115`*^9}, 
   3.672942660676553*^9, 3.6729428396714945`*^9, {3.6729428744373956`*^9, 
   3.6729428791205645`*^9}, {3.672942927683508*^9, 3.672942992563116*^9}, {
   3.6729430276005516`*^9, 3.672943122465444*^9}, 3.6729431542673244`*^9, {
   3.672943238174302*^9, 3.6729432405337386`*^9}, {3.6729433089185257`*^9, 
   3.6729433118091726`*^9}, 3.6729433697208347`*^9, {3.6729435556082187`*^9, 
   3.6729435747778*^9}, {3.672946687205556*^9, 3.67294671925691*^9}, {
   3.672946881884638*^9, 3.6729469172728367`*^9}, {3.6729469515983715`*^9, 
   3.6729469546648965`*^9}, {3.6729471408857393`*^9, 3.672947145781169*^9}, {
   3.67294721585527*^9, 3.6729472364731436`*^9}, {3.6729472679396877`*^9, 
   3.6729472812522697`*^9}, {3.672947391245015*^9, 3.67294740292869*^9}, {
   3.672966815729293*^9, 3.672966816401171*^9}, {3.6729669268084307`*^9, 
   3.6729669329774275`*^9}, {3.6729672451969414`*^9, 
   3.6729672651497607`*^9}, {3.672967296509385*^9, 3.6729673161502266`*^9}, {
   3.6729673506974177`*^9, 3.6729673590412054`*^9}, {3.672967467042173*^9, 
   3.672967506683215*^9}, {3.67296858325613*^9, 3.672968583990512*^9}, {
   3.672968627647162*^9, 3.6729686346472263`*^9}, {3.672968665897509*^9, 
   3.6729688137658796`*^9}, {3.6729689351536317`*^9, 
   3.6729689401849833`*^9}, {3.6729689729561005`*^9, 3.672968977846769*^9}, {
   3.672969010237632*^9, 3.672969103181587*^9}, {3.6729692950114727`*^9, 
   3.672969324717699*^9}, {3.6729696007983446`*^9, 3.67296960904842*^9}, {
   3.6729696755645933`*^9, 3.6729697808662777`*^9}, {3.672969873924942*^9, 
   3.6729698792062254`*^9}, {3.672970008863673*^9, 3.6729700145981436`*^9}, {
   3.672970068286091*^9, 3.6729700935519867`*^9}, {3.6729701709588995`*^9, 
   3.672970178740264*^9}, {3.6729702579128046`*^9, 3.6729702622307987`*^9}, {
   3.67297340416953*^9, 3.672973405599137*^9}, 3.6729734455838785`*^9, {
   3.6729735297125144`*^9, 3.6729735654776716`*^9}, {3.6729736064468374`*^9, 
   3.672973626212637*^9}, {3.672973664403517*^9, 3.6729736928568616`*^9}, {
   3.672973735638542*^9, 3.672973779107648*^9}, {3.672973832295675*^9, 
   3.6729738405830884`*^9}, 3.6729738914585905`*^9, {3.672973950064999*^9, 
   3.672973976853453*^9}, {3.6729740804064713`*^9, 3.6729740825784245`*^9}, 
   3.672974424774643*^9, {3.6729744893690414`*^9, 3.672974502275411*^9}, {
   3.6729746259866323`*^9, 3.6729746289210978`*^9}, {3.672974690116191*^9, 
   3.672974733517294*^9}, {3.672974815264155*^9, 3.672974820728876*^9}, {
   3.672993064251093*^9, 3.6729930885773406`*^9}, {3.672993134876603*^9, 
   3.672993135470359*^9}, {3.6729932326356907`*^9, 3.6729932427763824`*^9}, {
   3.672993479263315*^9, 3.6729936256398716`*^9}, {3.6729936893162646`*^9, 
   3.672993715113412*^9}, {3.6729937496813855`*^9, 3.672993778670251*^9}, {
   3.6729938988808193`*^9, 3.672993955371016*^9}, {3.67299400763064*^9, 
   3.6729940088181553`*^9}, {3.672994074745188*^9, 3.6729941045464*^9}, {
   3.6729941610799336`*^9, 3.67299420086067*^9}, {3.672994269168688*^9, 
   3.672994315286899*^9}, {3.672994597047865*^9, 3.6729945974541216`*^9}, {
   3.6729947173460193`*^9, 3.6729947691640368`*^9}, {3.672994810617605*^9, 
   3.672994817180175*^9}, {3.672994897500884*^9, 3.6729949006102943`*^9}, {
   3.672994983017383*^9, 3.6729949834080496`*^9}, {3.6729951793438215`*^9, 
   3.672995338503119*^9}, {3.672995424582159*^9, 3.67299548231715*^9}, {
   3.6729955210700097`*^9, 3.6729955976702776`*^9}, {3.6729956311238136`*^9, 
   3.672995662358493*^9}, {3.672995711624671*^9, 3.672995916968398*^9}, {
   3.672996420415288*^9, 3.672996513131817*^9}, {3.6729966176006503`*^9, 
   3.67299663430315*^9}, {3.672996704290532*^9, 3.6729967153218937`*^9}, {
   3.6729967542441473`*^9, 3.6729968334050426`*^9}, {3.672996874377798*^9, 
   3.672996874612172*^9}, 3.672996911018773*^9, {3.6729984047719135`*^9, 
   3.672998444584838*^9}, {3.6729985117418036`*^9, 3.672998515163657*^9}, {
   3.6729985541016283`*^9, 3.6729985877130237`*^9}, {3.672998676056633*^9, 
   3.6729987092501755`*^9}, {3.6729987464983377`*^9, 
   3.6729987479515343`*^9}, {3.6729987788893647`*^9, 
   3.6729987816302924`*^9}, {3.672998932475648*^9, 3.6729990082252407`*^9}, {
   3.6729990588664417`*^9, 3.6729990866948643`*^9}, {3.6729991351538115`*^9, 
   3.6729991504039755`*^9}, {3.672999261655156*^9, 3.6729993557967854`*^9}, {
   3.672999471566995*^9, 3.672999528973894*^9}, {3.672999574321541*^9, 
   3.6729995829622135`*^9}, 3.6730000477994986`*^9, {3.673000112040515*^9, 
   3.673000117649952*^9}, {3.67300015835347*^9, 3.673000181259946*^9}, {
   3.6730002259636035`*^9, 3.6730002926049376`*^9}, {3.673000400574797*^9, 
   3.673000418408077*^9}, {3.6730004726345587`*^9, 3.6730004778377585`*^9}, {
   3.6730005216819744`*^9, 3.6730005263895907`*^9}, {3.6730006655629253`*^9, 
   3.673000756860651*^9}, {3.673001135468763*^9, 3.6730011374062834`*^9}, {
   3.6730012051257534`*^9, 3.6730012066570196`*^9}, {3.6730012649076405`*^9, 
   3.6730013111824493`*^9}, {3.6730013711353936`*^9, 3.673001379869859*^9}, {
   3.6730014761208467`*^9, 3.6730015090118065`*^9}, {3.6730019445789967`*^9, 
   3.6730019759107084`*^9}, {3.6730036460961676`*^9, 3.673003683274808*^9}, {
   3.6730037533536797`*^9, 3.6730037543981867`*^9}, {3.673003799389406*^9, 
   3.6730038000938005`*^9}, {3.673003835411345*^9, 3.67300388243285*^9}, {
   3.6730039407304*^9, 3.6730039433214674`*^9}, {3.6730040123534546`*^9, 
   3.6730040263222976`*^9}, {3.6730040564156885`*^9, 3.673004063572014*^9}, {
   3.673004234045515*^9, 3.6730042375631127`*^9}, {3.673004363743765*^9, 
   3.673004367384425*^9}, {3.673005622106264*^9, 3.673005670731781*^9}, {
   3.673008261426072*^9, 3.673008293193389*^9}, {3.6730083441433067`*^9, 
   3.673008390231715*^9}, {3.6730085249653845`*^9, 3.6730085291832886`*^9}, {
   3.673008567825856*^9, 3.6730085686696167`*^9}, {3.6730086014199657`*^9, 
   3.673008620818368*^9}, {3.6730088113665414`*^9, 3.673008862738968*^9}, 
   3.6730091692670264`*^9, {3.67301460825314*^9, 3.673014622927169*^9}, {
   3.673014975008257*^9, 3.673014976698572*^9}, {3.673092750460484*^9, 
   3.673092774826923*^9}, {3.6730928639959016`*^9, 3.6730928645373955`*^9}, {
   3.6730929276506357`*^9, 3.673092972721137*^9}, 3.673093010045974*^9, {
   3.673093860112836*^9, 3.6730938669156528`*^9}, {3.673094050199472*^9, 
   3.6730940502144833`*^9}, {3.6730955969619827`*^9, 
   3.6730956654961247`*^9}, {3.6730957119099903`*^9, 3.673095792085063*^9}, {
   3.673095835383345*^9, 3.673095838139547*^9}, {3.6730959143719316`*^9, 
   3.6730960079251027`*^9}, {3.6730960424060316`*^9, 3.673096050760952*^9}, {
   3.6730961099118357`*^9, 3.673096265588333*^9}, {3.6730963182130566`*^9, 
   3.6730963470674877`*^9}, {3.6730963778907957`*^9, 3.673096378751799*^9}, {
   3.6730964335914063`*^9, 3.6730964476398587`*^9}, {3.6730971613313665`*^9, 
   3.6730972619091783`*^9}, {3.6730972932797875`*^9, 
   3.6730973185395904`*^9}, {3.6730974355644364`*^9, 
   3.6730974401439705`*^9}, {3.6730974791739235`*^9, 3.673097514069307*^9}, {
   3.673097618411811*^9, 3.6730976809924903`*^9}, {3.6730978226771345`*^9, 
   3.6730978513864813`*^9}, {3.6730979093327*^9, 3.673097955834776*^9}, {
   3.673098500416672*^9, 3.673098501075818*^9}, {3.673098546582277*^9, 
   3.6730985702113013`*^9}, {3.6730986458379383`*^9, 3.6730986740607257`*^9}, 
   3.6730987353600626`*^9, {3.67309877873357*^9, 3.6730989628527126`*^9}, {
   3.673099265340266*^9, 3.6730992755592704`*^9}, {3.673099356590049*^9, 
   3.6730993572225513`*^9}, {3.6731015179516087`*^9, 
   3.6731015883528795`*^9}, {3.673101893687087*^9, 3.673101895237196*^9}, 
   3.6731020955720825`*^9, {3.6731021301269283`*^9, 3.673102180099937*^9}, {
   3.673102234051756*^9, 3.673102234210868*^9}, {3.6731022643032894`*^9, 
   3.6731023221196084`*^9}, {3.6731026258298216`*^9, 
   3.6731026262771387`*^9}, {3.67310270016525*^9, 3.6731027042511435`*^9}, 
   3.673102756466938*^9, {3.6731028462319784`*^9, 3.673102866139098*^9}, {
   3.673102901285778*^9, 3.67310292554869*^9}, {3.673103434381622*^9, 
   3.673103666644972*^9}, {3.67310373690971*^9, 3.6731037879101043`*^9}, {
   3.673103936715156*^9, 3.673103966846873*^9}, {3.6731040077291*^9, 
   3.6731040468099785`*^9}, {3.6731040805498877`*^9, 3.673104122708008*^9}, 
   3.673104206292513*^9, {3.673104243767274*^9, 3.673104283240779*^9}, {
   3.67310432777127*^9, 3.6731043846337824`*^9}, {3.6731045675428305`*^9, 
   3.6731045758822794`*^9}, {3.6731046713889513`*^9, 
   3.6731046997264175`*^9}, {3.6731047421467648`*^9, 
   3.6731048165873084`*^9}, {3.6731049254153643`*^9, 
   3.6731049542995267`*^9}, {3.6731049882954726`*^9, 
   3.6731050106617756`*^9}, {3.67310569894119*^9, 3.673105699073286*^9}, {
   3.673105745006565*^9, 3.6731057483279095`*^9}, {3.673106146342636*^9, 
   3.6731061912192845`*^9}, {3.6731062228228045`*^9, 3.6731062286790547`*^9}, 
   3.673106289217881*^9, {3.673106323860526*^9, 3.6731063626409903`*^9}, {
   3.6731064064518285`*^9, 3.6731064088995595`*^9}, 3.6731064666007247`*^9, {
   3.673106621683176*^9, 3.6731066229614983`*^9}, {3.6731067332981477`*^9, 
   3.67310675742727*^9}, {3.673106902586769*^9, 3.673106905561937*^9}, {
   3.6731070648563223`*^9, 3.6731070655406713`*^9}, {3.673107292061803*^9, 
   3.6731073281018534`*^9}, {3.6731073607169514`*^9, 
   3.6731073699009295`*^9}, {3.6731074550345125`*^9, 
   3.6731074885745087`*^9}, {3.673107632594349*^9, 3.673107640667688*^9}, {
   3.6731077365092077`*^9, 3.67310785155603*^9}, {3.6731078896457987`*^9, 
   3.6731080177531195`*^9}, {3.6731080491259284`*^9, 
   3.6731080760121136`*^9}, {3.673108168532712*^9, 3.6731082188486805`*^9}, 
   3.673108641881422*^9, {3.6731089583820496`*^9, 3.673108963058516*^9}, {
   3.6731090466613784`*^9, 3.673109050472077*^9}, {3.673192807411872*^9, 
   3.6731928114431643`*^9}, 3.673192892678402*^9, 3.673192941438696*^9, {
   3.6731964323296256`*^9, 3.67319643276713*^9}, 3.6731965665887604`*^9, 
   3.673196598970043*^9, {3.673196821994419*^9, 3.6731968290721345`*^9}, {
   3.673196959619616*^9, 3.6731969758228555`*^9}, {3.673197036969309*^9, 
   3.6731970394537625`*^9}, 3.6731973632702403`*^9, {3.6731974319656963`*^9, 
   3.673197435261653*^9}, 3.673197547825222*^9, {3.673197623494339*^9, 
   3.6731976238380957`*^9}, {3.6731976605845723`*^9, 
   3.6731976652053084`*^9}, {3.673197787979232*^9, 3.6731977882917557`*^9}, {
   3.6731978722340717`*^9, 3.6731978722395763`*^9}, {3.6734617881233873`*^9, 
   3.6734617893890295`*^9}, {3.673461834920784*^9, 3.673461836936371*^9}, {
   3.6734618869057293`*^9, 3.6734618902587323`*^9}, {3.673461932431073*^9, 
   3.6734619341967583`*^9}, {3.6734620386255445`*^9, 3.673462040031853*^9}, {
   3.6734621804396544`*^9, 3.6734621821427574`*^9}, {3.6734625674769535`*^9, 
   3.6734625937934833`*^9}, {3.6734626434034066`*^9, 
   3.6734626482327824`*^9}, {3.673462726608646*^9, 3.673462730139936*^9}, 
   3.6734628214827833`*^9, {3.6734629575467844`*^9, 3.6734629593886003`*^9}, {
   3.6734629907170296`*^9, 3.673462991060825*^9}, {3.6734630345144243`*^9, 
   3.673463103832074*^9}, {3.673463137629323*^9, 3.6734631390355887`*^9}, {
   3.6734636370890446`*^9, 3.67346366894877*^9}, {3.6737976003248024`*^9, 
   3.673797601074806*^9}, 3.6737978917948503`*^9, 3.674608729718012*^9, {
   3.674745705728945*^9, 3.6747457133383846`*^9}, {3.6806526940562*^9, 
   3.6806527479478645`*^9}, {3.712075675001467*^9, 
   3.712075682204651*^9}},ExpressionUUID->"31691d20-74ca-4af9-9018-\
9af0b2b1db87"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Derivatives", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
   3.6729235256788254`*^9}, {3.6731965701825666`*^9, 
   3.6731965721044188`*^9}, {3.6731969304344425`*^9, 
   3.6731969451064043`*^9}, {3.6731973450357323`*^9, 
   3.6731973537233086`*^9}, {3.673197534746973*^9, 3.673197537325123*^9}, 
   3.673197872216854*^9, {3.6731980165476217`*^9, 3.6731980166726274`*^9}, {
   3.6747443379139376`*^9, 3.674744339132643*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ExtractDerivatives", ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractDerivatives", "[", 
    RowBox[{"expr_", ",", " ", 
     RowBox[{"fcn_:", "Identity"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", " ", "e", ",", " ", "f"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"fcn", "@", "x"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"Hold", "@", "expr"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"e", ",", " ", 
         RowBox[{"HoldPattern", "[", 
          StyleBox[
           RowBox[{
            RowBox[{"Derivative", "[", "__", "]"}], "[", "_", "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Extract", "[", 
        RowBox[{"e", ",", " ", "f", ",", " ", "h"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", "f", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", " ", 
       RowBox[{"True", "\[Rule]", " ", "f"}], " ", "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231473762894`*^9, 3.67292333059666*^9}, {
   3.672923569896279*^9, 3.6729235971152735`*^9}, {3.6729236576325245`*^9, 
   3.672923778232132*^9}, {3.67292382112319*^9, 3.672923822203421*^9}, {
   3.672933886099881*^9, 3.672933913901292*^9}, {3.6729339542354774`*^9, 
   3.672934116763858*^9}, {3.6729341568736563`*^9, 3.67293418242076*^9}, {
   3.6729346973963056`*^9, 3.672934708755745*^9}, {3.6729347744438443`*^9, 
   3.6729347795883484`*^9}, {3.6729348324603205`*^9, 3.672934876447199*^9}, {
   3.672934919614563*^9, 3.672934934793215*^9}, {3.6729350147431393`*^9, 
   3.672935044958498*^9}, {3.6729350802676315`*^9, 3.672935092689661*^9}, {
   3.6729351387809553`*^9, 3.672935159531186*^9}, {3.6729352126566706`*^9, 
   3.67293529614421*^9}, 3.6729353830951786`*^9, {3.672935639630994*^9, 
   3.6729357272039003`*^9}, 3.672937702423049*^9, {3.672937744922078*^9, 
   3.6729377903379717`*^9}, {3.67293788968925*^9, 3.672937939696617*^9}, {
   3.6729379844498577`*^9, 3.6729380008792334`*^9}, {3.672938083670993*^9, 
   3.6729381365376663`*^9}, {3.6729382059697833`*^9, 3.672938219413664*^9}, {
   3.672938301312541*^9, 3.672938321211969*^9}, {3.67293835304044*^9, 
   3.6729383760063505`*^9}, {3.672938550922858*^9, 3.672938619751956*^9}, {
   3.672938661564331*^9, 3.672938666142521*^9}, {3.6729387005211987`*^9, 
   3.6729387569056244`*^9}, {3.672938811214872*^9, 3.672938814326576*^9}, {
   3.672938971020873*^9, 3.672939001369969*^9}, {3.6729390483372555`*^9, 
   3.672939051813734*^9}, {3.672939110853039*^9, 3.672939116118719*^9}, {
   3.6729393516950064`*^9, 3.672939353493438*^9}, 3.672940702976226*^9, {
   3.672942002456709*^9, 3.672942010023283*^9}, {3.672942132038026*^9, 
   3.6729421651053705`*^9}, {3.6729423737093782`*^9, 3.6729424581562014`*^9}, 
   3.6729425192817574`*^9, {3.672942580859954*^9, 3.6729426141050115`*^9}, 
   3.672942660676553*^9, 3.6729428396714945`*^9, {3.6729428744373956`*^9, 
   3.6729428791205645`*^9}, {3.672942927683508*^9, 3.672942992563116*^9}, {
   3.6729430276005516`*^9, 3.672943122465444*^9}, 3.6729431542673244`*^9, {
   3.672943238174302*^9, 3.6729432405337386`*^9}, {3.6729433089185257`*^9, 
   3.6729433118091726`*^9}, 3.6729433697208347`*^9, {3.6729435556082187`*^9, 
   3.6729435747778*^9}, {3.672946687205556*^9, 3.67294671925691*^9}, {
   3.672946881884638*^9, 3.6729469172728367`*^9}, {3.6729469515983715`*^9, 
   3.6729469546648965`*^9}, {3.6729471408857393`*^9, 3.672947145781169*^9}, {
   3.67294721585527*^9, 3.6729472364731436`*^9}, {3.6729472679396877`*^9, 
   3.6729472812522697`*^9}, {3.672947391245015*^9, 3.67294740292869*^9}, {
   3.672966815729293*^9, 3.672966816401171*^9}, {3.6729669268084307`*^9, 
   3.6729669329774275`*^9}, {3.6729672451969414`*^9, 
   3.6729672651497607`*^9}, {3.672967296509385*^9, 3.6729673161502266`*^9}, {
   3.6729673506974177`*^9, 3.6729673590412054`*^9}, {3.672967467042173*^9, 
   3.672967506683215*^9}, {3.67296858325613*^9, 3.672968583990512*^9}, {
   3.672968627647162*^9, 3.6729686346472263`*^9}, {3.672968665897509*^9, 
   3.6729688137658796`*^9}, {3.6729689351536317`*^9, 
   3.6729689401849833`*^9}, {3.6729689729561005`*^9, 3.672968977846769*^9}, {
   3.672969010237632*^9, 3.672969103181587*^9}, {3.6729692950114727`*^9, 
   3.672969324717699*^9}, {3.6729696007983446`*^9, 3.67296960904842*^9}, {
   3.6729696755645933`*^9, 3.6729697808662777`*^9}, {3.672969873924942*^9, 
   3.6729698792062254`*^9}, {3.672970008863673*^9, 3.6729700145981436`*^9}, {
   3.672970068286091*^9, 3.6729700935519867`*^9}, {3.6729701709588995`*^9, 
   3.672970178740264*^9}, {3.6729702579128046`*^9, 3.6729702622307987`*^9}, {
   3.67297340416953*^9, 3.672973405599137*^9}, 3.6729734455838785`*^9, {
   3.6729735297125144`*^9, 3.6729735654776716`*^9}, {3.6729736064468374`*^9, 
   3.672973626212637*^9}, {3.672973664403517*^9, 3.6729736928568616`*^9}, {
   3.672973735638542*^9, 3.672973779107648*^9}, {3.672973832295675*^9, 
   3.6729738405830884`*^9}, 3.6729738914585905`*^9, {3.672973950064999*^9, 
   3.672973976853453*^9}, {3.6729740804064713`*^9, 3.6729740825784245`*^9}, 
   3.672974424774643*^9, {3.6729744893690414`*^9, 3.672974502275411*^9}, {
   3.6729746259866323`*^9, 3.6729746289210978`*^9}, {3.672974690116191*^9, 
   3.672974733517294*^9}, {3.672974815264155*^9, 3.672974820728876*^9}, {
   3.672993064251093*^9, 3.6729930885773406`*^9}, {3.672993134876603*^9, 
   3.672993135470359*^9}, {3.6729932326356907`*^9, 3.6729932427763824`*^9}, {
   3.672993479263315*^9, 3.6729936256398716`*^9}, {3.6729936893162646`*^9, 
   3.672993715113412*^9}, {3.6729937496813855`*^9, 3.672993778670251*^9}, {
   3.6729938988808193`*^9, 3.672993955371016*^9}, {3.67299400763064*^9, 
   3.6729940088181553`*^9}, {3.672994074745188*^9, 3.6729941045464*^9}, {
   3.6729941610799336`*^9, 3.67299420086067*^9}, {3.672994269168688*^9, 
   3.672994315286899*^9}, {3.672994597047865*^9, 3.6729945974541216`*^9}, {
   3.6729947173460193`*^9, 3.6729947691640368`*^9}, {3.672994810617605*^9, 
   3.672994817180175*^9}, {3.672994897500884*^9, 3.6729949006102943`*^9}, {
   3.672994983017383*^9, 3.6729949834080496`*^9}, {3.6729951793438215`*^9, 
   3.672995338503119*^9}, {3.672995424582159*^9, 3.67299548231715*^9}, {
   3.6729955210700097`*^9, 3.6729955976702776`*^9}, {3.6729956311238136`*^9, 
   3.672995662358493*^9}, {3.672995711624671*^9, 3.672995916968398*^9}, {
   3.672996420415288*^9, 3.672996513131817*^9}, {3.6729966176006503`*^9, 
   3.67299663430315*^9}, {3.672996704290532*^9, 3.6729967153218937`*^9}, {
   3.6729967542441473`*^9, 3.6729968334050426`*^9}, {3.672996874377798*^9, 
   3.672996874612172*^9}, 3.672996911018773*^9, {3.6729984047719135`*^9, 
   3.672998444584838*^9}, {3.6729985117418036`*^9, 3.672998515163657*^9}, {
   3.6729985541016283`*^9, 3.6729985877130237`*^9}, {3.672998676056633*^9, 
   3.6729987092501755`*^9}, {3.6729987464983377`*^9, 
   3.6729987479515343`*^9}, {3.6729987788893647`*^9, 
   3.6729987816302924`*^9}, {3.672998932475648*^9, 3.6729990082252407`*^9}, {
   3.6729990588664417`*^9, 3.6729990866948643`*^9}, {3.6729991351538115`*^9, 
   3.6729991504039755`*^9}, {3.672999261655156*^9, 3.6729993557967854`*^9}, {
   3.672999471566995*^9, 3.672999528973894*^9}, {3.672999574321541*^9, 
   3.6729995829622135`*^9}, 3.6730000477994986`*^9, {3.673000112040515*^9, 
   3.673000117649952*^9}, {3.67300015835347*^9, 3.673000181259946*^9}, {
   3.6730002259636035`*^9, 3.6730002926049376`*^9}, {3.673000400574797*^9, 
   3.673000418408077*^9}, {3.6730004726345587`*^9, 3.6730004778377585`*^9}, {
   3.6730005216819744`*^9, 3.6730005263895907`*^9}, {3.6730006655629253`*^9, 
   3.673000756860651*^9}, {3.673001135468763*^9, 3.6730011374062834`*^9}, {
   3.6730012051257534`*^9, 3.6730012066570196`*^9}, {3.6730012649076405`*^9, 
   3.6730013111824493`*^9}, {3.6730013711353936`*^9, 3.673001379869859*^9}, {
   3.6730014761208467`*^9, 3.6730015090118065`*^9}, {3.6730019445789967`*^9, 
   3.6730019759107084`*^9}, {3.6730036460961676`*^9, 3.673003683274808*^9}, {
   3.6730037533536797`*^9, 3.6730037543981867`*^9}, {3.673003799389406*^9, 
   3.6730038000938005`*^9}, {3.673003835411345*^9, 3.67300388243285*^9}, {
   3.6730039407304*^9, 3.6730039433214674`*^9}, {3.6730040123534546`*^9, 
   3.6730040263222976`*^9}, {3.6730040564156885`*^9, 3.673004063572014*^9}, {
   3.673004234045515*^9, 3.6730042375631127`*^9}, {3.673004363743765*^9, 
   3.673004367384425*^9}, {3.673005622106264*^9, 3.673005670731781*^9}, {
   3.673008261426072*^9, 3.673008293193389*^9}, {3.6730083441433067`*^9, 
   3.673008390231715*^9}, {3.6730085249653845`*^9, 3.6730085291832886`*^9}, {
   3.673008567825856*^9, 3.6730085686696167`*^9}, {3.6730086014199657`*^9, 
   3.673008620818368*^9}, {3.6730088113665414`*^9, 3.673008862738968*^9}, 
   3.6730091692670264`*^9, {3.67301460825314*^9, 3.673014622927169*^9}, {
   3.673014975008257*^9, 3.673014976698572*^9}, {3.673092750460484*^9, 
   3.673092774826923*^9}, {3.6730928639959016`*^9, 3.6730928645373955`*^9}, {
   3.6730929276506357`*^9, 3.673092972721137*^9}, 3.673093010045974*^9, {
   3.673093860112836*^9, 3.6730938669156528`*^9}, {3.673094050199472*^9, 
   3.6730940502144833`*^9}, {3.6730955969619827`*^9, 
   3.6730956654961247`*^9}, {3.6730957119099903`*^9, 3.673095792085063*^9}, {
   3.673095835383345*^9, 3.673095838139547*^9}, {3.6730959143719316`*^9, 
   3.6730960079251027`*^9}, {3.6730960424060316`*^9, 3.673096050760952*^9}, {
   3.6730961099118357`*^9, 3.673096265588333*^9}, {3.6730963182130566`*^9, 
   3.6730963470674877`*^9}, {3.6730963778907957`*^9, 3.673096378751799*^9}, {
   3.6730964335914063`*^9, 3.6730964476398587`*^9}, {3.6730971613313665`*^9, 
   3.6730972619091783`*^9}, {3.6730972932797875`*^9, 
   3.6730973185395904`*^9}, {3.6730974355644364`*^9, 
   3.6730974401439705`*^9}, {3.6730974791739235`*^9, 3.673097514069307*^9}, {
   3.673097618411811*^9, 3.6730976809924903`*^9}, {3.6730978226771345`*^9, 
   3.6730978513864813`*^9}, {3.6730979093327*^9, 3.673097955834776*^9}, {
   3.673098500416672*^9, 3.673098501075818*^9}, {3.673098546582277*^9, 
   3.6730985702113013`*^9}, {3.6730986458379383`*^9, 3.6730986740607257`*^9}, 
   3.6730987353600626`*^9, {3.67309877873357*^9, 3.6730989628527126`*^9}, {
   3.673099265340266*^9, 3.6730992755592704`*^9}, {3.673099356590049*^9, 
   3.6730993572225513`*^9}, {3.6731015179516087`*^9, 
   3.6731015883528795`*^9}, {3.673101893687087*^9, 3.673101895237196*^9}, 
   3.6731020955720825`*^9, {3.6731021301269283`*^9, 3.673102180099937*^9}, {
   3.673102234051756*^9, 3.673102234210868*^9}, {3.6731022643032894`*^9, 
   3.6731023221196084`*^9}, {3.6731026258298216`*^9, 
   3.6731026262771387`*^9}, {3.67310270016525*^9, 3.6731027042511435`*^9}, 
   3.673102756466938*^9, {3.6731028462319784`*^9, 3.673102866139098*^9}, {
   3.673102901285778*^9, 3.67310292554869*^9}, {3.673103434381622*^9, 
   3.673103666644972*^9}, {3.67310373690971*^9, 3.6731037879101043`*^9}, {
   3.673103936715156*^9, 3.673103966846873*^9}, {3.6731040077291*^9, 
   3.6731040468099785`*^9}, {3.6731040805498877`*^9, 3.673104122708008*^9}, 
   3.673104206292513*^9, {3.673104243767274*^9, 3.673104283240779*^9}, {
   3.67310432777127*^9, 3.6731043846337824`*^9}, {3.6731045675428305`*^9, 
   3.6731045758822794`*^9}, {3.6731046713889513`*^9, 
   3.6731046997264175`*^9}, {3.6731047421467648`*^9, 
   3.6731048165873084`*^9}, {3.6731049254153643`*^9, 
   3.6731049542995267`*^9}, {3.6731049882954726`*^9, 
   3.6731050106617756`*^9}, {3.67310569894119*^9, 3.673105699073286*^9}, {
   3.673105745006565*^9, 3.6731057483279095`*^9}, {3.673106146342636*^9, 
   3.6731061912192845`*^9}, {3.6731062228228045`*^9, 3.6731062286790547`*^9}, 
   3.673106289217881*^9, {3.673106323860526*^9, 3.6731063626409903`*^9}, {
   3.6731064064518285`*^9, 3.6731064088995595`*^9}, 3.6731064666007247`*^9, {
   3.673106621683176*^9, 3.6731066229614983`*^9}, {3.6731067332981477`*^9, 
   3.67310675742727*^9}, {3.673106902586769*^9, 3.673106905561937*^9}, {
   3.6731070648563223`*^9, 3.6731070655406713`*^9}, {3.673107292061803*^9, 
   3.6731073281018534`*^9}, {3.6731073607169514`*^9, 
   3.6731073699009295`*^9}, {3.6731074550345125`*^9, 
   3.6731074885745087`*^9}, {3.673107632594349*^9, 3.673107640667688*^9}, {
   3.6731077365092077`*^9, 3.67310785155603*^9}, {3.6731078896457987`*^9, 
   3.6731080177531195`*^9}, {3.6731080491259284`*^9, 
   3.6731080760121136`*^9}, {3.673108168532712*^9, 3.6731082188486805`*^9}, 
   3.673108641881422*^9, {3.6731089583820496`*^9, 3.673108963058516*^9}, {
   3.6731090466613784`*^9, 3.673109050472077*^9}, {3.673192807411872*^9, 
   3.6731928114431643`*^9}, 3.673192892678402*^9, 3.673192941438696*^9, {
   3.6731964323296256`*^9, 3.67319643276713*^9}, 3.6731965665887604`*^9, 
   3.673196598970043*^9, {3.673196821994419*^9, 3.6731968290721345`*^9}, {
   3.673196959619616*^9, 3.6731969758228555`*^9}, {3.673197036969309*^9, 
   3.6731970394537625`*^9}, 3.6731973632702403`*^9, {3.6731974319656963`*^9, 
   3.673197435261653*^9}, 3.673197547825222*^9, {3.673197623494339*^9, 
   3.6731976238380957`*^9}, {3.6731976605845723`*^9, 
   3.6731976652053084`*^9}, {3.673197787979232*^9, 3.6731977882917557`*^9}, {
   3.6731978722340717`*^9, 3.6731978722395763`*^9}, {3.6734617881233873`*^9, 
   3.6734617893890295`*^9}, {3.673461834920784*^9, 3.673461836936371*^9}, {
   3.6734618869057293`*^9, 3.6734618902587323`*^9}, {3.673461932431073*^9, 
   3.6734619341967583`*^9}, {3.6734620386255445`*^9, 3.673462040031853*^9}, {
   3.6734621804396544`*^9, 3.6734621821427574`*^9}, {3.6734625674769535`*^9, 
   3.6734625937934833`*^9}, {3.6734626434034066`*^9, 
   3.6734626482327824`*^9}, {3.673462726608646*^9, 3.673462730139936*^9}, 
   3.6734628214827833`*^9, {3.6734629575467844`*^9, 3.6734629593886003`*^9}, {
   3.6734629907170296`*^9, 3.673462991060825*^9}, {3.6734630345144243`*^9, 
   3.673463103832074*^9}, {3.673463137629323*^9, 3.6734631390355887`*^9}, {
   3.6734636370890446`*^9, 3.67346366894877*^9}, {3.6737976003248024`*^9, 
   3.673797601074806*^9}, 3.6737978917948503`*^9, 3.674608729718012*^9, {
   3.674608967283054*^9, 3.6746089909594593`*^9}, {3.674609021647172*^9, 
   3.674609056131879*^9}, {3.6746090992728624`*^9, 3.6746091092950735`*^9}, {
   3.6746092071149807`*^9, 3.6746092815101585`*^9}, {3.674609316642312*^9, 
   3.6746093834163666`*^9}, {3.6746094224753656`*^9, 3.674609442556562*^9}, {
   3.6746094755922766`*^9, 3.674609503478061*^9}, {3.6746096190746155`*^9, 
   3.674609619605871*^9}, 3.674609664782216*^9, {3.6747440656442504`*^9, 
   3.6747440690348525`*^9}, {3.674744227196015*^9, 3.6747442616625547`*^9}, {
   3.6747451411202717`*^9, 3.6747451860615807`*^9}, {3.6747452451408186`*^9, 
   3.674745284466505*^9}, {3.674745339801757*^9, 3.6747454783757167`*^9}, {
   3.6747459165082717`*^9, 3.6747459268551617`*^9}, {3.674745966668008*^9, 
   3.6747459818244257`*^9}, {3.6747460634813175`*^9, 3.67474610729955*^9}, {
   3.674746163004769*^9, 3.6747462142861533`*^9}, {3.67474646048106*^9, 
   3.674746521719607*^9}, {3.6900000094491053`*^9, 3.690000015470426*^9}, {
   3.7173466037192554`*^9, 
   3.717346604422386*^9}},ExpressionUUID->"35f33b61-28e7-490c-b323-\
35582828e1d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Variables", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731966061576476`*^9}, {
  3.6731976078257923`*^9, 3.673197611200825*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ExtractVariables", ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractVariables", "[", 
    RowBox[{"expr_", ",", " ", 
     RowBox[{"fcn_:", "Identity"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h", ",", " ", "v", ",", " ", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "apply", " ", "fcn", " ", "and", " ", "convert", " ", "symbol", " ", 
       "to", " ", "string"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"fcn", "@", "x"}], ",", " ", 
           RowBox[{"ToString", "@", 
            RowBox[{"Unevaluated", "@", "x"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "get", " ", "all", " ", "leaves", " ", "of", " ", "an", " ", 
        "expression"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Hold", "@", "expr"}], ",", " ", 
         RowBox[{
          RowBox[{"Except", "[", 
           RowBox[{"Null", ",", " ", "x_Symbol"}], "]"}], " ", 
          "\[RuleDelayed]", " ", 
          RowBox[{"h", "@", "x"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", "v", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"extract", " ", "all", " ", "indices"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Hold", "@", "expr"}], ",", " ", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{
           "x_", "\[LeftDoubleBracket]", "y__", "\[RightDoubleBracket]"}], 
           "]"}], " ", "\[RuleDelayed]", " ", 
          RowBox[{"Hold", "[", 
           RowBox[{"{", "y", "}"}], "]"}]}], ",", " ", "Infinity"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"i", ",", " ", 
         RowBox[{"x_Symbol", " ", "\[RuleDelayed]", " ", 
          RowBox[{"h", "@", "x"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "@", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", "i"}], ",", " ", "2"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "group", " ", "indexing", " ", "variables", " ", "under", " ", 
        "False"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{
          RowBox[{"i", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"Last", "@", "#"}]}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"GroupBy", "[", 
         RowBox[{"v", ",", " ", "h"}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "All", ",", " ", "1"}], 
        "\[RightDoubleBracket]"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"make", " ", "Part", " ", "safe"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{"First", ",", " ", 
        RowBox[{"GroupBy", "[", 
         RowBox[{"v", ",", " ", "h"}], "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231473762894`*^9, 3.67292333059666*^9}, {
   3.672923569896279*^9, 3.6729235971152735`*^9}, {3.6729236576325245`*^9, 
   3.672923778232132*^9}, {3.67292382112319*^9, 3.672923822203421*^9}, {
   3.672933886099881*^9, 3.672933913901292*^9}, {3.6729339542354774`*^9, 
   3.672934116763858*^9}, {3.6729341568736563`*^9, 3.67293418242076*^9}, {
   3.6729346973963056`*^9, 3.672934708755745*^9}, {3.6729347744438443`*^9, 
   3.6729347795883484`*^9}, {3.6729348324603205`*^9, 3.672934876447199*^9}, {
   3.672934919614563*^9, 3.672934934793215*^9}, {3.6729350147431393`*^9, 
   3.672935044958498*^9}, {3.6729350802676315`*^9, 3.672935092689661*^9}, {
   3.6729351387809553`*^9, 3.672935159531186*^9}, {3.6729352126566706`*^9, 
   3.67293529614421*^9}, 3.6729353830951786`*^9, {3.672935639630994*^9, 
   3.6729357272039003`*^9}, 3.672937702423049*^9, {3.672937744922078*^9, 
   3.6729377903379717`*^9}, {3.67293788968925*^9, 3.672937939696617*^9}, {
   3.6729379844498577`*^9, 3.6729380008792334`*^9}, {3.672938083670993*^9, 
   3.6729381365376663`*^9}, {3.6729382059697833`*^9, 3.672938219413664*^9}, {
   3.672938301312541*^9, 3.672938321211969*^9}, {3.67293835304044*^9, 
   3.6729383760063505`*^9}, {3.672938550922858*^9, 3.672938619751956*^9}, {
   3.672938661564331*^9, 3.672938666142521*^9}, {3.6729387005211987`*^9, 
   3.6729387569056244`*^9}, {3.672938811214872*^9, 3.672938814326576*^9}, {
   3.672938971020873*^9, 3.672939001369969*^9}, {3.6729390483372555`*^9, 
   3.672939051813734*^9}, {3.672939110853039*^9, 3.672939116118719*^9}, {
   3.6729393516950064`*^9, 3.672939353493438*^9}, 3.672940702976226*^9, {
   3.672942002456709*^9, 3.672942010023283*^9}, {3.672942132038026*^9, 
   3.6729421651053705`*^9}, {3.6729423737093782`*^9, 3.6729424581562014`*^9}, 
   3.6729425192817574`*^9, {3.672942580859954*^9, 3.6729426141050115`*^9}, 
   3.672942660676553*^9, 3.6729428396714945`*^9, {3.6729428744373956`*^9, 
   3.6729428791205645`*^9}, {3.672942927683508*^9, 3.672942992563116*^9}, {
   3.6729430276005516`*^9, 3.672943122465444*^9}, 3.6729431542673244`*^9, {
   3.672943238174302*^9, 3.6729432405337386`*^9}, {3.6729433089185257`*^9, 
   3.6729433118091726`*^9}, 3.6729433697208347`*^9, {3.6729435556082187`*^9, 
   3.6729435747778*^9}, {3.672946687205556*^9, 3.67294671925691*^9}, {
   3.672946881884638*^9, 3.6729469172728367`*^9}, {3.6729469515983715`*^9, 
   3.6729469546648965`*^9}, {3.6729471408857393`*^9, 3.672947145781169*^9}, {
   3.67294721585527*^9, 3.6729472364731436`*^9}, {3.6729472679396877`*^9, 
   3.6729472812522697`*^9}, {3.672947391245015*^9, 3.67294740292869*^9}, {
   3.672966815729293*^9, 3.672966816401171*^9}, {3.6729669268084307`*^9, 
   3.6729669329774275`*^9}, {3.6729672451969414`*^9, 
   3.6729672651497607`*^9}, {3.672967296509385*^9, 3.6729673161502266`*^9}, {
   3.6729673506974177`*^9, 3.6729673590412054`*^9}, {3.672967467042173*^9, 
   3.672967506683215*^9}, {3.67296858325613*^9, 3.672968583990512*^9}, {
   3.672968627647162*^9, 3.6729686346472263`*^9}, {3.672968665897509*^9, 
   3.6729688137658796`*^9}, {3.6729689351536317`*^9, 
   3.6729689401849833`*^9}, {3.6729689729561005`*^9, 3.672968977846769*^9}, {
   3.672969010237632*^9, 3.672969103181587*^9}, {3.6729692950114727`*^9, 
   3.672969324717699*^9}, {3.6729696007983446`*^9, 3.67296960904842*^9}, {
   3.6729696755645933`*^9, 3.6729697808662777`*^9}, {3.672969873924942*^9, 
   3.6729698792062254`*^9}, {3.672970008863673*^9, 3.6729700145981436`*^9}, {
   3.672970068286091*^9, 3.6729700935519867`*^9}, {3.6729701709588995`*^9, 
   3.672970178740264*^9}, {3.6729702579128046`*^9, 3.6729702622307987`*^9}, {
   3.67297340416953*^9, 3.672973405599137*^9}, 3.6729734455838785`*^9, {
   3.6729735297125144`*^9, 3.6729735654776716`*^9}, {3.6729736064468374`*^9, 
   3.672973626212637*^9}, {3.672973664403517*^9, 3.6729736928568616`*^9}, {
   3.672973735638542*^9, 3.672973779107648*^9}, {3.672973832295675*^9, 
   3.6729738405830884`*^9}, 3.6729738914585905`*^9, {3.672973950064999*^9, 
   3.672973976853453*^9}, {3.6729740804064713`*^9, 3.6729740825784245`*^9}, 
   3.672974424774643*^9, {3.6729744893690414`*^9, 3.672974502275411*^9}, {
   3.6729746259866323`*^9, 3.6729746289210978`*^9}, {3.672974690116191*^9, 
   3.672974733517294*^9}, {3.672974815264155*^9, 3.672974820728876*^9}, {
   3.672993064251093*^9, 3.6729930885773406`*^9}, {3.672993134876603*^9, 
   3.672993135470359*^9}, {3.6729932326356907`*^9, 3.6729932427763824`*^9}, {
   3.672993479263315*^9, 3.6729936256398716`*^9}, {3.6729936893162646`*^9, 
   3.672993715113412*^9}, {3.6729937496813855`*^9, 3.672993778670251*^9}, {
   3.6729938988808193`*^9, 3.672993955371016*^9}, {3.67299400763064*^9, 
   3.6729940088181553`*^9}, {3.672994074745188*^9, 3.6729941045464*^9}, {
   3.6729941610799336`*^9, 3.67299420086067*^9}, {3.672994269168688*^9, 
   3.672994315286899*^9}, {3.672994597047865*^9, 3.6729945974541216`*^9}, {
   3.6729947173460193`*^9, 3.6729947691640368`*^9}, {3.672994810617605*^9, 
   3.672994817180175*^9}, {3.672994897500884*^9, 3.6729949006102943`*^9}, {
   3.672994983017383*^9, 3.6729949834080496`*^9}, {3.6729951793438215`*^9, 
   3.672995338503119*^9}, {3.672995424582159*^9, 3.67299548231715*^9}, {
   3.6729955210700097`*^9, 3.6729955976702776`*^9}, {3.6729956311238136`*^9, 
   3.672995662358493*^9}, {3.672995711624671*^9, 3.672995916968398*^9}, {
   3.672996420415288*^9, 3.672996513131817*^9}, {3.6729966176006503`*^9, 
   3.67299663430315*^9}, {3.672996704290532*^9, 3.6729967153218937`*^9}, {
   3.6729967542441473`*^9, 3.6729968334050426`*^9}, {3.672996874377798*^9, 
   3.672996874612172*^9}, 3.672996911018773*^9, {3.6729984047719135`*^9, 
   3.672998444584838*^9}, {3.6729985117418036`*^9, 3.672998515163657*^9}, {
   3.6729985541016283`*^9, 3.6729985877130237`*^9}, {3.672998676056633*^9, 
   3.6729987092501755`*^9}, {3.6729987464983377`*^9, 
   3.6729987479515343`*^9}, {3.6729987788893647`*^9, 
   3.6729987816302924`*^9}, {3.672998932475648*^9, 3.6729990082252407`*^9}, {
   3.6729990588664417`*^9, 3.6729990866948643`*^9}, {3.6729991351538115`*^9, 
   3.6729991504039755`*^9}, {3.672999261655156*^9, 3.6729993557967854`*^9}, {
   3.672999471566995*^9, 3.672999528973894*^9}, {3.672999574321541*^9, 
   3.6729995829622135`*^9}, 3.6730000477994986`*^9, {3.673000112040515*^9, 
   3.673000117649952*^9}, {3.67300015835347*^9, 3.673000181259946*^9}, {
   3.6730002259636035`*^9, 3.6730002926049376`*^9}, {3.673000400574797*^9, 
   3.673000418408077*^9}, {3.6730004726345587`*^9, 3.6730004778377585`*^9}, {
   3.6730005216819744`*^9, 3.6730005263895907`*^9}, {3.6730006655629253`*^9, 
   3.673000756860651*^9}, {3.673001135468763*^9, 3.6730011374062834`*^9}, {
   3.6730012051257534`*^9, 3.6730012066570196`*^9}, {3.6730012649076405`*^9, 
   3.6730013111824493`*^9}, {3.6730013711353936`*^9, 3.673001379869859*^9}, {
   3.6730014761208467`*^9, 3.6730015090118065`*^9}, {3.6730019445789967`*^9, 
   3.6730019759107084`*^9}, {3.6730036460961676`*^9, 3.673003683274808*^9}, {
   3.6730037533536797`*^9, 3.6730037543981867`*^9}, {3.673003799389406*^9, 
   3.6730038000938005`*^9}, {3.673003835411345*^9, 3.67300388243285*^9}, {
   3.6730039407304*^9, 3.6730039433214674`*^9}, {3.6730040123534546`*^9, 
   3.6730040263222976`*^9}, {3.6730040564156885`*^9, 3.673004063572014*^9}, {
   3.673004234045515*^9, 3.6730042375631127`*^9}, {3.673004363743765*^9, 
   3.673004367384425*^9}, {3.673005622106264*^9, 3.673005670731781*^9}, {
   3.673008261426072*^9, 3.673008293193389*^9}, {3.6730083441433067`*^9, 
   3.673008390231715*^9}, {3.6730085249653845`*^9, 3.6730085291832886`*^9}, {
   3.673008567825856*^9, 3.6730085686696167`*^9}, {3.6730086014199657`*^9, 
   3.673008620818368*^9}, {3.6730088113665414`*^9, 3.673008862738968*^9}, 
   3.6730091692670264`*^9, {3.67301460825314*^9, 3.673014622927169*^9}, {
   3.673014975008257*^9, 3.673014976698572*^9}, {3.673092750460484*^9, 
   3.673092774826923*^9}, {3.6730928639959016`*^9, 3.6730928645373955`*^9}, {
   3.6730929276506357`*^9, 3.673092972721137*^9}, 3.673093010045974*^9, {
   3.673093860112836*^9, 3.6730938669156528`*^9}, {3.673094050199472*^9, 
   3.6730940502144833`*^9}, {3.6730955969619827`*^9, 
   3.6730956654961247`*^9}, {3.6730957119099903`*^9, 3.673095792085063*^9}, {
   3.673095835383345*^9, 3.673095838139547*^9}, {3.6730959143719316`*^9, 
   3.6730960079251027`*^9}, {3.6730960424060316`*^9, 3.673096050760952*^9}, {
   3.6730961099118357`*^9, 3.673096265588333*^9}, {3.6730963182130566`*^9, 
   3.6730963470674877`*^9}, {3.6730963778907957`*^9, 3.673096378751799*^9}, {
   3.6730964335914063`*^9, 3.6730964476398587`*^9}, {3.6730971613313665`*^9, 
   3.6730972619091783`*^9}, {3.6730972932797875`*^9, 
   3.6730973185395904`*^9}, {3.6730974355644364`*^9, 
   3.6730974401439705`*^9}, {3.6730974791739235`*^9, 3.673097514069307*^9}, {
   3.673097618411811*^9, 3.6730976809924903`*^9}, {3.6730978226771345`*^9, 
   3.6730978513864813`*^9}, {3.6730979093327*^9, 3.673097955834776*^9}, {
   3.673098500416672*^9, 3.673098501075818*^9}, {3.673098546582277*^9, 
   3.6730985702113013`*^9}, {3.6730986458379383`*^9, 3.6730986740607257`*^9}, 
   3.6730987353600626`*^9, {3.67309877873357*^9, 3.6730989628527126`*^9}, {
   3.673099265340266*^9, 3.6730992755592704`*^9}, {3.673099356590049*^9, 
   3.6730993572225513`*^9}, {3.6731015179516087`*^9, 
   3.6731015883528795`*^9}, {3.673101893687087*^9, 3.673101895237196*^9}, 
   3.6731020955720825`*^9, {3.6731021301269283`*^9, 3.673102180099937*^9}, {
   3.673102234051756*^9, 3.673102234210868*^9}, {3.6731022643032894`*^9, 
   3.6731023221196084`*^9}, {3.6731026258298216`*^9, 
   3.6731026262771387`*^9}, {3.67310270016525*^9, 3.6731027042511435`*^9}, 
   3.673102756466938*^9, {3.6731028462319784`*^9, 3.673102866139098*^9}, {
   3.673102901285778*^9, 3.67310292554869*^9}, {3.673103434381622*^9, 
   3.673103666644972*^9}, {3.67310373690971*^9, 3.6731037879101043`*^9}, {
   3.673103936715156*^9, 3.673103966846873*^9}, {3.6731040077291*^9, 
   3.6731040468099785`*^9}, {3.6731040805498877`*^9, 3.673104122708008*^9}, 
   3.673104206292513*^9, {3.673104243767274*^9, 3.673104283240779*^9}, {
   3.67310432777127*^9, 3.6731043846337824`*^9}, {3.6731045675428305`*^9, 
   3.6731045758822794`*^9}, {3.6731046713889513`*^9, 
   3.6731046997264175`*^9}, {3.6731047421467648`*^9, 
   3.6731048165873084`*^9}, {3.6731049254153643`*^9, 
   3.6731049542995267`*^9}, {3.6731049882954726`*^9, 
   3.6731050106617756`*^9}, {3.67310569894119*^9, 3.673105699073286*^9}, {
   3.673105745006565*^9, 3.6731057483279095`*^9}, {3.673106146342636*^9, 
   3.6731061912192845`*^9}, {3.6731062228228045`*^9, 3.6731062286790547`*^9}, 
   3.673106289217881*^9, {3.673106323860526*^9, 3.6731063626409903`*^9}, {
   3.6731064064518285`*^9, 3.6731064088995595`*^9}, 3.6731064666007247`*^9, {
   3.673106621683176*^9, 3.6731066229614983`*^9}, {3.6731067332981477`*^9, 
   3.67310675742727*^9}, {3.673106902586769*^9, 3.673106905561937*^9}, {
   3.6731070648563223`*^9, 3.6731070655406713`*^9}, {3.673107292061803*^9, 
   3.6731073281018534`*^9}, {3.6731073607169514`*^9, 
   3.6731073699009295`*^9}, {3.6731074550345125`*^9, 
   3.6731074885745087`*^9}, {3.673107632594349*^9, 3.673107640667688*^9}, {
   3.6731077365092077`*^9, 3.67310785155603*^9}, {3.6731078896457987`*^9, 
   3.6731080177531195`*^9}, {3.6731080491259284`*^9, 
   3.6731080760121136`*^9}, {3.673108168532712*^9, 3.6731082188486805`*^9}, 
   3.673108641881422*^9, {3.6731089583820496`*^9, 3.673108963058516*^9}, {
   3.6731090466613784`*^9, 3.673109050472077*^9}, {3.673192807411872*^9, 
   3.6731928114431643`*^9}, 3.673192892678402*^9, 3.673192941438696*^9, {
   3.6731964323296256`*^9, 3.67319643276713*^9}, 3.6731965665887604`*^9, 
   3.673196598970043*^9, {3.673196821994419*^9, 3.6731968290721345`*^9}, {
   3.673196988885521*^9, 3.6731969894948997`*^9}, {3.673197089659045*^9, 
   3.673197094002838*^9}, 3.67319716839089*^9, 3.6731972662068586`*^9, {
   3.67319735869211*^9, 3.6731973683327723`*^9}, {3.6731975422314177`*^9, 
   3.6731975666847553`*^9}, {3.6731976208884172`*^9, 3.673197621716508*^9}, {
   3.673197960027825*^9, 3.673197973340452*^9}, {3.673461674106507*^9, 
   3.67346167626278*^9}, {3.673461777248268*^9, 3.6734617779826527`*^9}, 
   3.6737976865913105`*^9, 3.6746087186710076`*^9, {3.6747456806974983`*^9, 
   3.674745696853893*^9}, {3.6806523741040444`*^9, 3.6806524487954626`*^9}, {
   3.6806525229822645`*^9, 3.680652576436515*^9}, {3.711548250584865*^9, 
   3.7115482527255096`*^9}, {3.711548283288211*^9, 3.7115482996008463`*^9}, {
   3.711548392570387*^9, 3.711548416820631*^9}, {3.7115484720554256`*^9, 
   3.7115484741960573`*^9}, {3.71154855214985*^9, 3.7115485523217106`*^9}, {
   3.7115583795808*^9, 3.711558383487084*^9}, {3.7115735574392734`*^9, 
   3.711573558751837*^9}, {3.7115736928935833`*^9, 3.711573693862344*^9}, 
   3.7115744914574223`*^9, {3.711574601098953*^9, 3.7115746020833488`*^9}, {
   3.7116455418826213`*^9, 3.7116455471795397`*^9}, 3.7116455845080304`*^9, 
   3.711645646899123*^9, {3.711646765033475*^9, 3.7116467846586385`*^9}, {
   3.7116468514716973`*^9, 3.71164685242483*^9}, {3.7116469133940907`*^9, 
   3.7116469476287627`*^9}, {3.7116469944572687`*^9, 
   3.7116469950510235`*^9}, {3.712072711533061*^9, 3.712072734658241*^9}, {
   3.7120728355497265`*^9, 3.712072836846597*^9}, {3.7120744468642654`*^9, 
   3.71207445566123*^9}, {3.7120755748756275`*^9, 3.712075593485177*^9}, {
   3.712075639844923*^9, 
   3.712075663735749*^9}},ExpressionUUID->"ce2a2e24-f88d-4fec-86dd-\
16658dfc7064"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Expressions (in Functions)", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731966061576476`*^9}, {
  3.67319669842465*^9, 3.6731966990809608`*^9}, {3.6731979878874626`*^9, 
  3.6731980015527925`*^9}, {3.6746087427962484`*^9, 3.674608744499389*^9}, {
  3.6802698935528655`*^9, 3.680269894758434*^9}, {3.6802699426263723`*^9, 
  3.6802699439305487`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"TransformExpression", ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", "expr_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "s", ",", " ", "f", ",", " ", "v", ",", " ", "x", ",", " ", "w"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "wrap", " ", "hold", " ", "variable", " ", "\[FormalP]", " ", "around",
         " ", "variables", " ", "and", " ", "functions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Part", ",", " ", "Transpose"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"HoldPattern", "[", 
            RowBox[{"Pattern", "[", 
             RowBox[{"x", ",", 
              RowBox[{"Blank", "[", "#", "]"}]}], "]"}], "]"}], " ", 
           "\[RuleDelayed]", "  ", 
           RowBox[{
            RowBox[{"\[FormalP]", "[", "x", "]"}], "[", "\[FormalR]", "]"}]}],
           "&"}], " ", "/@", " ", "w"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{
           RowBox[{"HoldPattern", "[", "x", "]"}], " ", "\[RuleDelayed]", 
           "  ", 
           RowBox[{
            RowBox[{"\[FormalP]", "[", "x", "]"}], "[", "\[FormalR]", "]"}]}],
           ",", " ", 
          RowBox[{"{", "HoldAll", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"ExtractVariables", "[", 
         RowBox[{"expr", ",", " ", "w"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"w", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"h", ",", " ", 
          RowBox[{
           RowBox[{"HoldPattern", "[", "x_h", "]"}], " ", "\[RuleDelayed]", 
           "  ", 
           RowBox[{
            RowBox[{"\[FormalP]", "[", "x", "]"}], "[", "\[FormalR]", "]"}]}],
           ",", " ", 
          RowBox[{"{", "HoldAll", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"ExtractSubfunctions", "[", 
         RowBox[{"expr", ",", " ", "w"}], "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"f", ",", " ", "True", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"v", ",", " ", "True", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ReleaseHold", "[", 
        RowBox[{
         RowBox[{"Hold", "[", "expr", "]"}], " ", "/.", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"s", ",", " ", "f", ",", " ", "v"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RestoreExpression", "[", "expr_", "]"}], " ", ":=", " ", 
    RowBox[{"expr", " ", "/.", " ", 
     RowBox[{
      RowBox[{"HoldPattern", "[", 
       RowBox[{"f_", "[", "\[FormalR]", "]"}], "]"}], " ", "\[RuleDelayed]", 
      " ", 
      RowBox[{"CreateSymbol", "[", "f", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DifferentiateExpression", "[", 
    RowBox[{"expr_", ",", " ", "x_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "f", ",", " ", "e"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", " ", "===", " ", "\[FormalR]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "expression", " ", "has", " ", "prespecified", " ", "what", " ", 
          "to", " ", "differentiate"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"v", " ", "=", " ", "expr"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"o", ".", "w", "."}], ",", " ", 
          RowBox[{
          "differentiate", " ", "with", " ", "respect", " ", "to", " ", 
           "variables", " ", "in", " ", "x"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"f", " ", "=", " ", 
          RowBox[{"Function", "[", 
           RowBox[{"e", ",", " ", 
            RowBox[{"e", " ", "\[Rule]", " ", 
             RowBox[{"e", "[", "\[FormalR]", "]"}]}], ",", " ", 
            RowBox[{"{", "Listable", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"v", " ", "=", " ", 
          RowBox[{"expr", " ", "/.", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"f", "[", "x", "]"}], "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"v", ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[FormalR]", ",", " ", "e"}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"e", ",", " ", "0", ",", " ", "n"}], "}"}]}], "]"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"v", ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[FormalR]", ",", " ", 
            RowBox[{"First", "@", "n"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NestList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"#", ",", " ", "\[FormalR]"}], "]"}], "&"}], ",", " ", 
          "v", ",", " ", "n"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231473762894`*^9, 3.67292333059666*^9}, {
   3.672923569896279*^9, 3.6729235971152735`*^9}, {3.6729236576325245`*^9, 
   3.672923778232132*^9}, {3.67292382112319*^9, 3.672923822203421*^9}, {
   3.672933886099881*^9, 3.672933913901292*^9}, {3.6729339542354774`*^9, 
   3.672934116763858*^9}, {3.6729341568736563`*^9, 3.67293418242076*^9}, {
   3.6729346973963056`*^9, 3.672934708755745*^9}, {3.6729347744438443`*^9, 
   3.6729347795883484`*^9}, {3.6729348324603205`*^9, 3.672934876447199*^9}, {
   3.672934919614563*^9, 3.672934934793215*^9}, {3.6729350147431393`*^9, 
   3.672935044958498*^9}, {3.6729350802676315`*^9, 3.672935092689661*^9}, {
   3.6729351387809553`*^9, 3.672935159531186*^9}, {3.6729352126566706`*^9, 
   3.67293529614421*^9}, 3.6729353830951786`*^9, {3.672935639630994*^9, 
   3.6729357272039003`*^9}, 3.672937702423049*^9, {3.672937744922078*^9, 
   3.6729377903379717`*^9}, {3.67293788968925*^9, 3.672937939696617*^9}, {
   3.6729379844498577`*^9, 3.6729380008792334`*^9}, {3.672938083670993*^9, 
   3.6729381365376663`*^9}, {3.6729382059697833`*^9, 3.672938219413664*^9}, {
   3.672938301312541*^9, 3.672938321211969*^9}, {3.67293835304044*^9, 
   3.6729383760063505`*^9}, {3.672938550922858*^9, 3.672938619751956*^9}, {
   3.672938661564331*^9, 3.672938666142521*^9}, {3.6729387005211987`*^9, 
   3.6729387569056244`*^9}, {3.672938811214872*^9, 3.672938814326576*^9}, {
   3.672938971020873*^9, 3.672939001369969*^9}, {3.6729390483372555`*^9, 
   3.672939051813734*^9}, {3.672939110853039*^9, 3.672939116118719*^9}, {
   3.6729393516950064`*^9, 3.672939353493438*^9}, 3.672940702976226*^9, {
   3.672942002456709*^9, 3.672942010023283*^9}, {3.672942132038026*^9, 
   3.6729421651053705`*^9}, {3.6729423737093782`*^9, 3.6729424581562014`*^9}, 
   3.6729425192817574`*^9, {3.672942580859954*^9, 3.6729426141050115`*^9}, 
   3.672942660676553*^9, 3.6729428396714945`*^9, {3.6729428744373956`*^9, 
   3.6729428791205645`*^9}, {3.672942927683508*^9, 3.672942992563116*^9}, {
   3.6729430276005516`*^9, 3.672943122465444*^9}, 3.6729431542673244`*^9, {
   3.672943238174302*^9, 3.6729432405337386`*^9}, {3.6729433089185257`*^9, 
   3.6729433118091726`*^9}, 3.6729433697208347`*^9, {3.6729435556082187`*^9, 
   3.6729435747778*^9}, {3.672946687205556*^9, 3.67294671925691*^9}, {
   3.672946881884638*^9, 3.6729469172728367`*^9}, {3.6729469515983715`*^9, 
   3.6729469546648965`*^9}, {3.6729471408857393`*^9, 3.672947145781169*^9}, {
   3.67294721585527*^9, 3.6729472364731436`*^9}, {3.6729472679396877`*^9, 
   3.6729472812522697`*^9}, {3.672947391245015*^9, 3.67294740292869*^9}, {
   3.672966815729293*^9, 3.672966816401171*^9}, {3.6729669268084307`*^9, 
   3.6729669329774275`*^9}, {3.6729672451969414`*^9, 
   3.6729672651497607`*^9}, {3.672967296509385*^9, 3.6729673161502266`*^9}, {
   3.6729673506974177`*^9, 3.6729673590412054`*^9}, {3.672967467042173*^9, 
   3.672967506683215*^9}, {3.67296858325613*^9, 3.672968583990512*^9}, {
   3.672968627647162*^9, 3.6729686346472263`*^9}, {3.672968665897509*^9, 
   3.6729688137658796`*^9}, {3.6729689351536317`*^9, 
   3.6729689401849833`*^9}, {3.6729689729561005`*^9, 3.672968977846769*^9}, {
   3.672969010237632*^9, 3.672969103181587*^9}, {3.6729692950114727`*^9, 
   3.672969324717699*^9}, {3.6729696007983446`*^9, 3.67296960904842*^9}, {
   3.6729696755645933`*^9, 3.6729697808662777`*^9}, {3.672969873924942*^9, 
   3.6729698792062254`*^9}, {3.672970008863673*^9, 3.6729700145981436`*^9}, {
   3.672970068286091*^9, 3.6729700935519867`*^9}, {3.6729701709588995`*^9, 
   3.672970178740264*^9}, {3.6729702579128046`*^9, 3.6729702622307987`*^9}, {
   3.67297340416953*^9, 3.672973405599137*^9}, 3.6729734455838785`*^9, {
   3.6729735297125144`*^9, 3.6729735654776716`*^9}, {3.6729736064468374`*^9, 
   3.672973626212637*^9}, {3.672973664403517*^9, 3.6729736928568616`*^9}, {
   3.672973735638542*^9, 3.672973779107648*^9}, {3.672973832295675*^9, 
   3.6729738405830884`*^9}, 3.6729738914585905`*^9, {3.672973950064999*^9, 
   3.672973976853453*^9}, {3.6729740804064713`*^9, 3.6729740825784245`*^9}, 
   3.672974424774643*^9, {3.6729744893690414`*^9, 3.672974502275411*^9}, {
   3.6729746259866323`*^9, 3.6729746289210978`*^9}, {3.672974690116191*^9, 
   3.672974733517294*^9}, {3.672974815264155*^9, 3.672974820728876*^9}, {
   3.672993064251093*^9, 3.6729930885773406`*^9}, {3.672993134876603*^9, 
   3.672993135470359*^9}, {3.6729932326356907`*^9, 3.6729932427763824`*^9}, {
   3.672993479263315*^9, 3.6729936256398716`*^9}, {3.6729936893162646`*^9, 
   3.672993715113412*^9}, {3.6729937496813855`*^9, 3.672993778670251*^9}, {
   3.6729938988808193`*^9, 3.672993955371016*^9}, {3.67299400763064*^9, 
   3.6729940088181553`*^9}, {3.672994074745188*^9, 3.6729941045464*^9}, {
   3.6729941610799336`*^9, 3.67299420086067*^9}, {3.672994269168688*^9, 
   3.672994315286899*^9}, {3.672994597047865*^9, 3.6729945974541216`*^9}, {
   3.6729947173460193`*^9, 3.6729947691640368`*^9}, {3.672994810617605*^9, 
   3.672994817180175*^9}, {3.672994897500884*^9, 3.6729949006102943`*^9}, {
   3.672994983017383*^9, 3.6729949834080496`*^9}, {3.6729951793438215`*^9, 
   3.672995338503119*^9}, {3.672995424582159*^9, 3.67299548231715*^9}, {
   3.6729955210700097`*^9, 3.6729955976702776`*^9}, {3.6729956311238136`*^9, 
   3.672995662358493*^9}, {3.672995711624671*^9, 3.672995916968398*^9}, {
   3.672996420415288*^9, 3.672996513131817*^9}, {3.6729966176006503`*^9, 
   3.67299663430315*^9}, {3.672996704290532*^9, 3.6729967153218937`*^9}, {
   3.6729967542441473`*^9, 3.6729968334050426`*^9}, {3.672996874377798*^9, 
   3.672996874612172*^9}, 3.672996911018773*^9, {3.6729984047719135`*^9, 
   3.672998444584838*^9}, {3.6729985117418036`*^9, 3.672998515163657*^9}, {
   3.6729985541016283`*^9, 3.6729985877130237`*^9}, {3.672998676056633*^9, 
   3.6729987092501755`*^9}, {3.6729987464983377`*^9, 
   3.6729987479515343`*^9}, {3.6729987788893647`*^9, 
   3.6729987816302924`*^9}, {3.672998932475648*^9, 3.6729990082252407`*^9}, {
   3.6729990588664417`*^9, 3.6729990866948643`*^9}, {3.6729991351538115`*^9, 
   3.6729991504039755`*^9}, {3.672999261655156*^9, 3.6729993557967854`*^9}, {
   3.672999471566995*^9, 3.672999528973894*^9}, {3.672999574321541*^9, 
   3.6729995829622135`*^9}, 3.6730000477994986`*^9, {3.673000112040515*^9, 
   3.673000117649952*^9}, {3.67300015835347*^9, 3.673000181259946*^9}, {
   3.6730002259636035`*^9, 3.6730002926049376`*^9}, {3.673000400574797*^9, 
   3.673000418408077*^9}, {3.6730004726345587`*^9, 3.6730004778377585`*^9}, {
   3.6730005216819744`*^9, 3.6730005263895907`*^9}, {3.6730006655629253`*^9, 
   3.673000756860651*^9}, {3.673001135468763*^9, 3.6730011374062834`*^9}, {
   3.6730012051257534`*^9, 3.6730012066570196`*^9}, {3.6730012649076405`*^9, 
   3.6730013111824493`*^9}, {3.6730013711353936`*^9, 3.673001379869859*^9}, {
   3.6730014761208467`*^9, 3.6730015090118065`*^9}, {3.6730019445789967`*^9, 
   3.6730019759107084`*^9}, {3.6730036460961676`*^9, 3.673003683274808*^9}, {
   3.6730037533536797`*^9, 3.6730037543981867`*^9}, {3.673003799389406*^9, 
   3.6730038000938005`*^9}, {3.673003835411345*^9, 3.67300388243285*^9}, {
   3.6730039407304*^9, 3.6730039433214674`*^9}, {3.6730040123534546`*^9, 
   3.6730040263222976`*^9}, {3.6730040564156885`*^9, 3.673004063572014*^9}, {
   3.673004234045515*^9, 3.6730042375631127`*^9}, {3.673004363743765*^9, 
   3.673004367384425*^9}, {3.673005622106264*^9, 3.673005670731781*^9}, {
   3.673008261426072*^9, 3.673008293193389*^9}, {3.6730083441433067`*^9, 
   3.673008390231715*^9}, {3.6730085249653845`*^9, 3.6730085291832886`*^9}, {
   3.673008567825856*^9, 3.6730085686696167`*^9}, {3.6730086014199657`*^9, 
   3.673008620818368*^9}, {3.6730088113665414`*^9, 3.673008862738968*^9}, 
   3.6730091692670264`*^9, {3.67301460825314*^9, 3.673014622927169*^9}, {
   3.673014975008257*^9, 3.673014976698572*^9}, {3.673092750460484*^9, 
   3.673092774826923*^9}, {3.6730928639959016`*^9, 3.6730928645373955`*^9}, {
   3.6730929276506357`*^9, 3.673092972721137*^9}, 3.673093010045974*^9, {
   3.673093860112836*^9, 3.6730938669156528`*^9}, {3.673094050199472*^9, 
   3.6730940502144833`*^9}, {3.6730955969619827`*^9, 
   3.6730956654961247`*^9}, {3.6730957119099903`*^9, 3.673095792085063*^9}, {
   3.673095835383345*^9, 3.673095838139547*^9}, {3.6730959143719316`*^9, 
   3.6730960079251027`*^9}, {3.6730960424060316`*^9, 3.673096050760952*^9}, {
   3.6730961099118357`*^9, 3.673096265588333*^9}, {3.6730963182130566`*^9, 
   3.6730963470674877`*^9}, {3.6730963778907957`*^9, 3.673096378751799*^9}, {
   3.6730964335914063`*^9, 3.6730964476398587`*^9}, {3.6730971613313665`*^9, 
   3.6730972619091783`*^9}, {3.6730972932797875`*^9, 
   3.6730973185395904`*^9}, {3.6730974355644364`*^9, 
   3.6730974401439705`*^9}, {3.6730974791739235`*^9, 3.673097514069307*^9}, {
   3.673097618411811*^9, 3.6730976809924903`*^9}, {3.6730978226771345`*^9, 
   3.6730978513864813`*^9}, {3.6730979093327*^9, 3.673097955834776*^9}, {
   3.673098500416672*^9, 3.673098501075818*^9}, {3.673098546582277*^9, 
   3.6730985702113013`*^9}, {3.6730986458379383`*^9, 3.6730986740607257`*^9}, 
   3.6730987353600626`*^9, {3.67309877873357*^9, 3.6730989628527126`*^9}, {
   3.673099265340266*^9, 3.6730992755592704`*^9}, {3.673099356590049*^9, 
   3.6730993572225513`*^9}, {3.6731015179516087`*^9, 
   3.6731015883528795`*^9}, {3.673101893687087*^9, 3.673101895237196*^9}, 
   3.6731020955720825`*^9, {3.6731021301269283`*^9, 3.673102180099937*^9}, {
   3.673102234051756*^9, 3.673102234210868*^9}, {3.6731022643032894`*^9, 
   3.6731023221196084`*^9}, {3.6731026258298216`*^9, 
   3.6731026262771387`*^9}, {3.67310270016525*^9, 3.6731027042511435`*^9}, 
   3.673102756466938*^9, {3.6731028462319784`*^9, 3.673102866139098*^9}, {
   3.673102901285778*^9, 3.67310292554869*^9}, {3.673103434381622*^9, 
   3.673103666644972*^9}, {3.67310373690971*^9, 3.6731037879101043`*^9}, {
   3.673103936715156*^9, 3.673103966846873*^9}, {3.6731040077291*^9, 
   3.6731040468099785`*^9}, {3.6731040805498877`*^9, 3.673104122708008*^9}, 
   3.673104206292513*^9, {3.673104243767274*^9, 3.673104283240779*^9}, {
   3.67310432777127*^9, 3.6731043846337824`*^9}, {3.6731045675428305`*^9, 
   3.6731045758822794`*^9}, {3.6731046713889513`*^9, 
   3.6731046997264175`*^9}, {3.6731047421467648`*^9, 
   3.6731048165873084`*^9}, {3.6731049254153643`*^9, 
   3.6731049542995267`*^9}, {3.6731049882954726`*^9, 
   3.6731050106617756`*^9}, {3.67310569894119*^9, 3.673105699073286*^9}, {
   3.673105745006565*^9, 3.6731057483279095`*^9}, {3.673106146342636*^9, 
   3.6731061912192845`*^9}, {3.6731062228228045`*^9, 3.6731062286790547`*^9}, 
   3.673106289217881*^9, {3.673106323860526*^9, 3.6731063626409903`*^9}, {
   3.6731064064518285`*^9, 3.6731064088995595`*^9}, 3.6731064666007247`*^9, {
   3.673106621683176*^9, 3.6731066229614983`*^9}, {3.6731067332981477`*^9, 
   3.67310675742727*^9}, {3.673106902586769*^9, 3.673106905561937*^9}, {
   3.6731070648563223`*^9, 3.6731070655406713`*^9}, {3.673107292061803*^9, 
   3.6731073281018534`*^9}, {3.6731073607169514`*^9, 
   3.6731073699009295`*^9}, {3.6731074550345125`*^9, 
   3.6731074885745087`*^9}, {3.673107632594349*^9, 3.673107640667688*^9}, {
   3.6731077365092077`*^9, 3.67310785155603*^9}, {3.6731078896457987`*^9, 
   3.6731080177531195`*^9}, {3.6731080491259284`*^9, 
   3.6731080760121136`*^9}, {3.673108168532712*^9, 3.6731082188486805`*^9}, 
   3.673108641881422*^9, {3.6731089583820496`*^9, 3.673108963058516*^9}, {
   3.6731090466613784`*^9, 3.673109050472077*^9}, {3.673192807411872*^9, 
   3.6731928114431643`*^9}, 3.673192892678402*^9, 3.673192941438696*^9, {
   3.6731964323296256`*^9, 3.67319643276713*^9}, 3.6731965665887604`*^9, 
   3.673196598970043*^9, {3.673196821994419*^9, 3.6731968290721345`*^9}, {
   3.673196988885521*^9, 3.6731969894948997`*^9}, {3.673197086407877*^9, 
   3.6731970869246445`*^9}, {3.673197124093593*^9, 3.673197128328007*^9}, {
   3.6731971642970543`*^9, 3.673197175281577*^9}, {3.6731972110500813`*^9, 
   3.6731972322065363`*^9}, {3.673405205274062*^9, 3.673405209430358*^9}, {
   3.673407871792041*^9, 3.673407879163915*^9}, {3.6734079581623106`*^9, 
   3.673407980927236*^9}, {3.673463231270979*^9, 3.673463245401657*^9}, {
   3.6735188291374006`*^9, 3.673518830059288*^9}, {3.673518886802058*^9, 
   3.673518891523387*^9}, {3.6735189805129213`*^9, 3.6735189994506655`*^9}, {
   3.6735224481030626`*^9, 3.6735224546188*^9}, {3.6735226518581877`*^9, 
   3.673522660983342*^9}, {3.6735227576922607`*^9, 3.673522759145401*^9}, {
   3.6735230110203915`*^9, 3.6735230371351624`*^9}, {3.673523180492337*^9, 
   3.673523188818979*^9}, {3.673523230194436*^9, 3.6735232319444523`*^9}, {
   3.673523265431002*^9, 3.673523362390115*^9}, {3.6735235117905254`*^9, 
   3.6735235131342363`*^9}, {3.673523847902669*^9, 3.673523961464225*^9}, {
   3.6735240376369405`*^9, 3.673524070427616*^9}, {3.673524194447047*^9, 
   3.6735241981081324`*^9}, {3.673524256201812*^9, 3.673524310136902*^9}, {
   3.673524407974611*^9, 3.673524459946006*^9}, {3.673524510134062*^9, 
   3.6735245447139783`*^9}, {3.6735246697093925`*^9, 3.673524707553556*^9}, {
   3.6735248499300966`*^9, 3.673524851086359*^9}, {3.67352562218001*^9, 
   3.673525629398841*^9}, {3.673525739155207*^9, 3.673525746061531*^9}, {
   3.6735259260624385`*^9, 3.6735259402188883`*^9}, {3.673526008464738*^9, 
   3.6735260244492884`*^9}, {3.6735260849655986`*^9, 
   3.6735260906531982`*^9}, {3.6735286887472973`*^9, 
   3.6735287037623987`*^9}, {3.6735287716381874`*^9, 
   3.6735288428928566`*^9}, {3.6735289805662923`*^9, 3.67352900084776*^9}, {
   3.6735291476150055`*^9, 3.673529193349848*^9}, 3.6736205693757935`*^9, {
   3.6736206045530276`*^9, 3.6736206349741745`*^9}, 3.6736206909182606`*^9, 
   3.673620798263092*^9, {3.6736208527422504`*^9, 3.673620892727169*^9}, {
   3.6736214911051216`*^9, 3.673621522773225*^9}, {3.673621572368353*^9, 
   3.673621591926754*^9}, 3.673621650366064*^9, {3.6736597252811856`*^9, 
   3.673659772410232*^9}, {3.673659816375909*^9, 3.673659821778139*^9}, {
   3.673660180015358*^9, 3.6736601916025105`*^9}, {3.673660225116188*^9, 
   3.6736602422592354`*^9}, {3.673660896395646*^9, 3.673660949294095*^9}, {
   3.6736609806131706`*^9, 3.673660986448886*^9}, {3.673661565104325*^9, 
   3.673661569090539*^9}, 3.6736616522702155`*^9, {3.673661919603377*^9, 
   3.6736619278261952`*^9}, {3.6736622073829117`*^9, 3.673662216969177*^9}, {
   3.673662407763562*^9, 3.673662429320773*^9}, 3.6736625457608967`*^9, {
   3.6736626884166603`*^9, 3.6736627187183247`*^9}, {3.6736627668301716`*^9, 
   3.673662766988927*^9}, {3.673687983730879*^9, 3.673688052387804*^9}, {
   3.673695061442609*^9, 3.6736950621144943`*^9}, {3.6736952740855646`*^9, 
   3.6736952748980694`*^9}, {3.6736955615260153`*^9, 
   3.6736955711042385`*^9}, {3.6736977524087734`*^9, 
   3.6736977532681956`*^9}, {3.673698882329829*^9, 3.6736988827986336`*^9}, {
   3.6736996539148417`*^9, 3.6736996543680167`*^9}, {3.6736997309699163`*^9, 
   3.673699743729955*^9}, {3.6736998366371613`*^9, 3.6736998371997223`*^9}, {
   3.673699912419244*^9, 3.673699986801875*^9}, 3.6737007114715805`*^9, {
   3.673700859327484*^9, 3.6737008990086946`*^9}, {3.6737009711813107`*^9, 
   3.6737010072129316`*^9}, {3.6737010466507945`*^9, 3.673701047291419*^9}, {
   3.673701108627741*^9, 3.673701275558638*^9}, {3.673701310387123*^9, 
   3.673701316965314*^9}, {3.6737016502656116`*^9, 3.6737018024390464`*^9}, {
   3.6737019234090385`*^9, 3.6737019239402933`*^9}, {3.673702149150129*^9, 
   3.673702206864233*^9}, {3.6737022619788437`*^9, 3.673702295787018*^9}, {
   3.673702624062162*^9, 3.673702645499925*^9}, 3.673702896174367*^9, {
   3.6737030182224965`*^9, 3.673703027950392*^9}, {3.6737031078545933`*^9, 
   3.6737031215109878`*^9}, {3.6737037772067933`*^9, 
   3.6737038315042796`*^9}, {3.6737038938059163`*^9, 3.673703894259047*^9}, {
   3.673704022623932*^9, 3.673704023952093*^9}, {3.6737041999695253`*^9, 
   3.673704205198105*^9}, {3.673704270764268*^9, 3.6737042760143576`*^9}, {
   3.673704356148484*^9, 3.673704358742262*^9}, {3.673704398350318*^9, 
   3.673704483977092*^9}, {3.6737046465412197`*^9, 3.673704650181884*^9}, 
   3.673704929855476*^9, {3.673705729998725*^9, 3.6737057700944033`*^9}, {
   3.673706354926861*^9, 3.673706488886578*^9}, {3.6737065243107896`*^9, 
   3.673706541154711*^9}, {3.6737067014476175`*^9, 3.673706701619491*^9}, {
   3.673706765022571*^9, 3.673706914942589*^9}, {3.6737069520836296`*^9, 
   3.6737069866862965`*^9}, {3.6737071102837195`*^9, 
   3.6737071242994924`*^9}, {3.6737071837374673`*^9, 3.673707187315677*^9}, {
   3.6737072185186605`*^9, 3.6737072201436768`*^9}, {3.673707343457713*^9, 
   3.6737073504264784`*^9}, {3.6737073988175993`*^9, 
   3.6737074167305403`*^9}, {3.6737078951431704`*^9, 3.673707899908846*^9}, {
   3.673707973319605*^9, 3.6737080630236473`*^9}, 3.6737081049359293`*^9, {
   3.6737081433661814`*^9, 3.6737081456162415`*^9}, {3.673708197382413*^9, 
   3.6737081994449377`*^9}, {3.673708230648383*^9, 3.6737082818989058`*^9}, {
   3.673708342899534*^9, 3.6737083705952587`*^9}, 3.673708416608807*^9, {
   3.6737084564998417`*^9, 3.673708472335002*^9}, {3.673708515465288*^9, 
   3.6737085163405843`*^9}, {3.6737086996659765`*^9, 
   3.6737087604635296`*^9}, {3.6737088105734177`*^9, 3.673708811720481*^9}, {
   3.6737088491583247`*^9, 3.673708868111644*^9}, {3.673710203693472*^9, 
   3.6737102575064645`*^9}, {3.67371062376575*^9, 3.6737106350940313`*^9}, 
   3.6737791887189207`*^9, {3.6737796227963*^9, 3.673779624593195*^9}, {
   3.673779664640479*^9, 3.673779665015482*^9}, {3.6737797885493164`*^9, 
   3.673779790460619*^9}, {3.6737967023728247`*^9, 3.673796749820363*^9}, {
   3.6737968828063383`*^9, 3.6737968834001513`*^9}, 3.6737969316975217`*^9, {
   3.6737969900574937`*^9, 3.673797011714405*^9}, {3.6737970736198483`*^9, 
   3.673797117715971*^9}, {3.6737976427001967`*^9, 3.673797643059614*^9}, {
   3.6737978066394215`*^9, 3.673797806998742*^9}, 3.6737982737799377`*^9, {
   3.6737998603351183`*^9, 3.673799872688257*^9}, 3.673799963454812*^9, {
   3.6738000030801754`*^9, 3.6738001054894643`*^9}, {3.6738001721776514`*^9, 
   3.6738002082405157`*^9}, {3.6738229305511055`*^9, 
   3.6738229388469768`*^9}, {3.673823044625134*^9, 3.6738230583609657`*^9}, {
   3.673823604027401*^9, 3.6738236043996973`*^9}, {3.6738237190546412`*^9, 
   3.67382372050033*^9}, 3.673824161102025*^9, {3.673827339157401*^9, 
   3.673827339641781*^9}, {3.673827400829911*^9, 3.673827447177389*^9}, {
   3.673827746475203*^9, 3.6738278072604895`*^9}, {3.673827837729553*^9, 
   3.673827865306802*^9}, {3.673828221274635*^9, 3.6738282229572997`*^9}, {
   3.673828263436757*^9, 3.6738282965933056`*^9}, {3.673828331080083*^9, 
   3.673828333048853*^9}, {3.673828382924369*^9, 3.6738283861431246`*^9}, {
   3.6738284404718347`*^9, 3.673828615127669*^9}, {3.673828655117944*^9, 
   3.6738286824428225`*^9}, {3.673828910325343*^9, 3.6738289290150304`*^9}, {
   3.673830806876315*^9, 3.673830937728383*^9}, {3.6738310564712725`*^9, 
   3.67383106712763*^9}, {3.6738311994520955`*^9, 3.6738312002489786`*^9}, {
   3.6738315294673696`*^9, 3.673831529654876*^9}, {3.6738316793907814`*^9, 
   3.673831679875124*^9}, {3.6738318154703054`*^9, 3.6738318622842684`*^9}, {
   3.673831952397986*^9, 3.6738320350243907`*^9}, {3.6738320790170517`*^9, 
   3.673832079407683*^9}, {3.673833823054076*^9, 3.673833851770221*^9}, {
   3.673833900906864*^9, 3.673833997533202*^9}, {3.6738340540004864`*^9, 
   3.6738340561255083`*^9}, {3.673834093657144*^9, 3.6738340963915453`*^9}, {
   3.673834162265249*^9, 3.673834180745737*^9}, 3.6738342222149167`*^9, {
   3.673834260590308*^9, 3.6738342643559375`*^9}, {3.673834958284996*^9, 
   3.6738349585193653`*^9}, {3.6738361465385213`*^9, 
   3.6738361528979626`*^9}, {3.6738362958736343`*^9, 
   3.6738363156863766`*^9}, {3.673836607592435*^9, 3.6738366214697266`*^9}, {
   3.673836974466318*^9, 3.673837016603362*^9}, {3.673837107229283*^9, 
   3.673837121636732*^9}, {3.673837399223879*^9, 3.673837452775747*^9}, 
   3.673837507213859*^9, {3.6738375949785376`*^9, 3.673837648252845*^9}, {
   3.6738379913749704`*^9, 3.6738380800882254`*^9}, {3.6738381241042476`*^9, 
   3.673838151354578*^9}, {3.673838190276405*^9, 3.673838209120345*^9}, {
   3.673838287308691*^9, 3.6738383215406294`*^9}, {3.673838514017105*^9, 
   3.673838514188943*^9}, {3.673838547001821*^9, 3.6738386339275427`*^9}, {
   3.6738386982563286`*^9, 3.6738387621944294`*^9}, {3.6738388124293365`*^9, 
   3.6738388971701574`*^9}, 3.673839036734089*^9, 3.6738391059857364`*^9, {
   3.6738392150806446`*^9, 3.673839347053564*^9}, {3.6738609008421087`*^9, 
   3.673860904685893*^9}, {3.673860947418183*^9, 3.673860956840209*^9}, {
   3.6738609875748444`*^9, 3.673861014559554*^9}, {3.673861075357053*^9, 
   3.673861077107071*^9}, {3.673861281390418*^9, 3.673861290343633*^9}, {
   3.6738624021438446`*^9, 3.6738624590246515`*^9}, {3.6738626855251837`*^9, 
   3.6738627352994747`*^9}, {3.6738627803624573`*^9, 3.673862902036069*^9}, {
   3.6738629448490076`*^9, 3.673863010385069*^9}, {3.6738633641094937`*^9, 
   3.673863453835796*^9}, {3.6738634864847527`*^9, 3.673863490170454*^9}, {
   3.6738635216061296`*^9, 3.673863605174364*^9}, {3.6738636903483686`*^9, 
   3.6738636908170657`*^9}, {3.6738638209400363`*^9, 3.67386385819615*^9}, {
   3.673863901854392*^9, 3.673863945173967*^9}, {3.673864003361137*^9, 
   3.673864068920088*^9}, {3.67386416621815*^9, 3.67386416742129*^9}, {
   3.6738643512350473`*^9, 3.673864352406936*^9}, {3.6738644747158184`*^9, 
   3.6738645523626995`*^9}, {3.6738645939099693`*^9, 
   3.6738646261759577`*^9}, {3.6738646656713786`*^9, 
   3.6738646720307627`*^9}, {3.673864725737336*^9, 3.673864741096871*^9}, {
   3.6738649498799033`*^9, 3.673864950067365*^9}, {3.6738652353755217`*^9, 
   3.6738652410657854`*^9}, {3.673865328004176*^9, 3.6738653870047417`*^9}, 
   3.6738655731364765`*^9, {3.6738659581320734`*^9, 3.6738660118252335`*^9}, {
   3.673866052700638*^9, 3.6738660962208457`*^9}, {3.6738661370571637`*^9, 
   3.6738661407758927`*^9}, {3.6738661969906273`*^9, 3.67386619791251*^9}, {
   3.6738662331472425`*^9, 3.6738662341159678`*^9}, {3.6738663073067665`*^9, 
   3.673866367743537*^9}, {3.6738664061970615`*^9, 3.673866438709003*^9}, {
   3.6738665343662357`*^9, 3.673866613787884*^9}, {3.67386669774187*^9, 
   3.673866756666215*^9}, {3.6738667955645666`*^9, 3.673866838246605*^9}, {
   3.673867018935957*^9, 3.6738670808888617`*^9}, {3.6738671263112054`*^9, 
   3.673867184499302*^9}, {3.6738672722281055`*^9, 3.673867322904101*^9}, {
   3.6738673652098627`*^9, 3.673867607895364*^9}, {3.6738676475896916`*^9, 
   3.67386769166376*^9}, {3.6738678652818637`*^9, 3.673867939787032*^9}, {
   3.67386835488878*^9, 3.6738683734202185`*^9}, {3.673868444077177*^9, 
   3.673868482501258*^9}, {3.673868553370479*^9, 3.673868626104807*^9}, {
   3.6738687031311493`*^9, 3.673868706021805*^9}, {3.6738688025852957`*^9, 
   3.6738688090683217`*^9}, {3.673868852608241*^9, 3.6738688693271217`*^9}, {
   3.673868918429812*^9, 3.6738689600396147`*^9}, {3.6738690203182716`*^9, 
   3.6738690212245646`*^9}, {3.6738695300107665`*^9, 3.673869570822882*^9}, {
   3.673869655443761*^9, 3.673869664818858*^9}, {3.6738697133505497`*^9, 
   3.6738697369919915`*^9}, {3.67386990817036*^9, 3.6738699100297165`*^9}, {
   3.673869941045644*^9, 3.6738699430996633`*^9}, {3.6738700520363374`*^9, 
   3.673870054072201*^9}, {3.6738700975711713`*^9, 3.673870132009756*^9}, {
   3.673870891674554*^9, 3.6738708941623983`*^9}, {3.673872122593462*^9, 
   3.673872168340045*^9}, {3.673872214536224*^9, 3.6738722159581146`*^9}, {
   3.673872572555564*^9, 3.673872600446474*^9}, {3.6738726736346865`*^9, 
   3.67387267829919*^9}, {3.673872728929242*^9, 3.6738727339136744`*^9}, {
   3.6738730432983418`*^9, 3.6738731199241257`*^9}, 3.6738731688949833`*^9, {
   3.6738733130272317`*^9, 3.673873358246448*^9}, {3.673873537543908*^9, 
   3.67387354021587*^9}, {3.673873577335226*^9, 3.6738736046480083`*^9}, {
   3.673873778649796*^9, 3.673873793181195*^9}, 3.6738761561368113`*^9, {
   3.6738765873654346`*^9, 3.673876591787358*^9}, {3.6738774041172705`*^9, 
   3.6738774144299335`*^9}, {3.67387756072491*^9, 3.673877592483136*^9}, {
   3.67387762656157*^9, 3.6738776595307007`*^9}, {3.67387770025611*^9, 
   3.673877737155512*^9}, {3.673877790297101*^9, 3.673877827293272*^9}, {
   3.6738778821302648`*^9, 3.6738779651949*^9}, {3.673878066352147*^9, 
   3.673878076899131*^9}, {3.6738782331054606`*^9, 3.673878289512329*^9}, {
   3.6738785982263994`*^9, 3.6738785996014137`*^9}, {3.673879292900654*^9, 
   3.673879324476345*^9}, {3.6738793926872396`*^9, 3.6738794079951105`*^9}, {
   3.67387943857359*^9, 3.6738794464249315`*^9}, {3.673879479589204*^9, 
   3.673879706200823*^9}, {3.673879803464884*^9, 3.6738798361092625`*^9}, {
   3.673879937225372*^9, 3.673880002335373*^9}, {3.673880062398532*^9, 
   3.6738801334773455`*^9}, {3.6738803695891266`*^9, 
   3.6738804241066856`*^9}, {3.673880739281756*^9, 3.6738807545631104`*^9}, {
   3.673880847221655*^9, 3.6738808540655146`*^9}, {3.673881145276297*^9, 
   3.67388114566693*^9}, {3.673881313050373*^9, 3.6738813695206137`*^9}, {
   3.673881420568016*^9, 3.673881506498324*^9}, {3.6738815389361706`*^9, 
   3.6738815679560003`*^9}, {3.67388164043686*^9, 3.6738816619839954`*^9}, {
   3.673882093937314*^9, 3.6738821482191224`*^9}, {3.6738822071572285`*^9, 
   3.6738823246958933`*^9}, {3.6738824193697433`*^9, 3.673882419651039*^9}, {
   3.673882525603676*^9, 3.673882525916175*^9}, {3.673882589448082*^9, 
   3.6738825905418425`*^9}, {3.6738826583859577`*^9, 3.673882663698512*^9}, {
   3.673882701917655*^9, 3.673882730136692*^9}, {3.6738827616995163`*^9, 
   3.673882792136446*^9}, {3.6738828582933197`*^9, 3.673882896895021*^9}, {
   3.673882963345891*^9, 3.673882996506648*^9}, {3.6738830306475735`*^9, 
   3.673883056767188*^9}, 3.6738830994082503`*^9, {3.6738832516128793`*^9, 
   3.6738835337417684`*^9}, {3.6738835848403172`*^9, 3.673883585777861*^9}, {
   3.6738836488253803`*^9, 3.673883652778544*^9}, {3.6738842869203005`*^9, 
   3.6738844092965555`*^9}, {3.6738844846328955`*^9, 3.673884484820395*^9}, {
   3.673884692900603*^9, 3.6738847942130327`*^9}, {3.6738848659481983`*^9, 
   3.673884868291937*^9}, {3.673961788839229*^9, 3.673961793879814*^9}, 
   3.6739735970529866`*^9, 3.67397584403415*^9, {3.673975955688366*^9, 
   3.673976004291283*^9}, {3.6739760367056313`*^9, 3.6739760669120874`*^9}, {
   3.6739761043285847`*^9, 3.6739761132589035`*^9}, {3.674049163183374*^9, 
   3.674049236141945*^9}, 3.6740493244048395`*^9, {3.6740493559804726`*^9, 
   3.6740493985422573`*^9}, {3.6740494695083156`*^9, 
   3.6740495028625584`*^9}, {3.6740496739948215`*^9, 3.674049675304772*^9}, 
   3.67405619263844*^9, {3.67405623533573*^9, 3.674056284202018*^9}, {
   3.674056326670761*^9, 3.674056348314724*^9}, {3.6740563798253326`*^9, 
   3.6740563866214333`*^9}, {3.674094296584594*^9, 3.674094298069022*^9}, 
   3.674131492753136*^9, 3.674178994048335*^9, {3.6741805266063375`*^9, 
   3.6741805424971323`*^9}, {3.6741806255292673`*^9, 
   3.6741806350293617`*^9}, {3.6742190685208845`*^9, 
   3.6742191215586143`*^9}, {3.6742192494806647`*^9, 3.674219256058809*^9}, {
   3.6742198883831463`*^9, 3.6742198891331134`*^9}, {3.6742281056620665`*^9, 
   3.674228106683223*^9}, {3.6742283210572853`*^9, 3.674228353323249*^9}, {
   3.674228436371473*^9, 3.6742285106840496`*^9}, {3.6742285859346514`*^9, 
   3.6742285867940483`*^9}, {3.674228628888209*^9, 3.674228631638194*^9}, {
   3.6742287504361477`*^9, 3.674228765427442*^9}, {3.6742289996639023`*^9, 
   3.674229020945341*^9}, {3.6742290825552516`*^9, 3.6742291042741933`*^9}, {
   3.6742292645055437`*^9, 3.6742292756239405`*^9}, {3.674229411156407*^9, 
   3.6742294831921444`*^9}, {3.6742295243409004`*^9, 
   3.6742296075640926`*^9}, {3.6742297230338526`*^9, 3.674229782992811*^9}, {
   3.674229825477559*^9, 3.674229834165135*^9}, {3.6742298848434095`*^9, 
   3.6742298927341003`*^9}, {3.6742299640159197`*^9, 
   3.6742300146726675`*^9}, {3.6742301458117547`*^9, 
   3.6742302435782356`*^9}, {3.674230622176481*^9, 3.67423064995154*^9}, {
   3.674230692467535*^9, 3.6742307971412897`*^9}, {3.6742308327197285`*^9, 
   3.674230995476261*^9}, {3.6742310285718513`*^9, 3.674231041539591*^9}, {
   3.6742310729773655`*^9, 3.6742310936181707`*^9}, {3.6742311321810074`*^9, 
   3.6742311779500685`*^9}, {3.6742312268442135`*^9, 
   3.6742312297887735`*^9}, {3.6742313383053913`*^9, 
   3.6742315791066217`*^9}, {3.6742316432187247`*^9, 3.6742316527697353`*^9}, 
   3.674231696413912*^9, {3.674231728540717*^9, 3.674231731275115*^9}, {
   3.674231813729166*^9, 3.6742318439874144`*^9}, {3.674231883766206*^9, 
   3.6742319317017546`*^9}, {3.6742319687020216`*^9, 
   3.6742320307429795`*^9}, {3.674232091993515*^9, 3.67423209246216*^9}, {
   3.6742321547818594`*^9, 3.6742321576801786`*^9}, {3.6742323407842507`*^9, 
   3.674232346081135*^9}, {3.6742324205349503`*^9, 3.6742324574195337`*^9}, {
   3.674232506715622*^9, 3.6742325074187555`*^9}, {3.6742325458237834`*^9, 
   3.674232562651998*^9}, {3.6742327043974857`*^9, 3.6742327665251865`*^9}, {
   3.67423296346259*^9, 3.6742329654000673`*^9}, {3.674233179191605*^9, 
   3.6742332328130746`*^9}, {3.674233266375871*^9, 3.6742334056970997`*^9}, {
   3.674233437766489*^9, 3.674233446750939*^9}, {3.674233503345189*^9, 
   3.6742335372887197`*^9}, {3.674233956765807*^9, 3.6742340082377872`*^9}, {
   3.674234092097868*^9, 3.674234172687406*^9}, {3.6742342059307365`*^9, 
   3.6742342191126013`*^9}, 3.6742342822849984`*^9, {3.6742344456301537`*^9, 
   3.6742344576117663`*^9}, {3.6742344939870768`*^9, 
   3.6742345119905934`*^9}, {3.674234795384448*^9, 3.6742348512824287`*^9}, {
   3.674235018365449*^9, 3.6742350551470222`*^9}, {3.674235088088449*^9, 
   3.6742351039353466`*^9}, {3.674235195029936*^9, 3.6742351956861424`*^9}, {
   3.6742524890397167`*^9, 3.674252489402973*^9}, {3.6742528485415893`*^9, 
   3.674252921672307*^9}, {3.674253041413743*^9, 3.6742530564494705`*^9}, {
   3.674299768827241*^9, 3.674299789816435*^9}, 3.6742998924080353`*^9, {
   3.674299936913656*^9, 3.674299938687909*^9}, {3.674305601367225*^9, 
   3.674305612398512*^9}, {3.6743058624394417`*^9, 3.6743058898479156`*^9}, {
   3.6743060456617193`*^9, 3.6743060819720955`*^9}, {3.6743061165661325`*^9, 
   3.6743061178942733`*^9}, {3.6743062524210043`*^9, 3.674306305086936*^9}, 
   3.6743962967335787`*^9, {3.674396989134615*^9, 3.674396989353321*^9}, {
   3.6743983182776194`*^9, 3.6743983203987226`*^9}, {3.6743983640240307`*^9, 
   3.674398365039385*^9}, {3.6743984222117014`*^9, 3.6743984767360497`*^9}, {
   3.674398507232953*^9, 3.674398512640567*^9}, {3.674398617101912*^9, 
   3.674398627058359*^9}, {3.674398744037783*^9, 3.674398854912772*^9}, {
   3.6746087138055263`*^9, 3.6746087628432894`*^9}, {3.6747463461803155`*^9, 
   3.6747463558834867`*^9}, {3.6899971250915546`*^9, 
   3.6899971321274643`*^9}, {3.690000361345767*^9, 3.6900003654679613`*^9}, {
   3.6901285664048557`*^9, 3.6901285758004675`*^9}, {3.6901301740764985`*^9, 
   3.690130212584014*^9}, {3.690130253411696*^9, 3.6901303492266483`*^9}, {
   3.6901305279027557`*^9, 3.69013063782894*^9}, {3.6901307090530624`*^9, 
   3.690130723751217*^9}, {3.690130787058947*^9, 3.6901307876973696`*^9}, {
   3.6901308188870554`*^9, 3.690130875672799*^9}, {3.690131008803198*^9, 
   3.690131059593053*^9}, {3.690131134562023*^9, 3.6901311415145597`*^9}, {
   3.6901313816433477`*^9, 3.69013138206522*^9}, {3.6901328069095163`*^9, 
   3.6901328070841856`*^9}, 3.690134863800295*^9, {3.7114525267987933`*^9, 
   3.711452557455352*^9}, {3.711452605987009*^9, 3.7114527263942127`*^9}, {
   3.7115534205579777`*^9, 3.7115534930898333`*^9}, {3.711553527418249*^9, 
   3.7115535486996746`*^9}, {3.711553593465675*^9, 3.7115535955438166`*^9}, {
   3.7115536604506083`*^9, 3.711553843139637*^9}, {3.7115538764367905`*^9, 
   3.7115539061557884`*^9}, {3.711554059875825*^9, 3.711554089813575*^9}, 
   3.7115542620181403`*^9, {3.711554472843238*^9, 3.7115544734681892`*^9}, {
   3.711554538983449*^9, 3.7115545530773296`*^9}, {3.71155459539017*^9, 
   3.7115545960308013`*^9}, {3.711554878439412*^9, 3.7115548826894474`*^9}, {
   3.711554926611744*^9, 3.7115550626128654`*^9}, {3.711555114644514*^9, 
   3.7115551381135116`*^9}, {3.711555211629699*^9, 3.711555216051626*^9}, 
   3.714491732552602*^9, {3.7144919410298796`*^9, 3.7144919547646084`*^9}, {
   3.7179027291334105`*^9, 
   3.7179027811651387`*^9}},ExpressionUUID->"f192004c-fde8-48eb-80a7-\
c0e956ff7ef4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"WrapExpression", ",", " ", "BlockExpression"}], "}"}], ",", 
     " ", "HoldAll"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WrapExpression", "[", 
     RowBox[{"expr_", ",", " ", 
      RowBox[{"fcn_:", "Hold"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", " ", "f", ",", " ", "h"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "returns", " ", "expr", " ", "with", " ", "all", " ", "symbols", " ", 
        "wrapped", " ", "in", " ", "fcn"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h", " ", "=", " ", 
        RowBox[{"Function", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{
           RowBox[{"HoldPattern", "[", "x", "]"}], "\[RuleDelayed]", " ", 
           RowBox[{"fcn", "[", "x", "]"}]}], ",", " ", "HoldAll"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"ExtractVariables", "[", 
         RowBox[{"expr", ",", " ", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"ExtractSubfunctions", "[", 
         RowBox[{"expr", ",", " ", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", " ", "=", " ", 
        RowBox[{"Merge", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v", ",", " ", "f"}], "}"}], ",", " ", "Flatten"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fcn", "[", "expr", "]"}], " ", "/.", " ", 
        RowBox[{"h", "[", "True", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockExpression", "[", 
    RowBox[{"b_List", ",", " ", "expr_", ",", " ", 
     RowBox[{"e_List:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "f", ",", " ", "h"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "all", " ", "variables", " ", "and", " ", "functions"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"\[FormalP]", "[", "x", "]"}], ",", " ", "HoldAll"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"ExtractVariables", "[", 
        RowBox[{"expr", ",", " ", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"ExtractSubfunctions", "[", 
        RowBox[{"expr", ",", " ", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Merge", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v", ",", " ", "f"}], "}"}], ",", " ", "Flatten"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"place", " ", "in", " ", "block", " ", "environment"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"\[FormalP]", "[", "x", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"Listable", ",", " ", "HoldAll"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"f", "@", "b"}], ",", " ", 
         RowBox[{"Lookup", "[", 
          RowBox[{"h", ",", " ", "True", ",", " ", 
           RowBox[{"{", "}"}]}], "]"}], ",", " ", 
         RowBox[{"Lookup", "[", 
          RowBox[{"v", ",", " ", "False", ",", " ", 
           RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"except", " ", "those", " ", "symbols", " ", "in", " ", "e"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{"h", ",", 
         RowBox[{"f", "@", "e"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{"Hold", "[", 
         RowBox[{"Block", "[", 
          RowBox[{"v", ",", " ", "expr"}], "]"}], "]"}], " ", "/.", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", "v", "]"}], " ", "\[Rule]", " ", 
         "f"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"evaluate", " ", "expr"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"First", "[", 
       RowBox[{"v", " ", "/.", " ", 
        RowBox[{
         RowBox[{"\[FormalP]", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
         "x"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.712076770518008*^9, 3.712076796330736*^9}, {
  3.7120768345341682`*^9, 3.712076837159191*^9}, {3.7120768761282854`*^9, 
  3.7120768794407945`*^9}, {3.7120778794647975`*^9, 3.712077881792943*^9}, {
  3.712077950871645*^9, 3.712077956949821*^9}, {3.7120780797945814`*^9, 
  3.712078085497757*^9}, {3.7120785584548473`*^9, 3.712078577970625*^9}, {
  3.7128885289430494`*^9, 
  3.7128885481463704`*^9}},ExpressionUUID->"0fa1d158-6f0c-4b52-903e-\
e6082af646ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Set Expressions (in Functions)", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731966061576476`*^9}, {
  3.67319669842465*^9, 3.6731966990809608`*^9}, {3.6731979878874626`*^9, 
  3.6731980015527925`*^9}, {3.6746087427962484`*^9, 3.674608744499389*^9}, {
  3.6802698935528655`*^9, 3.680269894758434*^9}, {3.6802699426263723`*^9, 
  3.6802699439305487`*^9}, {3.690134839299774*^9, 
  3.690134839748515*^9}},ExpressionUUID->"a9f14c49-5306-4e56-95ae-\
8ef446213604"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransformExpression", "[", 
     RowBox[{"HoldPattern", "@", 
      RowBox[{"Set", "[", 
       RowBox[{"x_", ",", " ", "y_"}], "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TransformExpression", "[", "x", "]"}], ",", " ", 
      RowBox[{"TransformExpression", "[", "y", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FlattenCompoundExpressions", "[", "e_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"e", " ", "//.", " ", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"CompoundExpression", "[", 
       RowBox[{"x___", ",", " ", 
        RowBox[{"CompoundExpression", "[", "y__", "]"}], ",", " ", "z___"}], 
       "]"}], "]"}], " ", "\[RuleDelayed]", " ", 
     RowBox[{"CompoundExpression", "[", 
      RowBox[{"x", ",", " ", "y", ",", " ", "z"}], "]"}]}]}], " ", "//.", " ", 
   RowBox[{
    RowBox[{"HoldPattern", "[", 
     RowBox[{"CompoundExpression", "[", 
      RowBox[{"x__", ",", " ", "Null", ",", " ", "y__"}], "]"}], "]"}], " ", 
    "\[RuleDelayed]", " ", 
    RowBox[{"CompoundExpression", "[", 
     RowBox[{"x", ",", " ", "y"}], "]"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675852559095492*^9, 3.6758526005665092`*^9}, 
   3.6759750822937193`*^9, 3.675975129992173*^9, 3.675975233545326*^9, 
   3.675980669954183*^9, {3.6759828785981736`*^9, 3.675982879809209*^9}, {
   3.6759831021549892`*^9, 3.6759831050768347`*^9}, {3.675983145785646*^9, 
   3.6759831526451397`*^9}, 3.675983199301778*^9, {3.6759832413888073`*^9, 
   3.675983243826329*^9}, {3.675983512918589*^9, 3.675983514606104*^9}, {
   3.6760070205959406`*^9, 3.6760070390179887`*^9}, {3.676007277292011*^9, 
   3.6760073580969353`*^9}, 3.67600865719456*^9, {3.6802210865774775`*^9, 
   3.680221089487192*^9}, {3.680221166150494*^9, 3.6802211664004946`*^9}, {
   3.6802282019016705`*^9, 3.6802282038198853`*^9}, {3.680228300413221*^9, 
   3.6802283345031223`*^9}, {3.680228538319089*^9, 3.680228540357415*^9}, {
   3.6802286253769474`*^9, 3.680228630158242*^9}, {3.680228674145255*^9, 
   3.680228723712755*^9}, {3.680228765890715*^9, 3.6802287922492037`*^9}, {
   3.6802288691212826`*^9, 3.680228871261875*^9}, {3.6802289203226557`*^9, 
   3.680228973016181*^9}, {3.6802290926152163`*^9, 3.680229102635081*^9}, {
   3.6802292978082695`*^9, 3.680229321927509*^9}, {3.6802294151905193`*^9, 
   3.6802294505447693`*^9}, 3.6899646110077925`*^9, {3.6899656868868465`*^9, 
   3.689965732527928*^9}, {3.6899677771342773`*^9, 3.689967934921317*^9}, {
   3.6899679818620553`*^9, 3.6899680195698624`*^9}, {3.6899681610035563`*^9, 
   3.6899681708940816`*^9}, {3.689968213618952*^9, 3.6899682890872693`*^9}, {
   3.689968323093845*^9, 3.689968330736059*^9}, {3.6899946767656384`*^9, 
   3.6899946988529353`*^9}, {3.689996841200594*^9, 3.6899968972641907`*^9}, {
   3.6899971643154097`*^9, 3.689997187891069*^9}, {3.689997380865167*^9, 
   3.689997384399935*^9}, {3.6899974729305573`*^9, 3.689997514794594*^9}, {
   3.6899976094061565`*^9, 3.6899976336788845`*^9}, {3.689997804735403*^9, 
   3.6899978128599663`*^9}, {3.6899980850375643`*^9, 3.689998123214323*^9}, {
   3.689998431483377*^9, 3.6899984440566864`*^9}, {3.689998555027257*^9, 
   3.689998556269449*^9}, {3.6900003905917807`*^9, 3.6900003911565237`*^9}, {
   3.6900004354928894`*^9, 3.6900004357775745`*^9}, {3.690000485690069*^9, 
   3.6900005044466743`*^9}, {3.690001292253702*^9, 3.6900012963371115`*^9}, 
   3.690004479305722*^9, {3.6901290558612537`*^9, 3.690129056918252*^9}, {
   3.690129112394973*^9, 3.6901291225679045`*^9}, {3.6901291689633846`*^9, 
   3.6901291827663774`*^9}, {3.6901292606890287`*^9, 
   3.6901292665434904`*^9}, {3.6901293028562937`*^9, 
   3.6901293105553174`*^9}, {3.690129371411908*^9, 3.6901294550461516`*^9}, {
   3.6901295119123926`*^9, 3.6901295290038757`*^9}, {3.6901295815570383`*^9, 
   3.690129586637545*^9}, 3.690129674004936*^9, {3.6901297839629498`*^9, 
   3.6901298076120844`*^9}, {3.6901298820206823`*^9, 3.6901299081551085`*^9}, 
   3.690131079200898*^9, {3.6901311625760145`*^9, 3.6901312410237875`*^9}, {
   3.690131312018956*^9, 3.690131314433852*^9}, {3.690131405939188*^9, 
   3.6901314103611264`*^9}, 3.6901315235608654`*^9, {3.690131668676735*^9, 
   3.690131688306327*^9}, {3.6901317221167793`*^9, 3.6901317833162537`*^9}, {
   3.690131829145713*^9, 3.690131844463916*^9}, 3.6901329249943323`*^9, {
   3.6901329605749173`*^9, 3.690132983793914*^9}, {3.6901330241229486`*^9, 
   3.6901330299254937`*^9}, {3.690133075454568*^9, 3.690133075845195*^9}, {
   3.6901343572842865`*^9, 3.690134358513234*^9}, {3.690134727150283*^9, 
   3.6901347277753267`*^9}, {3.6901348677977147`*^9, 3.690134874246049*^9}, {
   3.71157725274117*^9, 3.711577252944244*^9}, {3.711577283850754*^9, 
   3.711577304085299*^9}, {3.71157737694528*^9, 3.7115774124924755`*^9}, {
   3.7115774595240965`*^9, 3.7115774879774604`*^9}, {3.7115775180245857`*^9, 
   3.7115775288371763`*^9}, {3.7115885134988127`*^9, 3.711588522780141*^9}, {
   3.7115885779368515`*^9, 3.711588596749528*^9}, {3.711588636031088*^9, 
   3.7115887544070783`*^9}, {3.7115891739418883`*^9, 3.711589175441851*^9}, {
   3.711589205567102*^9, 3.7115892376767445`*^9}, {3.711589273567671*^9, 
   3.711589363735175*^9}, {3.7115894317045264`*^9, 3.7115894408295517`*^9}, {
   3.711589499283164*^9, 3.7115895382678647`*^9}, {3.7115898603643084`*^9, 
   3.7115898645830936`*^9}, {3.7115898984271407`*^9, 
   3.7115898988958807`*^9}, {3.7115901166633267`*^9, 
   3.7115901206321635`*^9}, {3.711873595274152*^9, 3.711873634540125*^9}, {
   3.717738956451848*^9, 3.7177390543746414`*^9}, {3.7177392709554367`*^9, 
   3.7177392877524595`*^9}},ExpressionUUID->"e52a2af8-84ba-42b9-98a2-\
181e57398dae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DifferentiateSetStatements", "[", 
    RowBox[{"fcn_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", " ", "m", ",", " ", "d"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{
         RowBox[{"ExtractVariables", "[", 
          RowBox[{"fcn", ",", " ", "\[FormalP]"}], "]"}], ",", " ", "False", 
         ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "extract", " ", "and", " ", "transform", " ", "all", " ", "set", " ", 
         "statements"}], ",", " ", 
        RowBox[{"adds", " ", "\[FormalR]", " ", "to", " ", "symbols"}]}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"fcn", ",", " ", 
         RowBox[{"HoldPattern", "[", 
          RowBox[{"Set", "[", 
           RowBox[{"_", ",", " ", "_"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"Extract", "[", 
        RowBox[{"fcn", ",", " ", "m", ",", " ", "TransformExpression"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"remove", " ", "statements", " ", "x"}], " ", "=", " ", 
         "y"}], ",", " ", 
        RowBox[{
         RowBox[{
         "where", " ", "x", " ", "is", " ", "an", " ", "index", " ", "or", 
          " ", "x"}], " ", "=", " ", "IgnoreCase"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"d", " ", "=!=", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{"d", "[", "\[FormalR]", "]"}], "]"}], ",", " ", 
            "IgnoreCase"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "m"}]}], ",", " ", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{"d", ",", " ", 
               RowBox[{"v", "\[LeftDoubleBracket]", 
                RowBox[{"#", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], 
              "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"m", " ", "=", " ", 
          RowBox[{
          "m", "\[LeftDoubleBracket]", "d", "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"v", " ", "=", " ", 
          RowBox[{
          "v", "\[LeftDoubleBracket]", "d", "\[RightDoubleBracket]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "drop", " ", "statements", " ", "with", " ", "zeros", " ", "as", " ", 
        "results"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"v", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", " ", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"PossibleZeroQ", "[", 
                RowBox[{"Last", "@", "#"}], "]"}]}], "&"}]}], "]"}], "&"}], 
          " ", "/@", " ", "v"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"differentiate", " ", "statements"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"DifferentiateExpression", "[", 
        RowBox[{"v", ",", " ", "\[FormalR]", ",", " ", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"RestoreExpression", "[", 
        RowBox[{"v", "\[Transpose]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"restore", " ", "set", " ", "statement"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[FormalP]", "[", 
            RowBox[{"#1", " ", "=", " ", "#2"}], "]"}], "&"}], ",", " ", "v", 
          ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}], " ", "/.", " ", 
        RowBox[{
         RowBox[{"Hold", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
         "x"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "add", " ", "derivatives", " ", "to", " ", "extracted", " ", 
        "statements"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", " ", "/.", " ", 
          RowBox[{
           RowBox[{"{", "x__", "}"}], " ", "\[RuleDelayed]", " ", 
           RowBox[{"\[FormalP]", "[", 
            RowBox[{"CompoundExpression", "[", "x", "]"}], "]"}]}]}], "&"}], 
        " ", "/@", " ", "v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"fcn", ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"m", " ", "\[Rule]", " ", "v"}], "]"}]}], "]"}], "  ", "//.",
         " ", 
        RowBox[{
         RowBox[{"\[FormalP]", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
         "x"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "flatten", " ", "the", " ", "excessive", " ", "compound", " ", 
        "expressions"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      RowBox[{"FlattenCompoundExpressions", "[", "v", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675852559095492*^9, 3.6758526005665092`*^9}, 
   3.6759750822937193`*^9, 3.675975129992173*^9, 3.675975233545326*^9, 
   3.675980669954183*^9, {3.6759828785981736`*^9, 3.675982879809209*^9}, {
   3.6759831021549892`*^9, 3.6759831050768347`*^9}, {3.675983145785646*^9, 
   3.6759831526451397`*^9}, 3.675983199301778*^9, {3.6759832413888073`*^9, 
   3.675983243826329*^9}, {3.675983512918589*^9, 3.675983514606104*^9}, {
   3.6760070205959406`*^9, 3.6760070390179887`*^9}, {3.676007277292011*^9, 
   3.6760073580969353`*^9}, 3.67600865719456*^9, {3.6802210865774775`*^9, 
   3.680221089487192*^9}, {3.680221166150494*^9, 3.6802211664004946`*^9}, {
   3.6802282019016705`*^9, 3.6802282038198853`*^9}, {3.680228300413221*^9, 
   3.6802283345031223`*^9}, {3.680228538319089*^9, 3.680228540357415*^9}, {
   3.6802286253769474`*^9, 3.680228630158242*^9}, {3.680228674145255*^9, 
   3.680228723712755*^9}, {3.680228765890715*^9, 3.6802287922492037`*^9}, {
   3.6802288691212826`*^9, 3.680228871261875*^9}, {3.6802289203226557`*^9, 
   3.680228973016181*^9}, {3.6802290926152163`*^9, 3.680229102635081*^9}, {
   3.6802292978082695`*^9, 3.680229321927509*^9}, {3.6802294151905193`*^9, 
   3.6802294505447693`*^9}, 3.6899646110077925`*^9, {3.6899656868868465`*^9, 
   3.689965732527928*^9}, {3.6899677771342773`*^9, 3.689967934921317*^9}, {
   3.6899679818620553`*^9, 3.6899680195698624`*^9}, {3.6899681610035563`*^9, 
   3.6899681708940816`*^9}, {3.689968213618952*^9, 3.6899682890872693`*^9}, {
   3.689968323093845*^9, 3.689968330736059*^9}, {3.6899946767656384`*^9, 
   3.6899946988529353`*^9}, {3.689996841200594*^9, 3.6899968972641907`*^9}, {
   3.6899971643154097`*^9, 3.689997187891069*^9}, {3.689997380865167*^9, 
   3.689997384399935*^9}, {3.6899974729305573`*^9, 3.689997514794594*^9}, {
   3.6899976094061565`*^9, 3.6899976336788845`*^9}, {3.689997804735403*^9, 
   3.6899978128599663`*^9}, {3.6899980850375643`*^9, 3.689998123214323*^9}, {
   3.689998431483377*^9, 3.6899984440566864`*^9}, {3.689998555027257*^9, 
   3.689998556269449*^9}, {3.6900003905917807`*^9, 3.6900003911565237`*^9}, {
   3.6900004354928894`*^9, 3.6900004357775745`*^9}, {3.690000485690069*^9, 
   3.6900005044466743`*^9}, {3.690001292253702*^9, 3.6900012963371115`*^9}, 
   3.690004479305722*^9, {3.6901290558612537`*^9, 3.690129056918252*^9}, {
   3.690129112394973*^9, 3.6901291225679045`*^9}, {3.6901291689633846`*^9, 
   3.6901291827663774`*^9}, {3.6901292606890287`*^9, 
   3.6901292665434904`*^9}, {3.6901293028562937`*^9, 
   3.6901293105553174`*^9}, {3.690129371411908*^9, 3.6901294550461516`*^9}, {
   3.6901295119123926`*^9, 3.6901295290038757`*^9}, {3.6901295815570383`*^9, 
   3.690129586637545*^9}, 3.690129674004936*^9, {3.6901297839629498`*^9, 
   3.6901298076120844`*^9}, {3.6901298820206823`*^9, 3.6901299081551085`*^9}, 
   3.690131079200898*^9, {3.6901311625760145`*^9, 3.6901312410237875`*^9}, {
   3.690131312018956*^9, 3.690131314433852*^9}, {3.690131405939188*^9, 
   3.6901314103611264`*^9}, 3.6901315235608654`*^9, {3.690131668676735*^9, 
   3.690131688306327*^9}, {3.6901317221167793`*^9, 3.6901317833162537`*^9}, {
   3.690131829145713*^9, 3.690131844463916*^9}, 3.6901329249943323`*^9, {
   3.6901329605749173`*^9, 3.690132983793914*^9}, {3.6901330241229486`*^9, 
   3.6901330299254937`*^9}, {3.690133075454568*^9, 3.690133075845195*^9}, {
   3.6901343572842865`*^9, 3.690134358513234*^9}, {3.690134727150283*^9, 
   3.6901347277753267`*^9}, {3.6901348677977147`*^9, 3.690134874246049*^9}, 
   3.711384643044145*^9, 3.7113848796867495`*^9, {3.7115576497891026`*^9, 
   3.711557650445357*^9}, 3.7115761098878293`*^9, {3.7115770941617193`*^9, 
   3.7115771188806233`*^9}, 3.7115772094907556`*^9, {3.711577552493636*^9, 
   3.711577567478126*^9}, {3.711577702104267*^9, 3.711577704213659*^9}, {
   3.711578208795988*^9, 3.7115782132335253`*^9}, {3.711578575988639*^9, 
   3.7115785873012342`*^9}, 3.7115786213171434`*^9, {3.711578676645731*^9, 
   3.7115787705528193`*^9}, 3.7115788075843253`*^9, {3.711588381513346*^9, 
   3.7115883856852446`*^9}, {3.711588439138817*^9, 3.711588442670149*^9}, {
   3.711588526483296*^9, 3.7115885313115005`*^9}, 3.7115891863794928`*^9, {
   3.7115896882066207`*^9, 3.711589688456621*^9}, {3.711589807973287*^9, 
   3.7115898089732533`*^9}, {3.7115899877872486`*^9, 3.71158999192791*^9}, 
   3.7115900352720222`*^9, 3.7115900733035903`*^9, {3.7115901238821373`*^9, 
   3.7115901871951675`*^9}, {3.711590255492613*^9, 3.71159029899303*^9}, 
   3.711590333915144*^9, {3.711590370759202*^9, 3.711590407150135*^9}, {
   3.711590437462886*^9, 3.7115904457754555`*^9}, {3.71159053307306*^9, 
   3.711590580557888*^9}, {3.711810254803043*^9, 3.71181026455307*^9}, {
   3.711810300100243*^9, 3.711810319100455*^9}, {3.7118736657903337`*^9, 
   3.7118736708997517`*^9}, {3.7128804975031204`*^9, 
   3.7128805028156943`*^9}, {3.7128805516130905`*^9, 3.712880585785343*^9}, {
   3.7144914602745223`*^9, 3.7144914661414337`*^9}, 3.7144915023311*^9, {
   3.714492083135249*^9, 3.7144920888554716`*^9}, {3.717346702907774*^9, 
   3.717346703048402*^9}, {3.7179064267560444`*^9, 3.7179064288498125`*^9}, 
   3.7179065804450197`*^9, {3.7179066289923563`*^9, 3.7179066584457636`*^9}, {
   3.7179066985086374`*^9, 3.7179067545404186`*^9}, {3.7179067963689423`*^9, 
   3.7179068966667595`*^9}, {3.717906977730029*^9, 3.7179070054334183`*^9}, {
   3.7179070520588617`*^9, 3.7179070744496994`*^9}, 3.717907320545273*^9, {
   3.7179075054532804`*^9, 3.7179075090627007`*^9}, 3.7183273422806163`*^9, {
   3.7183275682828474`*^9, 3.7183275728297668`*^9}, {3.718327962692997*^9, 
   3.718327999615237*^9}},ExpressionUUID->"258251b7-9b4c-4c39-a81d-\
70808e3f5d52"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operations on Functions", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6729228450322733`*^9, 3.6729228470646935`*^9}, {3.6729235232568893`*^9, 
  3.6729235256788254`*^9}, {3.6731965701825666`*^9, 3.6731966061576476`*^9}, {
  3.67319669842465*^9, 3.6731966990809608`*^9}, {3.6731979878874626`*^9, 
  3.6731980015527925`*^9}, {3.6746087427962484`*^9, 3.674608744499389*^9}, {
  3.680269846475335*^9, 3.680269847633199*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MergeFunctions", ",", " ", "HoldRest"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MergeFunctions", "[", 
    RowBox[{"fcns_", ",", " ", "F_", ",", " ", 
     RowBox[{"lcls_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"n_:", "0"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "p", ",", " ", "e", ",", " ", "g", ",", " ", "a", ",", 
       " ", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"DownValues", " ", "/@", " ", "fcns"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"Cases", "[", 
        RowBox[{"f", ",", " ", 
         RowBox[{
          RowBox[{"HoldPattern", "[", 
           RowBox[{"Module", "[", 
            RowBox[{"x_", ",", " ", "y_"}], "]"}], "]"}], " ", 
          "\[RuleDelayed]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Hold", "[", "x", "]"}], ",", " ", 
            RowBox[{"Hold", "[", "y", "]"}]}], "}"}]}], ",", " ", 
         "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"wrap", " ", "Hold", " ", "around", " ", "each", " ", "arg"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"e", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"Hold", "[", "lcls", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"Thread", " ", "/@", " ", "a"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", "a", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "combine", " ", "separate", " ", "expression", " ", "into", " ", 
        "one"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{
        RowBox[{"Join", "@@", 
         RowBox[{"e", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}], " ", "/.",
         " ", 
        RowBox[{
         RowBox[{"Hold", "[", "x__", "]"}], " ", "\[RuleDelayed]", " ", 
         RowBox[{"Hold", "[", 
          RowBox[{"CompoundExpression", "[", "x", "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"FlattenCompoundExpressions", "[", "b", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"HoldPattern", "[", "a", "]"}], " ", "\[Rule]", " ", "a"}], 
         ",", " ", 
         RowBox[{
          RowBox[{"HoldPattern", "[", "b", "]"}], " ", "\[Rule]", " ", 
          "b"}]}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"Head", "[", "F", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ReleaseHold", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "\"\<F\>\"", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"DownValues", "[", "\"\<F\>\"", "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"HoldPattern", "[", "F", "]"}], "\[RuleDelayed]", 
                 RowBox[{"Module", "[", 
                  RowBox[{"a", ",", " ", "b"}], "]"}]}], "}"}], " ", "/.", 
               " ", "g"}], " ", "/.", " ", 
              RowBox[{
               RowBox[{"Hold", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
               "x"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"DifferentiateFunction", "[", 
             RowBox[{"\"\<F\>\"", ",", " ", "n"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], " ", "/.", " ", 
        RowBox[{"\"\<F\>\"", " ", "\[Rule]", " ", "f"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7177189482211733`*^9, {3.717719030096952*^9, 3.7177190564409657`*^9}, 
   3.7177388169505105`*^9, {3.717739062921599*^9, 3.7177390780623817`*^9}, {
   3.7177626786525383`*^9, 3.7177627692940245`*^9}, {3.7177629116860027`*^9, 
   3.717763030856389*^9}, {3.7177631115602727`*^9, 3.717763121466631*^9}, {
   3.7177632038580236`*^9, 3.717763208842454*^9}, {3.717763246592819*^9, 
   3.717763279327501*^9}, {3.7177633673595877`*^9, 3.7177635522675943`*^9}, {
   3.717763590986701*^9, 3.7177636404715576`*^9}, {3.7177637206754456`*^9, 
   3.7177637738322*^9}, {3.7177638045981226`*^9, 
   3.717763874551898*^9}},ExpressionUUID->"4ad40dc0-de4f-49c3-af92-\
d4c71df327d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DifferentiateFunction", "[", 
    RowBox[{"fcn_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"DownValues", "@", "fcn"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"DifferentiateFunctionArguments", "[", 
        RowBox[{"f", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"DifferentiateLocalArguments", "[", 
        RowBox[{"f", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DifferentiateSetStatements", "[", 
       RowBox[{"f", ",", " ", "n"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231473762894`*^9, 3.67292333059666*^9}, {
   3.672923569896279*^9, 3.6729235971152735`*^9}, {3.6729236576325245`*^9, 
   3.672923778232132*^9}, {3.67292382112319*^9, 3.672923822203421*^9}, {
   3.672933886099881*^9, 3.672933913901292*^9}, {3.6729339542354774`*^9, 
   3.672934116763858*^9}, {3.6729341568736563`*^9, 3.67293418242076*^9}, {
   3.6729346973963056`*^9, 3.672934708755745*^9}, {3.6729347744438443`*^9, 
   3.6729347795883484`*^9}, {3.6729348324603205`*^9, 3.672934876447199*^9}, {
   3.672934919614563*^9, 3.672934934793215*^9}, {3.6729350147431393`*^9, 
   3.672935044958498*^9}, {3.6729350802676315`*^9, 3.672935092689661*^9}, {
   3.6729351387809553`*^9, 3.672935159531186*^9}, {3.6729352126566706`*^9, 
   3.67293529614421*^9}, 3.6729353830951786`*^9, {3.672935639630994*^9, 
   3.6729357272039003`*^9}, 3.672937702423049*^9, {3.672937744922078*^9, 
   3.6729377903379717`*^9}, {3.67293788968925*^9, 3.672937939696617*^9}, {
   3.6729379844498577`*^9, 3.6729380008792334`*^9}, {3.672938083670993*^9, 
   3.6729381365376663`*^9}, {3.6729382059697833`*^9, 3.672938219413664*^9}, {
   3.672938301312541*^9, 3.672938321211969*^9}, {3.67293835304044*^9, 
   3.6729383760063505`*^9}, {3.672938550922858*^9, 3.672938619751956*^9}, {
   3.672938661564331*^9, 3.672938666142521*^9}, {3.6729387005211987`*^9, 
   3.6729387569056244`*^9}, {3.672938811214872*^9, 3.672938814326576*^9}, {
   3.672938971020873*^9, 3.672939001369969*^9}, {3.6729390483372555`*^9, 
   3.672939051813734*^9}, {3.672939110853039*^9, 3.672939116118719*^9}, {
   3.6729393516950064`*^9, 3.672939353493438*^9}, 3.672940702976226*^9, {
   3.672942002456709*^9, 3.672942010023283*^9}, {3.672942132038026*^9, 
   3.6729421651053705`*^9}, {3.6729423737093782`*^9, 3.6729424581562014`*^9}, 
   3.6729425192817574`*^9, {3.672942580859954*^9, 3.6729426141050115`*^9}, 
   3.672942660676553*^9, 3.6729428396714945`*^9, {3.6729428744373956`*^9, 
   3.6729428791205645`*^9}, {3.672942927683508*^9, 3.672942992563116*^9}, {
   3.6729430276005516`*^9, 3.672943122465444*^9}, 3.6729431542673244`*^9, {
   3.672943238174302*^9, 3.6729432405337386`*^9}, {3.6729433089185257`*^9, 
   3.6729433118091726`*^9}, 3.6729433697208347`*^9, {3.6729435556082187`*^9, 
   3.6729435747778*^9}, {3.672946687205556*^9, 3.67294671925691*^9}, {
   3.672946881884638*^9, 3.6729469172728367`*^9}, {3.6729469515983715`*^9, 
   3.6729469546648965`*^9}, {3.6729471408857393`*^9, 3.672947145781169*^9}, {
   3.67294721585527*^9, 3.6729472364731436`*^9}, {3.6729472679396877`*^9, 
   3.6729472812522697`*^9}, {3.672947391245015*^9, 3.67294740292869*^9}, {
   3.672966815729293*^9, 3.672966816401171*^9}, {3.6729669268084307`*^9, 
   3.6729669329774275`*^9}, {3.6729672451969414`*^9, 
   3.6729672651497607`*^9}, {3.672967296509385*^9, 3.6729673161502266`*^9}, {
   3.6729673506974177`*^9, 3.6729673590412054`*^9}, {3.672967467042173*^9, 
   3.672967506683215*^9}, {3.67296858325613*^9, 3.672968583990512*^9}, {
   3.672968627647162*^9, 3.6729686346472263`*^9}, {3.672968665897509*^9, 
   3.6729688137658796`*^9}, {3.6729689351536317`*^9, 
   3.6729689401849833`*^9}, {3.6729689729561005`*^9, 3.672968977846769*^9}, {
   3.672969010237632*^9, 3.672969103181587*^9}, {3.6729692950114727`*^9, 
   3.672969324717699*^9}, {3.6729696007983446`*^9, 3.67296960904842*^9}, {
   3.6729696755645933`*^9, 3.6729697808662777`*^9}, {3.672969873924942*^9, 
   3.6729698792062254`*^9}, {3.672970008863673*^9, 3.6729700145981436`*^9}, {
   3.672970068286091*^9, 3.6729700935519867`*^9}, {3.6729701709588995`*^9, 
   3.672970178740264*^9}, {3.6729702579128046`*^9, 3.6729702622307987`*^9}, {
   3.67297340416953*^9, 3.672973405599137*^9}, 3.6729734455838785`*^9, {
   3.6729735297125144`*^9, 3.6729735654776716`*^9}, {3.6729736064468374`*^9, 
   3.672973626212637*^9}, {3.672973664403517*^9, 3.6729736928568616`*^9}, {
   3.672973735638542*^9, 3.672973779107648*^9}, {3.672973832295675*^9, 
   3.6729738405830884`*^9}, 3.6729738914585905`*^9, {3.672973950064999*^9, 
   3.672973976853453*^9}, {3.6729740804064713`*^9, 3.6729740825784245`*^9}, 
   3.672974424774643*^9, {3.6729744893690414`*^9, 3.672974502275411*^9}, {
   3.6729746259866323`*^9, 3.6729746289210978`*^9}, {3.672974690116191*^9, 
   3.672974733517294*^9}, {3.672974815264155*^9, 3.672974820728876*^9}, {
   3.672993064251093*^9, 3.6729930885773406`*^9}, {3.672993134876603*^9, 
   3.672993135470359*^9}, {3.6729932326356907`*^9, 3.6729932427763824`*^9}, {
   3.672993479263315*^9, 3.6729936256398716`*^9}, {3.6729936893162646`*^9, 
   3.672993715113412*^9}, {3.6729937496813855`*^9, 3.672993778670251*^9}, {
   3.6729938988808193`*^9, 3.672993955371016*^9}, {3.67299400763064*^9, 
   3.6729940088181553`*^9}, {3.672994074745188*^9, 3.6729941045464*^9}, {
   3.6729941610799336`*^9, 3.67299420086067*^9}, {3.672994269168688*^9, 
   3.672994315286899*^9}, {3.672994597047865*^9, 3.6729945974541216`*^9}, {
   3.6729947173460193`*^9, 3.6729947691640368`*^9}, {3.672994810617605*^9, 
   3.672994817180175*^9}, {3.672994897500884*^9, 3.6729949006102943`*^9}, {
   3.672994983017383*^9, 3.6729949834080496`*^9}, {3.6729951793438215`*^9, 
   3.672995338503119*^9}, {3.672995424582159*^9, 3.67299548231715*^9}, {
   3.6729955210700097`*^9, 3.6729955976702776`*^9}, {3.6729956311238136`*^9, 
   3.672995662358493*^9}, {3.672995711624671*^9, 3.672995916968398*^9}, {
   3.672996420415288*^9, 3.672996513131817*^9}, {3.6729966176006503`*^9, 
   3.67299663430315*^9}, {3.672996704290532*^9, 3.6729967153218937`*^9}, {
   3.6729967542441473`*^9, 3.6729968334050426`*^9}, {3.672996874377798*^9, 
   3.672996874612172*^9}, 3.672996911018773*^9, {3.6729984047719135`*^9, 
   3.672998444584838*^9}, {3.6729985117418036`*^9, 3.672998515163657*^9}, {
   3.6729985541016283`*^9, 3.6729985877130237`*^9}, {3.672998676056633*^9, 
   3.6729987092501755`*^9}, {3.6729987464983377`*^9, 
   3.6729987479515343`*^9}, {3.6729987788893647`*^9, 
   3.6729987816302924`*^9}, {3.672998932475648*^9, 3.6729990082252407`*^9}, {
   3.6729990588664417`*^9, 3.6729990866948643`*^9}, {3.6729991351538115`*^9, 
   3.6729991504039755`*^9}, {3.672999261655156*^9, 3.6729993557967854`*^9}, {
   3.672999471566995*^9, 3.672999528973894*^9}, {3.672999574321541*^9, 
   3.6729995829622135`*^9}, 3.6730000477994986`*^9, {3.673000112040515*^9, 
   3.673000117649952*^9}, {3.67300015835347*^9, 3.673000181259946*^9}, {
   3.6730002259636035`*^9, 3.6730002926049376`*^9}, {3.673000400574797*^9, 
   3.673000418408077*^9}, {3.6730004726345587`*^9, 3.6730004778377585`*^9}, {
   3.6730005216819744`*^9, 3.6730005263895907`*^9}, {3.6730006655629253`*^9, 
   3.673000756860651*^9}, {3.673001135468763*^9, 3.6730011374062834`*^9}, {
   3.6730012051257534`*^9, 3.6730012066570196`*^9}, {3.6730012649076405`*^9, 
   3.6730013111824493`*^9}, {3.6730013711353936`*^9, 3.673001379869859*^9}, {
   3.6730014761208467`*^9, 3.6730015090118065`*^9}, {3.6730019445789967`*^9, 
   3.6730019759107084`*^9}, {3.6730036460961676`*^9, 3.673003683274808*^9}, {
   3.6730037533536797`*^9, 3.6730037543981867`*^9}, {3.673003799389406*^9, 
   3.6730038000938005`*^9}, {3.673003835411345*^9, 3.67300388243285*^9}, {
   3.6730039407304*^9, 3.6730039433214674`*^9}, {3.6730040123534546`*^9, 
   3.6730040263222976`*^9}, {3.6730040564156885`*^9, 3.673004063572014*^9}, {
   3.673004234045515*^9, 3.6730042375631127`*^9}, {3.673004363743765*^9, 
   3.673004367384425*^9}, {3.673005622106264*^9, 3.673005670731781*^9}, {
   3.673008261426072*^9, 3.673008293193389*^9}, {3.6730083441433067`*^9, 
   3.673008390231715*^9}, {3.6730085249653845`*^9, 3.6730085291832886`*^9}, {
   3.673008567825856*^9, 3.6730085686696167`*^9}, {3.6730086014199657`*^9, 
   3.673008620818368*^9}, {3.6730088113665414`*^9, 3.673008862738968*^9}, 
   3.6730091692670264`*^9, {3.67301460825314*^9, 3.673014622927169*^9}, {
   3.673014975008257*^9, 3.673014976698572*^9}, {3.673092750460484*^9, 
   3.673092774826923*^9}, {3.6730928639959016`*^9, 3.6730928645373955`*^9}, {
   3.6730929276506357`*^9, 3.673092972721137*^9}, 3.673093010045974*^9, {
   3.673093860112836*^9, 3.6730938669156528`*^9}, {3.673094050199472*^9, 
   3.6730940502144833`*^9}, {3.6730955969619827`*^9, 
   3.6730956654961247`*^9}, {3.6730957119099903`*^9, 3.673095792085063*^9}, {
   3.673095835383345*^9, 3.673095838139547*^9}, {3.6730959143719316`*^9, 
   3.6730960079251027`*^9}, {3.6730960424060316`*^9, 3.673096050760952*^9}, {
   3.6730961099118357`*^9, 3.673096265588333*^9}, {3.6730963182130566`*^9, 
   3.6730963470674877`*^9}, {3.6730963778907957`*^9, 3.673096378751799*^9}, {
   3.6730964335914063`*^9, 3.6730964476398587`*^9}, {3.6730971613313665`*^9, 
   3.6730972619091783`*^9}, {3.6730972932797875`*^9, 
   3.6730973185395904`*^9}, {3.6730974355644364`*^9, 
   3.6730974401439705`*^9}, {3.6730974791739235`*^9, 3.673097514069307*^9}, {
   3.673097618411811*^9, 3.6730976809924903`*^9}, {3.6730978226771345`*^9, 
   3.6730978513864813`*^9}, {3.6730979093327*^9, 3.673097955834776*^9}, {
   3.673098500416672*^9, 3.673098501075818*^9}, {3.673098546582277*^9, 
   3.6730985702113013`*^9}, {3.6730986458379383`*^9, 3.6730986740607257`*^9}, 
   3.6730987353600626`*^9, {3.67309877873357*^9, 3.6730989628527126`*^9}, {
   3.673099265340266*^9, 3.6730992755592704`*^9}, {3.673099356590049*^9, 
   3.6730993572225513`*^9}, {3.6731015179516087`*^9, 
   3.6731015883528795`*^9}, {3.673101893687087*^9, 3.673101895237196*^9}, 
   3.6731020955720825`*^9, {3.6731021301269283`*^9, 3.673102180099937*^9}, {
   3.673102234051756*^9, 3.673102234210868*^9}, {3.6731022643032894`*^9, 
   3.6731023221196084`*^9}, {3.6731026258298216`*^9, 
   3.6731026262771387`*^9}, {3.67310270016525*^9, 3.6731027042511435`*^9}, 
   3.673102756466938*^9, {3.6731028462319784`*^9, 3.673102866139098*^9}, {
   3.673102901285778*^9, 3.67310292554869*^9}, {3.673103434381622*^9, 
   3.673103666644972*^9}, {3.67310373690971*^9, 3.6731037879101043`*^9}, {
   3.673103936715156*^9, 3.673103966846873*^9}, {3.6731040077291*^9, 
   3.6731040468099785`*^9}, {3.6731040805498877`*^9, 3.673104122708008*^9}, 
   3.673104206292513*^9, {3.673104243767274*^9, 3.673104283240779*^9}, {
   3.67310432777127*^9, 3.6731043846337824`*^9}, {3.6731045675428305`*^9, 
   3.6731045758822794`*^9}, {3.6731046713889513`*^9, 
   3.6731046997264175`*^9}, {3.6731047421467648`*^9, 
   3.6731048165873084`*^9}, {3.6731049254153643`*^9, 
   3.6731049542995267`*^9}, {3.6731049882954726`*^9, 
   3.6731050106617756`*^9}, {3.67310569894119*^9, 3.673105699073286*^9}, {
   3.673105745006565*^9, 3.6731057483279095`*^9}, {3.673106146342636*^9, 
   3.6731061912192845`*^9}, {3.6731062228228045`*^9, 3.6731062286790547`*^9}, 
   3.673106289217881*^9, {3.673106323860526*^9, 3.6731063626409903`*^9}, {
   3.6731064064518285`*^9, 3.6731064088995595`*^9}, 3.6731064666007247`*^9, {
   3.673106621683176*^9, 3.6731066229614983`*^9}, {3.6731067332981477`*^9, 
   3.67310675742727*^9}, {3.673106902586769*^9, 3.673106905561937*^9}, {
   3.6731070648563223`*^9, 3.6731070655406713`*^9}, {3.673107292061803*^9, 
   3.6731073281018534`*^9}, {3.6731073607169514`*^9, 
   3.6731073699009295`*^9}, {3.6731074550345125`*^9, 
   3.6731074885745087`*^9}, {3.673107632594349*^9, 3.673107640667688*^9}, {
   3.6731077365092077`*^9, 3.67310785155603*^9}, {3.6731078896457987`*^9, 
   3.6731080177531195`*^9}, {3.6731080491259284`*^9, 
   3.6731080760121136`*^9}, {3.673108168532712*^9, 3.6731082188486805`*^9}, 
   3.673108641881422*^9, {3.6731089583820496`*^9, 3.673108963058516*^9}, {
   3.6731090466613784`*^9, 3.673109050472077*^9}, {3.673192807411872*^9, 
   3.6731928114431643`*^9}, 3.673192892678402*^9, 3.673192941438696*^9, {
   3.6731964323296256`*^9, 3.67319643276713*^9}, 3.6731965665887604`*^9, 
   3.673196598970043*^9, {3.673196821994419*^9, 3.6731968290721345`*^9}, {
   3.673196988885521*^9, 3.6731969894948997`*^9}, {3.673197086407877*^9, 
   3.6731970869246445`*^9}, {3.673197124093593*^9, 3.673197128328007*^9}, {
   3.6731971642970543`*^9, 3.673197175281577*^9}, {3.6731972110500813`*^9, 
   3.6731972322065363`*^9}, {3.673405205274062*^9, 3.673405209430358*^9}, {
   3.673407871792041*^9, 3.673407879163915*^9}, {3.6734079581623106`*^9, 
   3.673407980927236*^9}, {3.673463231270979*^9, 3.673463245401657*^9}, {
   3.6735188291374006`*^9, 3.673518830059288*^9}, {3.673518886802058*^9, 
   3.673518891523387*^9}, {3.6735189805129213`*^9, 3.6735189994506655`*^9}, {
   3.6735224481030626`*^9, 3.6735224546188*^9}, {3.6735226518581877`*^9, 
   3.673522660983342*^9}, {3.6735227576922607`*^9, 3.673522759145401*^9}, {
   3.6735230110203915`*^9, 3.6735230371351624`*^9}, {3.673523180492337*^9, 
   3.673523188818979*^9}, {3.673523230194436*^9, 3.6735232319444523`*^9}, {
   3.673523265431002*^9, 3.673523362390115*^9}, {3.6735235117905254`*^9, 
   3.6735235131342363`*^9}, {3.673523847902669*^9, 3.673523961464225*^9}, {
   3.6735240376369405`*^9, 3.673524070427616*^9}, {3.673524194447047*^9, 
   3.6735241981081324`*^9}, {3.673524256201812*^9, 3.673524310136902*^9}, {
   3.673524407974611*^9, 3.673524459946006*^9}, {3.673524510134062*^9, 
   3.6735245447139783`*^9}, {3.6735246697093925`*^9, 3.673524707553556*^9}, {
   3.6735248499300966`*^9, 3.673524851086359*^9}, {3.67352562218001*^9, 
   3.673525629398841*^9}, {3.673525739155207*^9, 3.673525746061531*^9}, {
   3.6735259260624385`*^9, 3.6735259402188883`*^9}, {3.673526008464738*^9, 
   3.6735260244492884`*^9}, {3.6735260849655986`*^9, 
   3.6735260906531982`*^9}, {3.6735286887472973`*^9, 
   3.6735287037623987`*^9}, {3.6735287716381874`*^9, 
   3.6735288428928566`*^9}, {3.6735289805662923`*^9, 3.67352900084776*^9}, {
   3.6735291476150055`*^9, 3.673529193349848*^9}, 3.6736205693757935`*^9, {
   3.6736206045530276`*^9, 3.6736206349741745`*^9}, 3.6736206909182606`*^9, 
   3.673620798263092*^9, {3.6736208527422504`*^9, 3.673620892727169*^9}, {
   3.6736214911051216`*^9, 3.673621522773225*^9}, {3.673621572368353*^9, 
   3.673621591926754*^9}, 3.673621650366064*^9, {3.6736597252811856`*^9, 
   3.673659772410232*^9}, {3.673659816375909*^9, 3.673659821778139*^9}, {
   3.673660180015358*^9, 3.6736601916025105`*^9}, {3.673660225116188*^9, 
   3.6736602422592354`*^9}, {3.673660896395646*^9, 3.673660949294095*^9}, {
   3.6736609806131706`*^9, 3.673660986448886*^9}, {3.673661565104325*^9, 
   3.673661569090539*^9}, 3.6736616522702155`*^9, {3.673661919603377*^9, 
   3.6736619278261952`*^9}, {3.6736622073829117`*^9, 3.673662216969177*^9}, {
   3.673662407763562*^9, 3.673662429320773*^9}, 3.6736625457608967`*^9, {
   3.6736626884166603`*^9, 3.6736627187183247`*^9}, {3.6736627668301716`*^9, 
   3.673662766988927*^9}, {3.673687983730879*^9, 3.673688052387804*^9}, {
   3.673695061442609*^9, 3.6736950621144943`*^9}, {3.6736952740855646`*^9, 
   3.6736952748980694`*^9}, {3.6736955615260153`*^9, 
   3.6736955711042385`*^9}, {3.6736977524087734`*^9, 
   3.6736977532681956`*^9}, {3.673698882329829*^9, 3.6736988827986336`*^9}, {
   3.6736996539148417`*^9, 3.6736996543680167`*^9}, {3.6736997309699163`*^9, 
   3.673699743729955*^9}, {3.6736998366371613`*^9, 3.6736998371997223`*^9}, {
   3.673699912419244*^9, 3.673699986801875*^9}, 3.6737007114715805`*^9, {
   3.673700859327484*^9, 3.6737008990086946`*^9}, {3.6737009711813107`*^9, 
   3.6737010072129316`*^9}, {3.6737010466507945`*^9, 3.673701047291419*^9}, {
   3.673701108627741*^9, 3.673701275558638*^9}, {3.673701310387123*^9, 
   3.673701316965314*^9}, {3.6737016502656116`*^9, 3.6737018024390464`*^9}, {
   3.6737019234090385`*^9, 3.6737019239402933`*^9}, {3.673702149150129*^9, 
   3.673702206864233*^9}, {3.6737022619788437`*^9, 3.673702295787018*^9}, {
   3.673702624062162*^9, 3.673702645499925*^9}, 3.673702896174367*^9, {
   3.6737030182224965`*^9, 3.673703027950392*^9}, {3.6737031078545933`*^9, 
   3.6737031215109878`*^9}, {3.6737037772067933`*^9, 
   3.6737038315042796`*^9}, {3.6737038938059163`*^9, 3.673703894259047*^9}, {
   3.673704022623932*^9, 3.673704023952093*^9}, {3.6737041999695253`*^9, 
   3.673704205198105*^9}, {3.673704270764268*^9, 3.6737042760143576`*^9}, {
   3.673704356148484*^9, 3.673704358742262*^9}, {3.673704398350318*^9, 
   3.673704483977092*^9}, {3.6737046465412197`*^9, 3.673704650181884*^9}, 
   3.673704929855476*^9, {3.673705729998725*^9, 3.6737057700944033`*^9}, {
   3.673706354926861*^9, 3.673706488886578*^9}, {3.6737065243107896`*^9, 
   3.673706541154711*^9}, {3.6737067014476175`*^9, 3.673706701619491*^9}, {
   3.673706765022571*^9, 3.673706914942589*^9}, {3.6737069520836296`*^9, 
   3.6737069866862965`*^9}, {3.6737071102837195`*^9, 
   3.6737071242994924`*^9}, {3.6737071837374673`*^9, 3.673707187315677*^9}, {
   3.6737072185186605`*^9, 3.6737072201436768`*^9}, {3.673707343457713*^9, 
   3.6737073504264784`*^9}, {3.6737073988175993`*^9, 
   3.6737074167305403`*^9}, {3.6737078951431704`*^9, 3.673707899908846*^9}, {
   3.673707973319605*^9, 3.6737080630236473`*^9}, 3.6737081049359293`*^9, {
   3.6737081433661814`*^9, 3.6737081456162415`*^9}, {3.673708197382413*^9, 
   3.6737081994449377`*^9}, {3.673708230648383*^9, 3.6737082818989058`*^9}, {
   3.673708342899534*^9, 3.6737083705952587`*^9}, 3.673708416608807*^9, {
   3.6737084564998417`*^9, 3.673708472335002*^9}, {3.673708515465288*^9, 
   3.6737085163405843`*^9}, {3.6737086996659765`*^9, 
   3.6737087604635296`*^9}, {3.6737088105734177`*^9, 3.673708811720481*^9}, {
   3.6737088491583247`*^9, 3.673708868111644*^9}, {3.673710203693472*^9, 
   3.6737102575064645`*^9}, {3.67371062376575*^9, 3.6737106350940313`*^9}, 
   3.6737791887189207`*^9, {3.6737796227963*^9, 3.673779624593195*^9}, {
   3.673779664640479*^9, 3.673779665015482*^9}, {3.6737797885493164`*^9, 
   3.673779790460619*^9}, {3.6737967023728247`*^9, 3.673796749820363*^9}, {
   3.6737968828063383`*^9, 3.6737968834001513`*^9}, 3.6737969316975217`*^9, {
   3.6737969900574937`*^9, 3.673797011714405*^9}, {3.6737970736198483`*^9, 
   3.673797117715971*^9}, {3.6737976427001967`*^9, 3.673797643059614*^9}, {
   3.6737978066394215`*^9, 3.673797806998742*^9}, 3.6737982737799377`*^9, {
   3.6737998603351183`*^9, 3.673799872688257*^9}, 3.673799963454812*^9, {
   3.6738000030801754`*^9, 3.6738001054894643`*^9}, {3.6738001721776514`*^9, 
   3.6738002082405157`*^9}, {3.6738229305511055`*^9, 
   3.6738229388469768`*^9}, {3.673823044625134*^9, 3.6738230583609657`*^9}, {
   3.673823604027401*^9, 3.6738236043996973`*^9}, {3.6738237190546412`*^9, 
   3.67382372050033*^9}, 3.673824161102025*^9, {3.673827339157401*^9, 
   3.673827339641781*^9}, {3.673827400829911*^9, 3.673827447177389*^9}, {
   3.673827746475203*^9, 3.6738278072604895`*^9}, {3.673827837729553*^9, 
   3.673827865306802*^9}, {3.673828221274635*^9, 3.6738282229572997`*^9}, {
   3.673828263436757*^9, 3.6738282965933056`*^9}, {3.673828331080083*^9, 
   3.673828333048853*^9}, {3.673828382924369*^9, 3.6738283861431246`*^9}, {
   3.6738284404718347`*^9, 3.673828615127669*^9}, {3.673828655117944*^9, 
   3.6738286824428225`*^9}, {3.673828910325343*^9, 3.6738289290150304`*^9}, {
   3.673830806876315*^9, 3.673830937728383*^9}, {3.6738310564712725`*^9, 
   3.67383106712763*^9}, {3.6738311994520955`*^9, 3.6738312002489786`*^9}, {
   3.6738315294673696`*^9, 3.673831529654876*^9}, {3.6738316793907814`*^9, 
   3.673831679875124*^9}, {3.6738318154703054`*^9, 3.6738318622842684`*^9}, {
   3.673831952397986*^9, 3.6738320350243907`*^9}, {3.6738320790170517`*^9, 
   3.673832079407683*^9}, {3.673833823054076*^9, 3.673833851770221*^9}, {
   3.673833900906864*^9, 3.673833997533202*^9}, {3.6738340540004864`*^9, 
   3.6738340561255083`*^9}, {3.673834093657144*^9, 3.6738340963915453`*^9}, {
   3.673834162265249*^9, 3.673834180745737*^9}, 3.6738342222149167`*^9, {
   3.673834260590308*^9, 3.6738342643559375`*^9}, {3.673834958284996*^9, 
   3.6738349585193653`*^9}, {3.6738361465385213`*^9, 
   3.6738361528979626`*^9}, {3.6738362958736343`*^9, 
   3.6738363156863766`*^9}, {3.673836607592435*^9, 3.6738366214697266`*^9}, {
   3.673836974466318*^9, 3.673837016603362*^9}, {3.673837107229283*^9, 
   3.673837121636732*^9}, {3.673837399223879*^9, 3.673837452775747*^9}, 
   3.673837507213859*^9, {3.6738375949785376`*^9, 3.673837648252845*^9}, {
   3.6738379913749704`*^9, 3.6738380800882254`*^9}, {3.6738381241042476`*^9, 
   3.673838151354578*^9}, {3.673838190276405*^9, 3.673838209120345*^9}, {
   3.673838287308691*^9, 3.6738383215406294`*^9}, {3.673838514017105*^9, 
   3.673838514188943*^9}, {3.673838547001821*^9, 3.6738386339275427`*^9}, {
   3.6738386982563286`*^9, 3.6738387621944294`*^9}, {3.6738388124293365`*^9, 
   3.6738388971701574`*^9}, 3.673839036734089*^9, 3.6738391059857364`*^9, {
   3.6738392150806446`*^9, 3.673839347053564*^9}, {3.6738609008421087`*^9, 
   3.673860904685893*^9}, {3.673860947418183*^9, 3.673860956840209*^9}, {
   3.6738609875748444`*^9, 3.673861014559554*^9}, {3.673861075357053*^9, 
   3.673861077107071*^9}, {3.673861281390418*^9, 3.673861290343633*^9}, {
   3.6738624021438446`*^9, 3.6738624590246515`*^9}, {3.6738626855251837`*^9, 
   3.6738627352994747`*^9}, {3.6738627803624573`*^9, 3.673862902036069*^9}, {
   3.6738629448490076`*^9, 3.673863010385069*^9}, {3.6738633641094937`*^9, 
   3.673863453835796*^9}, {3.6738634864847527`*^9, 3.673863490170454*^9}, {
   3.6738635216061296`*^9, 3.673863605174364*^9}, {3.6738636903483686`*^9, 
   3.6738636908170657`*^9}, {3.6738638209400363`*^9, 3.67386385819615*^9}, {
   3.673863901854392*^9, 3.673863945173967*^9}, {3.673864003361137*^9, 
   3.673864068920088*^9}, {3.67386416621815*^9, 3.67386416742129*^9}, {
   3.6738643512350473`*^9, 3.673864352406936*^9}, {3.6738644747158184`*^9, 
   3.6738645523626995`*^9}, {3.6738645939099693`*^9, 
   3.6738646261759577`*^9}, {3.6738646656713786`*^9, 
   3.6738646720307627`*^9}, {3.673864725737336*^9, 3.673864741096871*^9}, {
   3.6738649498799033`*^9, 3.673864950067365*^9}, {3.6738652353755217`*^9, 
   3.6738652410657854`*^9}, {3.673865328004176*^9, 3.6738653870047417`*^9}, 
   3.6738655731364765`*^9, {3.6738659581320734`*^9, 3.6738660118252335`*^9}, {
   3.673866052700638*^9, 3.6738660962208457`*^9}, {3.6738661370571637`*^9, 
   3.6738661407758927`*^9}, {3.6738661969906273`*^9, 3.67386619791251*^9}, {
   3.6738662331472425`*^9, 3.6738662341159678`*^9}, {3.6738663073067665`*^9, 
   3.673866367743537*^9}, {3.6738664061970615`*^9, 3.673866438709003*^9}, {
   3.6738665343662357`*^9, 3.673866613787884*^9}, {3.67386669774187*^9, 
   3.673866756666215*^9}, {3.6738667955645666`*^9, 3.673866838246605*^9}, {
   3.673867018935957*^9, 3.6738670808888617`*^9}, {3.6738671263112054`*^9, 
   3.673867184499302*^9}, {3.6738672722281055`*^9, 3.673867322904101*^9}, {
   3.6738673652098627`*^9, 3.673867607895364*^9}, {3.6738676475896916`*^9, 
   3.67386769166376*^9}, {3.6738678652818637`*^9, 3.673867939787032*^9}, {
   3.67386835488878*^9, 3.6738683734202185`*^9}, {3.673868444077177*^9, 
   3.673868482501258*^9}, {3.673868553370479*^9, 3.673868626104807*^9}, {
   3.6738687031311493`*^9, 3.673868706021805*^9}, {3.6738688025852957`*^9, 
   3.6738688090683217`*^9}, {3.673868852608241*^9, 3.6738688693271217`*^9}, {
   3.673868918429812*^9, 3.6738689600396147`*^9}, {3.6738690203182716`*^9, 
   3.6738690212245646`*^9}, {3.6738695300107665`*^9, 3.673869570822882*^9}, {
   3.673869655443761*^9, 3.673869664818858*^9}, {3.6738697133505497`*^9, 
   3.6738697369919915`*^9}, {3.67386990817036*^9, 3.6738699100297165`*^9}, {
   3.673869941045644*^9, 3.6738699430996633`*^9}, {3.6738700520363374`*^9, 
   3.673870054072201*^9}, {3.6738700975711713`*^9, 3.673870132009756*^9}, {
   3.673870891674554*^9, 3.6738708941623983`*^9}, {3.673872122593462*^9, 
   3.673872168340045*^9}, {3.673872214536224*^9, 3.6738722159581146`*^9}, {
   3.673872572555564*^9, 3.673872600446474*^9}, {3.6738726736346865`*^9, 
   3.67387267829919*^9}, {3.673872728929242*^9, 3.6738727339136744`*^9}, {
   3.6738730432983418`*^9, 3.6738731199241257`*^9}, 3.6738731688949833`*^9, {
   3.6738733130272317`*^9, 3.673873358246448*^9}, {3.673873537543908*^9, 
   3.67387354021587*^9}, {3.673873577335226*^9, 3.6738736046480083`*^9}, {
   3.673873778649796*^9, 3.673873793181195*^9}, 3.6738761561368113`*^9, {
   3.6738765873654346`*^9, 3.673876591787358*^9}, {3.6738774041172705`*^9, 
   3.6738774144299335`*^9}, {3.67387756072491*^9, 3.673877592483136*^9}, {
   3.67387762656157*^9, 3.6738776595307007`*^9}, {3.67387770025611*^9, 
   3.673877737155512*^9}, {3.673877790297101*^9, 3.673877827293272*^9}, {
   3.6738778821302648`*^9, 3.6738779651949*^9}, {3.673878066352147*^9, 
   3.673878076899131*^9}, {3.6738782331054606`*^9, 3.673878289512329*^9}, {
   3.6738785982263994`*^9, 3.6738785996014137`*^9}, {3.673879292900654*^9, 
   3.673879324476345*^9}, {3.6738793926872396`*^9, 3.6738794079951105`*^9}, {
   3.67387943857359*^9, 3.6738794464249315`*^9}, {3.673879479589204*^9, 
   3.673879706200823*^9}, {3.673879803464884*^9, 3.6738798361092625`*^9}, {
   3.673879937225372*^9, 3.673880002335373*^9}, {3.673880062398532*^9, 
   3.6738801334773455`*^9}, {3.6738803695891266`*^9, 
   3.6738804241066856`*^9}, {3.673880739281756*^9, 3.6738807545631104`*^9}, {
   3.673880847221655*^9, 3.6738808540655146`*^9}, {3.673881145276297*^9, 
   3.67388114566693*^9}, {3.673881313050373*^9, 3.6738813695206137`*^9}, {
   3.673881420568016*^9, 3.673881506498324*^9}, {3.6738815389361706`*^9, 
   3.6738815679560003`*^9}, {3.67388164043686*^9, 3.6738816619839954`*^9}, {
   3.673882093937314*^9, 3.6738821482191224`*^9}, {3.6738822071572285`*^9, 
   3.6738823246958933`*^9}, {3.6738824193697433`*^9, 3.673882419651039*^9}, {
   3.673882525603676*^9, 3.673882525916175*^9}, {3.673882589448082*^9, 
   3.6738825905418425`*^9}, {3.6738826583859577`*^9, 3.673882663698512*^9}, {
   3.673882701917655*^9, 3.673882730136692*^9}, {3.6738827616995163`*^9, 
   3.673882792136446*^9}, {3.6738828582933197`*^9, 3.673882896895021*^9}, {
   3.673882963345891*^9, 3.673882996506648*^9}, {3.6738830306475735`*^9, 
   3.673883056767188*^9}, 3.6738830994082503`*^9, {3.6738832516128793`*^9, 
   3.6738835337417684`*^9}, {3.6738835848403172`*^9, 3.673883585777861*^9}, {
   3.6738836488253803`*^9, 3.673883652778544*^9}, {3.6738842869203005`*^9, 
   3.6738844092965555`*^9}, {3.6738844846328955`*^9, 3.673884484820395*^9}, {
   3.673884692900603*^9, 3.6738847942130327`*^9}, {3.6738848659481983`*^9, 
   3.673884868291937*^9}, {3.673961788839229*^9, 3.673961793879814*^9}, 
   3.6739735970529866`*^9, 3.67397584403415*^9, {3.673975955688366*^9, 
   3.673976004291283*^9}, {3.6739760367056313`*^9, 3.6739760669120874`*^9}, {
   3.6739761043285847`*^9, 3.6739761132589035`*^9}, {3.674049163183374*^9, 
   3.674049236141945*^9}, 3.6740493244048395`*^9, {3.6740493559804726`*^9, 
   3.6740493985422573`*^9}, {3.6740494695083156`*^9, 
   3.6740495028625584`*^9}, {3.6740496739948215`*^9, 3.674049675304772*^9}, 
   3.67405619263844*^9, {3.67405623533573*^9, 3.674056284202018*^9}, {
   3.674056326670761*^9, 3.674056348314724*^9}, {3.6740563798253326`*^9, 
   3.6740563866214333`*^9}, {3.674094296584594*^9, 3.674094298069022*^9}, 
   3.674131492753136*^9, 3.674178994048335*^9, {3.6741805266063375`*^9, 
   3.6741805424971323`*^9}, {3.6741806255292673`*^9, 
   3.6741806350293617`*^9}, {3.6742190685208845`*^9, 
   3.6742191215586143`*^9}, {3.6742192494806647`*^9, 3.674219256058809*^9}, {
   3.6742198883831463`*^9, 3.6742198891331134`*^9}, {3.6742281056620665`*^9, 
   3.674228106683223*^9}, {3.6742283210572853`*^9, 3.674228353323249*^9}, {
   3.674228436371473*^9, 3.6742285106840496`*^9}, {3.6742285859346514`*^9, 
   3.6742285867940483`*^9}, {3.674228628888209*^9, 3.674228631638194*^9}, {
   3.6742287504361477`*^9, 3.674228765427442*^9}, {3.6742289996639023`*^9, 
   3.674229020945341*^9}, {3.6742290825552516`*^9, 3.6742291042741933`*^9}, {
   3.6742292645055437`*^9, 3.6742292756239405`*^9}, {3.674229411156407*^9, 
   3.6742294831921444`*^9}, {3.6742295243409004`*^9, 
   3.6742296075640926`*^9}, {3.6742297230338526`*^9, 3.674229782992811*^9}, {
   3.674229825477559*^9, 3.674229834165135*^9}, {3.6742298848434095`*^9, 
   3.6742298927341003`*^9}, {3.6742299640159197`*^9, 
   3.6742300146726675`*^9}, {3.6742301458117547`*^9, 
   3.6742302435782356`*^9}, {3.674230622176481*^9, 3.67423064995154*^9}, {
   3.674230692467535*^9, 3.6742307971412897`*^9}, {3.6742308327197285`*^9, 
   3.674230995476261*^9}, {3.6742310285718513`*^9, 3.674231041539591*^9}, {
   3.6742310729773655`*^9, 3.6742310936181707`*^9}, {3.6742311321810074`*^9, 
   3.6742311779500685`*^9}, {3.6742312268442135`*^9, 
   3.6742312297887735`*^9}, {3.6742313383053913`*^9, 
   3.6742315791066217`*^9}, {3.6742316432187247`*^9, 3.6742316527697353`*^9}, 
   3.674231696413912*^9, {3.674231728540717*^9, 3.674231731275115*^9}, {
   3.674231813729166*^9, 3.6742318439874144`*^9}, {3.674231883766206*^9, 
   3.6742319317017546`*^9}, {3.6742319687020216`*^9, 
   3.6742320307429795`*^9}, {3.674232091993515*^9, 3.67423209246216*^9}, {
   3.6742321547818594`*^9, 3.6742321576801786`*^9}, {3.6742323407842507`*^9, 
   3.674232346081135*^9}, {3.6742324205349503`*^9, 3.6742324574195337`*^9}, {
   3.674232506715622*^9, 3.6742325074187555`*^9}, {3.6742325458237834`*^9, 
   3.674232562651998*^9}, {3.6742327043974857`*^9, 3.6742327665251865`*^9}, {
   3.67423296346259*^9, 3.6742329654000673`*^9}, {3.674233179191605*^9, 
   3.6742332328130746`*^9}, {3.674233266375871*^9, 3.6742334056970997`*^9}, {
   3.674233437766489*^9, 3.674233446750939*^9}, {3.674233503345189*^9, 
   3.6742335372887197`*^9}, {3.674233956765807*^9, 3.6742340082377872`*^9}, {
   3.674234092097868*^9, 3.674234172687406*^9}, {3.6742342059307365`*^9, 
   3.6742342191126013`*^9}, 3.6742342822849984`*^9, {3.6742344456301537`*^9, 
   3.6742344576117663`*^9}, {3.6742344939870768`*^9, 
   3.6742345119905934`*^9}, {3.674234795384448*^9, 3.6742348512824287`*^9}, {
   3.674235018365449*^9, 3.6742350551470222`*^9}, {3.674235088088449*^9, 
   3.6742351039353466`*^9}, {3.674235195029936*^9, 3.6742351956861424`*^9}, {
   3.6742524890397167`*^9, 3.674252489402973*^9}, {3.6742528485415893`*^9, 
   3.674252921672307*^9}, {3.674253041413743*^9, 3.6742530564494705`*^9}, {
   3.674299768827241*^9, 3.674299789816435*^9}, 3.6742998924080353`*^9, {
   3.674299936913656*^9, 3.674299938687909*^9}, {3.674305601367225*^9, 
   3.674305612398512*^9}, {3.6743058624394417`*^9, 3.6743058898479156`*^9}, {
   3.6743060456617193`*^9, 3.6743060819720955`*^9}, {3.6743061165661325`*^9, 
   3.6743061178942733`*^9}, {3.6743062524210043`*^9, 3.674306305086936*^9}, 
   3.6743962967335787`*^9, {3.674396989134615*^9, 3.674396989353321*^9}, {
   3.6743983182776194`*^9, 3.6743983203987226`*^9}, {3.6743983640240307`*^9, 
   3.674398365039385*^9}, {3.6743984222117014`*^9, 3.6743984767360497`*^9}, {
   3.674398507232953*^9, 3.674398512640567*^9}, {3.674398617101912*^9, 
   3.674398627058359*^9}, {3.674398744037783*^9, 3.674398854912772*^9}, {
   3.6746087138055263`*^9, 3.6746087628432894`*^9}, {3.6757880026984*^9, 
   3.675788008202099*^9}, {3.675790994473591*^9, 3.675791066973671*^9}, {
   3.675791173439558*^9, 3.6757911737974124`*^9}, {3.67585227513605*^9, 
   3.675852312402015*^9}, {3.6758525221306973`*^9, 3.67585254012637*^9}, {
   3.6759007554292974`*^9, 3.6759007596324606`*^9}, {3.675974993631215*^9, 
   3.6759750697157784`*^9}, {3.6759800721609087`*^9, 3.675980101390105*^9}, {
   3.6759806997059355`*^9, 3.675980753034547*^9}, {3.67600739148787*^9, 
   3.6760074157082605`*^9}, 3.676008653507032*^9, {3.6802216626429577`*^9, 
   3.6802216914488225`*^9}, {3.6802217820487523`*^9, 
   3.6802217853144073`*^9}},ExpressionUUID->"eb528a42-4da3-4674-a497-\
433f483745bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.672922910157816*^9, 3.6729229104546924`*^9}}],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231090809507`*^9, 3.6729231097997046`*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718, 718},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2593, 52, 285, "Code", "ExpressionUUID" -> \
"285b5be0-4653-45f0-a326-77e4a9dd6480"],
Cell[3154, 74, 1438, 37, 486, "Text", "ExpressionUUID" -> \
"d9a0edb2-dcac-486c-bd2d-201209e38aec"],
Cell[CellGroupData[{
Cell[4617, 115, 100, 1, 70, "Section", "ExpressionUUID" -> \
"f09cea84-d87d-49ec-a40b-0d936b6fdb75"],
Cell[4720, 118, 1706, 42, 237, "Input", "ExpressionUUID" -> \
"f59f84c0-b48f-4372-8e17-5a1474dbdc4f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6463, 165, 419, 6, 70, "Section", "ExpressionUUID" -> \
"98efe4b4-e822-4290-8973-17108c3ad40b"],
Cell[6885, 173, 213, 5, 51, "Input", "ExpressionUUID" -> \
"32288a83-7fe1-4da6-9175-2cefd97af4cb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[7135, 183, 379, 6, 70, "Section", "ExpressionUUID" -> \
"6198731d-17f5-4fa8-8990-0e6211c5bea0"],
Cell[7517, 191, 2114, 50, 199, "Input", "ExpressionUUID" -> \
"54921280-b6a3-4c55-8686-1fcca14196df",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[9668, 246, 367, 5, 70, "Section", "ExpressionUUID" -> \
"e43f368c-3e06-4444-a498-90e1c76fd7d5"],
Cell[10038, 253, 5585, 100, 218, "Input", "ExpressionUUID" -> \
"617be577-fd44-476e-9055-38b6624e59e3",
 InitializationCell->True],
Cell[15626, 355, 17370, 338, 832, "Input", "ExpressionUUID" -> \
"8dbb65ed-a9ed-449d-9edf-9797baf27ea3",
 InitializationCell->True],
Cell[32999, 695, 19435, 320, 630, "Input", "ExpressionUUID" -> \
"c77bcf6c-30c0-4f95-bf20-28ca0c182834",
 InitializationCell->True],
Cell[52437, 1017, 188, 4, 30, "Text", "ExpressionUUID" -> \
"611f5969-6488-4995-a29c-842832a1ee0f"],
Cell[52628, 1023, 14562, 240, 522, "Input", "ExpressionUUID" -> \
"ddacbb74-b94a-47c8-a75e-54f0351aa4a3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[67227, 1268, 374, 5, 70, "Section", "ExpressionUUID" -> \
"77f7d82a-a682-444d-bea1-c72489fedb32"],
Cell[67604, 1275, 19014, 337, 753, "Input", "ExpressionUUID" -> \
"eceb5adb-4596-401a-a23d-5cd3c1be4d9d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[86655, 1617, 353, 4, 70, "Section", "ExpressionUUID" -> \
"5ac54457-d957-432d-8838-a2a044e372fd"],
Cell[87011, 1623, 7283, 148, 528, "Input", "ExpressionUUID" -> \
"745e8d23-5e52-46b3-a28e-02053da667e3",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[94331, 1776, 412, 6, 70, "Section", "ExpressionUUID" -> \
"9d2ec7fe-a6d4-4090-ad58-65224e83a383"],
Cell[94746, 1784, 7462, 157, 503, "Input", "ExpressionUUID" -> \
"f3805c01-9b62-4e37-b635-29b206040d55",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[102245, 1946, 505, 7, 70, "Section", "ExpressionUUID" -> \
"48a5ef7a-a6c2-40a6-8601-37c9b1fafd6b"],
Cell[102753, 1955, 16259, 257, 332, "Input", "ExpressionUUID" -> \
"31691d20-74ca-4af9-9018-9af0b2b1db87",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[119049, 2217, 556, 8, 70, "Section", "ExpressionUUID" -> \
"4a2eaecf-96d5-420e-8f03-e4ef5aa67060"],
Cell[119608, 2227, 15909, 240, 218, "Input", "ExpressionUUID" -> \
"35f33b61-28e7-490c-b323-35582828e1d0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[135554, 2472, 317, 4, 70, "Section", "ExpressionUUID" -> \
"10569118-7b2d-4d09-83d1-12b5c7fabdf4"],
Cell[135874, 2478, 17789, 292, 446, "Input", "ExpressionUUID" -> \
"ce2a2e24-f88d-4fec-86dd-16658dfc7064",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[153700, 2775, 538, 7, 70, "Section", "ExpressionUUID" -> \
"b82a2380-21b8-4b75-8ade-e02f475e0f4c"],
Cell[154241, 2784, 38982, 607, 751, "Input", "ExpressionUUID" -> \
"f192004c-fde8-48eb-80a7-c0e956ff7ef4",
 InitializationCell->True],
Cell[193226, 3393, 5498, 132, 548, "Input", "ExpressionUUID" -> \
"0fa1d158-6f0c-4b52-903e-e6082af646ca",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[198761, 3530, 648, 9, 70, "Section", "ExpressionUUID" -> \
"a9f14c49-5306-4e56-95ae-8ef446213604"],
Cell[199412, 3541, 5808, 94, 161, "Input", "ExpressionUUID" -> \
"e52a2af8-84ba-42b9-98a2-181e57398dae",
 InitializationCell->True],
Cell[205223, 3637, 11788, 227, 650, "Input", "ExpressionUUID" -> \
"258251b7-9b4c-4c39-a81d-70808e3f5d52",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[217048, 3869, 466, 6, 70, "Section", "ExpressionUUID" -> \
"c5917e7c-7ad6-425f-8be4-fbf24fb8b30c"],
Cell[217517, 3877, 5173, 120, 484, "Input", "ExpressionUUID" -> \
"4ad40dc0-de4f-49c3-af92-d4c71df327d8",
 InitializationCell->True],
Cell[222693, 3999, 32431, 451, 142, "Input", "ExpressionUUID" -> \
"eb528a42-4da3-4674-a497-433f483745bb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[255161, 4455, 176, 3, 70, "Section", "ExpressionUUID" -> \
"ebeb03c9-3e6c-4121-96fd-7d58fe43fec9",
 InitializationCell->True],
Cell[255340, 4460, 192, 4, 66, "Input", "ExpressionUUID" -> \
"a80dada4-e5be-492c-be27-5ebc88cfc74a",
 InitializationCell->True]
}, Open  ]]
}
]
*)

