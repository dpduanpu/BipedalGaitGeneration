(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     81849,       1639]
NotebookOptionsPosition[     79667,       1590]
NotebookOutlinePosition[     80041,       1606]
CellTagsIndexPosition[     79998,       1603]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"RigidBodyDerivatives", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{"High", "-", 
      RowBox[{
      "level", " ", "functions", " ", "used", " ", "to", " ", "define", " ", 
       "a", " ", "rigid", " ", 
       RowBox[{"body", ".", "\n", "Copyright"}], " ", 
       RowBox[{"(", "C", ")"}], " ", "2016", " ", "Nelson", " ", "Rosa", " ", 
       RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", 
       " ", "free", " ", "software"}]}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103714917959795`*^9, 3.6103715279410496`*^9}, {
  3.6901267523786774`*^9, 
  3.6901267578419495`*^9}},ExpressionUUID->"36a9df72-93f1-4f0b-8886-\
624339e55a43"],

Cell[CellGroupData[{

Cell["TODO", "Section",
 CellChangeTimes->{{3.7177648232869816`*^9, 
  3.7177648281151495`*^9}},ExpressionUUID->"1ca30525-235d-4b71-b266-\
347149e3d529"],

Cell["should expand linear solve to do least squares too.", "Text",
 CellChangeTimes->{{3.7177648290214214`*^9, 
  3.717764836427746*^9}},ExpressionUUID->"19c9e19f-e54b-44a1-8a10-\
d336e88cf9ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 
  3.591487004222381*^9}},ExpressionUUID->"1f9a3370-6be5-493e-8b2a-\
43070650433e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Derivatives`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"depth", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FixDotProducts", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixLinearSolve", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.592241768075292*^9, 3.5922417692471714`*^9}, {3.592242084931059*^9, 
   3.5922420876966925`*^9}, 3.5922421309311514`*^9, {3.592255703284815*^9, 
   3.592255706497998*^9}, {3.59225574155902*^9, 3.592255745349224*^9}, {
   3.5922557821253295`*^9, 3.592255815751254*^9}, {3.5922559034172745`*^9, 
   3.5922559113667307`*^9}, {3.5922800860555387`*^9, 3.592280103747531*^9}, {
   3.59275716675933*^9, 3.5927571696474915`*^9}, 3.5927838101231008`*^9, {
   3.5933676479376955`*^9, 3.5933676483126965`*^9}, 3.602872256432743*^9, {
   3.717351942621008*^9, 3.7173519634180803`*^9}, {3.717352014918607*^9, 
   3.717352032731306*^9}, {3.7173535589344544`*^9, 3.717353563731394*^9}, {
   3.717724346036401*^9, 
   3.717724350583354*^9}},ExpressionUUID->"3cf3e4b0-4a71-4941-9549-\
2d45368eddd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Rank", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.6901268666505804`*^9, 
  3.6901268731337385`*^9}, {3.6901270649577737`*^9, 3.690127070584634*^9}, {
  3.690127494493346*^9, 3.690127504470751*^9}, {3.7118120434052362`*^9, 
  3.711812044764623*^9}, {3.7173533618074417`*^9, 
  3.7173534203861685`*^9}},ExpressionUUID->"929b8b80-5e12-4e23-8a7b-\
c22106ff6344"],

Cell["\<\
depth =  {depth of original tensor, number of derivatives from original \
tensor};
tensor rank/depth = Total[depth]
With calls to depth, assumes all operations make sense, no error checking.\
\>", "Text",
 CellChangeTimes->{{3.7173527072850885`*^9, 3.7173527226290116`*^9}, {
  3.7173534218236704`*^9, 
  3.7173534618865833`*^9}},ExpressionUUID->"b0189633-d67b-450b-bf52-\
bd9f3ae0865a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"clear", " ", "previous", " ", "definitions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "@", "depth"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"depth", ",", " ", 
      RowBox[{"{", 
       RowBox[{"HoldFirst", ",", " ", "Listable"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "::", "undef"}], " ", "=", " ", 
     "\"\<`1` is not defined.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", "x__", "]"}], " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Message", "[", 
        RowBox[{
         RowBox[{"depth", "::", "undef"}], ",", " ", 
         RowBox[{"HoldForm", "@", "x"}]}], "]"}], ";", " ", 
       RowBox[{"{", 
        RowBox[{"\[Infinity]", ",", " ", "\[Infinity]"}], "}"}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", "x_Real", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", "x_Integer", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", "x_Length", "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Cos", "|", "Sin", "|", "Tan"}], ")"}], "[", "x_", "]"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"x_", ",", " ", "y_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Power", "[", 
       RowBox[{"x_", ",", " ", "y_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"x_", ",", " ", "___"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"HoldPattern", "@", 
       RowBox[{"Part", "[", 
        RowBox[{"x_", ",", " ", "i__"}], "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", " ", "c"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"depth", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_Span", " ", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"All", " ", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"a_", " ", "\[RuleDelayed]", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"depth", "[", "a", "]"}], "]"}], " ", "===", " ", 
               "1"}], ",", " ", "0", ",", " ", "1"}], "]"}]}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"Hold", "[", "i", "]"}], ",", " ", "c", ",", " ", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"List", "@", 
          RowBox[{"ReleaseHold", "@", "c"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "0"}], "}"}], " ", "d"}], "]"}], " ", 
          "stays", " ", "unevaluated", " ", "if", " ", "d", " ", "is", " ", 
          "not", " ", "a", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"TakeDrop", "[", 
            RowBox[{"c", ",", " ", 
             RowBox[{"UpTo", "@", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", " ", "0"}], "}"}], "d"}], "]"}]}]}], "]"}],
            ",", " ", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", " ", "-", " ", "c"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"f_", "[", "___", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", "f", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{
       RowBox[{"Derivative", "[", "d__", "]"}], "[", "x_", "]"}], "]"}], " ", 
     ":=", " ", 
     RowBox[{
      RowBox[{"depth", "[", "x", "]"}], " ", "+", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "d"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Derivative", "[", "d__", "]"}], "[", "f_", "]"}], "[", 
       "x___", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"depth", "[", 
       RowBox[{"f", "[", "x", "]"}], "]"}], " ", "+", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "d"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"HoldPattern", "@", 
       RowBox[{"Set", "[", 
        RowBox[{"y_", ",", " ", "x_"}], "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"depth", "[", "y", "]"}], " ", "=", " ", 
      RowBox[{"depth", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"Set", "[", 
        RowBox[{"x_List", " ", ",", " ", "y_"}], "]"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"S", ",", " ", "d", ",", " ", "n"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{
          RowBox[{"depth", "[", "y", "]"}], " ", "-", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetAttributes", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"S", ",", " ", "d"}], "}"}], ",", " ", "HoldAll"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Fold", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"#2", ",", " ", "#1"}], "]"}], "&"}], ",", " ", "n", 
            ",", " ", 
            RowBox[{"Thread", "@", 
             RowBox[{"d", "[", "x", "]"}]}]}], "]"}], " ", "/.", " ", 
          RowBox[{"d", " ", "\[Rule]", " ", "depth"}]}], " ", "/.", " ", 
         RowBox[{"S", " ", "\[Rule]", " ", "Set"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Dot", "[", "x__", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d", ",", " ", "c"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"depth", "[", 
           RowBox[{"A", ".", "B"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"depth", "[", "A", "]"}], " ", "+", " ", 
           RowBox[{"depth", "[", "B", "]"}], " ", "-", " ", "2"}]}], ",", " ", 
         RowBox[{
          RowBox[{"for", " ", 
           RowBox[{"depth", "[", "*", "]"}]}], " ", ">", " ", "0"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"update", " ", 
          RowBox[{"rule", ":", " ", 
           RowBox[{
            RowBox[{"d", "^", "n"}], 
            RowBox[{
             RowBox[{"(", "A", ")"}], ".", 
             RowBox[{"d", "^", "m"}]}], 
            RowBox[{"(", "B", ")"}]}]}]}], " ", "=", ">"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"depth", "[", 
           RowBox[{"A", ".", "B"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"depth", "[", 
            RowBox[{
             RowBox[{"d", "^", "n"}], 
             RowBox[{
              RowBox[{"(", "A", ")"}], ".", 
              RowBox[{"d", "^", "m"}]}], 
             RowBox[{"(", "B", ")"}]}], "]"}], " ", "-", " ", 
           RowBox[{"depth", "[", 
            RowBox[{"A", ".", "B"}], "]"}]}]}], "}"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", " ", "=", " ", 
         RowBox[{"depth", "[", 
          RowBox[{"{", "x", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "special", " ", "case", " ", "of", " ", "0", " ", "leads", " ", 
            "to"}], " ", "-", 
           RowBox[{"'", "ve", " ", "#s"}]}], ",", " ", 
          RowBox[{"map", " ", "-", 
           RowBox[{
           "'", "ve", " ", "#s", " ", "back", " ", "to", " ", "0"}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"c", " ", "=", " ", 
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"d", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}], ",", 
             " ", 
             RowBox[{"_", "?", "Positive"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"Count", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"Take", "[", 
             RowBox[{"d", ",", " ", "All", ",", " ", "1"}], "]"}]}], ",", " ", 
           RowBox[{"_", "?", "Positive"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"c", " ", ">", " ", "0"}], ",", " ", 
           RowBox[{"c", " ", "-", " ", "1"}], ",", " ", "0"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", "d", "]"}], " ", "-", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", "c"}], ",", " ", "0"}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Times", "[", "x__", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", 
      RowBox[{"Dot", "[", "x", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Plus", "[", "x__", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"First", "@", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"depth", "[", 
         RowBox[{"{", "x", "}"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"VectorQ", "[", 
          RowBox[{"#", ",", " ", "IntegerQ"}], "]"}], "&"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", " ", "x_", ",", " ", "y_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{
      RowBox[{"depth", "[", "x", "]"}], " ", "+", " ", 
      RowBox[{"depth", "[", "y", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"x_", ",", " ", "___"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "arrived", " ", "by", " ", "setting", " ", "up", " ", "system", " ", "of",
      " ", "equations", " ", "from", " ", "Dot", " ", "rule"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"A_", ",", " ", "b_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"depth", "[", "b", "]"}], "-", 
      RowBox[{"depth", "[", "A", "]"}], " ", "+", " ", 
      RowBox[{"{", 
       RowBox[{"2", ",", " ", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"LeastSquares", "[", 
       RowBox[{"A_", ",", " ", "b_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"A", ",", " ", "b"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"x_", ",", " ", "d_Integer", ",", " ", "n_Integer"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", " ", "X", ",", " ", "D", ",", " ", "T"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", " ", "=", " ", 
         RowBox[{"ToString", "@", 
          RowBox[{"Unevaluated", "@", "depth"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"X", " ", "=", " ", 
         RowBox[{"List", "@", 
          RowBox[{"ToString", "@", 
           RowBox[{"Unevaluated", "@", "x"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"X", " ", "=", " ", 
         RowBox[{"List", "@", 
          RowBox[{"CreateArgumentsString", "[", 
           RowBox[{
            RowBox[{"Evaluate", "@", "X"}], ",", " ", "n"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"d", ",", " ", "#"}], "}"}], "&"}], " ", "/@", " ", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", " ", "n"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"T", " ", "=", " ", 
         RowBox[{
          RowBox[{
          "f", " ", "<>", " ", "\"\<[\>\"", " ", "<>", " ", "#1", " ", "<>", 
           " ", "\"\<] = \>\"", " ", "<>", " ", 
           RowBox[{"ToString", "@", "#2"}], " ", "<>", " ", "\"\<;\>\""}], 
          "&"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ToExpression", "@", 
         RowBox[{"StringJoin", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"T", ",", " ", 
            RowBox[{"{", 
             RowBox[{"X", ",", " ", "D"}], "}"}]}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"\[FormalP]", "[", "x__", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", 
      RowBox[{"Hold", "[", "x__", "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"depth", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"depth", "[", "Clear", "]"}], " ", ":=", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"DownValues", "[", "depth", "]"}], " ", "=", " ", 
        "depthfuns"}], ";"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"store", " ", "all", " ", "default", " ", "definitions"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"depthfuns", " ", "=", " ", 
     RowBox[{"DownValues", "[", "depth", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7115824246892056`*^9, 3.711582445689432*^9}, {
   3.711582477392774*^9, 3.7115825247994547`*^9}, {3.711582679097621*^9, 
   3.7115826921424847`*^9}, {3.711587059932912*^9, 3.7115871869339314`*^9}, {
   3.7115913965994577`*^9, 3.7115913974275894`*^9}, {3.71159175553469*^9, 
   3.7115917616909904`*^9}, 3.711592119912737*^9, {3.7116393702520533`*^9, 
   3.7116393920021853`*^9}, {3.7116396792925544`*^9, 
   3.7116396874644985`*^9}, {3.7116398123874273`*^9, 3.711639813262435*^9}, {
   3.7117129381307473`*^9, 3.711712972146673*^9}, {3.7117131018196154`*^9, 
   3.7117131032259307`*^9}, {3.71171319852355*^9, 3.7117132003673162`*^9}, {
   3.7117136598363466`*^9, 3.7117136748989215`*^9}, {3.7117137142742505`*^9, 
   3.711713714774307*^9}, {3.7117138416191187`*^9, 3.7117138559004517`*^9}, {
   3.7117138977601614`*^9, 3.7117138982914305`*^9}, {3.711713991698461*^9, 
   3.7117139965266113`*^9}, {3.7117144093638086`*^9, 3.711714430895239*^9}, {
   3.7117145959278736`*^9, 3.7117146323813357`*^9}, {3.711714669287857*^9, 
   3.711714701256874*^9}, {3.7117147610386252`*^9, 3.711714761507394*^9}, {
   3.711714807382778*^9, 3.711714851945637*^9}, {3.711715300039201*^9, 
   3.711715346883346*^9}, {3.7117153942743683`*^9, 3.7117154612280474`*^9}, {
   3.711715523572337*^9, 3.711715545666255*^9}, {3.71171558932287*^9, 
   3.7117156085730305`*^9}, {3.7117156656985407`*^9, 
   3.7117156971675224`*^9}, {3.711716040311016*^9, 3.71171604102981*^9}, {
   3.7117160816082363`*^9, 3.711716102045925*^9}, {3.711716144796281*^9, 
   3.7117161711559134`*^9}, {3.7117162443596506`*^9, 3.711716250312772*^9}, 
   3.711716450642626*^9, {3.7117167203959227`*^9, 3.7117167427867336`*^9}, {
   3.711716782677746*^9, 3.711716853725215*^9}, {3.711716885600466*^9, 
   3.7117169192413373`*^9}, {3.7117169654448457`*^9, 
   3.7117170998282404`*^9}, {3.711717130203535*^9, 3.7117171363129106`*^9}, {
   3.711718272024685*^9, 3.71171829113422*^9}, {3.7117192604730935`*^9, 
   3.711719289692086*^9}, {3.711719351536355*^9, 3.7117193950992184`*^9}, {
   3.7117194311463947`*^9, 3.711719432099527*^9}, {3.7117194693342137`*^9, 
   3.7117194751780653`*^9}, {3.7117195343191476`*^9, 
   3.7117195541161723`*^9}, {3.7117198968221636`*^9, 3.711719980510382*^9}, {
   3.711720046214039*^9, 3.711720051010956*^9}, 3.7117202557939672`*^9, 
   3.7117203497947025`*^9, {3.7117214510474625`*^9, 3.7117215015478926`*^9}, {
   3.711722180928566*^9, 3.7117221930536585`*^9}, {3.7117222233352146`*^9, 
   3.7117222366634216`*^9}, {3.711722380352112*^9, 3.711722420896282*^9}, {
   3.711722478943642*^9, 3.711722497162545*^9}, {3.7117225386472764`*^9, 
   3.711722539928546*^9}, {3.711722575772586*^9, 3.7117225855539103`*^9}, {
   3.7117226411481237`*^9, 3.7117226591013985`*^9}, {3.711722835790389*^9, 
   3.7117229217129707`*^9}, {3.711723144230472*^9, 3.7117231500586295`*^9}, {
   3.7117231946058784`*^9, 3.711723197887158*^9}, {3.7117232719659*^9, 
   3.7117232853253984`*^9}, {3.711723669313027*^9, 3.7117237002976074`*^9}, {
   3.7117237351729*^9, 3.711723753704357*^9}, {3.71172384468944*^9, 
   3.7117238967679996`*^9}, 3.7117239944875665`*^9, 3.711724242918603*^9, 
   3.7117244204669633`*^9, {3.7117247810481544`*^9, 3.7117248559549804`*^9}, {
   3.7117249000178475`*^9, 3.711724903767914*^9}, 3.711724984924806*^9, {
   3.711725037409623*^9, 3.7117250398627777`*^9}, {3.7117257224310265`*^9, 
   3.7117257308216715`*^9}, {3.7117258352288027`*^9, 3.711725851885191*^9}, {
   3.7117262868073435`*^9, 3.7117263212138815`*^9}, {3.711726369214283*^9, 
   3.7117263709642973`*^9}, {3.7117264633713207`*^9, 
   3.7117264728401656`*^9}, {3.711726566231568*^9, 3.7117265896536274`*^9}, {
   3.711726624310166*^9, 3.711726634654018*^9}, {3.7117267353423457`*^9, 
   3.711726736436105*^9}, {3.71179509187667*^9, 3.711795097298627*^9}, {
   3.711795163809251*^9, 3.7117951717155333`*^9}, 3.711795556343731*^9, {
   3.711795626281827*^9, 3.7117956322662563`*^9}, {3.7117960609730043`*^9, 
   3.7117961140046964`*^9}, {3.7118011366411285`*^9, 3.711801158078807*^9}, {
   3.7118014893785057`*^9, 3.7118015010816913`*^9}, {3.711801599316923*^9, 
   3.7118016305802574`*^9}, {3.711801765456401*^9, 3.711801768081458*^9}, 
   3.711802074333968*^9, {3.711802189000431*^9, 3.7118021899379005`*^9}, {
   3.711802282282424*^9, 3.7118022868293734`*^9}, {3.711802367642533*^9, 
   3.7118023787675915`*^9}, {3.7118024170023217`*^9, 3.711802432627468*^9}, {
   3.711802592128806*^9, 3.7118025968944144`*^9}, {3.711802748114482*^9, 
   3.711802771677179*^9}, {3.7118030311167965`*^9, 3.7118030373825245`*^9}, {
   3.7118030692890425`*^9, 3.711803089726713*^9}, {3.711803150274078*^9, 
   3.7118031565240955`*^9}, {3.7118032025713654`*^9, 
   3.7118032386185827`*^9}, {3.711803423948207*^9, 3.7118034241826353`*^9}, {
   3.71180363607498*^9, 3.7118036395125604`*^9}, 3.7118036878097887`*^9, 
   3.7118037194350543`*^9, 3.71180377115425*^9, {3.711804080860003*^9, 
   3.7118040956881995`*^9}, {3.711804333637642*^9, 3.71180434535649*^9}, {
   3.7118043920912037`*^9, 3.71180444781042*^9}, {3.711804562608255*^9, 
   3.7118045797490225`*^9}, {3.7118046685153904`*^9, 3.7118046735623074`*^9}, 
   3.711804899864933*^9, {3.711809537650202*^9, 3.7118095409783554`*^9}, {
   3.711809639314904*^9, 3.711809639674282*^9}, {3.7118096762371407`*^9, 
   3.711809745831422*^9}, {3.7118115071572127`*^9, 3.711811558376444*^9}, {
   3.7118117735032*^9, 3.711811806519091*^9}, {3.711813679324296*^9, 
   3.7118137246059265`*^9}, {3.7118157830606394`*^9, 3.7118158172015653`*^9}, 
   3.7118164988322515`*^9, {3.711816533348164*^9, 3.7118165529420786`*^9}, {
   3.7118166219895306`*^9, 3.7118166471772404`*^9}, {3.7118168872261243`*^9, 
   3.711816896226199*^9}, {3.7118169359237366`*^9, 3.711816940080022*^9}, 
   3.7118170734248886`*^9, {3.7118171193783965`*^9, 3.7118176799455843`*^9}, {
   3.7118180063720107`*^9, 3.711818066341275*^9}, {3.7118181019040594`*^9, 
   3.711818171935895*^9}, {3.711818499423008*^9, 3.71181850279809*^9}, {
   3.7118190256461763`*^9, 3.71181904291193*^9}, {3.711820007211255*^9, 
   3.71182001575821*^9}, 3.71189953644833*^9, {3.7119090713525653`*^9, 
   3.7119091802060003`*^9}, {3.711909246521138*^9, 3.7119092522607365`*^9}, {
   3.711933275642832*^9, 3.7119332802522464`*^9}, 3.711933774725133*^9, {
   3.7119338188817525`*^9, 3.7119339058824778`*^9}, {3.7119339418827896`*^9, 
   3.711934051196192*^9}, {3.711934128212463*^9, 3.7119341327125*^9}, {
   3.7119341669471607`*^9, 3.711934193213007*^9}, {3.711934242088414*^9, 
   3.7119342505416107`*^9}, {3.7119342989014015`*^9, 
   3.7119342997451625`*^9}, {3.7119343394642315`*^9, 3.711934346558037*^9}, {
   3.711934396042828*^9, 3.711934400714756*^9}, 3.7119345290908165`*^9, {
   3.7119349765775895`*^9, 3.7119349798901005`*^9}, {3.7119355311018496`*^9, 
   3.7119355365550175`*^9}, {3.7119651639532366`*^9, 3.711965167500142*^9}, {
   3.711988518960342*^9, 3.7119885398667665`*^9}, {3.711989549297085*^9, 
   3.7119895521564856`*^9}, {3.7119931721934557`*^9, 3.711993192506126*^9}, {
   3.7120520636414237`*^9, 3.7120520875478745`*^9}, {3.71207845306334*^9, 
   3.7120784991105876`*^9}, {3.71234275394049*^9, 3.7123427857376175`*^9}, {
   3.712345358429889*^9, 3.712345360079491*^9}, {3.712536103785635*^9, 
   3.7125361329577756`*^9}, {3.7125361911301813`*^9, 3.7125362586151733`*^9}, 
   3.712536290084222*^9, {3.7125363287095776`*^9, 3.712536329850209*^9}, {
   3.712537987358673*^9, 3.7125380220152245`*^9}, {3.7125917420624743`*^9, 
   3.7125917522969356`*^9}, {3.71259373753051*^9, 3.712593755968148*^9}, {
   3.7125943098477807`*^9, 3.7125943133009334`*^9}, {3.7125946865853047`*^9, 
   3.712594687100946*^9}, {3.712594763476589*^9, 3.7125947667265997`*^9}, {
   3.7127216046119204`*^9, 3.7127216062369494`*^9}, {3.712797209886237*^9, 
   3.7127972110737457`*^9}, 3.7128427953020587`*^9, {3.712842829114915*^9, 
   3.712842838240033*^9}, {3.712845001000713*^9, 3.712845020141545*^9}, {
   3.712846011088607*^9, 3.7128460229793634`*^9}, {3.712846875707513*^9, 
   3.712846933395649*^9}, {3.71284741257281*^9, 3.71284741383843*^9}, {
   3.712847636903405*^9, 3.7128476481847844`*^9}, {3.712849443370489*^9, 
   3.7128494625582013`*^9}, {3.71284951080875*^9, 3.7128495306370773`*^9}, {
   3.7128495671687284`*^9, 3.712849597637827*^9}, {3.7128496684667206`*^9, 
   3.712849679169965*^9}, {3.712849794124372*^9, 3.7128498887660255`*^9}, {
   3.71285002572066*^9, 3.712850037236427*^9}, {3.7128503699152007`*^9, 
   3.712850370180831*^9}, {3.7128566013450446`*^9, 3.7128566153451824`*^9}, {
   3.7128566697989244`*^9, 3.7128566744083347`*^9}, {3.712856726362034*^9, 
   3.712856754096712*^9}, {3.712881482904608*^9, 3.712881492467213*^9}, {
   3.7128844567949753`*^9, 3.712884456873089*^9}, {3.712884722569025*^9, 
   3.7128847229909067`*^9}, 3.71290143802129*^9, {3.712904475299296*^9, 
   3.7129044792212143`*^9}, {3.712904553456406*^9, 3.7129045778941784`*^9}, {
   3.7129047715525737`*^9, 3.7129047994903717`*^9}, {3.712904840709591*^9, 
   3.712904894147663*^9}, {3.712904967570347*^9, 3.7129050207472124`*^9}, {
   3.712905692814499*^9, 3.7129057028614836`*^9}, {3.7129057565964346`*^9, 
   3.7129058691133165`*^9}, {3.712951719271057*^9, 3.7129517364899855`*^9}, {
   3.7129518097056613`*^9, 3.7129518411122637`*^9}, {3.7130202960188184`*^9, 
   3.7130203430506043`*^9}, {3.7130203931761394`*^9, 
   3.7130204250202403`*^9}, {3.7130207336017675`*^9, 
   3.7130207385236983`*^9}, {3.714239807063033*^9, 3.7142398083911705`*^9}, {
   3.7142410975919185`*^9, 3.7142410982481723`*^9}, {3.71682621363632*^9, 
   3.7168262143081865`*^9}, {3.7168277558938885`*^9, 3.716827863066577*^9}, {
   3.716827917660742*^9, 3.7168279212701607`*^9}, {3.7168280850995164`*^9, 
   3.716828085724537*^9}, {3.716828587900225*^9, 3.716828667150832*^9}, {
   3.7168289285087967`*^9, 3.716828933368198*^9}, {3.716829063923414*^9, 
   3.716829076970372*^9}, {3.7168292428778844`*^9, 3.716829243565406*^9}, {
   3.7168307110915756`*^9, 3.7168307244666615`*^9}, {3.716830878287999*^9, 
   3.716830894751152*^9}, {3.7168309554202967`*^9, 3.7168309636703744`*^9}, {
   3.716831484096189*^9, 3.7168314852368355`*^9}, {3.7172429078711047`*^9, 
   3.717242910527397*^9}, {3.717242967059211*^9, 3.717242997231397*^9}, {
   3.7173522075612254`*^9, 3.7173522102799854`*^9}, 3.7173522614524045`*^9, {
   3.7173523191092296`*^9, 3.71735232603119*^9}, {3.71735257839314*^9, 
   3.7173525788775206`*^9}, {3.717352648471985*^9, 3.717352648862613*^9}, {
   3.7173526908786855`*^9, 3.717352704035056*^9}, {3.7173542197693624`*^9, 
   3.7173542203162427`*^9}, 3.7173545334600825`*^9, 3.7173546854772677`*^9, {
   3.7177405030765104`*^9, 3.717740525467348*^9}, {3.718669553342866*^9, 
   3.7186695775618696`*^9}, 3.718669608937166*^9, {3.730680430901729*^9, 
   3.73068043794862*^9}, {3.7306842148731747`*^9, 3.730684216966954*^9}, {
   3.7333317156561193`*^9, 3.7333317405097246`*^9}, 3.733334798156166*^9, {
   3.769735374004491*^9, 3.76973537708399*^9}, {3.769736226525405*^9, 
   3.769736252686245*^9}, {3.769736717381034*^9, 3.769736745581887*^9}, 
   3.76973985186364*^9, {3.7697399842422647`*^9, 3.7697399875529203`*^9}, {
   3.769740129025526*^9, 
   3.769740140233138*^9}},ExpressionUUID->"f298f11f-8fa9-4ca1-bc12-\
488fba247faa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Product", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.6901268666505804`*^9, 
  3.6901268731337385`*^9}, {3.6901270649577737`*^9, 3.690127070584634*^9}, {
  3.690127494493346*^9, 3.690127504470751*^9}, {3.7118120434052362`*^9, 
  3.711812044764623*^9}, {3.717353309681895*^9, 
  3.717353312306924*^9}},ExpressionUUID->"3f140dd7-86bf-468e-a96f-\
55df75468544"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"might", " ", "have", " ", "to", " ", "multiply", " ", "by", " ", 
    RowBox[{"1", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"tensym", ",", " ", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tensym", "::", "hess"}], " ", "=", " ", 
     "\"\<Last@depth[`1`] = `2` != 2\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tensym", "[", "X_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", " ", "n"}], "}"}], " ", "=", " ", 
        RowBox[{"depth", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"m", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
          RowBox[{"n", " ", "\[Equal]", " ", "2"}]}], ",", " ", 
         RowBox[{"X", " ", "+", " ", 
          RowBox[{"X", "\[Transpose]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
          RowBox[{"n", " ", "\[Equal]", " ", "2"}]}], ",", " ", 
         RowBox[{"X", " ", "+", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"X", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "3", ",", " ", "2"}], "}"}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
          RowBox[{"n", " ", "\[Equal]", " ", "2"}]}], ",", " ", 
         RowBox[{"X", " ", "+", " ", 
          RowBox[{"Transpose", "[", 
           RowBox[{"X", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "2", ",", " ", "4", ",", " ", "3"}], 
             "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"tensym", "::", "hess"}], ",", " ", "X", ",", " ", "n"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7117950219542055`*^9, 3.7117950340480614`*^9}, {
  3.7118198594131413`*^9, 
  3.7118198656475677`*^9}},ExpressionUUID->"513302b6-0cc6-4e8a-9c03-\
d8aa7ecf0637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"assume", " ", "derivatives", " ", "are", " ", "vectors", " ", 
     RowBox[{"df", "/", "dvec"}], 
     RowBox[{"(", "x", ")"}]}], ",", " ", 
    RowBox[{"f", " ", "\[Element]", " ", 
     RowBox[{"{", 
      RowBox[{"scalar", ",", " ", "vector", ",", " ", "matrix"}], "}"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"tencon", "::", "args"}], " ", "=", " ", 
     "\"\<Unknown Tensor(s): `1` (`2`) and/or `3` (`4`)\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tencon", "[", "C__", "]"}], " ", ":=", " ", 
     RowBox[{"Fold", "[", 
      RowBox[{"tencon", ",", " ", 
       RowBox[{"{", "C", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tencon", "[", 
      RowBox[{"A_", ",", " ", "B_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m0", ",", " ", "md", ",", " ", "n0", ",", " ", "nd"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m0", ",", " ", "md"}], "}"}], " ", "=", " ", 
         RowBox[{"depth", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n0", ",", " ", "nd"}], "}"}], " ", "=", " ", 
         RowBox[{"depth", "[", "B", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "scalar", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "0"}]}], ",", " ", 
          RowBox[{"A", " ", "B"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n0", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "0"}]}], ",", " ", 
          RowBox[{"B", " ", "A"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "1"}]}], ",", " ", 
          RowBox[{"tensym", "[", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", " ", "B", ",", " ", "A"}], "]"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n0", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "1"}]}], ",", " ", 
          RowBox[{"tensym", "[", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", " ", "A", ",", " ", "B"}], "]"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"m0", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", " ", "B", ",", " ", "A"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"n0", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{"Times", ",", " ", "A", ",", " ", "B"}], "]"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"vector", "/", "matrix"}], ",", " ", 
            RowBox[{
             RowBox[{"m0", " ", ">", " ", "0"}], " ", "&&", " ", 
             RowBox[{"n0", " ", ">", " ", "0"}]}], ",", " ", 
            RowBox[{
            "but", " ", "no", " ", "derivative", " ", "in", " ", "A"}]}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"md", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"A", ".", "B"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "vector", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "0"}]}], ",", " ", 
          RowBox[{"B", ".", "A"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "0"}]}], ",", " ", 
          RowBox[{
           RowBox[{"B", "\[Transpose]"}], ".", "A"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "1"}]}], ",", " ", 
          RowBox[{"tensym", "[", 
           RowBox[{
            RowBox[{"B", "\[Transpose]"}], ".", "A"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "1"}]}], ",", " ", 
          RowBox[{"tensym", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"A", "\[Transpose]"}], ".", "B"}], ")"}], 
            "\[Transpose]"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "matrix", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "0"}]}], ",", " ", 
          RowBox[{"B", ".", 
           RowBox[{"A", "\[Transpose]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "0"}]}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"B", "\[Transpose]"}], ".", 
             RowBox[{"A", "\[Transpose]"}]}], ")"}], "\[Transpose]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "1"}]}], ",", " ", 
          RowBox[{"tensym", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"B", "\[Transpose]"}], ".", 
              RowBox[{"A", "\[Transpose]"}]}], ")"}], "\[Transpose]"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"md", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"n0", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
           RowBox[{"nd", " ", "\[Equal]", " ", "1"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"tensym", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"A", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"2", ",", " ", "3", ",", " ", "1"}], "}"}]}], "]"}], 
              ".", "B"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"3", ",", " ", "1", ",", " ", "2", ",", " ", "4"}], 
              "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"tencon", "::", "args"}], ",", " ", "A", ",", " ", 
             RowBox[{"{", 
              RowBox[{"m0", ",", " ", "md"}], "}"}], ",", " ", "B", ",", " ", 
             RowBox[{"{", 
              RowBox[{"n0", ",", " ", "nd"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7116473342569847`*^9, 3.7116473348976164`*^9}, {
   3.7116480244346857`*^9, 3.7116480381691217`*^9}, {3.711648081606984*^9, 
   3.7116480827788706`*^9}, {3.711648272999211*^9, 3.7116483239840117`*^9}, 
   3.7116485267513514`*^9, {3.7116486937840314`*^9, 3.711648704112208*^9}, {
   3.7116737057791176`*^9, 3.711673740388835*^9}, {3.711673921780925*^9, 
   3.7116739486874514`*^9}, {3.711727053001251*^9, 3.711727057407539*^9}, {
   3.7117271111579905`*^9, 3.7117271144392653`*^9}, {3.711727200747667*^9, 
   3.7117273802179184`*^9}, 3.711727466343691*^9, 3.711727547984946*^9, {
   3.7117276017197704`*^9, 3.711727656626481*^9}, {3.711727798549554*^9, 
   3.711727868033926*^9}, {3.7117279002686057`*^9, 3.711727909174894*^9}, {
   3.7117279581909323`*^9, 3.711727976097328*^9}, {3.711728036676013*^9, 
   3.7117280638480616`*^9}, {3.711728149130025*^9, 3.711728272162304*^9}, {
   3.7117285250863113`*^9, 3.711728541758309*^9}, {3.7117285792898717`*^9, 
   3.711728615165189*^9}, {3.7117287352599277`*^9, 3.7117287364318123`*^9}, {
   3.7117287777759233`*^9, 3.711728780104068*^9}, {3.7117289365897355`*^9, 
   3.711728945246068*^9}, {3.7117290383874617`*^9, 3.711729073762769*^9}, {
   3.711729320124194*^9, 3.711729384749734*^9}, {3.7117295385322685`*^9, 
   3.7117296650129642`*^9}, {3.7117297086851883`*^9, 
   3.7117297301541348`*^9}, {3.711729785732708*^9, 3.7117298034359818`*^9}, {
   3.711729840155092*^9, 3.7117298484051085`*^9}, {3.711729884639838*^9, 
   3.711729938655865*^9}, {3.711730194001749*^9, 3.711730233080201*^9}, {
   3.711757891695299*^9, 3.7117578936448774`*^9}, {3.711761275477087*^9, 
   3.711761280574001*^9}, {3.7117620973982983`*^9, 3.7117621040206037`*^9}, {
   3.711762187518421*^9, 3.711762188033621*^9}, {3.711762231779873*^9, 
   3.7117622539654493`*^9}, {3.711762286416065*^9, 3.711762299146531*^9}, {
   3.7117623655297537`*^9, 3.7117623659611197`*^9}, {3.711762462667385*^9, 
   3.711762467250085*^9}, {3.7117628905029955`*^9, 3.7117630171603527`*^9}, {
   3.7117630843171563`*^9, 3.711763085051545*^9}, {3.711790485012201*^9, 
   3.7117905138405676`*^9}, 3.7117906558260813`*^9, {3.7117908560520105`*^9, 
   3.7117908665208435`*^9}, {3.7117909239900265`*^9, 3.7117909414746*^9}, {
   3.7117910615536795`*^9, 3.711791066741273*^9}, {3.7117911029602733`*^9, 
   3.7117911322574463`*^9}, {3.7117913189857264`*^9, 3.711791326079588*^9}, {
   3.71179154450329*^9, 3.711791682582571*^9}, {3.71179237693209*^9, 
   3.7117923798384013`*^9}, {3.711792677872141*^9, 3.7117926871690965`*^9}, {
   3.7117927325913506`*^9, 3.711792761841595*^9}, {3.711792868701865*^9, 
   3.711792872951864*^9}, {3.711793043922043*^9, 3.7117930621253557`*^9}, 
   3.7117938913978806`*^9, 3.711793971320409*^9, {3.7117953288730955`*^9, 
   3.711795341513815*^9}, {3.711795400061177*^9, 3.711795415280052*^9}, {
   3.7117954777024508`*^9, 3.711795493202594*^9}, {3.7117957192201*^9, 
   3.711795726845209*^9}, {3.71179582259601*^9, 3.711795830017948*^9}, {
   3.711795871440118*^9, 3.711795877377719*^9}, {3.7117959498782883`*^9, 
   3.7117959544564505`*^9}, {3.7117961322860613`*^9, 3.711796144551826*^9}, {
   3.7117961917084723`*^9, 3.7117962943499184`*^9}, {3.7117964097571707`*^9, 
   3.711796419350949*^9}, {3.71179690463631*^9, 3.7117969141207123`*^9}, {
   3.711796978496249*^9, 3.7117970035121374`*^9}, {3.7117970429030447`*^9, 
   3.711797095372264*^9}, {3.7117971285131454`*^9, 3.7117971364975863`*^9}, {
   3.711797529469623*^9, 3.711797549891652*^9}, {3.7117977570027604`*^9, 
   3.7117977653153467`*^9}, {3.711797811659483*^9, 3.711797813471994*^9}, {
   3.711797845253498*^9, 3.711797845659751*^9}, {3.711797956020049*^9, 
   3.7117979619107246`*^9}, {3.7117980215050087`*^9, 3.711798021864365*^9}, {
   3.711798058099044*^9, 3.711798107443206*^9}, {3.7117981657093563`*^9, 
   3.7117981667562027`*^9}, 3.7117983421795807`*^9, {3.7117983871174088`*^9, 
   3.7117984033050547`*^9}, {3.7117984661024413`*^9, 
   3.7117984677587404`*^9}, {3.7118008423944564`*^9, 3.711800842941389*^9}, {
   3.711812233422449*^9, 3.711812238063114*^9}, {3.711987909142742*^9, 
   3.71198790931462*^9}, {3.7119885815233655`*^9, 3.711988582492123*^9}, {
   3.7119890535585628`*^9, 3.7119890750118685`*^9}, {3.7119891739189463`*^9, 
   3.7119891962160063`*^9}, {3.7119892519352226`*^9, 3.711989258950906*^9}, {
   3.711989477327734*^9, 3.711989497312272*^9}, {3.711989686516983*^9, 
   3.7119896907513943`*^9}, {3.711989866596611*^9, 3.7119899065813255`*^9}, {
   3.711989962659915*^9, 3.7119899769100375`*^9}, {3.7119924377855773`*^9, 
   3.711992441566858*^9}, {3.711992527051952*^9, 3.7119925488958807`*^9}, {
   3.7119926090637465`*^9, 3.7119926116575184`*^9}, {3.7119926621423287`*^9, 
   3.7119926634235735`*^9}, {3.7119926983769913`*^9, 
   3.7119927024082775`*^9}, {3.7119927409867215`*^9, 
   3.7119927421117315`*^9}, {3.7119927759870157`*^9, 3.711992784799591*^9}, {
   3.7119928953786373`*^9, 3.7119928966755266`*^9}, {3.7119930074577*^9, 
   3.7119930544580936`*^9}, 3.71199322056886*^9, {3.71199375554417*^9, 
   3.7119937904038506`*^9}, {3.7120147319737043`*^9, 3.712014762427084*^9}, {
   3.712015586460741*^9, 3.7120155934764147`*^9}, {3.712015681820918*^9, 
   3.7120156980085526`*^9}, 3.712015834328992*^9, {3.7120175486774845`*^9, 
   3.7120175511462574`*^9}, {3.7120176352563334`*^9, 
   3.7120176622721853`*^9}, {3.712017886288086*^9, 3.712017886459953*^9}, {
   3.7120182137283287`*^9, 3.7120182165720873`*^9}, {3.7120183635560656`*^9, 
   3.7120183745092993`*^9}, {3.712018412040865*^9, 3.7120184128533707`*^9}, {
   3.712018448369275*^9, 3.712018450713045*^9}, {3.7120185560889263`*^9, 
   3.712018556635808*^9}, {3.7120513393971453`*^9, 3.7120513427565465`*^9}, {
   3.7120514300072746`*^9, 3.712051477460786*^9}, 3.712052317690411*^9, 
   3.7120523491594257`*^9, {3.712054180380877*^9, 3.712054183334009*^9}, {
   3.7120542383040776`*^9, 3.7120542513822975`*^9}, {3.7120558513755507`*^9, 
   3.712055851547413*^9}, {3.712062784639013*^9, 3.7120628435770063`*^9}, {
   3.7120629648436446`*^9, 3.7120630183597174`*^9}, 3.7120642615576115`*^9, {
   3.7120643007141757`*^9, 3.7120643679178658`*^9}, {3.7120648244382195`*^9, 
   3.712064837813343*^9}, {3.7120660230263653`*^9, 3.712066051854744*^9}, {
   3.7120661814889307`*^9, 3.7120662503504043`*^9}, 3.7120707155594645`*^9, 
   3.712070972577223*^9, {3.712071070999922*^9, 3.7120710766874685`*^9}, 
   3.712071297283063*^9, {3.7120715823198857`*^9, 3.7120715896637096`*^9}, {
   3.7120759174824705`*^9, 3.7120759521233883`*^9}, {3.712076014483282*^9, 
   3.712076132359267*^9}, 3.7120762275502243`*^9, {3.712076282831921*^9, 
   3.7120763010664616`*^9}, {3.71207648598987*^9, 3.712076493849324*^9}, {
   3.712076694954877*^9, 3.7120766963767753`*^9}, {3.7173521524356422`*^9, 
   3.7173521584982047`*^9}, {3.718303913315199*^9, 
   3.7183039604875402`*^9}},ExpressionUUID->"e77d0fd8-b5cd-47ae-977c-\
25fccc85b566"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common Post Processing Routines", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.5916678891560974`*^9, 3.5916678898031635`*^9}, {3.5922559886651573`*^9, 
  3.592256014246619*^9}, {3.615324296500348*^9, 3.6153243339535465`*^9}, {
  3.6805429853786454`*^9, 3.680543000157354*^9}, {3.6901268666505804`*^9, 
  3.6901268731337385`*^9}, {3.6901270649577737`*^9, 3.690127070584634*^9}, {
  3.690127494493346*^9, 3.690127504470751*^9}, {3.7118120434052362`*^9, 
  3.711812044764623*^9}, {3.717353309681895*^9, 3.717353323869542*^9}, {
  3.717353485824329*^9, 
  3.7173534867774644`*^9}},ExpressionUUID->"0ce17bc5-d4a4-4d53-9686-\
996877cfb998"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"FixDot", ",", " ", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FixDot", "[", "expr__", "]"}], " ", ":=", " ", 
   RowBox[{"BlockExpression", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Outer", ",", " ", "Part"}], "}"}], ",", " ", 
     RowBox[{"Hold", "@", 
      RowBox[{"Evaluate", "@", 
       RowBox[{"tencon", "[", "expr", "]"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"FixDot", ",", " ", "tencon"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FixDotProducts", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pos", ",", " ", "ex", ",", " ", "posd", ",", " ", "exd", ",", " ", "p",
        ",", " ", "f"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", "expr"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"first", " ", "pass"}], ",", " ", 
        RowBox[{"assign", " ", "depth", " ", "to", " ", "symbols"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pos", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"f", ",", " ", "_Set"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ex", " ", "=", " ", 
       RowBox[{"Extract", "[", 
        RowBox[{"f", ",", " ", "pos", ",", " ", "Hold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"depth", "@@@", "ex"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"second", " ", "pass"}], ",", " ", 
        RowBox[{
        "update", " ", "dot", " ", "products", " ", "and", " ", 
         "multiplications"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"f", " ", "/.", " ", 
        RowBox[{"Times", " ", "\[Rule]", " ", "Dot"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"f", " ", "/.", " ", 
        RowBox[{"Dot", " ", "\[Rule]", " ", "FixDot"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"f", " ", "//.", " ", 
        RowBox[{"x_FixDot", " ", "\[RuleDelayed]", " ", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", " ", "=", " ", "x"}], "}"}], ",", " ", 
           RowBox[{"a", " ", "/;", " ", "True"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "//.", " ", 
       RowBox[{
        RowBox[{"Hold", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
        "x"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7118121869845634`*^9, 3.7118123086105785`*^9}, {
   3.7118123580172415`*^9, 3.7118123806893063`*^9}, {3.711812425056534*^9, 
   3.7118124714006715`*^9}, {3.7118136393552647`*^9, 3.711813675324314*^9}, {
   3.711815010616679*^9, 3.7118150738515997`*^9}, {3.711815175930614*^9, 
   3.7118151771336975`*^9}, {3.7118157267320433`*^9, 
   3.7118157301070786`*^9}, {3.7118158420143104`*^9, 
   3.7118159038898125`*^9}, {3.711815934468157*^9, 3.711816015609459*^9}, {
   3.71181606242235*^9, 3.711816065781754*^9}, {3.7118160958289323`*^9, 
   3.7118160961882577`*^9}, {3.7118161967047615`*^9, 3.711816256173971*^9}, {
   3.7118162949555473`*^9, 3.711816295346177*^9}, {3.711816332330858*^9, 
   3.7118163661748924`*^9}, {3.7118164060033493`*^9, 3.711816451409979*^9}, {
   3.711816714787182*^9, 3.711816741006152*^9}, {3.7118169705334015`*^9, 
   3.71181697104903*^9}, 3.7118170129712563`*^9, {3.7118177110239687`*^9, 
   3.711817742696162*^9}, {3.711817791946521*^9, 3.711817802104677*^9}, {
   3.7118178329486847`*^9, 3.7118178603551636`*^9}, 3.7118179261369815`*^9, {
   3.7118181825766087`*^9, 3.711818270811723*^9}, {3.711818335499765*^9, 
   3.7118183598905916`*^9}, {3.7118184197817183`*^9, 
   3.7118184675790105`*^9}, {3.7118186490805626`*^9, 
   3.7118187094716415`*^9}, {3.7118187873473444`*^9, 
   3.7118188622854185`*^9}, {3.7118189236765556`*^9, 
   3.7118189265672584`*^9}, {3.7118189570674615`*^9, 
   3.7118189831927176`*^9}, {3.7118190692559*^9, 3.7118190695840263`*^9}, {
   3.7118191086937284`*^9, 3.711819115568786*^9}, {3.7118191650067005`*^9, 
   3.7118191651160755`*^9}, {3.71181961427052*^9, 3.7118196216924195`*^9}, {
   3.71181965606769*^9, 3.7118196573958263`*^9}, {3.7118198783976917`*^9, 
   3.7118198982415905`*^9}, {3.7118200330159454`*^9, 3.711820065813094*^9}, {
   3.711820127782401*^9, 3.7118201288136215`*^9}, {3.711820235923893*^9, 
   3.71182024286145*^9}, {3.7118204369456496`*^9, 3.7118204400706744`*^9}, {
   3.7119090185221543`*^9, 3.711909048407277*^9}, {3.711989029730238*^9, 
   3.711989032777141*^9}, {3.712014538206458*^9, 3.7120147017234354`*^9}, {
   3.712014951236682*^9, 3.7120149554554524`*^9}, {3.7120150422999454`*^9, 
   3.7120150683001575`*^9}, {3.7120151094880023`*^9, 
   3.7120151364413433`*^9}, {3.7120152261139774`*^9, 3.7120152293327446`*^9}, 
   3.712015374693334*^9, {3.712015863563608*^9, 3.712015954361231*^9}, {
   3.7120161653786306`*^9, 3.712016169394278*^9}, {3.712016430427723*^9, 
   3.712016431177719*^9}, {3.712016466521764*^9, 3.712016468553034*^9}, 
   3.7120165488818274`*^9, {3.7120166206480637`*^9, 3.71201662383558*^9}, {
   3.712016701326677*^9, 3.7120167015454106`*^9}, {3.7120168781406374`*^9, 
   3.7120169640163555`*^9}, {3.7120170014072924`*^9, 3.71201700414168*^9}, {
   3.712017145189746*^9, 3.712017174783744*^9}, {3.7120178988194294`*^9, 
   3.712017908491387*^9}, {3.7120179451791906`*^9, 3.7120179505698624`*^9}, {
   3.712018192743763*^9, 3.712018193462535*^9}, {3.7120507890405254`*^9, 
   3.71205082472831*^9}, {3.7120509206748896`*^9, 3.712050954956427*^9}, {
   3.712050992862993*^9, 3.7120510206913447`*^9}, {3.712051167801961*^9, 
   3.7120512136617045`*^9}, {3.7120512580839634`*^9, 
   3.7120512717403164`*^9}, {3.7120515465395036`*^9, 
   3.7120515838054357`*^9}, {3.7120516954782333`*^9, 
   3.7120519219839816`*^9}, {3.7120519626874585`*^9, 3.712052032313028*^9}, {
   3.7120521616578703`*^9, 3.712052161829733*^9}, {3.7120530768964148`*^9, 
   3.71205308177147*^9}, {3.712053148693904*^9, 3.7120531509751577`*^9}, {
   3.7120538093621445`*^9, 3.7120538096121373`*^9}, {3.7120545358378005`*^9, 
   3.7120545450253925`*^9}, {3.7120552208271565`*^9, 3.712055221045909*^9}, {
   3.7120558255040736`*^9, 3.7120558298478746`*^9}, {3.712060515846831*^9, 
   3.7120605181906157`*^9}, {3.7120606319786596`*^9, 3.712060644550764*^9}, {
   3.71206709106056*^9, 3.7120672082803087`*^9}, {3.7120672802184052`*^9, 
   3.712067294171647*^9}, {3.7120673262812805`*^9, 3.712067381109862*^9}, 
   3.712067457548018*^9, {3.7120675552519445`*^9, 3.7120675839240723`*^9}, 
   3.712067619533743*^9, {3.712067660862218*^9, 3.71206768009674*^9}, {
   3.7120677209877214`*^9, 3.7120677222220907`*^9}, {3.7120677779256816`*^9, 
   3.7120677843163586`*^9}, {3.712067861551379*^9, 3.7120678623951397`*^9}, {
   3.7120679005673475`*^9, 3.7120679563803015`*^9}, {3.7120680854562006`*^9, 
   3.7120681598318367`*^9}, {3.7120684427717032`*^9, 3.712068485818922*^9}, {
   3.712068538288123*^9, 3.7120685978198595`*^9}, {3.7120686740548706`*^9, 
   3.7120686930862846`*^9}, 3.7120687293834753`*^9, {3.712068760055607*^9, 
   3.7120687674306655`*^9}, {3.7120704664636307`*^9, 3.712070504354573*^9}, {
   3.7120706018710093`*^9, 3.712070609527311*^9}, {3.7120711049377055`*^9, 
   3.7120711306410465`*^9}, {3.7120716785400486`*^9, 
   3.7120716822431946`*^9}, {3.7120717158059835`*^9, 3.712071725868558*^9}, {
   3.7120724641716185`*^9, 3.7120724749842134`*^9}, {3.712074540286934*^9, 
   3.712074563427742*^9}, {3.7120764445676503`*^9, 3.7120764570833907`*^9}, {
   3.7120767037049503`*^9, 3.712076732095813*^9}, {3.7120774537112217`*^9, 
   3.712077480805199*^9}, {3.712077539274437*^9, 3.712077596196787*^9}, {
   3.7120777456980505`*^9, 3.712077749260569*^9}, {3.7120783131246586`*^9, 
   3.712078369703271*^9}, {3.7120784374382114`*^9, 3.712078437860079*^9}, {
   3.712109218251438*^9, 3.712109245673545*^9}, {3.712148671038212*^9, 
   3.712148672522602*^9}, {3.7121490687602882`*^9, 3.7121490787134976`*^9}, {
   3.712149115823183*^9, 3.7121491278076563`*^9}, {3.712149263558792*^9, 
   3.7121492898715134`*^9}, {3.7121493722628274`*^9, 
   3.7121494824512467`*^9}, {3.7121495773426676`*^9, 3.712149657890215*^9}, {
   3.7121505843976*^9, 3.712150909415943*^9}, {3.7121510659172544`*^9, 
   3.712151101714428*^9}, {3.7121511352772074`*^9, 3.7121511800588346`*^9}, {
   3.7121512440593696`*^9, 3.7121512655439215`*^9}, {3.712151308075529*^9, 
   3.712151339825795*^9}, {3.712151434139084*^9, 3.712151441732896*^9}, {
   3.7121514818894815`*^9, 3.712151512186612*^9}, {3.712151543811877*^9, 
   3.7121515487650414`*^9}, {3.7121515918435287`*^9, 
   3.7121516741411057`*^9}, {3.7121517383291273`*^9, 3.712151823751717*^9}, 
   3.7121518633301716`*^9, {3.7121519816436625`*^9, 3.7121519838155537`*^9}, {
   3.712152222270707*^9, 3.7121522249425707`*^9}, {3.712152336256002*^9, 
   3.7121523614906044`*^9}, {3.7121526165708475`*^9, 
   3.7121526211177607`*^9}, {3.71234170425114*^9, 3.712341709188694*^9}, {
   3.71234213261275*^9, 3.712342135519027*^9}, {3.7123422608950863`*^9, 
   3.7123422663326316`*^9}, {3.7123426233612614`*^9, 3.7123426236269*^9}, {
   3.7125360114635863`*^9, 3.712536018760513*^9}, {3.712536309537511*^9, 
   3.7125363118187823`*^9}, {3.714495611354274*^9, 3.7144956142203135`*^9}, {
   3.717243532315015*^9, 3.717243550643327*^9}, {3.717243592268754*^9, 
   3.7172436198471622`*^9}, {3.7172437542704167`*^9, 3.71724376719244*^9}, {
   3.7172437995677557`*^9, 3.717243841130684*^9}, {3.7173528417552185`*^9, 
   3.717352842645852*^9}, {3.7173529164903603`*^9, 3.717352917302884*^9}, {
   3.71735298361605*^9, 3.7173529930224075`*^9}, {3.7173530597730813`*^9, 
   3.7173530605387135`*^9}, {3.71735309752347*^9, 3.71735310439854*^9}, {
   3.7173531447114687`*^9, 3.717353160758494*^9}, {3.717353216321563*^9, 
   3.7173532191653414`*^9}},ExpressionUUID->"88485869-8511-4b57-a463-\
a63347a6f277"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FixLinearSolve", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "f", ",", " ", "h", ",", " ", "j", ",", " ", "pos", ",", " ", "ex", ",",
        " ", "r", ",", " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "assumes", " ", "FixDotProducts", " ", "has", " ", "already", " ", 
       "been", " ", "called"}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "max", " ", "derivative", " ", "order"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", " ", "=", " ", 
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"Set", "[", 
          RowBox[{"x_", ",", " ", "_"}], "]"}], "]"}], " ", "\[RuleDelayed]", 
        " ", 
        RowBox[{"DerivativeOrder", "[", "x", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Max", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"expr", ",", " ", "r", ",", " ", "Infinity"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "assume", " ", "A", " ", "in", " ", "LinearSolve", " ", "has", " ", 
         RowBox[{"depth", "[", "A", "]"}]}], " ", "\[Equal]", " ", 
        RowBox[{"(", 
         RowBox[{"2", ",", " ", "0"}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"=", 
        RowBox[{
         RowBox[{">", " ", 
          RowBox[{"depth", "[", 
           RowBox[{"LinearSolve", "[", 
            RowBox[{"A", ",", " ", "b"}], "]"}], "]"}]}], " ", "=", " ", 
         RowBox[{"depth", "[", "b", "]"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "LinearSolve", " ", "with", " ", "RHS", " ", "arg", 
          " ", "of", " ", "increasing", " ", "derivative", " ", "order"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"pos", " ", "=", " ", 
           RowBox[{"Position", "[", 
            RowBox[{"expr", ",", " ", 
             RowBox[{"x_LinearSolve", " ", "/;", " ", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{"depth", "[", "x", "]"}], "]"}], " ", "\[Equal]", " ", 
               RowBox[{"i", "+", "2"}]}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ex", " ", "=", " ", 
           RowBox[{"Extract", "[", 
            RowBox[{"expr", ",", " ", "pos", ",", " ", "Hold"}], "]"}]}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"d", " ", "=", " ", 
             RowBox[{"initial", " ", "transpose"}]}], ",", " ", 
            RowBox[{"b", " ", "=", " ", 
             RowBox[{"final", " ", "transpose"}]}], ",", " ", 
            RowBox[{"k", " ", "=", " ", 
             RowBox[{"Map", " ", "depth"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "k", " ", "has", " ", "Map", " ", "solve", " ", "matrix", " ", 
             "problems"}], ",", " ", 
            RowBox[{"since", " ", "LinearSolve", " ", 
             RowBox[{"can", "'"}], "t", " ", "do"}]}], " ", "*)"}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{"higher", "-", 
            RowBox[{"order", " ", "tensors"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"j", " ", "=", " ", 
           RowBox[{"Flatten", " ", "/@", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", " ", 
                RowBox[{"Range", "[", "i", "]"}], ",", " ", 
                RowBox[{"i", "+", "2"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"2", ",", " ", 
                  RowBox[{"i", "+", "1"}]}], "]"}], ",", " ", "1", ",", " ", 
                RowBox[{"i", "+", "2"}]}], "}"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"h", " ", "=", " ", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"d", " ", "=", " ", 
                RowBox[{
                "j", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ",", " ", 
               RowBox[{"b", " ", "=", " ", 
                RowBox[{
                "j", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                ",", " ", 
               RowBox[{"k", " ", "=", " ", "i"}]}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"HoldPattern", "[", 
               RowBox[{"LinearSolve", "[", 
                RowBox[{"A_", ",", " ", "B_"}], "]"}], "]"}], " ", 
              "\[RuleDelayed]", " ", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"LinearSolve", "[", 
                    RowBox[{"A", ",", " ", "#"}], "]"}], "&"}], ",", " ", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"B", ",", " ", "d"}], "]"}], ",", " ", 
                  RowBox[{"{", "k", "}"}]}], "]"}], ",", " ", "b"}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"accumulate", " ", "transformations"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"ex", " ", "=", " ", 
           RowBox[{"ex", " ", "/.", " ", "h"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{"pos", " ", "\[Rule]", " ", "ex"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"apply", " ", "transformations"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"expr", ",", " ", 
         RowBox[{"Join", "@@", "r"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", " ", "/.", " ", 
       RowBox[{
        RowBox[{"Hold", "[", "x_", "]"}], " ", "\[RuleDelayed]", " ", 
        "x"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7118121869845634`*^9, 3.7118123086105785`*^9}, {
   3.7118123580172415`*^9, 3.7118123806893063`*^9}, {3.711812425056534*^9, 
   3.7118124714006715`*^9}, {3.7118136393552647`*^9, 3.711813675324314*^9}, {
   3.711815010616679*^9, 3.7118150738515997`*^9}, {3.711815175930614*^9, 
   3.7118151771336975`*^9}, {3.7118157267320433`*^9, 
   3.7118157301070786`*^9}, {3.7118158420143104`*^9, 
   3.7118159038898125`*^9}, {3.711815934468157*^9, 3.711816015609459*^9}, {
   3.71181606242235*^9, 3.711816065781754*^9}, {3.7118160958289323`*^9, 
   3.7118160961882577`*^9}, {3.7118161967047615`*^9, 3.711816256173971*^9}, {
   3.7118162949555473`*^9, 3.711816295346177*^9}, {3.711816332330858*^9, 
   3.7118163661748924`*^9}, {3.7118164060033493`*^9, 3.711816451409979*^9}, {
   3.711816714787182*^9, 3.711816741006152*^9}, {3.7118169705334015`*^9, 
   3.71181697104903*^9}, 3.7118170129712563`*^9, {3.7118177110239687`*^9, 
   3.711817742696162*^9}, {3.711817791946521*^9, 3.711817802104677*^9}, {
   3.7118178329486847`*^9, 3.7118178603551636`*^9}, 3.7118179261369815`*^9, {
   3.7118181825766087`*^9, 3.711818270811723*^9}, {3.711818335499765*^9, 
   3.7118183598905916`*^9}, {3.7118184197817183`*^9, 
   3.7118184675790105`*^9}, {3.7118186490805626`*^9, 
   3.7118187094716415`*^9}, {3.7118187873473444`*^9, 
   3.7118188622854185`*^9}, {3.7118189236765556`*^9, 
   3.7118189265672584`*^9}, {3.7118189570674615`*^9, 
   3.7118189831927176`*^9}, {3.7118190692559*^9, 3.7118190695840263`*^9}, {
   3.7118191086937284`*^9, 3.711819115568786*^9}, {3.7118191650067005`*^9, 
   3.7118191651160755`*^9}, {3.71181961427052*^9, 3.7118196216924195`*^9}, {
   3.71181965606769*^9, 3.7118196573958263`*^9}, {3.7118198783976917`*^9, 
   3.7118198982415905`*^9}, {3.7118200330159454`*^9, 3.711820065813094*^9}, {
   3.711820127782401*^9, 3.7118201288136215`*^9}, {3.711820235923893*^9, 
   3.71182024286145*^9}, {3.7118204369456496`*^9, 3.7118204400706744`*^9}, {
   3.7119090185221543`*^9, 3.711909048407277*^9}, {3.711989029730238*^9, 
   3.711989032777141*^9}, {3.712014538206458*^9, 3.7120147017234354`*^9}, {
   3.712014951236682*^9, 3.7120149554554524`*^9}, {3.7120150422999454`*^9, 
   3.7120150683001575`*^9}, {3.7120151094880023`*^9, 
   3.7120151364413433`*^9}, {3.7120152261139774`*^9, 3.7120152293327446`*^9}, 
   3.712015374693334*^9, {3.712015863563608*^9, 3.712015954361231*^9}, {
   3.7120161653786306`*^9, 3.712016169394278*^9}, {3.712016430427723*^9, 
   3.712016431177719*^9}, {3.712016466521764*^9, 3.712016468553034*^9}, 
   3.7120165488818274`*^9, {3.7120166206480637`*^9, 3.71201662383558*^9}, {
   3.712016701326677*^9, 3.7120167015454106`*^9}, {3.7120168781406374`*^9, 
   3.7120169640163555`*^9}, {3.7120170014072924`*^9, 3.71201700414168*^9}, {
   3.712017145189746*^9, 3.712017174783744*^9}, {3.7120178988194294`*^9, 
   3.712017908491387*^9}, {3.7120179451791906`*^9, 3.7120179505698624`*^9}, {
   3.712018192743763*^9, 3.712018193462535*^9}, {3.7120507890405254`*^9, 
   3.71205082472831*^9}, {3.7120509206748896`*^9, 3.712050954956427*^9}, {
   3.712050992862993*^9, 3.7120510206913447`*^9}, {3.712051167801961*^9, 
   3.7120512136617045`*^9}, {3.7120512580839634`*^9, 
   3.7120512717403164`*^9}, {3.7120515465395036`*^9, 
   3.7120515838054357`*^9}, {3.7120516954782333`*^9, 
   3.7120519219839816`*^9}, {3.7120519626874585`*^9, 3.712052032313028*^9}, {
   3.7120521616578703`*^9, 3.712052161829733*^9}, {3.7120530768964148`*^9, 
   3.71205308177147*^9}, {3.712053148693904*^9, 3.7120531509751577`*^9}, {
   3.7120538093621445`*^9, 3.7120538096121373`*^9}, {3.7120545358378005`*^9, 
   3.7120545450253925`*^9}, {3.7120552208271565`*^9, 3.712055221045909*^9}, {
   3.7120558255040736`*^9, 3.7120558298478746`*^9}, {3.712060515846831*^9, 
   3.7120605181906157`*^9}, {3.7120606319786596`*^9, 3.712060644550764*^9}, {
   3.71206709106056*^9, 3.7120672082803087`*^9}, {3.7120672802184052`*^9, 
   3.712067294171647*^9}, {3.7120673262812805`*^9, 3.712067381109862*^9}, 
   3.712067457548018*^9, {3.7120675552519445`*^9, 3.7120675839240723`*^9}, 
   3.712067619533743*^9, {3.712067660862218*^9, 3.71206768009674*^9}, {
   3.7120677209877214`*^9, 3.7120677222220907`*^9}, {3.7120677779256816`*^9, 
   3.7120677843163586`*^9}, {3.712067861551379*^9, 3.7120678623951397`*^9}, {
   3.7120679005673475`*^9, 3.7120679563803015`*^9}, {3.7120680854562006`*^9, 
   3.7120681598318367`*^9}, {3.7120684427717032`*^9, 3.712068485818922*^9}, {
   3.712068538288123*^9, 3.7120685978198595`*^9}, {3.7120686740548706`*^9, 
   3.7120686930862846`*^9}, 3.7120687293834753`*^9, {3.712068760055607*^9, 
   3.7120687674306655`*^9}, {3.7120704664636307`*^9, 3.712070504354573*^9}, {
   3.7120706018710093`*^9, 3.712070609527311*^9}, {3.7120711049377055`*^9, 
   3.7120711306410465`*^9}, {3.7120716785400486`*^9, 
   3.7120716822431946`*^9}, {3.7120717158059835`*^9, 3.712071725868558*^9}, {
   3.7120724641716185`*^9, 3.7120724749842134`*^9}, {3.712074540286934*^9, 
   3.712074563427742*^9}, {3.7120764445676503`*^9, 3.7120764570833907`*^9}, {
   3.7120767037049503`*^9, 3.712076732095813*^9}, {3.7120774537112217`*^9, 
   3.712077480805199*^9}, {3.712077539274437*^9, 3.712077596196787*^9}, {
   3.7120777456980505`*^9, 3.712077749260569*^9}, {3.7120783131246586`*^9, 
   3.712078369703271*^9}, {3.7120784374382114`*^9, 3.712078437860079*^9}, {
   3.712109218251438*^9, 3.712109245673545*^9}, {3.712148671038212*^9, 
   3.712148672522602*^9}, {3.7121490687602882`*^9, 3.7121490787134976`*^9}, {
   3.712149115823183*^9, 3.7121491278076563`*^9}, {3.712149263558792*^9, 
   3.7121492898715134`*^9}, {3.7121493722628274`*^9, 
   3.7121494824512467`*^9}, {3.7121495773426676`*^9, 3.712149657890215*^9}, {
   3.7121505843976*^9, 3.712150909415943*^9}, {3.7121510659172544`*^9, 
   3.712151101714428*^9}, {3.7121511352772074`*^9, 3.7121511800588346`*^9}, {
   3.7121512440593696`*^9, 3.7121512655439215`*^9}, {3.712151308075529*^9, 
   3.712151339825795*^9}, {3.712151434139084*^9, 3.712151441732896*^9}, {
   3.7121514818894815`*^9, 3.712151512186612*^9}, {3.712151543811877*^9, 
   3.7121515487650414`*^9}, {3.7121515918435287`*^9, 
   3.7121516741411057`*^9}, {3.7121517383291273`*^9, 3.712151823751717*^9}, 
   3.7121518633301716`*^9, {3.7121519816436625`*^9, 3.7121519838155537`*^9}, {
   3.712152222270707*^9, 3.7121522249425707`*^9}, {3.712152336256002*^9, 
   3.7121523614906044`*^9}, {3.7121526165708475`*^9, 
   3.7121526211177607`*^9}, {3.71234170425114*^9, 3.712341709188694*^9}, {
   3.71234213261275*^9, 3.712342135519027*^9}, {3.7123422608950863`*^9, 
   3.7123422663326316`*^9}, {3.7123426233612614`*^9, 3.7123426236269*^9}, {
   3.7125360114635863`*^9, 3.712536018760513*^9}, {3.712536309537511*^9, 
   3.7125363118187823`*^9}, {3.714495611354274*^9, 3.7144956142203135`*^9}, {
   3.717243532315015*^9, 3.717243550643327*^9}, {3.717243592268754*^9, 
   3.7172436198471622`*^9}, {3.7172437542704167`*^9, 3.71724376719244*^9}, {
   3.7172437995677557`*^9, 3.717243841130684*^9}, {3.7176822039356985`*^9, 
   3.7176822053419647`*^9}, 3.7177235037002845`*^9, {3.717723565544626*^9, 
   3.717723573841564*^9}, {3.717723627013955*^9, 3.7177236407015896`*^9}, {
   3.717723673670649*^9, 3.7177237448432007`*^9}, {3.7177238501098304`*^9, 
   3.717723939813793*^9}, {3.7177239760172725`*^9, 3.717724062518081*^9}, {
   3.7177244137558117`*^9, 3.7177244376935234`*^9}, {3.7177647600051293`*^9, 
   3.7177647671458225`*^9}, {3.718368970756186*^9, 
   3.7183690084128084`*^9}},ExpressionUUID->"85801bc0-6a49-4704-89cc-\
69675840d288"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.591486801989799*^9, 
  3.5914868026208353`*^9}},ExpressionUUID->"2143a952-ac86-44ce-80d6-\
af271244e104"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718, 718},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2937, 59, 285, "Code",ExpressionUUID->"36a9df72-93f1-4f0b-8886-624339e55a43",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3520, 83, 153, 3, 67, "Section",ExpressionUUID->"1ca30525-235d-4b71-b266-347149e3d529"],
Cell[3676, 88, 195, 3, 34, "Text",ExpressionUUID->"19c9e19f-e54b-44a1-8a10-d336e88cf9ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3908, 96, 160, 3, 67, "Section",ExpressionUUID->"1f9a3370-6be5-493e-8b2a-43070650433e"],
Cell[4071, 101, 2422, 43, 159, "Input",ExpressionUUID->"3cf3e4b0-4a71-4941-9549-2d45368eddd0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6530, 149, 612, 9, 67, "Section",ExpressionUUID->"929b8b80-5e12-4e23-8a7b-c22106ff6344"],
Cell[7145, 160, 397, 9, 78, "Text",ExpressionUUID->"b0189633-d67b-450b-bf52-bd9f3ae0865a"],
Cell[7545, 171, 27725, 593, 1572, "Input",ExpressionUUID->"f298f11f-8fa9-4ca1-bc12-488fba247faa",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[35307, 769, 611, 9, 67, "Section",ExpressionUUID->"3f140dd7-86bf-468e-a96f-55df75468544"],
Cell[35921, 780, 2615, 60, 292, "Input",ExpressionUUID->"513302b6-0cc6-4e8a-9c03-d8aa7ecf0637",
 InitializationCell->True],
Cell[38539, 842, 15476, 276, 748, "Input",ExpressionUUID->"e77d0fd8-b5cd-47ae-977c-25fccc85b566",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[54052, 1123, 679, 10, 67, "Section",ExpressionUUID->"0ce17bc5-d4a4-4d53-9686-996877cfb998"],
Cell[54734, 1135, 10178, 171, 349, "Input",ExpressionUUID->"88485869-8511-4b57-a463-a63347a6f277",
 InitializationCell->True],
Cell[64915, 1308, 14399, 266, 634, "Input",ExpressionUUID->"85801bc0-6a49-4704-89cc-69675840d288",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[79351, 1579, 30, 0, 67, "Section",ExpressionUUID->"1866561b-02c6-4da5-b1c8-799bbc39c0fe"],
Cell[79384, 1581, 267, 6, 64, "Input",ExpressionUUID->"2143a952-ac86-44ce-80d6-af271244e104",
 InitializationCell->True]
}, Open  ]]
}
]
*)

