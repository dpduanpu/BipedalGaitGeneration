(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102204,       1937]
NotebookOptionsPosition[     99970,       1887]
NotebookOutlinePosition[    100337,       1903]
CellTagsIndexPosition[    100294,       1900]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{"SimplestModel", ".", 
    RowBox[{"nb", ":", " ", 
     RowBox[{
     "An", " ", "implementation", " ", "of", " ", "various", " ", 
      "continuation", " ", 
      RowBox[{"methods", ".", "\n", "Copyright"}], " ", 
      RowBox[{"(", "C", ")"}], " ", "2017", " ", "Nelson", " ", "Rosa", " ", 
      RowBox[{"Jr", ".", "\n", "\n", "This"}], " ", "program", " ", "is", " ",
       "free", " ", "software"}], ":", " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", "\n", "it", " ", "under", 
      " ", "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "as", " ", "published", 
      " ", "by", "\n", 
      RowBox[{"the", " ", "Free", " ", "Software", " ", "Foundation"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "either", " ", "version", " ", "3", " ", "of", " ", "the", " ", 
    "License"}], ",", " ", 
   RowBox[{"or", "\n", 
    RowBox[{"(", 
     RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
    "later", " ", 
    RowBox[{"version", ".", " ", "This"}], " ", "program", " ", "is", " ", 
    "distributed", " ", "in", " ", "the", " ", "\n", "hope", " ", "that", " ",
     "it", " ", "will", " ", "be", " ", "useful"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
    RowBox[{
    "without", " ", "even", " ", "the", " ", "\n", "implied", " ", "warranty",
      " ", "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", 
     "FOR", " ", "A", " ", "PARTICULAR", " ", 
     RowBox[{"PURPOSE", ".", "\n", "See"}], " ", "the", " ", "GNU", " ", 
     "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
     RowBox[{"details", ".", " ", "You"}], " ", "should", " ", "have", " ", 
     "\n", "received", " ", "a", " ", "copy", " ", "of", " ", "the", " ", 
     "GNU", " ", "General", " ", "Public", " ", "License", " ", "along", " ", 
     "with", " ", "this", " ", 
     RowBox[{"program", ".", "\n", "If"}], " ", "not"}]}], ",", " ", 
   RowBox[{
    RowBox[{"see", " ", "<", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "gnu", ".", "org"}], "/", "licenses"}], "/"}], ">",
      "."}]}]}], "\n", "*)"}]], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.6103707836964283`*^9, 3.610370783709448*^9}, {
  3.610370828952024*^9, 3.610370962648698*^9}, {3.6103710877518406`*^9, 
  3.610371111376195*^9}, {3.6103711469392376`*^9, 3.6103712325731497`*^9}, {
  3.610371305900334*^9, 3.610371331708816*^9}, {3.610371368620943*^9, 
  3.61037139802861*^9}, {3.6103715538125486`*^9, 3.6103716079966354`*^9}, {
  3.6103717337958384`*^9, 3.6103717435163946`*^9}, {3.610375905814865*^9, 
  3.6103759286701736`*^9}, {3.708188034452876*^9, 3.708188042234197*^9}, {
  3.7081882270910406`*^9, 3.708188227794161*^9}, {3.7082009294953814`*^9, 
  3.708200932792328*^9}},ExpressionUUID->"bdd16de3-b081-422d-bf19-\
ad04f5c7fa5b"],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 InitializationCell->
  True,ExpressionUUID->"ffc4eb86-334d-4138-9d93-a94ad2ffa2b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<HybridDynamics`\>\"", ",", " ", "\"\<GlobalVariables`\>\""}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rbd", " ", "=", " ", 
   RowBox[{"<|", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o", " ", "=", " ", "0"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.593429691613509*^9, 3.5934296991603985`*^9}, {
   3.5934304492147074`*^9, 3.593430460293337*^9}, {3.593430598468252*^9, 
   3.5934306015764303`*^9}, {3.5934307799096446`*^9, 3.593430808052258*^9}, {
   3.604003954825133*^9, 3.6040039601376452`*^9}, 3.604015318567862*^9, {
   3.6157725447048154`*^9, 3.6157725835486383`*^9}, {3.6157726578300314`*^9, 
   3.6157727675177507`*^9}, {3.61577320898736*^9, 3.6157732136748695`*^9}, {
   3.615773303035429*^9, 3.6157733326604815`*^9}, 3.615801292371916*^9, {
   3.615802310795785*^9, 3.615802311733284*^9}, {3.66859247590735*^9, 
   3.668592588898917*^9}, {3.669771251861636*^9, 3.669771394270951*^9}, {
   3.6811664244342394`*^9, 3.6811664256584125`*^9}, {3.6812268158577976`*^9, 
   3.681226849314602*^9}, {3.708167005320278*^9, 3.7081670465393534`*^9}, {
   3.70816717129836*^9, 3.7081671713503947`*^9}, {3.708188067385829*^9, 
   3.7081881019017982`*^9}, {3.708188163292983*^9, 3.7081882034808493`*^9}, {
   3.708200942261109*^9, 3.708201171229169*^9}, {3.7082012194795623`*^9, 
   3.7082012207764935`*^9}, {3.708213739344715*^9, 3.7082137434385033`*^9}, {
   3.708263813692348*^9, 3.7082638630365686`*^9}, {3.7082646897628393`*^9, 
   3.708264689950341*^9}, {3.7089953921428633`*^9, 3.708995393687953*^9}, {
   3.7091340784534826`*^9, 3.709134078549555*^9}, {3.709137881218701*^9, 
   3.7091378964604464`*^9}, {3.7091397602298374`*^9, 
   3.7091397627356215`*^9}, {3.7092006887170124`*^9, 3.709200705958169*^9}, {
   3.7092204545302415`*^9, 3.709220459430698*^9}, {3.70929865050327*^9, 
   3.7092986506438785`*^9}, {3.709300388138702*^9, 3.709300390716848*^9}, {
   3.7093030156567783`*^9, 3.709303016016156*^9}, {3.709305576496077*^9, 
   3.7093055824648733`*^9}, {3.7093056250901966`*^9, 3.709305636793394*^9}, {
   3.7093057560389357`*^9, 3.709305799328763*^9}, {3.7093071969161797`*^9, 
   3.7093072154006963`*^9}, {3.7093091625135255`*^9, 3.709309173107356*^9}, {
   3.7093119258643*^9, 3.7093119432238674`*^9}, {3.7093155904044347`*^9, 
   3.709315599857649*^9}, {3.7188483780587463`*^9, 3.7188484002777*^9}, {
   3.7188856464184895`*^9, 3.718885649652881*^9}, {3.7188876724997234`*^9, 
   3.7188876891405287`*^9}, {3.718887895080049*^9, 3.7188878956894336`*^9}, {
   3.71888794183051*^9, 3.718887968674527*^9}, {3.7188970785233197`*^9, 
   3.718897084007761*^9}, {3.718897246509367*^9, 3.7188972471812363`*^9}, {
   3.71889900180797*^9, 3.7188990071517725`*^9}, {3.7189005659121647`*^9, 
   3.7189006301628*^9}, {3.7189009211969414`*^9, 3.7189009393689795`*^9}, {
   3.718902887138983*^9, 3.7189028962797146`*^9}, {3.7189067648042097`*^9, 
   3.718906770804269*^9}, {3.718928002257004*^9, 3.7189280091320887`*^9}, 
   3.7189330516156597`*^9, {3.718933122944487*^9, 3.7189331248507667`*^9}, 
   3.718933400025361*^9, {3.718935933782951*^9, 3.718935937782995*^9}, {
   3.7189368451056547`*^9, 3.7189368505588465`*^9}, {3.718969601387094*^9, 
   3.718969603293363*^9}, {3.7191214087316637`*^9, 3.719121410153552*^9}, {
   3.7191571723084116`*^9, 3.719157186871055*^9}, {3.719157242574731*^9, 
   3.7191572428403587`*^9}, {3.7196759110617867`*^9, 3.719675928593195*^9}, {
   3.719677536840168*^9, 3.7196775417308335`*^9}, {3.72039431210083*^9, 
   3.7203943157883644`*^9}, {3.7234772335451345`*^9, 
   3.7234772349957333`*^9}, {3.7234772677015066`*^9, 
   3.7234772686627245`*^9}, {3.7251326338487935`*^9, 
   3.7251326385832167`*^9}, {3.72514102602882*^9, 3.7251410306396523`*^9}, 
   3.7251571596015825`*^9, 3.725160534920519*^9, {3.726425938996232*^9, 
   3.726425944919203*^9}, {3.7264261549594936`*^9, 3.7264261591651163`*^9}, 
   3.726454028184588*^9, 3.7264540649036446`*^9, 3.7299873410918756`*^9, 
   3.7301188740437746`*^9, {3.730121495967536*^9, 3.730121500326932*^9}, 
   3.7301317496893835`*^9, 3.730131786861555*^9, {3.7301570664720974`*^9, 
   3.7301570699252524`*^9}, 3.730157111300579*^9, 3.73015730684909*^9, {
   3.7304463486853466`*^9, 3.730446354466632*^9}, 3.7329845873413935`*^9, 
   3.7329846868844523`*^9, 3.732985820727009*^9, 3.7329887000689163`*^9, 
   3.732989768839373*^9, 3.732990012151295*^9, {3.732990119919958*^9, 
   3.732990125513755*^9}, 3.7329904537720222`*^9, 3.7329919366606503`*^9, 
   3.7329921322384143`*^9, 3.73300401817771*^9, {3.733005541760129*^9, 
   3.7330055500500417`*^9}, {3.733018048151247*^9, 3.7330180580763707`*^9}, {
   3.733022316061736*^9, 3.73302232762435*^9}, {3.7341097603531666`*^9, 
   3.73410976754073*^9}, 3.7462289984417505`*^9, 
   3.7462291161477737`*^9},ExpressionUUID->"dd4cc13e-61c0-4bd2-9d55-\
ae41946e57b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Switching Events", "Section",
 CellChangeTimes->{{3.681661196468502*^9, 3.6816612120238156`*^9}, {
  3.682474122543976*^9, 3.682474123825241*^9}, {3.68248472469718*^9, 
  3.68248472556816*^9}, {3.6943042237947645`*^9, 3.6943042242920237`*^9}, {
  3.694308657183693*^9, 3.694308682268508*^9}, {3.708181997350568*^9, 
  3.708182021131984*^9}, {3.718897274134631*^9, 
  3.71889727722841*^9}},ExpressionUUID->"1988e040-07fb-4905-8e13-\
34fc6839c894"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"DefaultSwitchingEvent", ",", " ", "AddSwitchingEvent"}], "}"}],
      ",", " ", "HoldFirst"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DefaultSwitchingEvent", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", 
       RowBox[{"2", ";;", 
        RowBox[{"-", "2"}]}]}], ",", " ", 
      RowBox[{"\"\<p\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<a\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"WhenEvent", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<DT\>\"", " ", "\[Rule]", " ", "0"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Events", "[", 
     RowBox[{"k_:", "0"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"TF", "[", 
        RowBox[{
         RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], ",", " ",
          "k"}], "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"m", "[", 
        RowBox[{
         RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
        "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"h", "[", 
        RowBox[{
         RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
        "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"d", "[", 
        RowBox[{
         RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
        "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], " ", 
       "\[Rule]", " ", 
       RowBox[{"T0", "[", 
        RowBox[{
         RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",", " ", 
         RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], ",", " ",
          "k"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DefaultSwitchingEvent", "[", 
     RowBox[{"evnt_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Events", "[", 
         RowBox[{"OptionValue", "[", "\"\<DT\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<p\>\"", "]"}], ",", " ", 
          RowBox[{"a", "\[LeftDoubleBracket]", 
           RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}], 
           "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"OptionValue", "[", "\"\<a\>\"", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"e", " ", "=", " ", "a"}], ",", " ", 
           RowBox[{"o", " ", "=", " ", 
            RowBox[{"OptionValue", "[", "WhenEvent", "]"}]}]}], "}"}], ",", 
         " ", 
         RowBox[{"WhenEvent", "[", 
          RowBox[{"evnt", ",", " ", "e", ",", " ", "o"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddSwitchingTimeEvents", "[", 
     RowBox[{"T_", ",", " ", 
      RowBox[{"DT_:", "Automatic"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "DefaultSwitchingEvent", "]"}]}]}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t0", ",", " ", "tf", ",", " ", "p", ",", " ", "a", ",", " ", "k", ",",
         " ", "n"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "T", " ", "contains", " ", "indices", " ", "in", " ", 
         "\[DoubleStruckC]"}], ",", " ", 
        RowBox[{"with", " ", 
         RowBox[{
         "\[DoubleStruckC]", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], " ", "being", " ", "absolute", " ", 
         "time", " ", "from", " ", "t0", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"=", " ", "0"}], ")"}], "."}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "assumes", " ", "T", " ", "is", " ", "in", " ", "ascending", " ", 
         "order", " ", "0"}], " ", "<=", " ", 
        RowBox[{"T", "[", "i", "]"}], " ", "<=", " ", 
        RowBox[{"T", "[", 
         RowBox[{"i", "+", "1"}], "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "@", "T"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"k", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"VectorQ", "[", "DT", "]"}], " ", "&&", " ", 
              RowBox[{"DT", " ", "=!=", " ", 
               RowBox[{"{", "}"}]}]}], ",", " ", 
             RowBox[{
             "DT", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ",", " ", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "final", " ", "switching", " ", "time", " ", "derivative"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tf", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], " ", 
             "\[Rule]", " ", 
             RowBox[{"TF", "[", 
              RowBox[{
               RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
               ",", " ", 
               RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
               ",", " ", 
               RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
               ",", " ", "k"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p", " ", "=", " ", 
           RowBox[{"\"\<p\>\"", " ", "\[Rule]", " ", "tf"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "start", " ", "switching", " ", "time", " ", "derivative"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"t0", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], " ", 
             "\[Rule]", " ", 
             RowBox[{"T0", "[", 
              RowBox[{
               RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], 
               ",", " ", 
               RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], 
               ",", " ", 
               RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}], 
               ",", " ", "k"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a", " ", "=", " ", 
           RowBox[{"\"\<a\>\"", " ", "\[Rule]", " ", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", " ", "<", " ", "n"}], ",", " ", "t0", ",", " ", 
                RowBox[{"{", "}"}]}], "]"}], ",", " ", 
              "\"\<RemoveEvent\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"final", " ", "switching", " ", 
            RowBox[{"time", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"k", " ", "=", " ", 
           RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", " ", "<", " ", "n"}], ",", " ", 
              RowBox[{"OptionValue", "[", 
               RowBox[{"DefaultSwitchingEvent", ",", " ", "\"\<i\>\""}], 
               "]"}], ",", " ", 
              RowBox[{"{", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"create", " ", "event"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"k", " ", "=", " ", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"j", " ", "=", " ", 
               RowBox[{
               "T", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", " ", 
             RowBox[{"DefaultSwitchingEvent", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[DoubleStruckT]", " ", "-", " ", "j"}], " ", 
                "\[Equal]", " ", "0"}], ",", " ", "p", ",", " ", "a", ",", 
               " ", "k", ",", " ", 
               RowBox[{"WhenEvent", " ", "\[Rule]", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Priority\>\"", " ", "\[Rule]", " ", "i"}], 
                   "}"}], ",", " ", 
                  RowBox[{"OptionValue", "@", "WhenEvent"}]}], "]"}]}], ",", 
               " ", "opts"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "allow", " ", "for", " ", "parameters", " ", "in", " ", "T"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"k", " ", "/.", " ", 
           RowBox[{
            RowBox[{"\[DoubleStruckC]", "[", "k_Integer", "]"}], " ", 
            "\[RuleDelayed]", " ", 
            RowBox[{
            "\[DoubleStruckC]", "\[LeftDoubleBracket]", "k", 
             "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "n"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddSwitchingEvent", "[", 
     RowBox[{"evnt_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", " ", "=", 
        RowBox[{"DefaultSwitchingEvent", "[", 
         RowBox[{"evnt", ",", " ", "opts"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Last", "@", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"e", ",", " ", "a"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RemoveSwitchingEvent", "[", 
    RowBox[{"form_:", 
     RowBox[{"(", "_WhenEvent", ")"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"e", " ", "=", " ", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{"e", ",", " ", "form"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7188972823378353`*^9, 3.7188973177288218`*^9}, {
   3.7188973573542175`*^9, 3.7188973757606335`*^9}, {3.7188976024659996`*^9, 
   3.7188976037160225`*^9}, {3.7188987029456244`*^9, 
   3.7188987214145737`*^9}, {3.7188987596024513`*^9, 3.718898768961919*^9}, {
   3.718898813681111*^9, 3.7188988177280264`*^9}, {3.718900436754637*^9, 
   3.7189004564267063`*^9}, {3.7189004936927*^9, 3.718900494114596*^9}, {
   3.7189024899006824`*^9, 3.7189024909007072`*^9}, {3.7189026404334354`*^9, 
   3.718902651089775*^9}, {3.718902686121372*^9, 3.7189027118247504`*^9}, {
   3.71890275426267*^9, 3.718902877357636*^9}, {3.718902938858243*^9, 
   3.718902953780278*^9}, {3.718906799867057*^9, 3.7189068138515863`*^9}, {
   3.718933020271596*^9, 3.7189330444280863`*^9}, {3.7189330755377665`*^9, 
   3.7189331081162305`*^9}, {3.7189331608979864`*^9, 
   3.7189332036327953`*^9}, {3.718933394119054*^9, 3.718933445213297*^9}, 
   3.7189335051826544`*^9, {3.718934631100018*^9, 3.7189347821796427`*^9}, {
   3.7189348785868373`*^9, 3.718934883071274*^9}, {3.7189349143684425`*^9, 
   3.718934916243459*^9}, 3.7189349712596416`*^9, {3.7189350934639626`*^9, 
   3.718935094588974*^9}, {3.7189352842470975`*^9, 3.7189353373726225`*^9}, {
   3.7189358399070234`*^9, 3.7189359206890707`*^9}, {3.718969559480446*^9, 
   3.718969560074186*^9}, {3.7196308104665294`*^9, 3.719630843982435*^9}, 
   3.719630876779585*^9, 3.719674739433433*^9, {3.7196761556577687`*^9, 
   3.7196762589712176`*^9}, {3.7251326105673046`*^9, 3.725132621364306*^9}, 
   3.725132688930047*^9, 3.725764907591117*^9, {3.725767599875802*^9, 
   3.725767603578955*^9}, {3.728205369362513*^9, 3.728205418581682*^9}, {
   3.7282055008636575`*^9, 3.7282055267545023`*^9}, {3.728205575036174*^9, 
   3.728205585114403*^9}, 3.7282056331929326`*^9, 3.7282056712245283`*^9, {
   3.728205783116118*^9, 3.7282057903661814`*^9}, {3.728205865491838*^9, 
   3.728205892101446*^9}, 3.7282059983523912`*^9, {3.7282062888549213`*^9, 
   3.7282063065894547`*^9}, {3.7282066575856466`*^9, 
   3.7282067296487503`*^9}, {3.7282068190589666`*^9, 3.728206822918378*^9}, {
   3.728215419925082*^9, 3.7282154341908207`*^9}, 3.7282154781442976`*^9, {
   3.728216356245057*^9, 3.7282164197611895`*^9}, {3.7282164503708076`*^9, 
   3.728216462417779*^9}, {3.7282165023868484`*^9, 3.72821650369936*^9}, {
   3.728217248771716*^9, 3.7282172557248964`*^9}, 3.7282174720547485`*^9, {
   3.7282198930716343`*^9, 3.7282198935715866`*^9}, {3.7282203005436373`*^9, 
   3.728220443388528*^9}, {3.7282205529987783`*^9, 3.728220654796466*^9}, {
   3.728220765234847*^9, 3.728220918669932*^9}, {3.7282209515295687`*^9, 
   3.728221025639535*^9}, {3.728221344907668*^9, 3.728221345657716*^9}, {
   3.7282215867205734`*^9, 3.7282216066894836`*^9}, {3.728221662752429*^9, 
   3.7282216722993793`*^9}, {3.7282217213778973`*^9, 3.728221726674816*^9}, {
   3.728221806191075*^9, 3.7282218315037766`*^9}, {3.728223502660037*^9, 
   3.728223527300861*^9}, {3.7282236076296268`*^9, 3.7282236981459565`*^9}, {
   3.728223736021239*^9, 3.7282238238032107`*^9}, {3.728223873241068*^9, 
   3.728223920491501*^9}, 3.7282239572574167`*^9, {3.7282242453690915`*^9, 
   3.7282242754787073`*^9}, {3.7282243777763977`*^9, 
   3.7282243787920313`*^9}, {3.7282244195267324`*^9, 
   3.7282244239486446`*^9}, {3.7282244751209254`*^9, 
   3.7282244812459745`*^9}, {3.728224528886981*^9, 3.728224532074452*^9}, {
   3.728224587168642*^9, 3.7282247013727317`*^9}, {3.7282247540492516`*^9, 
   3.728224811549746*^9}, {3.728224847050027*^9, 3.728224851487562*^9}, 
   3.728224890534752*^9, {3.7282250005668774`*^9, 3.7282250042543716`*^9}, {
   3.728225127536604*^9, 3.7282251610525327`*^9}, {3.728225210599767*^9, 
   3.7282252209435825`*^9}, {3.7282252598814487`*^9, 
   3.7282252833659563`*^9}, {3.7282253167725267`*^9, 3.728225363257273*^9}, {
   3.7282254030232153`*^9, 3.7282254375703664`*^9}, {3.728225530227355*^9, 
   3.728225578696494*^9}, {3.7282256521946993`*^9, 3.72822567856991*^9}, {
   3.728225725054655*^9, 3.7282257259609127`*^9}, {3.728225815914756*^9, 
   3.728225848040012*^9}, {3.728225914099547*^9, 3.728225925568426*^9}, {
   3.7282259784438477`*^9, 3.7282259816626234`*^9}, 3.728226074522705*^9, {
   3.7282269195524073`*^9, 3.7282269593496*^9}, {3.7282271016319857`*^9, 
   3.7282271539136*^9}, {3.728227226054853*^9, 3.7282272643207846`*^9}, {
   3.7282279072790413`*^9, 3.728227954888796*^9}, {3.7283019451195884`*^9, 
   3.7283019985888023`*^9}, {3.7283027122633796`*^9, 3.728302751482442*^9}, {
   3.7283027928422003`*^9, 3.7283028494106684`*^9}, {3.728304040545101*^9, 
   3.7283040457639112`*^9}, {3.7283076625632668`*^9, 
   3.7283076722039165`*^9}, {3.7283930260509515`*^9, 
   3.7283931091297398`*^9}, {3.730037403458395*^9, 3.730037404361779*^9}, 
   3.7300375252687845`*^9, {3.730037567644847*^9, 3.730037625114272*^9}, {
   3.730037694836924*^9, 3.7300377044096975`*^9}, {3.73003808957113*^9, 
   3.730038096291859*^9}, {3.7300382023780327`*^9, 3.7300383285695143`*^9}, {
   3.7300384128816357`*^9, 3.73003850901575*^9}, {3.730038544855625*^9, 
   3.7300385604615684`*^9}, {3.730114983498025*^9, 3.730115019342018*^9}, 
   3.730115175076427*^9, {3.7301153360465193`*^9, 3.730115411484654*^9}, {
   3.7301157162286363`*^9, 3.730115731931904*^9}, {3.730116141773757*^9, 
   3.7301161456331496`*^9}, {3.7301162626653795`*^9, 
   3.7301162683373156`*^9}, {3.7301163373378925`*^9, 
   3.7301163611661997`*^9}, {3.730116530167614*^9, 3.730116532058271*^9}, {
   3.7301166844555435`*^9, 3.7301167133151464`*^9}, {3.7301167476435432`*^9, 
   3.730116772018734*^9}, 3.730117053083597*^9, {3.73011782448067*^9, 
   3.730117828574441*^9}, {3.730117914997057*^9, 3.7301179371847477`*^9}, {
   3.730117976200693*^9, 3.73011799002892*^9}, {3.730119243108981*^9, 
   3.730119255734068*^9}, {3.730119513174077*^9, 3.7301195593932295`*^9}, {
   3.7301214771500854`*^9, 3.7301214800250473`*^9}, {3.7301279644408703`*^9, 
   3.730127965144*^9}, {3.7301571303320208`*^9, 3.7301571333476443`*^9}, {
   3.730157188504367*^9, 3.7301572644581413`*^9}, {3.7304463311383305`*^9, 
   3.730446336528984*^9}, {3.7329690992409067`*^9, 3.732969101365945*^9}, 
   3.7329693207432632`*^9, {3.732969415353677*^9, 3.7329694424320745`*^9}, {
   3.732969532198655*^9, 3.732969592104216*^9}, {3.732969632964017*^9, 
   3.7329697456347303`*^9}, {3.732977627494875*^9, 3.732977652745128*^9}, {
   3.732984090950494*^9, 3.732984098388055*^9}, {3.7329858638212214`*^9, 
   3.7329858639306*^9}, {3.732986806137476*^9, 3.7329868063093557`*^9}, {
   3.7329868573765707`*^9, 3.7329868835108185`*^9}, {3.7329869320936985`*^9, 
   3.7329869346562505`*^9}, {3.732987005031378*^9, 3.732987109907539*^9}, {
   3.732987181350193*^9, 3.7329871967409997`*^9}, 3.732990480512913*^9, {
   3.7329908959841223`*^9, 3.7329909285870247`*^9}, {3.7329909730874844`*^9, 
   3.732990986918311*^9}, {3.7329910393345623`*^9, 3.732991048350299*^9}, {
   3.7329910810381336`*^9, 3.732991088631961*^9}, {3.732991159976487*^9, 
   3.7329911705547733`*^9}, {3.732992139504113*^9, 3.732992152785507*^9}, {
   3.7329922314582357`*^9, 3.7329922470053053`*^9}, {3.732992434897885*^9, 
   3.7329924595387716`*^9}, 3.732992553477271*^9, {3.732992674166054*^9, 
   3.7329926781817255`*^9}, {3.7329934519950595`*^9, 
   3.7329934894642367`*^9}, {3.7329937927174196`*^9, 
   3.7329937963893166`*^9}, {3.732994083284326*^9, 3.7329940860031056`*^9}, {
   3.732994296567847*^9, 3.7329943271619225`*^9}, {3.7329943947720156`*^9, 
   3.73299441819414*^9}, {3.73299455322683*^9, 3.732994556070607*^9}, {
   3.732994608524296*^9, 3.732994639790267*^9}, 3.7329946830563526`*^9, {
   3.7329947184317102`*^9, 3.7329947196348515`*^9}, {3.7329947990453396`*^9, 
   3.7329948074822097`*^9}, {3.7329961605942507`*^9, 3.7329961798600817`*^9}, 
   3.732996291002008*^9, {3.732996345190053*^9, 3.7329963481588345`*^9}, 
   3.732997824035122*^9, {3.733003962337514*^9, 3.7330039801189528`*^9}, {
   3.733004559041623*^9, 3.73300456649481*^9}, 3.733006997167712*^9, {
   3.733010959753467*^9, 3.7330110288589473`*^9}, {3.7330113853740187`*^9, 
   3.733011449109215*^9}, {3.7330116489752803`*^9, 3.7330116715998096`*^9}, {
   3.7330141863985896`*^9, 3.733014191052823*^9}, {3.733018035197565*^9, 
   3.7330180383538423`*^9}, {3.7330183652339163`*^9, 
   3.7330183661549225`*^9}, {3.733018422283591*^9, 3.7330184333395166`*^9}, {
   3.733022300717845*^9, 3.733022309030422*^9}, {3.7330919460999184`*^9, 
   3.7330920095536995`*^9}, {3.733092202508629*^9, 3.733092237008984*^9}, {
   3.733094555324752*^9, 3.733094593325113*^9}, {3.733094631184862*^9, 
   3.7330946366380253`*^9}, {3.733095021460181*^9, 3.7330951481645117`*^9}, {
   3.733095900801695*^9, 3.7330960671470375`*^9}, {3.7330961099599304`*^9, 
   3.733096184007509*^9}, {3.7330962213359885`*^9, 3.733096334602691*^9}, {
   3.7330963668686275`*^9, 3.7330963696342735`*^9}, 3.733096481135332*^9, {
   3.733096572236655*^9, 3.7330966402842197`*^9}, {3.733096690237754*^9, 
   3.733096718722412*^9}, {3.7330971753872004`*^9, 3.733097402085698*^9}, {
   3.7330975589684772`*^9, 3.7330975643257184`*^9}, {3.733097703965247*^9, 
   3.733097706871524*^9}, {3.733097924455265*^9, 3.733097931136032*^9}, {
   3.7330979947427177`*^9, 3.7330980135554113`*^9}, {3.7330994922171144`*^9, 
   3.733099501232854*^9}, {3.7330995334675045`*^9, 3.733099537295695*^9}, {
   3.733099604593196*^9, 3.733099611155759*^9}, 3.7330996841564536`*^9, {
   3.733100822650299*^9, 3.7331008235096674`*^9}, {3.73323810240839*^9, 
   3.7332381650652213`*^9}, {3.7332382658318114`*^9, 
   3.7332382662537217`*^9}, {3.7341064773642297`*^9, 
   3.7341065259271903`*^9}, {3.734106578771409*^9, 3.7341065986465716`*^9}, {
   3.734106684928625*^9, 3.734106685788024*^9}, {3.7341067559605284`*^9, 
   3.7341067603980465`*^9}, {3.734107109495015*^9, 3.734107128385781*^9}, 
   3.734107275708226*^9, 3.734109559090906*^9, {3.7341096843524885`*^9, 
   3.734109703899542*^9}, {3.734109738337358*^9, 
   3.734109741806122*^9}},ExpressionUUID->"e0cbfc26-509b-46bf-ae25-\
902f54cf266a"]
}, Open  ]],

Cell["Dimensions of Various Spaces", "Section",
 CellChangeTimes->{{3.681661196468502*^9, 3.6816612120238156`*^9}, {
  3.682474122543976*^9, 3.682474123825241*^9}, {3.68248472469718*^9, 
  3.68248472556816*^9}, {3.6943042237947645`*^9, 3.6943042242920237`*^9}, {
  3.694308657183693*^9, 3.694308682268508*^9}, {3.708181997350568*^9, 
  3.708182021131984*^9}},ExpressionUUID->"9f876c75-bac9-4ecd-9a73-\
e270e67afed2"],

Cell[CellGroupData[{

Cell["Hybrid Dynamics (flow: swing + impact)", "Section",
 CellChangeTimes->{{3.681661196468502*^9, 3.6816612120238156`*^9}, {
  3.682474122543976*^9, 3.682474123825241*^9}, {3.68248472469718*^9, 
  3.68248472556816*^9}, {3.6943042237947645`*^9, 3.6943042242920237`*^9}, {
  3.694308657183693*^9, 3.694308682268508*^9}, {3.708182147680004*^9, 
  3.70818216411771*^9}},ExpressionUUID->"143a6573-fe08-4752-9b2c-\
2b1d44fde21c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rkopts", "[", 
    RowBox[{"b_", ",", " ", "T_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", " ", ">", " ", "0"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MaxStepFraction", "\[Rule]", "Infinity"}], ",", " ", 
       RowBox[{"Method", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<FixedStep\>\"", ",", " ", 
          RowBox[{"\"\<StepSize\>\"", " ", "\[Rule]", " ", 
           RowBox[{"T", "/", "n"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"RKODE", ",", " ", 
             RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "b"}]}], "}"}]}]}], 
         "}"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"3a23196e-617d-4f6b-90f9-cf0b99b2aeaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"devec", "[", "\"\<o\>\"", "]"}], " ", ":=", " ", "o"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"devec", "[", 
     RowBox[{"d_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", " ", "N", ",", " ", "x", ",", " ", "dx", ",", " ", "ddx"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"N", " ", "=", " ", 
        RowBox[{
         RowBox[{"Length", "[", "d", "]"}], "/", "n"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"Switch", "[", 
         RowBox[{"o", ",", " ", "0", ",", " ", "0", ",", " ", "1", ",", " ", 
          RowBox[{"N", "-", "1"}], ",", " ", "2", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "-", 
               RowBox[{"4", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "N"}], ")"}]}]}], "]"}]}], ")"}], "/", 
           "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"o", " ", "\[GreaterEqual]", " ", "0"}], ",", " ", 
         RowBox[{
          RowBox[{"x", " ", "=", " ", 
           RowBox[{"d", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "n"}], "\[RightDoubleBracket]"}]}], ";"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"o", " ", "\[GreaterEqual]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"dx", " ", "=", " ", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"d", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ";;", 
               RowBox[{"n", " ", 
                RowBox[{"(", 
                 RowBox[{"m", "+", "1"}], ")"}]}]}], 
              "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"n", ",", " ", "m"}], "}"}]}], "]"}]}], ";"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"o", " ", "\[GreaterEqual]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"ddx", " ", "=", " ", 
           RowBox[{"ArrayReshape", "[", 
            RowBox[{
             RowBox[{"d", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{
                RowBox[{"n", " ", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"n", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", "^", "2"}], "+", "m", "+", "1"}], ")"}]}]}], 
              "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"n", ",", " ", "m", ",", " ", "m"}], "}"}]}], "]"}]}], 
          ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "dx", ",", "ddx"}], "}"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", 
         RowBox[{"o", "+", "1"}]}], "\[RightDoubleBracket]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"devecF", "[", 
    RowBox[{"f_", ",", " ", "v_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "F", ",", " ", "r", ",", " ", "d", ",", " ", "p"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "@", "f"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"Slot", "[", "i", "]"}], ",", " ", "j"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "@", "v"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", " ", "=", " ", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Flatten", "@", 
              RowBox[{"d", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", " ", 
                RowBox[{"1", ";;", 
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], 
               "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{"Hold", "[", "#1", "]"}], "[", "a", "]"}]}], "]"}], 
        "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"F", " ", "=", " ", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{"r", ",", " ", "f"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", " ", "=", " ", "F"}], "}"}], ",", " ", 
          RowBox[{"a", "&"}]}], "]"}], " ", "/.", " ", 
        RowBox[{
         RowBox[{"Hold", "[", "a_", "]"}], " ", "\[RuleDelayed]", " ", 
         "a"}]}], " ", "/.", " ", 
       RowBox[{"p", " ", "\[Rule]", " ", "Part"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7081023656347904`*^9, 3.7081023723315086`*^9}, {
   3.708102459868252*^9, 3.7081026111671915`*^9}, {3.7081027066755595`*^9, 
   3.708102734103913*^9}, 3.708103196815297*^9, {3.708124772606333*^9, 
   3.7081248307493467`*^9}, 3.708127859881739*^9, {3.708171550103545*^9, 
   3.70817155015042*^9}, 3.7081716121040974`*^9, {3.7081754042091827`*^9, 
   3.7081754428188653`*^9}, {3.7082018800550747`*^9, 
   3.7082019186491456`*^9}, {3.708201951055693*^9, 3.7082019575714035`*^9}, {
   3.708201988977915*^9, 3.7082019893685427`*^9}, {3.708203347495906*^9, 
   3.708203348402111*^9}, {3.708203531558527*^9, 3.708203532964817*^9}, {
   3.708261894205122*^9, 3.708261898236409*^9}, {3.7082619944091597`*^9, 
   3.708262031378248*^9}, {3.708263058110505*^9, 3.708263086829517*^9}, {
   3.7082640962417994`*^9, 3.708264247711936*^9}, {3.7082642811966286`*^9, 
   3.70826437676*^9}, {3.7082644072134027`*^9, 3.7082645149487534`*^9}, {
   3.7082645856837683`*^9, 3.708264657746922*^9}, {3.7090436973783264`*^9, 
   3.7090436985761523`*^9}, {3.709134900533052*^9, 3.7091349040615444`*^9}, {
   3.709134951651097*^9, 3.709134952836916*^9}, {3.7091349925189056`*^9, 
   3.709135014977728*^9}, {3.7091350541973953`*^9, 3.7091351554918113`*^9}, {
   3.709135192854148*^9, 3.709135322280387*^9}, {3.709135620435596*^9, 
   3.709135694962139*^9}, {3.7091357680995135`*^9, 3.709135923823018*^9}, {
   3.7091359657605963`*^9, 3.709135967128561*^9}, {3.7091360165103655`*^9, 
   3.709136018130519*^9}, {3.7091360558901453`*^9, 3.709136070304308*^9}, {
   3.7091361192708254`*^9, 3.7091361204706764`*^9}, {3.709136169790433*^9, 
   3.709136345746444*^9}, {3.709136376649232*^9, 3.709136410721249*^9}, {
   3.709136517285369*^9, 3.709136569109918*^9}, {3.7091366816172276`*^9, 
   3.7091367247156124`*^9}, {3.709136761465523*^9, 3.7091371797384195`*^9}, {
   3.7091374049522147`*^9, 3.70913761995018*^9}, {3.7091377248471346`*^9, 
   3.709137765196565*^9}, {3.709137806473668*^9, 3.7091378095148287`*^9}, 
   3.70913979949654*^9, 3.709146598158702*^9, {3.709147266092799*^9, 
   3.709147268492508*^9}, {3.709155989567518*^9, 3.7091559926236677`*^9}, 
   3.7091560716664*^9, 3.7091576026023145`*^9, {3.7091579294126263`*^9, 
   3.7091579524248514`*^9}, {3.709158005860521*^9, 3.709158249639827*^9}, {
   3.709158299579039*^9, 3.7091583193800173`*^9}, {3.70915953339526*^9, 
   3.7091595389902053`*^9}, {3.709209580832116*^9, 3.709209592950678*^9}, {
   3.7092096909099145`*^9, 3.709209742672274*^9}, {3.7092097925084257`*^9, 
   3.709209818532769*^9}, {3.7092103125080433`*^9, 3.709210317406481*^9}, {
   3.7092127870026555`*^9, 3.709212789672538*^9}, 3.7092145617046127`*^9, {
   3.7092146231019*^9, 3.7092146292292356`*^9}, 3.709215262185836*^9, {
   3.709218351711486*^9, 3.709218365833426*^9}, {3.709218620235031*^9, 
   3.70921864211644*^9}, {3.7092187928111267`*^9, 3.7092188919440203`*^9}, {
   3.709218948713027*^9, 3.7092191233911924`*^9}, {3.709219159627746*^9, 
   3.709219173553559*^9}, {3.709220047015394*^9, 3.7092200503357353`*^9}, {
   3.709220669441304*^9, 3.7092206741816425`*^9}, {3.709220730645439*^9, 
   3.709220769671955*^9}, {3.709220808016226*^9, 3.7092208521536627`*^9}, {
   3.7092209021779313`*^9, 3.709220906533991*^9}, {3.7092247757607007`*^9, 
   3.70922481210631*^9}, {3.709232167176469*^9, 3.7092321707189665`*^9}, {
   3.7092322151442895`*^9, 3.709232292861093*^9}, 3.7092326286049194`*^9, {
   3.709254838395743*^9, 3.7092548418702087`*^9}, {3.7092549256798267`*^9, 
   3.709254926791611*^9}, {3.7092551567827573`*^9, 3.7092551672921553`*^9}, {
   3.7092554868674793`*^9, 3.7092555181735373`*^9}, {3.709255838334387*^9, 
   3.7092558388727665`*^9}, {3.7092560396663322`*^9, 3.709256063694272*^9}, {
   3.7092566555718145`*^9, 3.709256656493464*^9}, {3.709256860616207*^9, 
   3.709256864174716*^9}, {3.7092573217452517`*^9, 3.7092573889236317`*^9}, {
   3.709298547924039*^9, 3.70929855478379*^9}, {3.709298643721953*^9, 
   3.709298644409474*^9}, {3.7096837798583*^9, 3.7096837880459433`*^9}, {
   3.709684274459219*^9, 3.709684285678131*^9}, {3.7188483046048794`*^9, 
   3.718848305495513*^9}, 3.7191213719813023`*^9, {3.719156272283908*^9, 
   3.7191562729557843`*^9}, {3.7191563161124496`*^9, 
   3.7191563735192676`*^9}, {3.719156653365783*^9, 3.719156731132187*^9}, {
   3.719157128448603*^9, 3.7191571576832666`*^9}, {3.719157256887373*^9, 
   3.719157386326151*^9}, {3.7191574167952137`*^9, 3.7191574474048805`*^9}, {
   3.719157478373936*^9, 3.7191575523903036`*^9}, {3.719157596750106*^9, 
   3.719157619969097*^9}, {3.719157671578971*^9, 3.719157743798446*^9}, {
   3.7191578024552755`*^9, 3.7191578525182743`*^9}, {3.7191579086125746`*^9, 
   3.7191579289721403`*^9}, {3.7191579596443157`*^9, 
   3.7191580846924286`*^9}, {3.7191581438024044`*^9, 
   3.7191581495368347`*^9}, {3.719158188709097*^9, 3.7191581888965836`*^9}, {
   3.7191591908157325`*^9, 3.7191592310973916`*^9}, {3.7191593244576936`*^9, 
   3.7191593246295667`*^9}, {3.7191593595049105`*^9, 3.719159360192422*^9}, {
   3.7203940977721643`*^9, 3.720394122131771*^9}, {3.720394160319618*^9, 
   3.7203941813354535`*^9}, {3.720394235382832*^9, 3.7203942540236344`*^9}, {
   3.726425071270426*^9, 3.7264251070844507`*^9}, {3.726425258518486*^9, 
   3.7264254447387295`*^9}, {3.726425480166794*^9, 3.726425567262209*^9}, {
   3.7264259035661116`*^9, 3.7264259088564005`*^9}, {3.726426007024575*^9, 
   3.726426064953707*^9}, {3.726454036856536*^9, 3.726454040106562*^9}, {
   3.7698711624379616`*^9, 3.7698711729833364`*^9}, 3.7698712106993194`*^9, {
   3.799719978997682*^9, 
   3.7997199796849737`*^9}},ExpressionUUID->"6d2bc991-0286-490b-aed3-\
a34a338de089"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", 
     RowBox[{"m_", ",", " ", 
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"c_", "?", "VectorQ"}]}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", " ", "C"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sow", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rbd", "[", 
           RowBox[{"\"\<m\>\"", ",", " ", "m"}], "]"}], "[", 
          RowBox[{"X", ",", " ", "C"}], "]"}], ",", " ", "\"\<m\>\""}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"m_", ",", " ", 
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"c_", "?", "VectorQ"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", " ", "C"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rbd", "[", 
         RowBox[{"\"\<f\>\"", ",", " ", "m"}], "]"}], "[", 
        RowBox[{"X", ",", " ", "C"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"m_", ",", " ", 
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"c_", "?", "VectorQ"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", " ", "C"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rbd", "[", 
         RowBox[{"\"\<h\>\"", ",", " ", "m"}], "]"}], "[", 
        RowBox[{"X", ",", " ", "C"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"m_", ",", " ", 
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"c_", "?", "VectorQ"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", " ", "C"}], "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sow", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rbd", "[", 
           RowBox[{"\"\<d\>\"", ",", " ", "m"}], "]"}], "[", 
          RowBox[{"X", ",", " ", "C"}], "]"}], ",", " ", "\"\<c\>\""}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T0", "[", 
     RowBox[{"m_", ",", " ", 
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
      RowBox[{"c_", "?", "VectorQ"}], ",", " ", "i_Integer"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", " ", "C"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sow", "[", 
        RowBox[{
         RowBox[{"DT0", "[", 
          RowBox[{"m", ",", " ", "X", ",", " ", "C", ",", " ", "i"}], "]"}], 
         ",", " ", "\"\<x+\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TF", "[", 
    RowBox[{"m_", ",", " ", 
     RowBox[{"x_", "?", "VectorQ"}], ",", " ", 
     RowBox[{"c_", "?", "VectorQ"}], ",", " ", "i_Integer"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", ",", " ", "C"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X", " ", "=", " ", 
       RowBox[{"devec", "[", 
        RowBox[{"x", ",", " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"devec", "[", 
        RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sow", "[", 
       RowBox[{
        RowBox[{"DTF", "[", 
         RowBox[{"m", ",", " ", "X", ",", " ", "C", ",", " ", "i"}], "]"}], 
        ",", " ", "\"\<x-\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.707735390469975*^9, 3.707735391501251*^9}, {
   3.7077354391396484`*^9, 3.7077356633133*^9}, {3.70773586581739*^9, 
   3.7077359460211563`*^9}, {3.70773619524051*^9, 3.7077363156334686`*^9}, {
   3.7077363499266586`*^9, 3.7077363632300444`*^9}, {3.707736491760619*^9, 
   3.7077365504510207`*^9}, {3.707736823907444*^9, 3.7077368240949435`*^9}, {
   3.707738853337065*^9, 3.707738881149785*^9}, {3.707738990713166*^9, 
   3.7077390878076735`*^9}, {3.707739120432948*^9, 3.7077391258861017`*^9}, {
   3.7077391566363606`*^9, 3.7077391879022226`*^9}, {3.707739250410734*^9, 
   3.7077392533347797`*^9}, {3.707742927596059*^9, 3.7077429282367077`*^9}, {
   3.7077432116132393`*^9, 3.7077432507854424`*^9}, {3.7077433323173394`*^9, 
   3.707743334661112*^9}, {3.707743385583376*^9, 3.7077434234586797`*^9}, {
   3.7077434643652554`*^9, 3.7077435558816237`*^9}, {3.7077437807584224`*^9, 
   3.707743948041005*^9}, {3.7077441061360207`*^9, 3.70774410624539*^9}, 
   3.707744141808181*^9, {3.7077449063508587`*^9, 3.707745114727527*^9}, {
   3.7077452141319885`*^9, 3.7077452931951194`*^9}, {3.707745325726636*^9, 
   3.7077453349454594`*^9}, {3.707746753137072*^9, 3.7077467845123096`*^9}, {
   3.7077468310908003`*^9, 3.7077468664660964`*^9}, {3.7077469625293703`*^9, 
   3.707747027951766*^9}, {3.707747064670809*^9, 3.707747079358425*^9}, {
   3.7077471097961683`*^9, 3.707747136749505*^9}, {3.707747300297673*^9, 
   3.7077473453574724`*^9}, {3.7077473772014685`*^9, 
   3.7077473946859846`*^9}, {3.707747534468351*^9, 3.707747537390254*^9}, {
   3.7077476073439302`*^9, 3.707747625781584*^9}, {3.707747694219612*^9, 
   3.707747771642118*^9}, {3.7077478627678494`*^9, 3.7077479118932257`*^9}, {
   3.7077479853157043`*^9, 3.707747986362588*^9}, {3.707748032691081*^9, 
   3.7077482120049973`*^9}, {3.7077485162898035`*^9, 3.707748805811531*^9}, {
   3.7077488650932617`*^9, 3.707748883187148*^9}, {3.707748982922309*^9, 
   3.7077490691104994`*^9}, {3.7077492594245167`*^9, 
   3.7077493006279874`*^9}, {3.707749354065914*^9, 3.7077493867224236`*^9}, {
   3.707749846976093*^9, 3.7077498507417526`*^9}, {3.7077513455779567`*^9, 
   3.707751371765661*^9}, {3.707751436141163*^9, 3.7077514833134146`*^9}, {
   3.7077515387044997`*^9, 3.707751554923377*^9}, {3.7077515893767776`*^9, 
   3.707751640961842*^9}, {3.70775197088636*^9, 3.7077519767926507`*^9}, {
   3.707752061387086*^9, 3.7077520622308297`*^9}, {3.7077520932467155`*^9, 
   3.707752111981246*^9}, {3.7077521449281197`*^9, 3.7077521462093782`*^9}, {
   3.707752218837871*^9, 3.7077522716976624`*^9}, {3.7077524985744605`*^9, 
   3.70775251441835*^9}, 3.707752555043662*^9, {3.7077525874814386`*^9, 
   3.7077526804978056`*^9}, {3.707755281259742*^9, 3.707755294228595*^9}, {
   3.7077555192227135`*^9, 3.707755545706338*^9}, {3.707755587418268*^9, 
   3.707755606246545*^9}, {3.7077556669188995`*^9, 3.7077557274349957`*^9}, 
   3.7077557680945597`*^9, {3.70775581187906*^9, 3.707755853129384*^9}, {
   3.7077559397394586`*^9, 3.707756076506157*^9}, {3.707756132553489*^9, 
   3.7077561679287777`*^9}, {3.707756236824436*^9, 3.7077563369033594`*^9}, {
   3.7077564011851172`*^9, 3.7077564674043837`*^9}, {3.7077564997015285`*^9, 
   3.7077566205931234`*^9}, {3.7077567135313644`*^9, 
   3.7077567476722574`*^9}, {3.707756838344863*^9, 3.707756845313649*^9}, {
   3.7077569068297806`*^9, 3.707756976814699*^9}, {3.7077571268343487`*^9, 
   3.707757136022458*^9}, {3.7077575815353036`*^9, 3.7077576546603394`*^9}, {
   3.70775773817663*^9, 3.7077577386922474`*^9}, {3.707757933256313*^9, 
   3.70775794689705*^9}, {3.7077589121843967`*^9, 3.707758912825035*^9}, {
   3.707954293244898*^9, 3.707954313543235*^9}, {3.7079545231971254`*^9, 
   3.7079545234502993`*^9}, 3.707989030224156*^9, {3.7081003252204103`*^9, 
   3.7081003303830366`*^9}, {3.7081004254821205`*^9, 3.708100436704052*^9}, 
   3.708100523787467*^9, {3.708102741679239*^9, 3.708102782530057*^9}, 
   3.7081030264051056`*^9, {3.7081048581070757`*^9, 3.708104861563513*^9}, {
   3.7081113520043416`*^9, 3.7081113826319504`*^9}, 3.7081291556501484`*^9, 
   3.7081301488307343`*^9, 3.708175183785491*^9, {3.7081817950830903`*^9, 
   3.708181795692419*^9}, {3.7082140959260597`*^9, 3.708214121473159*^9}, {
   3.708214229559571*^9, 3.7082142410284424`*^9}, {3.708214364154605*^9, 
   3.7082144710305676`*^9}, {3.708214515280974*^9, 3.7082145448280888`*^9}, {
   3.708214958283203*^9, 3.708214967344607*^9}, {3.7082150336009674`*^9, 
   3.7082151457081184`*^9}, {3.708215199880514*^9, 3.708215220130646*^9}, {
   3.708215397741641*^9, 3.708215443351486*^9}, {3.708215655730373*^9, 
   3.708215699715149*^9}, {3.7082157531375113`*^9, 3.7082157647938676`*^9}, {
   3.708262279677389*^9, 3.708262281646157*^9}, {3.7082623312716074`*^9, 
   3.7082623330060005`*^9}, 3.708262426287426*^9, {3.70826246140658*^9, 
   3.7082625188133354`*^9}, {3.708262584970188*^9, 3.708262626908069*^9}, {
   3.708262740815358*^9, 3.7082627560967484`*^9}, {3.70826279559713*^9, 
   3.7082628738432198`*^9}, {3.708263266440546*^9, 3.708263268674942*^9}, {
   3.7082633237691784`*^9, 3.7082633240973053`*^9}, {3.7082639073650784`*^9, 
   3.7082639196620646`*^9}, 3.708263968209383*^9, {3.7082682777973785`*^9, 
   3.7082682779725018`*^9}, {3.708268396538274*^9, 3.7082684005851336`*^9}, {
   3.7082684809919615`*^9, 3.7082685082482023`*^9}, {3.7082685456776485`*^9, 
   3.7082685521562266`*^9}, {3.708268614103995*^9, 3.7082686680290976`*^9}, {
   3.7082687006581497`*^9, 3.7082687632443714`*^9}, {3.7082776996411786`*^9, 
   3.7082777029158597`*^9}, {3.708277947227744*^9, 3.70827795842664*^9}, {
   3.708278056368858*^9, 3.7082780610291433`*^9}, {3.7082781366767645`*^9, 
   3.708278145610093*^9}, 3.708278181692889*^9, {3.7082782288532104`*^9, 
   3.7082782684321747`*^9}, {3.709035564515501*^9, 3.7090355740602303`*^9}, {
   3.7090356782169743`*^9, 3.7090356784551253`*^9}, {3.7090374005469313`*^9, 
   3.709037432575513*^9}, {3.709132357926611*^9, 3.7091323605564656`*^9}, {
   3.7091324382092094`*^9, 3.709132446507064*^9}, {3.709132602648733*^9, 
   3.709132651439143*^9}, {3.7091326890166254`*^9, 3.709132755449478*^9}, {
   3.709139046415063*^9, 3.709139065318389*^9}, {3.709139128942251*^9, 
   3.7091391294435883`*^9}, 3.7091406034100885`*^9, {3.709140635612793*^9, 
   3.709140678156789*^9}, 3.7091407189855733`*^9, 3.7091587778300824`*^9, {
   3.709158809109135*^9, 3.709158821523872*^9}, {3.70915891267487*^9, 
   3.709158914500173*^9}, {3.7091595964371457`*^9, 3.7091595971056285`*^9}, {
   3.7093100901780844`*^9, 3.7093100932198353`*^9}, {3.709310296076475*^9, 
   3.709310299404632*^9}, {3.7093106517850513`*^9, 3.709310691863567*^9}, {
   3.709312199898181*^9, 3.709312205679434*^9}, {3.709683527135925*^9, 
   3.709683534667282*^9}, {3.709683688872635*^9, 3.709683725623166*^9}, {
   3.7152696933604403`*^9, 3.7152697003761215`*^9}, {3.7152697358851404`*^9, 
   3.7152697363695345`*^9}, {3.7188855505112906`*^9, 
   3.7188855629957895`*^9}, {3.718886077969613*^9, 3.7188860919385176`*^9}, {
   3.7188862906279645`*^9, 3.7188862978624277`*^9}, {3.7188867224447327`*^9, 
   3.7188867939141893`*^9}, {3.718886843555304*^9, 3.7188868543054123`*^9}, {
   3.718886907493437*^9, 3.7188869110559716`*^9}, {3.718888317959227*^9, 
   3.7188883184592314`*^9}, {3.718888894491143*^9, 3.7188889251320734`*^9}, {
   3.7188890621959257`*^9, 3.7188890705085087`*^9}, {3.7188999183276377`*^9, 
   3.7188999667500086`*^9}, {3.7189000400319676`*^9, 3.718900071563529*^9}, {
   3.7189001713770275`*^9, 3.7189001773145905`*^9}, {3.718902315633336*^9, 
   3.71890232235215*^9}, {3.7189279095842123`*^9, 3.718927964256628*^9}, {
   3.7189291193403516`*^9, 3.7189292564510837`*^9}, {3.718929740018379*^9, 
   3.7189297550185223`*^9}, {3.7189306199645576`*^9, 
   3.7189306265739985`*^9}, {3.719117318046441*^9, 3.719117368171939*^9}, {
   3.719119424868307*^9, 3.719119441712223*^9}, {3.7191213411841197`*^9, 
   3.7191213928408976`*^9}, {3.719158267537998*^9, 3.7191582684130063`*^9}, {
   3.720213537021554*^9, 3.720213537021554*^9}, {3.7202208492387257`*^9, 
   3.720220948272724*^9}, 3.720221004804529*^9, {3.7202213444542985`*^9, 
   3.720221351391865*^9}, {3.7202215400967846`*^9, 3.7202215411280556`*^9}, {
   3.7251326976645126`*^9, 3.7251327018364305`*^9}, {3.725132759415159*^9, 
   3.7251327680871105`*^9}, {3.7251332180604954`*^9, 
   3.7251332755454445`*^9}, {3.725133306467637*^9, 3.725133318702137*^9}, {
   3.725133373890219*^9, 3.725133388937233*^9}, {3.7251334575629373`*^9, 
   3.725133478156912*^9}, {3.725133600243265*^9, 3.7251336072277093`*^9}, {
   3.7251336418687077`*^9, 3.725133644603093*^9}, {3.7251398905852747`*^9, 
   3.725139895429093*^9}, {3.725157193101927*^9, 3.7251572566025767`*^9}, {
   3.725160543295607*^9, 3.7251605472800226`*^9}, {3.725770160342231*^9, 
   3.725770185108044*^9}, 3.7257707036588583`*^9, {3.728204386904191*^9, 
   3.728204392607368*^9}, {3.7282046935474963`*^9, 3.7282047117976656`*^9}, {
   3.7282049830580072`*^9, 3.728205025765747*^9}, {3.7282233154241686`*^9, 
   3.72822336576832*^9}, {3.7329960408993263`*^9, 3.732996041602522*^9}, {
   3.733095158398985*^9, 3.7330951588364882`*^9}, {3.7330995562333617`*^9, 
   3.733099588405525*^9}, {3.733099734656929*^9, 
   3.733099738750721*^9}},ExpressionUUID->"a9c41381-4ad2-4efb-99b5-\
5620c7f44bf5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "\[CurlyPhi]", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<e\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<n\>\"", " ", "\[Rule]", " ", "0"}], ",", " ", 
      RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"NDSolve", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<t0\>\"", " ", "\[Rule]", " ", "$MachineEpsilon"}], ",", 
      " ", 
      RowBox[{"\"\<tf\>\"", " ", "\[Rule]", " ", "$MachineEpsilon"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CurlyPhi]", "[", 
     RowBox[{"RBD_Association", ",", " ", "ord_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"o", " ", "=", " ", "ord"}], ";", "\[IndentingNewLine]", 
       RowBox[{"rbd", " ", "=", " ", "RBD"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CurlyPhi]", "[", 
    RowBox[{"m_", ",", " ", "x_", ",", " ", "c_", ",", " ", "T_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eqn", ",", " ", "o", ",", " ", "t0", ",", " ", "tf"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"set", " ", "time", " ", "interval"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t0", ",", " ", "tf"}], "}"}], " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"VectorQ", "[", "T", "]"}], ",", " ", 
         RowBox[{"T", "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", 
            RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "T"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"MMA", " ", "cannot", " ", "detect", " ", 
         RowBox[{"events", " ", "@", " ", "end"}], " ", "points"}], ",", " ", 
        RowBox[{
        "push", " ", "start", " ", "and", " ", "end", " ", "times", " ", "a", 
         " ", "little"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"t0", " ", "-=", " ", 
       RowBox[{"OptionValue", "[", "\"\<t0\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tf", " ", "+=", " ", 
       RowBox[{"OptionValue", "[", "\"\<tf\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[DoubleStruckX]", ",", " ", "\[DoubleStruckC]", ",", " ", 
          "\[DoubleStruckT]", ",", " ", "\[DoubleStruckM]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"eqns", " ", "&"}], " ", "events"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eqn", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[DoubleStruckX]", "'"}], "[", "\[DoubleStruckT]", 
             "]"}], " ", "\[Equal]", " ", 
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"\[DoubleStruckM]", "[", "\[DoubleStruckT]", "]"}], ",",
               " ", 
              RowBox[{"\[DoubleStruckX]", "[", "\[DoubleStruckT]", "]"}], ",",
               " ", 
              RowBox[{"\[DoubleStruckC]", "[", "\[DoubleStruckT]", "]"}]}], 
             "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"eqn", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"eqn", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"\[DoubleStruckX]", "[", "t0", "]"}], " ", "\[Equal]", 
               " ", "x"}], ",", " ", 
              RowBox[{
               RowBox[{"\[DoubleStruckC]", "[", "t0", "]"}], " ", "\[Equal]", 
               " ", "c"}], ",", " ", 
              RowBox[{
               RowBox[{"\[DoubleStruckM]", "[", "t0", "]"}], " ", "\[Equal]", 
               " ", "m"}]}], "}"}], ",", " ", "e", ",", " ", 
            RowBox[{"OptionValue", "[", "\"\<e\>\"", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", 
           RowBox[{"options", ":", " ", 
            RowBox[{"fixed", " ", "step", " ", 
             RowBox[{"size", "?", " ", "NDSolve"}], " ", "opts"}]}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"rkopts", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}], ",", " ", 
            RowBox[{"tf", "-", "t0"}], ",", " ", 
            RowBox[{"OptionValue", "[", "\"\<n\>\"", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"o", ",", " ", 
             RowBox[{"OptionValue", "[", "NDSolve", "]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"solve", " ", "ODE"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"Reap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sow", "[", 
              RowBox[{"m", ",", " ", "\"\<m\>\""}], "]"}], ";", 
             RowBox[{"Sow", "[", 
              RowBox[{"c", ",", " ", "\"\<c\>\""}], "]"}], ";", 
             RowBox[{"Sow", "[", 
              RowBox[{"x", ",", " ", "\"\<x-\>\""}], "]"}], ";", 
             RowBox[{"Sow", "[", 
              RowBox[{"x", ",", " ", "\"\<x+\>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"NDSolveValue", "[", 
              RowBox[{"eqn", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                "\[DoubleStruckX]", ",", " ", "\[DoubleStruckC]", ",", " ", 
                 "\[DoubleStruckM]"}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"\[DoubleStruckT]", ",", " ", "t0", ",", " ", "tf"}], 
                "}"}], ",", " ", 
               RowBox[{"DiscreteVariables", "\[Rule]", " ", 
                RowBox[{"{", 
                 RowBox[{"\[DoubleStruckC]", ",", " ", 
                  RowBox[{"\[DoubleStruckM]", " ", "\[Element]", " ", 
                   RowBox[{"Keys", "@", 
                    RowBox[{"rbd", "[", "\"\<m\>\"", "]"}]}]}]}], "}"}]}], 
               ",", " ", "o"}], "]"}]}], ",", " ", "_", ",", " ", "Rule"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"return", " ", "trajectories", " ", "and", " ", "events"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<x[t]\>\"", ",", " ", "\"\<c[t]\>\"", ",", " ", 
               "\"\<m[t]\>\""}], "}"}], " ", "\[Rule]", " ", 
             RowBox[{
             "o", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", " ", 
           RowBox[{"Rest", "@", "o"}], ",", " ", 
           RowBox[{"\"\<T\>\"", " ", "\[Rule]", " ", "T"}]}], "|>"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.707735390469975*^9, 3.707735391501251*^9}, {
   3.7077354391396484`*^9, 3.7077356633133*^9}, {3.70773586581739*^9, 
   3.7077359460211563`*^9}, {3.70773619524051*^9, 3.7077363156334686`*^9}, {
   3.7077363499266586`*^9, 3.7077363632300444`*^9}, {3.707736491760619*^9, 
   3.7077365504510207`*^9}, {3.707736823907444*^9, 3.7077368240949435`*^9}, {
   3.707738853337065*^9, 3.707738881149785*^9}, {3.707738990713166*^9, 
   3.7077390878076735`*^9}, {3.707739120432948*^9, 3.7077391258861017`*^9}, {
   3.7077391566363606`*^9, 3.7077391879022226`*^9}, {3.707739250410734*^9, 
   3.7077392533347797`*^9}, {3.707742927596059*^9, 3.7077429282367077`*^9}, {
   3.7077432116132393`*^9, 3.7077432507854424`*^9}, {3.7077433323173394`*^9, 
   3.707743334661112*^9}, {3.707743385583376*^9, 3.7077434234586797`*^9}, {
   3.7077434643652554`*^9, 3.7077435558816237`*^9}, {3.7077437807584224`*^9, 
   3.707743948041005*^9}, {3.7077441061360207`*^9, 3.70774410624539*^9}, 
   3.707744141808181*^9, {3.7077449063508587`*^9, 3.707745114727527*^9}, {
   3.7077452141319885`*^9, 3.7077452931951194`*^9}, {3.707745325726636*^9, 
   3.7077453349454594`*^9}, {3.707746753137072*^9, 3.7077467845123096`*^9}, {
   3.7077468310908003`*^9, 3.7077468664660964`*^9}, {3.7077469625293703`*^9, 
   3.707747027951766*^9}, {3.707747064670809*^9, 3.707747079358425*^9}, {
   3.7077471097961683`*^9, 3.707747136749505*^9}, {3.707747300297673*^9, 
   3.7077473453574724`*^9}, {3.7077473772014685`*^9, 
   3.7077473946859846`*^9}, {3.707747534468351*^9, 3.707747537390254*^9}, {
   3.7077476073439302`*^9, 3.707747625781584*^9}, {3.707747694219612*^9, 
   3.707747771642118*^9}, {3.7077478627678494`*^9, 3.7077479118932257`*^9}, {
   3.7077479853157043`*^9, 3.707747986362588*^9}, {3.707748032691081*^9, 
   3.7077482120049973`*^9}, {3.7077485162898035`*^9, 3.707748805811531*^9}, {
   3.7077488650932617`*^9, 3.707748883187148*^9}, {3.707748982922309*^9, 
   3.7077490691104994`*^9}, {3.7077492594245167`*^9, 
   3.7077493006279874`*^9}, {3.707749354065914*^9, 3.7077493867224236`*^9}, {
   3.707749846976093*^9, 3.7077498507417526`*^9}, {3.7077513455779567`*^9, 
   3.707751371765661*^9}, {3.707751436141163*^9, 3.7077514833134146`*^9}, {
   3.7077515387044997`*^9, 3.707751554923377*^9}, {3.7077515893767776`*^9, 
   3.707751640961842*^9}, {3.70775197088636*^9, 3.7077519767926507`*^9}, {
   3.707752061387086*^9, 3.7077520622308297`*^9}, {3.7077520932467155`*^9, 
   3.707752111981246*^9}, {3.7077521449281197`*^9, 3.7077521462093782`*^9}, {
   3.707752218837871*^9, 3.7077522716976624`*^9}, {3.7077524985744605`*^9, 
   3.70775251441835*^9}, 3.707752555043662*^9, {3.7077525874814386`*^9, 
   3.7077526804978056`*^9}, {3.707755281259742*^9, 3.707755294228595*^9}, {
   3.7077555192227135`*^9, 3.707755545706338*^9}, {3.707755587418268*^9, 
   3.707755606246545*^9}, {3.7077556669188995`*^9, 3.7077557274349957`*^9}, 
   3.7077557680945597`*^9, {3.70775581187906*^9, 3.707755853129384*^9}, {
   3.7077559397394586`*^9, 3.707756076506157*^9}, {3.707756132553489*^9, 
   3.7077561679287777`*^9}, {3.707756236824436*^9, 3.7077563369033594`*^9}, {
   3.7077564011851172`*^9, 3.7077564674043837`*^9}, {3.7077564997015285`*^9, 
   3.7077566205931234`*^9}, {3.7077567135313644`*^9, 
   3.7077567476722574`*^9}, {3.707756838344863*^9, 3.707756845313649*^9}, {
   3.7077569068297806`*^9, 3.707756976814699*^9}, {3.7077571268343487`*^9, 
   3.707757136022458*^9}, {3.7077575815353036`*^9, 3.7077576546603394`*^9}, {
   3.70775773817663*^9, 3.7077577386922474`*^9}, {3.707757933256313*^9, 
   3.70775794689705*^9}, {3.7077589121843967`*^9, 3.707758912825035*^9}, {
   3.707954293244898*^9, 3.707954313543235*^9}, {3.7079545231971254`*^9, 
   3.7079545234502993`*^9}, 3.707989030224156*^9, {3.7081003252204103`*^9, 
   3.7081003303830366`*^9}, {3.7081004254821205`*^9, 3.708100436704052*^9}, 
   3.708100523787467*^9, {3.708102741679239*^9, 3.708102782530057*^9}, 
   3.7081030264051056`*^9, {3.7081048581070757`*^9, 3.708104861563513*^9}, {
   3.7081113520043416`*^9, 3.7081113826319504`*^9}, 3.7081291556501484`*^9, 
   3.7081301488307343`*^9, 3.708175183785491*^9, {3.7081817950830903`*^9, 
   3.708181795692419*^9}, {3.7082140959260597`*^9, 3.708214121473159*^9}, {
   3.708214229559571*^9, 3.7082142410284424`*^9}, {3.708214364154605*^9, 
   3.7082144710305676`*^9}, {3.708214515280974*^9, 3.7082145448280888`*^9}, {
   3.708214958283203*^9, 3.708214967344607*^9}, {3.7082150336009674`*^9, 
   3.7082151457081184`*^9}, {3.708215199880514*^9, 3.708215220130646*^9}, {
   3.708215397741641*^9, 3.708215443351486*^9}, {3.708215655730373*^9, 
   3.708215699715149*^9}, {3.7082157531375113`*^9, 3.7082157647938676`*^9}, {
   3.708262279677389*^9, 3.708262281646157*^9}, {3.7082623312716074`*^9, 
   3.7082623330060005`*^9}, 3.708262426287426*^9, {3.70826246140658*^9, 
   3.7082625188133354`*^9}, {3.708262584970188*^9, 3.708262626908069*^9}, {
   3.708262740815358*^9, 3.7082627560967484`*^9}, {3.70826279559713*^9, 
   3.7082628738432198`*^9}, {3.708263266440546*^9, 3.708263268674942*^9}, {
   3.7082633237691784`*^9, 3.7082633240973053`*^9}, {3.7082639073650784`*^9, 
   3.7082639196620646`*^9}, 3.708263968209383*^9, {3.7082682777973785`*^9, 
   3.7082682779725018`*^9}, {3.708268396538274*^9, 3.7082684005851336`*^9}, {
   3.7082684809919615`*^9, 3.7082685082482023`*^9}, {3.7082685456776485`*^9, 
   3.7082685521562266`*^9}, {3.708268614103995*^9, 3.7082686680290976`*^9}, {
   3.7082687006581497`*^9, 3.7082687632443714`*^9}, {3.7082776996411786`*^9, 
   3.7082777029158597`*^9}, {3.708277947227744*^9, 3.70827795842664*^9}, {
   3.708278056368858*^9, 3.7082780610291433`*^9}, {3.7082781366767645`*^9, 
   3.708278145610093*^9}, 3.708278181692889*^9, {3.7082782288532104`*^9, 
   3.7082782684321747`*^9}, {3.709035564515501*^9, 3.7090355740602303`*^9}, {
   3.7090356782169743`*^9, 3.7090356784551253`*^9}, {3.7090374005469313`*^9, 
   3.709037432575513*^9}, {3.709132357926611*^9, 3.7091323605564656`*^9}, {
   3.7091324382092094`*^9, 3.709132446507064*^9}, {3.709132602648733*^9, 
   3.709132651439143*^9}, {3.7091326890166254`*^9, 3.709132755449478*^9}, {
   3.709139046415063*^9, 3.709139065318389*^9}, {3.709139128942251*^9, 
   3.7091391294435883`*^9}, 3.7091406034100885`*^9, {3.709140635612793*^9, 
   3.709140678156789*^9}, 3.7091407189855733`*^9, 3.7091587778300824`*^9, {
   3.709158809109135*^9, 3.709158821523872*^9}, {3.70915891267487*^9, 
   3.709158914500173*^9}, {3.7091595964371457`*^9, 3.7091595971056285`*^9}, {
   3.7093100901780844`*^9, 3.7093100932198353`*^9}, {3.709310296076475*^9, 
   3.709310299404632*^9}, {3.7093106517850513`*^9, 3.709310691863567*^9}, {
   3.709312199898181*^9, 3.709312205679434*^9}, {3.709683527135925*^9, 
   3.709683534667282*^9}, {3.709683688872635*^9, 3.709683725623166*^9}, {
   3.7152696933604403`*^9, 3.7152697003761215`*^9}, {3.7152697358851404`*^9, 
   3.7152697363695345`*^9}, {3.7188855505112906`*^9, 
   3.7188855629957895`*^9}, {3.718886077969613*^9, 3.7188860919385176`*^9}, {
   3.7188862906279645`*^9, 3.7188862978624277`*^9}, {3.7188867224447327`*^9, 
   3.7188867939141893`*^9}, {3.718886843555304*^9, 3.7188868543054123`*^9}, {
   3.718886907493437*^9, 3.7188869110559716`*^9}, {3.718888317959227*^9, 
   3.7188883184592314`*^9}, {3.718888894491143*^9, 3.7188889251320734`*^9}, {
   3.7188890621959257`*^9, 3.7188890832117753`*^9}, {3.7188891153683386`*^9, 
   3.7188891230871606`*^9}, {3.7188892037285767`*^9, 3.718889253354065*^9}, {
   3.718889336058009*^9, 3.71888933624551*^9}, {3.718899200856813*^9, 
   3.7188992230757675`*^9}, {3.718899286404517*^9, 3.718899299498397*^9}, {
   3.718899443234192*^9, 3.7188994651719246`*^9}, {3.718899555485301*^9, 
   3.7188995974857163`*^9}, {3.718899644783058*^9, 3.7188996449862027`*^9}, {
   3.718899683595959*^9, 3.7188997068255477`*^9}, {3.718899742404026*^9, 
   3.718899774560593*^9}, {3.71889986585837*^9, 3.7188998682802696`*^9}, {
   3.718900121548397*^9, 3.7189001477049227`*^9}, {3.718900260971651*^9, 
   3.7189002855812807`*^9}, {3.718900355628837*^9, 3.718900364566425*^9}, {
   3.7189007912112656`*^9, 3.718900827508515*^9}, {3.7189009526347356`*^9, 
   3.718901000728977*^9}, 3.718901040510621*^9, {3.7189010750109615`*^9, 
   3.7189011221364174`*^9}, {3.7189011668712277`*^9, 3.718901221606144*^9}, {
   3.718901257684626*^9, 3.7189012943881135`*^9}, {3.7189013552324643`*^9, 
   3.7189013914047103`*^9}, {3.718902275522826*^9, 3.7189022767259636`*^9}, {
   3.718927805692561*^9, 3.7189278088800936`*^9}, {3.718927981084921*^9, 
   3.718927998225726*^9}, {3.718929064699188*^9, 3.7189290670742097`*^9}, {
   3.7189308512168436`*^9, 3.718930873748317*^9}, {3.7189313677457757`*^9, 
   3.718931372778335*^9}, {3.7189315185568786`*^9, 3.718931522181912*^9}, {
   3.7189316369642954`*^9, 3.7189316376986785`*^9}, {3.718933250945751*^9, 
   3.7189332511645055`*^9}, {3.7189361826291766`*^9, 
   3.7189361840666733`*^9}, {3.7189366940404806`*^9, 3.718936706806215*^9}, 
   3.718936902746849*^9, {3.7189370370294285`*^9, 3.7189370392950907`*^9}, {
   3.7189371555462246`*^9, 3.718937214390555*^9}, {3.718937265344183*^9, 
   3.7189373878141565`*^9}, {3.7189374470803556`*^9, 3.718937471471233*^9}, {
   3.719121247792572*^9, 3.7191212952617908`*^9}, {3.7191213262777357`*^9, 
   3.7191213329184256`*^9}, {3.7191560910320997`*^9, 3.719156099032194*^9}, {
   3.7191571982930546`*^9, 3.719157235824664*^9}, {3.7191582944445133`*^9, 
   3.7191582950226326`*^9}, {3.719675110843073*^9, 3.71967513143701*^9}, {
   3.7196759341401215`*^9, 3.7196759487808986`*^9}, {3.719675997890704*^9, 
   3.719676012015848*^9}, {3.7196760986884985`*^9, 3.7196761153449016`*^9}, {
   3.7196764499573264`*^9, 3.719676460801176*^9}, {3.7196765735365973`*^9, 
   3.7196765747240925`*^9}, {3.719676701660659*^9, 3.7196767581142983`*^9}, {
   3.719677194430794*^9, 3.7196772213529005`*^9}, {3.7196773319164095`*^9, 
   3.719677375854309*^9}, {3.7196774407142744`*^9, 3.719677468948909*^9}, {
   3.7196775526215615`*^9, 3.7196775531215515`*^9}, {3.719677603137633*^9, 
   3.719677724935633*^9}, {3.720221583878462*^9, 3.720221599144232*^9}, {
   3.7218688070500655`*^9, 3.721868809554838*^9}, 3.725767556219273*^9, {
   3.725768834853942*^9, 3.725768903666963*^9}, {3.7257691074506874`*^9, 
   3.7257691155913734`*^9}, {3.7282049443076687`*^9, 3.728204947604624*^9}, {
   3.728205032328304*^9, 3.7282050327814465`*^9}, {3.728205154220014*^9, 
   3.7282051573293962`*^9}, 3.728206898622163*^9, {3.7282212301099176`*^9, 
   3.728221267078928*^9}, 3.7282242094156446`*^9, {3.7283055626355896`*^9, 
   3.7283055669793744`*^9}, {3.728305691292866*^9, 3.7283057118711557`*^9}, {
   3.7283059387426295`*^9, 3.728305947742714*^9}, {3.73297411066267*^9, 
   3.7329741399754305`*^9}, {3.7329838798497934`*^9, 3.732983933490972*^9}, {
   3.7329845959665017`*^9, 3.73298464122865*^9}, 3.7329846774937253`*^9, {
   3.7329873471183834`*^9, 3.7329873565091*^9}, {3.7329874147862988`*^9, 
   3.732987442549222*^9}, {3.7329875931586313`*^9, 3.7329875933305225`*^9}, {
   3.732987835228098*^9, 3.7329878402594013`*^9}, {3.7329878742441225`*^9, 
   3.732987874369122*^9}, {3.732987924117247*^9, 3.732987929804799*^9}, {
   3.732988049693653*^9, 3.7329880547249556`*^9}, {3.732988242289847*^9, 
   3.7329882424773617`*^9}, {3.73298867201925*^9, 3.732988672144252*^9}, {
   3.7329887631425343`*^9, 3.7329887706269903`*^9}, {3.732989623853365*^9, 
   3.7329896242127066`*^9}, {3.7329898517060823`*^9, 
   3.7329898628155766`*^9}, {3.7329898976904883`*^9, 3.732989897768633*^9}, 
   3.73298993013096*^9, {3.732990057026754*^9, 3.7329900574486656`*^9}, {
   3.732991271085607*^9, 3.732991278257559*^9}, {3.7329913099297695`*^9, 
   3.7329913481600056`*^9}, {3.732991417395099*^9, 3.732991637334941*^9}, {
   3.7329916717415714`*^9, 3.732991672413456*^9}, {3.732996063008936*^9, 
   3.732996064743331*^9}, {3.732996102885223*^9, 3.732996121104168*^9}, {
   3.7329978653168106`*^9, 3.7329978909800663`*^9}, {3.7329979611674566`*^9, 
   3.732997966386263*^9}, {3.7330038790866275`*^9, 3.7330038795397577`*^9}, {
   3.733004172298402*^9, 3.733004181282875*^9}, {3.7330054769587784`*^9, 
   3.733005516554079*^9}, {3.733006728228977*^9, 3.7330067423902087`*^9}, {
   3.7330067935416355`*^9, 3.7330068656440525`*^9}, {3.733006896688162*^9, 
   3.73300695819634*^9}, {3.7330070375579076`*^9, 3.7330070487876673`*^9}, {
   3.733010495436865*^9, 3.7330104968609657`*^9}, {3.73309257780907*^9, 
   3.7330926180906878`*^9}, {3.733093143001926*^9, 3.733093144736334*^9}, {
   3.7330939325068245`*^9, 3.733093979444772*^9}, {3.733094139649373*^9, 
   3.7330942815882683`*^9}, {3.7330943811449304`*^9, 3.733094428067266*^9}, {
   3.733094749401939*^9, 3.7330947514644504`*^9}, {3.733098508329689*^9, 
   3.7330985111109223`*^9}, {3.7330985534550576`*^9, 
   3.7330985609551497`*^9}, {3.73309976620409*^9, 3.7330999715810738`*^9}, {
   3.7331001580984707`*^9, 3.7331001833799467`*^9}, {3.733100232552288*^9, 
   3.7331002384742074`*^9}, {3.733100336959531*^9, 3.7331003426783247`*^9}, {
   3.733100451101226*^9, 3.7331005754461718`*^9}, 3.733100618496826*^9, {
   3.733100657077009*^9, 3.733100718805563*^9}, 3.733141305400669*^9, {
   3.746229018080944*^9, 3.746229035945822*^9}, 
   3.7462291059000406`*^9},ExpressionUUID->"96a8e446-5f1d-46af-abde-\
096e8c874348"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for Computing Derivatives", "Section",
 CellChangeTimes->{{3.681661196468502*^9, 3.6816612120238156`*^9}, {
  3.682474122543976*^9, 3.682474123825241*^9}, {3.68248472469718*^9, 
  3.68248472556816*^9}, {3.6943042237947645`*^9, 3.6943042242920237`*^9}, {
  3.694308657183693*^9, 3.694308682268508*^9}, {3.70818217275836*^9, 
  3.70818218835225*^9}, {3.7081822491184874`*^9, 3.708182283482999*^9}, {
  3.708203686231839*^9, 
  3.7082036864349103`*^9}},ExpressionUUID->"2d1a2e80-54a3-4d7e-853c-\
fe5facd59987"],

Cell["\<\
should switch to T being dT/dc to make general.  Need to then do z[[2]] -= \
Outer[F, T], for example.\
\>", "Text",
 CellChangeTimes->{{3.728218581904878*^9, 
  3.728218648483574*^9}},ExpressionUUID->"12ec3884-4b82-4df5-ac46-\
6d6636eef341"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DT0", "[", 
     RowBox[{"m_", ",", " ", "x_", ",", " ", "c_", ",", " ", "T_"}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", " ", "F"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"T", " ", 
         RowBox[{"(", 
          RowBox[{"an", " ", "index"}], ")"}]}], " ", "=", 
        RowBox[{
         RowBox[{">", " ", 
          RowBox[{
          "switching", " ", "time", " ", "derivatives", " ", "at", " ", 
           "s"}]}], " ", "=", " ", "t0"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"z", " ", "=", " ", "x"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"o", " ", "\[GreaterEqual]", " ", "1"}], " ", "&&", " ", 
          RowBox[{"T", " ", "\[NotEqual]", "  ", "0"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"F", " ", "=", " ", 
           RowBox[{
            RowBox[{"devec", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rbd", "[", 
                RowBox[{"\"\<f\>\"", ",", " ", "m"}], "]"}], "[", 
               RowBox[{"z", ",", " ", "c"}], "]"}], ",", " ", "nx"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"z", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", " ", "All", ",", " ", "T"}], 
            "\[RightDoubleBracket]"}], " ", "-=", " ", "F"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"o", " ", "\[GreaterEqual]", " ", "2"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"must", " ", "have", " ", 
              RowBox[{"dx", "/", "dT"}], " ", "set", " ", "above", " ", 
              "before", " ", "solving", " ", "for", " ", "Hessian"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"F", " ", "=", " ", 
              RowBox[{
               RowBox[{"devec", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rbd", "[", 
                   RowBox[{"\"\<f\>\"", ",", " ", "m"}], "]"}], "[", 
                  RowBox[{"z", ",", " ", "c"}], "]"}], ",", " ", "nx"}], 
                "]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"z", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "3", ",", " ", "i", ",", " ", "T", ",", " ", "All"}], 
                  "\[RightDoubleBracket]"}], " ", "=", " ", 
                 RowBox[{
                  RowBox[{"z", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "3", ",", " ", "i", ",", " ", "All", ",", " ", "T"}], 
                   "\[RightDoubleBracket]"}], " ", "-=", " ", 
                  RowBox[{
                  "F", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}]}], ";"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "nx"}], "}"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "z", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DTF", "[", 
    RowBox[{"m_", ",", " ", "x_", ",", " ", "c_", ",", " ", "T_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", " ", "F"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"T", " ", 
        RowBox[{"(", 
         RowBox[{"an", " ", "index"}], ")"}]}], " ", "=", 
       RowBox[{
        RowBox[{">", " ", 
         RowBox[{
         "switching", " ", "time", " ", "derivatives", " ", "at", " ", 
          "s"}]}], " ", "=", " ", "tf"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"or", " ", "initial", " ", 
        RowBox[{"condition", " ", "@", " ", "s"}]}], " ", "=", " ", 
       RowBox[{
        RowBox[{
        "t0", " ", "for", " ", "switching", " ", "time", " ", "derivatives", 
         " ", "at", " ", "s"}], " ", "=", " ", "tf"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", " ", "=", " ", "x"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"o", " ", "\[GreaterEqual]", " ", "1"}], " ", "&&", " ", 
         RowBox[{"T", " ", "\[NotEqual]", "  ", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"F", " ", "=", " ", 
          RowBox[{
           RowBox[{"devec", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rbd", "[", 
               RowBox[{"\"\<f\>\"", ",", " ", "m"}], "]"}], "[", 
              RowBox[{"z", ",", " ", "c"}], "]"}], ",", " ", "nx"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"z", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", " ", "All", ",", " ", "T"}], 
           "\[RightDoubleBracket]"}], " ", "+=", " ", "F"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"o", " ", "\[GreaterEqual]", " ", "2"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"must", " ", "have", " ", 
             RowBox[{"dx", "/", "dT"}], " ", "set", " ", "above", " ", 
             "before", " ", "solving", " ", "for", " ", "Hessian"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"F", " ", "=", " ", 
             RowBox[{
              RowBox[{"devec", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"rbd", "[", 
                  RowBox[{"\"\<f\>\"", ",", " ", "m"}], "]"}], "[", 
                 RowBox[{"z", ",", " ", "c"}], "]"}], ",", " ", "nx"}], "]"}],
               "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"z", "\[LeftDoubleBracket]", 
                 RowBox[{"3", ",", " ", "i", ",", " ", "T", ",", " ", "All"}],
                  "\[RightDoubleBracket]"}], " ", "=", " ", 
                RowBox[{
                 RowBox[{"z", "\[LeftDoubleBracket]", 
                  RowBox[{
                  "3", ",", " ", "i", ",", " ", "All", ",", " ", "T"}], 
                  "\[RightDoubleBracket]"}], " ", "+=", " ", 
                 RowBox[{
                 "F", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}]}], ";"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", "nx"}], "}"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "z", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7077435910068893`*^9, 3.707743655663659*^9}, {
   3.708124105566866*^9, 3.7081241110117245`*^9}, {3.708213391091539*^9, 
   3.708213405435422*^9}, {3.708213603093444*^9, 3.708213603171556*^9}, {
   3.7082136601252427`*^9, 3.7082136712347183`*^9}, {3.7082137071569233`*^9, 
   3.7082137276727333`*^9}, {3.7089957407266097`*^9, 3.708995788393216*^9}, {
   3.7090359862371225`*^9, 3.709035996311225*^9}, {3.709036040128133*^9, 
   3.7090360403953214`*^9}, {3.7091337518736124`*^9, 
   3.7091337844755983`*^9}, {3.709134067552785*^9, 3.709134082970673*^9}, {
   3.7091341676809244`*^9, 3.709134238470828*^9}, {3.7091342815942364`*^9, 
   3.7091343232455845`*^9}, {3.709134386291726*^9, 3.7091344197883263`*^9}, {
   3.709134467173751*^9, 3.7091344879754095`*^9}, {3.7091345311088114`*^9, 
   3.7091346262899337`*^9}, {3.7091703565138135`*^9, 
   3.7091706816570625`*^9}, {3.709170765746352*^9, 3.709170784898856*^9}, {
   3.7091708449161644`*^9, 3.7091708692353*^9}, {3.7091709161794147`*^9, 
   3.7091709212149577`*^9}, {3.709171404441637*^9, 3.709171428554656*^9}, {
   3.7091715058761635`*^9, 3.7091715417934866`*^9}, {3.7091715892609577`*^9, 
   3.7091715897552905`*^9}, {3.709171633368039*^9, 3.7091719757365336`*^9}, {
   3.7091721367054253`*^9, 3.7091721435382566`*^9}, {3.709172198958317*^9, 
   3.709172253657894*^9}, {3.709172371560007*^9, 3.709172409373684*^9}, {
   3.709172688922858*^9, 3.7091727020701323`*^9}, {3.7091730318912435`*^9, 
   3.709173060428364*^9}, {3.7091731993302937`*^9, 3.7091732004370923`*^9}, {
   3.7091732509867296`*^9, 3.7091732718464365`*^9}, {3.709173341051212*^9, 
   3.7091733525052867`*^9}, {3.709173390172843*^9, 3.709173426178246*^9}, {
   3.70917347312833*^9, 3.7091735422670918`*^9}, {3.7091736008749886`*^9, 
   3.709173662787139*^9}, {3.709173763864419*^9, 3.709173911017151*^9}, {
   3.7091739460188446`*^9, 3.7091739501997924`*^9}, {3.7091739914438715`*^9, 
   3.7091740685972633`*^9}, {3.7091741448550262`*^9, 
   3.7091741468534393`*^9}, {3.7091741885158124`*^9, 3.709174304617652*^9}, {
   3.7091743388768225`*^9, 3.709174545256326*^9}, {3.709174578003414*^9, 
   3.7091746225418153`*^9}, {3.709174912579302*^9, 3.709174912901512*^9}, {
   3.7091750047773037`*^9, 3.70917503703403*^9}, {3.7091751825316105`*^9, 
   3.7091752094776087`*^9}, {3.7092007117292385`*^9, 3.709200711896356*^9}, {
   3.7092042775003953`*^9, 3.7092042815502343`*^9}, {3.7092043182281046`*^9, 
   3.7092043544896755`*^9}, 3.709204395732752*^9, {3.7092044582088003`*^9, 
   3.709204539639207*^9}, {3.709204742483218*^9, 3.7092047770788584`*^9}, {
   3.7092048179957223`*^9, 3.7092048921930337`*^9}, {3.7092050498009195`*^9, 
   3.709205125702433*^9}, {3.709219230260539*^9, 3.709219231487392*^9}, {
   3.7092192874418583`*^9, 3.7092193218190784`*^9}, {3.709219397155096*^9, 
   3.709219401849394*^9}, {3.7092194417785463`*^9, 3.709219497613928*^9}, {
   3.709219660129485*^9, 3.7092197704112263`*^9}, {3.709219835965444*^9, 
   3.709219862299021*^9}, {3.7092199289520025`*^9, 3.7092199809846864`*^9}, {
   3.7092203653011255`*^9, 3.7092203701635523`*^9}, {3.7092205225523157`*^9, 
   3.7092205786843176`*^9}, {3.709220921652649*^9, 3.709220922534273*^9}, {
   3.709222615947714*^9, 3.709222627135602*^9}, {3.7092226647591434`*^9, 
   3.7092226894735518`*^9}, {3.7092229866327343`*^9, 3.709222989108498*^9}, {
   3.7092232995208387`*^9, 3.709223336719082*^9}, {3.7092234010363803`*^9, 
   3.709223414568921*^9}, {3.7092234526297555`*^9, 3.7092234875373664`*^9}, {
   3.709223521549341*^9, 3.709223540736858*^9}, {3.7092235766801996`*^9, 
   3.7092236272588587`*^9}, {3.7092236997549825`*^9, 
   3.7092237022047095`*^9}, {3.7092237534948597`*^9, 
   3.7092237813044825`*^9}, {3.7092238986151905`*^9, 
   3.7092240328465705`*^9}, {3.7092241001230025`*^9, 3.709224122066489*^9}, {
   3.709224174100054*^9, 3.7092241750036783`*^9}, {3.70922456517423*^9, 
   3.709224572678521*^9}, {3.709225215985057*^9, 3.70922523285096*^9}, {
   3.709225555465378*^9, 3.709225576274042*^9}, {3.709225648539*^9, 
   3.7092256763115945`*^9}, 3.7092258153105774`*^9, 3.709225993699334*^9, {
   3.7092296696817703`*^9, 3.7092297246675215`*^9}, {3.709232644736309*^9, 
   3.7092326491834393`*^9}, {3.7092330683097596`*^9, 3.709233105780179*^9}, {
   3.709234885668312*^9, 3.7092348927723293`*^9}, {3.70925454173484*^9, 
   3.709254558872923*^9}, 3.709257541011842*^9, {3.709257592081846*^9, 
   3.709257652934729*^9}, {3.70925789872836*^9, 3.709257929094759*^9}, {
   3.709258060923714*^9, 3.7092580617322664`*^9}, {3.7092877297236414`*^9, 
   3.709287741504982*^9}, {3.709289090150928*^9, 3.709289110916692*^9}, {
   3.7092927786741843`*^9, 3.7092927912524056`*^9}, {3.7092928232370253`*^9, 
   3.709292857409176*^9}, {3.709292889096918*^9, 3.7092929779725733`*^9}, {
   3.709293025004198*^9, 3.7092930925828404`*^9}, {3.7092931683177724`*^9, 
   3.709293263068513*^9}, 3.709293301162548*^9, {3.709293387085062*^9, 
   3.709293406178954*^9}, {3.709293473601362*^9, 3.709293593742898*^9}, 
   3.7092936277119007`*^9, {3.7092936598371515`*^9, 3.709293667634068*^9}, {
   3.7092937349783487`*^9, 3.7092937758223906`*^9}, {3.7092938896670065`*^9, 
   3.7092939729488893`*^9}, {3.7092940039803905`*^9, 
   3.7092940693090143`*^9}, {3.7092941234500527`*^9, 
   3.7092941577003126`*^9}, {3.7092944127022514`*^9, 3.709294519859316*^9}, {
   3.7092946210944605`*^9, 3.7092947064857345`*^9}, {3.7092947564548445`*^9, 
   3.7092948156584234`*^9}, {3.7092948459086695`*^9, 3.7092948588462505`*^9}, 
   3.7092949483313227`*^9, {3.70929499337854*^9, 3.7092949981598263`*^9}, {
   3.7092951783759685`*^9, 3.7092952174105377`*^9}, {3.7092952605983505`*^9, 
   3.709295314083149*^9}, {3.7092953743960896`*^9, 3.7092953799742575`*^9}, {
   3.7092954208027105`*^9, 3.709295673651207*^9}, {3.709295709917106*^9, 
   3.7092958429181004`*^9}, {3.7092959597627573`*^9, 
   3.7092960328883142`*^9}, {3.7092960824980483`*^9, 
   3.7092961052169695`*^9}, {3.709296139545356*^9, 3.7092961597955265`*^9}, {
   3.7092962449680314`*^9, 3.709296389766008*^9}, {3.709296426391305*^9, 
   3.709296482938609*^9}, {3.7092965854081335`*^9, 3.709296610080202*^9}, {
   3.7092967524562645`*^9, 3.7092967772689734`*^9}, {3.709296910988737*^9, 
   3.7092969223013244`*^9}, {3.7092969575828447`*^9, 
   3.7092969663329096`*^9}, {3.7092995616636524`*^9, 3.709299633429839*^9}, {
   3.7092997024303646`*^9, 3.709299704649132*^9}, {3.709299819696881*^9, 
   3.709299862337829*^9}, {3.7092999040256467`*^9, 3.70929991563509*^9}, {
   3.7092999735261755`*^9, 3.7092999867606506`*^9}, {3.7093000181827455`*^9, 
   3.70930004115167*^9}, {3.7093001064490414`*^9, 3.7093002660127726`*^9}, {
   3.7093002965755033`*^9, 3.7093003633885145`*^9}, {3.709300431760394*^9, 
   3.7093004324791517`*^9}, {3.7093007177156925`*^9, 3.709300719778207*^9}, {
   3.7093007752629876`*^9, 3.709300781059927*^9}, {3.7093008656543016`*^9, 
   3.7093009506393347`*^9}, {3.7093010174679747`*^9, 
   3.7093010803903275`*^9}, {3.70930113073446*^9, 3.7093012248758*^9}, {
   3.7093012891731453`*^9, 3.7093013896739283`*^9}, {3.709301492987214*^9, 
   3.7093014991279182`*^9}, {3.7093015651908875`*^9, 3.709301682269903*^9}, {
   3.709301740598471*^9, 3.7093017417078543`*^9}, {3.7093019471625414`*^9, 
   3.7093020170224476`*^9}, {3.7093021140856857`*^9, 
   3.7093021280389175`*^9}, {3.7093022036019917`*^9, 
   3.7093022077113953`*^9}, {3.709302276336919*^9, 3.7093023138059373`*^9}, {
   3.7093023626657004`*^9, 3.7093025052917857`*^9}, 3.709302567839135*^9, {
   3.7093026342458887`*^9, 3.7093026513710203`*^9}, {3.709302735356017*^9, 
   3.7093027658137913`*^9}, {3.7096838718909035`*^9, 3.709683895281867*^9}, {
   3.7096839858612995`*^9, 3.7096839956895666`*^9}, {3.7191215567487516`*^9, 
   3.7191215574518824`*^9}, {3.7191216050461054`*^9, 3.719121622343149*^9}, {
   3.7191216709373817`*^9, 3.7191216720155296`*^9}, 3.7202138162511687`*^9, {
   3.7202186193926835`*^9, 3.720218620267676*^9}, {3.720219059553113*^9, 
   3.7202191054754243`*^9}, {3.7202191501164613`*^9, 3.72021926046126*^9}, {
   3.7202193321806917`*^9, 3.720219347102725*^9}, {3.720219384415563*^9, 
   3.7202194623225656`*^9}, {3.720219514198058*^9, 3.720219536151396*^9}, {
   3.720219578589284*^9, 3.7202196123083534`*^9}, {3.7202197274969482`*^9, 
   3.7202197390126853`*^9}, {3.720219769559848*^9, 3.7202197698723545`*^9}, {
   3.7202198584513197`*^9, 3.720219862232603*^9}, {3.7202199107018137`*^9, 
   3.7202199298582478`*^9}, {3.7202200323279867`*^9, 
   3.7202200934691887`*^9}, {3.7202202283734684`*^9, 
   3.7202202403891897`*^9}, {3.7202202880459046`*^9, 
   3.7202203747967176`*^9}, {3.7202204098126783`*^9, 
   3.7202204185158825`*^9}, {3.7202204657976017`*^9, 3.720220574689242*^9}, {
   3.7202206058145547`*^9, 3.720220634580437*^9}, {3.7202211582962966`*^9, 
   3.720221177093335*^9}, {3.720221242812725*^9, 3.7202212462189918`*^9}, {
   3.720221373142073*^9, 3.720221506237087*^9}, {3.720221628316387*^9, 
   3.7202216308163967`*^9}, {3.7202229802573643`*^9, 3.720223009007636*^9}, {
   3.7202230456642485`*^9, 3.7202230791489277`*^9}, {3.720223134071337*^9, 
   3.7202232263534517`*^9}, {3.7282038154304447`*^9, 3.728203986838193*^9}, 
   3.7282040222135024`*^9, {3.7282041056829815`*^9, 3.7282042133557997`*^9}, {
   3.7282174491951475`*^9, 3.7282174587890186`*^9}, {3.72830860130447*^9, 
   3.728308614695201*^9}, {3.7283472618498354`*^9, 3.7283472656467047`*^9}, {
   3.7299873323588696`*^9, 3.7299873367711205`*^9}, {3.7299873761857224`*^9, 
   3.729987383989353*^9}, {3.729987437629959*^9, 3.7299874471763306`*^9}, {
   3.7299879357020483`*^9, 3.7299879518717623`*^9}, {3.729988010871561*^9, 
   3.7299880372234974`*^9}, {3.730123066558506*^9, 3.730123075321481*^9}, {
   3.7301317638301134`*^9, 3.730131778095855*^9}, {3.7301318500808496`*^9, 
   3.730131856065281*^9}, {3.7301560551674104`*^9, 3.730156067401857*^9}, {
   3.7301565340208063`*^9, 3.730156534567686*^9}, {3.7301570530990524`*^9, 
   3.73015706187829*^9}, {3.7301572927239885`*^9, 
   3.730157293020911*^9}},ExpressionUUID->"e1e7b507-2d1c-49b5-936c-\
e512dfbcbc3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->
  True,ExpressionUUID->"52bcf006-435d-4fb5-ab9c-56c602b78193"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5934306295330305`*^9, 
  3.593430630223071*^9}},ExpressionUUID->"e4dca736-71aa-4a70-bacd-\
862c25b073ff"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1373, 1509},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3080, 60, 547, "Code",ExpressionUUID->"bdd16de3-b081-422d-bf19-ad04f5c7fa5b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3663, 84, 117, 2, 95, "Section",ExpressionUUID->"ffc4eb86-334d-4138-9d93-a94ad2ffa2b2",
 InitializationCell->True],
Cell[3783, 88, 5114, 77, 262, "Input",ExpressionUUID->"dd4cc13e-61c0-4bd2-9d55-ae41946e57b7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[8934, 170, 452, 7, 95, "Section",ExpressionUUID->"1988e040-07fb-4905-8e13-34fc6839c894"],
Cell[9389, 179, 22395, 435, 1982, "Input",ExpressionUUID->"e0cbfc26-509b-46bf-ae25-902f54cf266a",
 InitializationCell->True]
}, Open  ]],
Cell[31799, 617, 416, 6, 95, "Section",ExpressionUUID->"9f876c75-bac9-4ecd-9a73-e270e67afed2"],
Cell[CellGroupData[{
Cell[32240, 627, 425, 6, 81, "Section",ExpressionUUID->"143a6573-fe08-4752-9b2c-2b1d44fde21c"],
Cell[32668, 635, 925, 23, 182, "Input",ExpressionUUID->"3a23196e-617d-4f6b-90f9-cf0b99b2aeaa",
 InitializationCell->True],
Cell[33596, 660, 11300, 226, 822, "Input",ExpressionUUID->"6d2bc991-0286-490b-aed3-a34a338de089",
 InitializationCell->True],
Cell[44899, 888, 14951, 274, 1422, "Input",ExpressionUUID->"a9c41381-4ad2-4efb-99b5-5620c7f44bf5",
 InitializationCell->True],
Cell[59853, 1164, 21141, 361, 653, "Input",ExpressionUUID->"96a8e446-5f1d-46af-abde-096e8c874348",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[81031, 1530, 523, 8, 67, "Section",ExpressionUUID->"2d1a2e80-54a3-4d7e-853c-fe5facd59987"],
Cell[81557, 1540, 252, 6, 34, "Text",ExpressionUUID->"12ec3884-4b82-4df5-ac46-6d6636eef341"],
Cell[81812, 1548, 17737, 321, 672, "Input",ExpressionUUID->"e1e7b507-2d1c-49b5-936c-e512dfbcbc3e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[99586, 1874, 115, 2, 67, "Section",ExpressionUUID->"52bcf006-435d-4fb5-ab9c-56c602b78193",
 InitializationCell->True],
Cell[99704, 1878, 250, 6, 64, "Input",ExpressionUUID->"e4dca736-71aa-4a70-bacd-862c25b073ff",
 InitializationCell->True]
}, Open  ]]
}
]
*)

