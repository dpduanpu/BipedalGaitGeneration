(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44436,        918]
NotebookOptionsPosition[     42580,        874]
NotebookOutlinePosition[     42947,        890]
CellTagsIndexPosition[     42904,        887]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 
  3.591487004222381*^9}},ExpressionUUID->"9c8ea0b3-0f26-4d7b-a778-\
9c0a24e54b04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<BipedalLocomotion`Model`\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<GlobalVariables`\>\"", ",", " ", "\"\<RigidBodyDynamics`\>\"", ",", 
      " ", "\"\<HybridDynamics`\>\"", ",", " ", 
      "\"\<BipedalLocomotion`\>\""}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367625062662*^9, 3.5933676251720285`*^9}, {
   3.704468357519539*^9, 3.704468459841198*^9}, {3.7044685529026203`*^9, 
   3.704468620873731*^9}, {3.7044692938575964`*^9, 3.704469294201355*^9}, {
   3.7044693718565884`*^9, 3.7044694237922263`*^9}, 3.7044696047095137`*^9, {
   3.704469723121451*^9, 3.7044697494763565`*^9}, {3.7044713775105753`*^9, 
   3.7044713779682055`*^9}, {3.71007627184459*^9, 3.7100763129700594`*^9}, {
   3.710085252492481*^9, 3.710085269273345*^9}, {3.710085701211694*^9, 
   3.710085704820245*^9}, {3.71008573624848*^9, 3.7100857468419538`*^9}, {
   3.7100858618232365`*^9, 3.710085866727702*^9}, {3.710085919261855*^9, 
   3.7100859355283422`*^9}, {3.7100860101270795`*^9, 3.710086010815563*^9}, {
   3.7100862247653303`*^9, 3.7100862253687563`*^9}, {3.7100876279638534`*^9, 
   3.7100876368821716`*^9}, {3.710247193222289*^9, 3.710247196972357*^9}, {
   3.710249077736276*^9, 3.710249078486265*^9}, {3.719112887775036*^9, 
   3.719112914478425*^9}, {3.719112998854257*^9, 3.719113000323023*^9}, {
   3.7191136395085473`*^9, 3.719113649164892*^9}, {3.7191142786242285`*^9, 
   3.7191142850305424`*^9}, {3.7191148517147193`*^9, 3.719114863449196*^9}, {
   3.719119110936748*^9, 3.7191191115148916`*^9}, {3.7192594158469114`*^9, 
   3.7192594159719267`*^9}, {3.719316051144735*^9, 3.7193160578791547`*^9}, {
   3.719319732049544*^9, 3.7193197419558764`*^9}, 3.7193203681377673`*^9, {
   3.7193207837662573`*^9, 3.7193208040007887`*^9}, {3.7193209410155106`*^9, 
   3.719320947859317*^9}, {3.7193210109535794`*^9, 3.7193210134848676`*^9}, {
   3.7193297273256416`*^9, 3.719329731778801*^9}, {3.719331828843217*^9, 
   3.719331830624465*^9}, {3.719342569756166*^9, 3.7193425902876005`*^9}, 
   3.7193563161264734`*^9, {3.7195278038553996`*^9, 3.7195278121835775`*^9}, {
   3.719527851043294*^9, 3.719527860183981*^9}, {3.7195279797943707`*^9, 
   3.7195279975757694`*^9}, {3.719528877851327*^9, 3.71952888489826*^9}, {
   3.71952896583644*^9, 3.7195289670395765`*^9}, {3.7195300338453684`*^9, 
   3.7195300418141737`*^9}, {3.719530107783491*^9, 3.7195301450806713`*^9}, {
   3.7195303916452246`*^9, 3.7195304070984783`*^9}, {3.7195306535380383`*^9, 
   3.7195306647568817`*^9}, {3.719532064143588*^9, 3.7195320709092674`*^9}, {
   3.719532111503368*^9, 3.7195321119408593`*^9}, {3.719533318166131*^9, 
   3.7195333205724144`*^9}, {3.7195338887177787`*^9, 3.7195338932959576`*^9}, 
   3.71953653490431*^9, {3.7195372142225065`*^9, 3.719537239628954*^9}, {
   3.719580059910945*^9, 3.7195800614578323`*^9}, {3.71958169698715*^9, 
   3.719581700659041*^9}, {3.719583219482529*^9, 3.7195832242169576`*^9}, 
   3.719586653720458*^9, {3.719587147626902*^9, 3.719587150033171*^9}, {
   3.7195911657964106`*^9, 3.7195911775308695`*^9}, {3.719591308469475*^9, 
   3.7195913086726027`*^9}, 3.719617249148912*^9, {3.7196805679542046`*^9, 
   3.7196805805168033`*^9}, 3.7197626191245446`*^9, {3.719762822642025*^9, 
   3.7197628523766727`*^9}, {3.7197635134243007`*^9, 
   3.7197635213462505`*^9}, {3.7197678733982067`*^9, 
   3.7197678793045216`*^9}, {3.7197688552747164`*^9, 3.719768858102868*^9}, {
   3.719847928484681*^9, 3.7198479314119463`*^9}, {3.7201443634474845`*^9, 
   3.7201443748538256`*^9}, {3.731225156076333*^9, 3.731225156732589*^9}, {
   3.7312252924029074`*^9, 
   3.731225292668518*^9}},ExpressionUUID->"e6160922-0389-4cb0-89f2-\
9999f824f16d"]
}, Open  ]],

Cell["TODO", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7191601507066483`*^9, 
  3.719160151769163*^9}},ExpressionUUID->"7c784083-9d6b-4a54-a2b7-\
120a0c46f4ab"],

Cell[CellGroupData[{

Cell["Compiled Dynamics", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7195903540083714`*^9, 
  3.7195903583521576`*^9}},ExpressionUUID->"6463c66c-ec44-435d-b7a0-\
ce9782c64439"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"confun", " ", "=", " ", 
    RowBox[{"<|", 
     RowBox[{"\"\<I\>\"", " ", "\[RuleDelayed]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Pfun", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[DoubleStruckX]", ",", " ", "_Real", ",", " ", "nx"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[DoubleStruckC]", ",", " ", "_Real", ",", " ", "nc"}], 
             "}"}]}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"B0fun", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[DoubleStruckX]", ",", " ", "_Real", ",", " ", "nx"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[DoubleStruckC]", ",", " ", "_Real", ",", " ", "nc"}], 
             "}"}]}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"BTfun", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[DoubleStruckX]", ",", " ", "_Real", ",", " ", "nx"}], 
             "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[DoubleStruckC]", ",", " ", "_Real", ",", " ", "nc"}], 
             "}"}]}], "}"}]}], "}"}]}], "}"}]}], "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"confun", " ", "=", " ", 
    RowBox[{"RBDMergeRecipes", "[", 
     RowBox[{"\"\<confun\>\"", ",", " ", "confun"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datrules", " ", "=", " ", 
   RowBox[{"Normal", "@", 
    RowBox[{"RBDMergeRecipes", "[", 
     RowBox[{"\"\<datrules\>\"", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"HoldPattern", "[", "\[Alpha]0", "]"}], " ", 
         "\[RuleDelayed]", " ", 
         RowBox[{"fcon", "[", "\"\<\[Alpha]0\>\"", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", "\[Alpha]T", "]"}], " ", 
         "\[RuleDelayed]", " ", 
         RowBox[{"fcon", "[", "\"\<\[Alpha]T\>\"", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", "\[Alpha]\[Theta]", "]"}], " ", 
         "\[RuleDelayed]", " ", 
         RowBox[{"fcon", "[", "\"\<\[Alpha]\[Theta]\>\"", "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"HoldPattern", "[", "\[Alpha]Jp", "]"}], " ", 
         "\[RuleDelayed]", " ", 
         RowBox[{"fcon", "[", "\"\<\[Alpha]J[p]\>\"", "]"}]}]}], "}"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719618063827598*^9, 3.7196180642026005`*^9}, {
  3.7201348772946243`*^9, 3.720134907794899*^9}, {3.7201570580469027`*^9, 
  3.72015706617198*^9}, {3.720162974297036*^9, 3.7201629758439126`*^9}, {
  3.7264284790050664`*^9, 3.7264284849269905`*^9}, {3.733239412734336*^9, 
  3.7332394135781083`*^9}},ExpressionUUID->"a117767b-b97a-497b-8a70-\
109e0ab836e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "BLCompileBiped", "]"}], " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<m\>\"", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
    RowBox[{"\"\<d\>\"", " ", "\[Rule]", " ", "Automatic"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLCompileBiped", "[", 
    RowBox[{"n_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "biped", ",", " ", "cons", ",", " ", "M", ",", " ", "D", ",", " ", 
       "C"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"compile", " ", "dynamics"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"biped", " ", "=", " ", 
       RowBox[{"Quiet", "@", 
        RowBox[{"RBDLoadDynamics", "[", 
         RowBox[{"n", ",", " ", 
          RowBox[{"\"\<F\>\"", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"BLbiped", "[", "\"\<name\>\"", "]"}], " ", "<>", " ", 
            "\"\<CompiledFunctions/\>\""}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"biped", " ", "===", " ", "$Failed"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"new", " ", "compile"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cons", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"con", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"AssociationQ", "[", "#", "]"}], " ", "&&", " ", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"#", ",", " ", "\"\<name\>\""}], "]"}]}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "cons"}], " ", ">", " ", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "RBDConstraintFunctions", " ", "=", " ", 
                "BLConstraintFunctions"}], "}"}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"biped", " ", "=", " ", 
                RowBox[{"RBDCompileFunction", "[", 
                 RowBox[{
                  RowBox[{"Values", "@", "cons"}], ",", " ", "n", ",", " ", 
                  RowBox[{"\"\<C\>\"", " ", "\[Rule]", " ", "confun"}], ",", 
                  " ", 
                  RowBox[{"\"\<D\>\"", " ", "\[Rule]", " ", "datrules"}]}], 
                 "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"M", " ", "=", " ", 
          RowBox[{"OptionValue", "[", "\"\<m\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"M", " ", "===", " ", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"M", "  ", "=", " ", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<left\>\"", " ", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{"\"\<right\>\"", "&"}], ")"}]}], ",", " ", 
               RowBox[{"\"\<right\>\"", " ", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{"\"\<left\>\"", "&"}], ")"}]}]}], "|>"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"D", " ", "=", " ", 
          RowBox[{"OptionValue", "[", "\"\<d\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"D", " ", "===", " ", "Automatic"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"D", " ", "=", " ", 
             RowBox[{"Function", "[", 
              RowBox[{"x", ",", " ", 
               RowBox[{"x", " ", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"BLc", "[", 
                   RowBox[{"x", ",", " ", "##"}], "]"}], "&"}], ")"}]}], ",", 
               " ", "Listable"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"D", "  ", "=", " ", 
             RowBox[{"<|", 
              RowBox[{"D", "@", 
               RowBox[{"Keys", "@", "M"}]}], "|>"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"set", " ", "up", " ", "hybrid", " ", "flow"}], " ", "*)"}],
          "\[IndentingNewLine]", 
         RowBox[{"biped", " ", "=", " ", 
          RowBox[{"Join", "[", " ", 
           RowBox[{"biped", ",", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<m\>\"", " ", "\[Rule]", " ", "M"}], ",", " ", 
              RowBox[{"\"\<d\>\"", " ", "\[Rule]", " ", "D"}], ",", " ", 
              RowBox[{"\"\<t\>\"", " ", "\[Rule]", " ", 
               RowBox[{"con", "[", "\"\<t\>\"", "]"}]}]}], "|>"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "save", " ", "to", " ", "avoid", " ", "lengthy", " ", "compilation",
            " ", "in", " ", "future"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"RBDSaveDynamics", "[", 
          RowBox[{"biped", ",", " ", "n", ",", " ", 
           RowBox[{"\"\<F\>\"", " ", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"BLbiped", "[", "\"\<name\>\"", "]"}], " ", "<>", " ", 
             "\"\<CompiledFunctions/\>\""}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CurlyPhi]", "[", 
       RowBox[{"biped", ",", " ", "n"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"compile", " ", "continuation", " ", "parameters"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BLbiped", "\[LeftDoubleBracket]", 
        RowBox[{
        "\"\<\[DoubleStruckC]\>\"", ",", " ", "All", ",", " ", "\"\<p\>\""}], 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Values", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"p2c", "[", 
            RowBox[{"#", ",", " ", "n"}], "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"con", "[", "\"\<p\>\"", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BLbiped", "\[LeftDoubleBracket]", 
        RowBox[{
        "\"\<\[DoubleStruckC]\>\"", ",", " ", "All", ",", " ", "\"\<T\>\""}], 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Values", "@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c2c", "[", 
            RowBox[{"#", ",", " ", "n"}], "]"}], "&"}], " ", "/@", " ", 
          RowBox[{"con", "[", "\"\<cT\>\"", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"BLbiped", ",", " ", "biped"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191130367608995`*^9, 3.7191131301368065`*^9}, {
   3.719113583617358*^9, 3.7191135897580442`*^9}, {3.7191137904475436`*^9, 
   3.719113835572975*^9}, {3.719114293640001*^9, 3.7191143552343707`*^9}, {
   3.7191145266021147`*^9, 3.7191145640087466`*^9}, {3.719114594602789*^9, 
   3.719114635634445*^9}, {3.719114711150816*^9, 3.7191147136977158`*^9}, {
   3.719114970356517*^9, 3.719114971919016*^9}, {3.7191150484693227`*^9, 
   3.719115050688096*^9}, {3.719115866506564*^9, 3.7191158906942873`*^9}, {
   3.7191160985557175`*^9, 3.719116131321666*^9}, {3.719116713577421*^9, 
   3.7191167415308228`*^9}, {3.71911724026444*^9, 3.7191172468582525`*^9}, 
   3.719156080375743*^9, {3.7191561388763337`*^9, 3.719156157345255*^9}, {
   3.7191583324761286`*^9, 3.7191583471980195`*^9}, {3.719259406753086*^9, 
   3.719259406846836*^9}, {3.7193193225773687`*^9, 3.7193193427962713`*^9}, 
   3.7193194174375367`*^9, {3.719319935129367*^9, 3.7193199359262333`*^9}, {
   3.7193212090333776`*^9, 3.7193212578775196`*^9}, {3.7193261320174637`*^9, 
   3.7193261782366*^9}, {3.7193264648327293`*^9, 3.7193265326926737`*^9}, {
   3.719326563614818*^9, 3.719326569146103*^9}, {3.7193288038865147`*^9, 
   3.7193288344336596`*^9}, {3.719328866949541*^9, 3.7193288731214695`*^9}, 
   3.719328920356239*^9, {3.71932895101276*^9, 3.719328997403758*^9}, {
   3.7193307538810854`*^9, 3.719330761240539*^9}, {3.7193308055690207`*^9, 
   3.719330869257069*^9}, 3.719331603372566*^9, {3.71934060072346*^9, 
   3.7193406238642793`*^9}, 3.719341210255195*^9, {3.7193423819420967`*^9, 
   3.7193424001297646`*^9}, {3.719342614881545*^9, 3.719342634991104*^9}, {
   3.719342765054674*^9, 3.71934276539843*^9}, {3.719343024775613*^9, 
   3.719343049010176*^9}, {3.7193431356827927`*^9, 3.7193431633392735`*^9}, {
   3.719343216011571*^9, 3.7193432294023256`*^9}, {3.7193432730901747`*^9, 
   3.7193432833715096`*^9}, {3.7193433184186783`*^9, 3.7193433249499826`*^9}, 
   3.7193435294516945`*^9, 3.7193467292909527`*^9, {3.719346886136015*^9, 
   3.7193468946048384`*^9}, {3.719367059188481*^9, 3.7193670657979116`*^9}, 
   3.7193673127455297`*^9, 3.71936742499647*^9, {3.719369159640607*^9, 
   3.719369180687659*^9}, {3.719518139658179*^9, 3.7195181861898165`*^9}, {
   3.719518217471347*^9, 3.7195182194557204`*^9}, {3.7195182656279984`*^9, 
   3.7195183360660872`*^9}, {3.7195184159261312`*^9, 3.719518438176302*^9}, {
   3.7195184744891057`*^9, 3.719518499786193*^9}, {3.719518596208873*^9, 
   3.719518601349541*^9}, 3.7195241131510572`*^9, {3.7195241670890074`*^9, 
   3.7195241920423393`*^9}, 3.7195243062483006`*^9, {3.719524356404009*^9, 
   3.7195243601384172`*^9}, {3.7195246201004915`*^9, 3.7195246321825676`*^9}, 
   3.7195246743079157`*^9, {3.719525325082879*^9, 3.719525367419572*^9}, 
   3.7195267226837764`*^9, 3.7195270204154406`*^9, {3.7195276201819887`*^9, 
   3.719527626010147*^9}, {3.7195294616999645`*^9, 3.7195294736375484`*^9}, {
   3.7195296069668026`*^9, 3.7195296224981675`*^9}, {3.719530168846486*^9, 
   3.7195301697058663`*^9}, {3.719532344005314*^9, 3.719532498240982*^9}, {
   3.7195325433507175`*^9, 3.7195325937261567`*^9}, {3.7195326916332235`*^9, 
   3.719532692805108*^9}, {3.7195333981043158`*^9, 3.7195334048856077`*^9}, {
   3.7195334359639935`*^9, 3.7195335278397627`*^9}, {3.719534106641492*^9, 
   3.7195341362354746`*^9}, {3.719534334018394*^9, 3.7195343343621473`*^9}, {
   3.7195347496937294`*^9, 3.7195347513656344`*^9}, {3.719538163214803*^9, 
   3.7195381802774467`*^9}, {3.7195783113927665`*^9, 
   3.7195783366585855`*^9}, {3.719579175196865*^9, 3.719579238166125*^9}, {
   3.71958050041463*^9, 3.719580523336694*^9}, {3.719584392523588*^9, 
   3.7195843954454994`*^9}, {3.719584504024537*^9, 3.719584508977703*^9}, 
   3.719617249148912*^9, {3.71961746676012*^9, 3.7196174804477186`*^9}, {
   3.719618046358717*^9, 3.7196180844996614`*^9}, {3.7196805805168033`*^9, 
   3.7196805805168033`*^9}, 3.719762885986352*^9, {3.719764731869668*^9, 
   3.719764740697874*^9}, {3.719765078128419*^9, 3.7197650954098263`*^9}, {
   3.719765182285636*^9, 3.7197652120983925`*^9}, {3.7197653106930404`*^9, 
   3.7197653151462183`*^9}, {3.7197662664390283`*^9, 
   3.7197663023143663`*^9}, {3.7197676421304855`*^9, 
   3.7197676669119453`*^9}, {3.719767730975032*^9, 3.7197677336156797`*^9}, {
   3.719767785616166*^9, 3.7197677859755335`*^9}, {3.7197678733982067`*^9, 
   3.7197680407122335`*^9}, {3.719768080775098*^9, 3.719768080915725*^9}, {
   3.719768329374957*^9, 3.719768369531562*^9}, 3.7197688126649547`*^9, 
   3.719768843180872*^9, {3.7197694680615635`*^9, 3.719769477717905*^9}, {
   3.7201043332244406`*^9, 3.7201043578809247`*^9}, {3.7201046352585616`*^9, 
   3.7201046426648827`*^9}, {3.720104715181196*^9, 3.720104794713201*^9}, {
   3.7201048274635253`*^9, 3.7201048780421305`*^9}, {3.720105474813428*^9, 
   3.7201055102825017`*^9}, {3.720134525416267*^9, 3.7201345779480257`*^9}, 
   3.7201986568906975`*^9, 3.720221897713585*^9, {3.720221952964125*^9, 
   3.7202219802925096`*^9}, {3.7202222434171677`*^9, 3.720222263948598*^9}, {
   3.7202227300286126`*^9, 3.720222730825495*^9}, {3.7204126544879265`*^9, 
   3.720412658003583*^9}, 3.7204133895771484`*^9, {3.7205080611524763`*^9, 
   3.7205080690431733`*^9}, {3.7205081919431915`*^9, 3.720508262646962*^9}, {
   3.7205083883356113`*^9, 3.72050838842936*^9}, {3.72050842291405*^9, 
   3.720508555024629*^9}, {3.720508845308529*^9, 3.7205088696837635`*^9}, {
   3.7209157556434784`*^9, 3.720915758721648*^9}, {3.7246915839191265`*^9, 
   3.724691603309963*^9}, {3.724717285349967*^9, 3.7247172863499765`*^9}, {
   3.7310655116414766`*^9, 3.7310655931051855`*^9}, 3.731065690283024*^9, {
   3.731065738517796*^9, 3.7310657392678165`*^9}, {3.7310658597900376`*^9, 
   3.7310658739154253`*^9}, {3.7310659901566014`*^9, 
   3.7310660024535756`*^9}, {3.7310661207610865`*^9, 3.7310661238079696`*^9}, 
   3.731066263041328*^9, {3.73106698629385*^9, 3.731066996997081*^9}, {
   3.7329075721890554`*^9, 3.7329076208458247`*^9}, 3.732907907083292*^9, {
   3.732907967216483*^9, 3.732907970435254*^9}, {3.732908799221299*^9, 
   3.732908827752861*^9}, {3.7329091297690463`*^9, 3.732909130135066*^9}, {
   3.739965600122938*^9, 3.739965600525673*^9}, {3.769785413834362*^9, 
   3.7697854254428854`*^9}, 3.7697854804770885`*^9, {3.769786037715448*^9, 
   3.76978603827789*^9}, {3.7698810350874586`*^9, 3.769881103348073*^9}, 
   3.7698818010445843`*^9, {3.7698827186103745`*^9, 3.769882749381892*^9}, {
   3.769882779457762*^9, 3.769882851543087*^9}, {3.76988290539851*^9, 
   3.769882911335563*^9}, {3.769882949067953*^9, 3.76988296248884*^9}, {
   3.7698830056508636`*^9, 3.7698830072601385`*^9}, {3.7698839769523344`*^9, 
   3.7698839989663596`*^9}, {3.791216943739895*^9, 3.791216948795731*^9}, {
   3.7912173047341213`*^9, 3.7912173051059237`*^9}, {3.7912173683711643`*^9, 
   3.791217369936574*^9}, {3.7912174075478907`*^9, 3.7912174094225483`*^9}, {
   3.7976304677401323`*^9, 
   3.797630524563257*^9}},ExpressionUUID->"8dc250a1-593d-44f8-9ae9-\
aa7695c6af78"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraints", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7193181990604544`*^9, 3.7193181998416986`*^9}, {3.7193288884340954`*^9, 
  3.7193289031060944`*^9}, {3.7195912625940957`*^9, 3.719591263437853*^9}, {
  3.7197623812707024`*^9, 3.7197623823019624`*^9}, {3.7197629391899643`*^9, 
  3.7197629406274776`*^9}},ExpressionUUID->"0fa4c3d9-4655-427e-ae2b-\
2212bea41d4d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DownValues", "[", "ConstraintFunctions", "]"}], "=", " ", 
    RowBox[{
     RowBox[{"DownValues", "[", "RBDConstraintFunctions", "]"}], " ", "/.", 
     " ", 
     RowBox[{
     "RBDConstraintFunctions", " ", "\[Rule]", " ", 
      "ConstraintFunctions"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conmat", "::", "mulp"}], " ", "=", " ", 
    "\"\<There are multiple matrices for constraint `` of type ``; selecting \
first one.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conmat", "[", 
     RowBox[{"t_", ",", " ", "n_", ",", " ", 
      RowBox[{"fcn_:", "True"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"con", "[", "t", "]"}], ",", " ", "n", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "make", " ", "sure", " ", "zero", " ", "or", " ", "one", " ", 
         "matrix", " ", "is", " ", "selected"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"VectorQ", "[", "n", "]"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"f", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"f", ",", " ", "MatrixQ"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "f"}], " ", ">", " ", "0"}], ",", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "f"}], " ", ">", " ", "1"}], ",", " ", 
               RowBox[{"Message", "[", 
                RowBox[{
                 RowBox[{"conmat", "::", "mulp"}], ",", " ", "n", ",", " ", 
                 "t"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"f", " ", "=", " ", 
              RowBox[{"First", "@", "f"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"fcn", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fcon", "[", "t", "]"}], " ", "=", " ", 
          RowBox[{
          "RigidBodyDynamics`Private`ConvertToXLFunction", "[", "f", "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"fcon", "[", "t", "]"}], " ", "=", " ", "f"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLConstraintFunctions", "[", "name_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"C", ",", " ", "P"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"ConstraintFunctions", "[", "name", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{"\"\<P\>\"", ",", " ", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{"\"\<B0\>\"", ",", " ", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{"\"\<BT\>\"", ",", " ", "name"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{"\"\<\[Alpha]0\>\"", ",", " ", "name", ",", " ", "False"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{"\"\<\[Alpha]T\>\"", ",", " ", "name", ",", " ", "False"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{
       "\"\<\[Alpha]\[Theta]\>\"", ",", " ", "name", ",", " ", "False"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"conmat", "[", 
       RowBox[{"\"\<\[Alpha]J[p]\>\"", ",", " ", "name", ",", " ", "False"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "C"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7193195142820807`*^9, 3.719319546016738*^9}, {
   3.7193195965484004`*^9, 3.719319759534131*^9}, {3.7193200545991154`*^9, 
   3.7193200583491488`*^9}, {3.7193201175058985`*^9, 3.7193201431467323`*^9}, 
   3.719320175115734*^9, {3.7193208275478754`*^9, 3.7193208346885443`*^9}, {
   3.7193208679055233`*^9, 3.7193208829056487`*^9}, {3.7193209670782113`*^9, 
   3.7193210035160165`*^9}, {3.7193210467351284`*^9, 
   3.7193211692205267`*^9}, {3.7193213617690134`*^9, 3.7193214088475432`*^9}, 
   3.7193214420469866`*^9, {3.7193217203534365`*^9, 3.719321789744642*^9}, {
   3.71932197318366*^9, 3.71932198512126*^9}, {3.719331402214649*^9, 
   3.719331408636563*^9}, {3.7193315190124846`*^9, 3.7193315595128236`*^9}, {
   3.7193319794850845`*^9, 3.719331991750825*^9}, {3.719343957377164*^9, 
   3.719343960705301*^9}, {3.7193440068775597`*^9, 3.7193440086588426`*^9}, {
   3.719344128175449*^9, 3.71934417764463*^9}, {3.719344259160921*^9, 
   3.719344323302083*^9}, {3.719344442459345*^9, 3.719344483022185*^9}, {
   3.719344523147519*^9, 3.719344564600974*^9}, {3.719344624179597*^9, 
   3.7193446392266*^9}, {3.719344680586337*^9, 3.719344680883213*^9}, {
   3.7193447518056645`*^9, 3.7193447772433786`*^9}, {3.7195276564947762`*^9, 
   3.719527681651235*^9}, {3.71952777804267*^9, 3.719527877012245*^9}, {
   3.7195279706536684`*^9, 3.7195280523418474`*^9}, {3.719528111798044*^9, 
   3.7195281223450117`*^9}, {3.719528356612582*^9, 3.7195284959887447`*^9}, {
   3.7195286822559433`*^9, 3.719528712896826*^9}, {3.719528747162721*^9, 
   3.719528826460275*^9}, {3.7195288589917974`*^9, 3.719528863351192*^9}, {
   3.7195289304142528`*^9, 3.7195289507738*^9}, {3.719528993555422*^9, 
   3.719529093696868*^9}, {3.7195291275252934`*^9, 3.7195291468692045`*^9}, {
   3.7195291942602296`*^9, 3.719529254323224*^9}, {3.719529342558325*^9, 
   3.71952934763651*^9}, 3.7195293928868876`*^9, {3.719530436239355*^9, 
   3.719530437270604*^9}, {3.719532154363105*^9, 3.7195321579725113`*^9}, {
   3.7195321882071395`*^9, 3.719532188613393*^9}, {3.719532286348584*^9, 
   3.719532297973682*^9}, {3.7195332585718946`*^9, 3.7195333104629574`*^9}, {
   3.719533347963257*^9, 3.7195333481663837`*^9}, {3.719534021593891*^9, 
   3.719534048109753*^9}, {3.7195341817046204`*^9, 3.7195342818617077`*^9}, {
   3.7195346501460366`*^9, 3.7195346503335347`*^9}, {3.719537778664712*^9, 
   3.7195377848678885`*^9}, {3.7195380979955053`*^9, 3.7195381027611866`*^9}, 
   3.7195385824839344`*^9, {3.7195800483014727`*^9, 3.7195800523171167`*^9}, {
   3.719580463648695*^9, 3.71958047125813*^9}, {3.7196172491645374`*^9, 
   3.719617263664673*^9}, {3.719617435322357*^9, 3.719617435431719*^9}, {
   3.719762954815118*^9, 3.7197629554713774`*^9}, {3.720134477712696*^9, 
   3.7201344802127104`*^9}, {3.7201413087218714`*^9, 3.720141311487522*^9}, {
   3.720157034906045*^9, 3.720157039140473*^9}, 3.7201629689219847`*^9, {
   3.7264285001615477`*^9, 3.726428502927141*^9}, {3.7332394156874876`*^9, 
   3.733239416546916*^9}, {3.7697845925339746`*^9, 3.7697846105947404`*^9}, {
   3.7697848272715845`*^9, 3.769784840614354*^9}, {3.76978553084321*^9, 
   3.7697855659031887`*^9}, {3.7697860288879523`*^9, 
   3.7697860299191265`*^9}, {3.791217440961753*^9, 3.791217451553993*^9}, {
   3.7912175242499332`*^9, 3.791217525277287*^9}, 
   3.791217570618527*^9},ExpressionUUID->"9207d3da-f29b-4319-9039-\
8d7f92e632e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.669631812504639*^9, 3.669631819769997*^9}, {
  3.6697210032317576`*^9, 3.6697210049036465`*^9}, {3.6697580388066244`*^9, 
  3.6697580398473396`*^9}, {3.6811438602412176`*^9, 3.681143862046855*^9}, {
  3.7193181990604544`*^9, 3.7193181998416986`*^9}, {3.7193288884340954`*^9, 
  3.7193289031060944`*^9}, {3.7195899400282373`*^9, 
  3.7195899412313895`*^9}},ExpressionUUID->"5d6e7ec1-affc-4290-9543-\
e8bf1504e3fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pfun", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"EvaluateFunction", "[", 
    RowBox[{"\"\<P\>\"", ",", " ", "x", ",", " ", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B0fun", "[", 
    RowBox[{
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"EvaluateFunction", "[", 
    RowBox[{"\"\<B0\>\"", ",", " ", "x", ",", " ", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BTfun", "[", 
     RowBox[{
      RowBox[{"x_:", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\[Lambda]_:", 
       RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"EvaluateFunction", "[", 
     RowBox[{"\"\<BT\>\"", ",", " ", "x", ",", " ", "\[Lambda]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateFunction", "[", 
    RowBox[{"t_", ",", " ", 
     RowBox[{"x_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"\[Lambda]_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", " ", "a", ",", " ", "b"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", " ", "=", " ", 
       RowBox[{"fcon", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Array", "[", 
          RowBox[{"\[DoubleStruckX]", ",", " ", "nx"}], "]"}], ",", " ", 
         "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\[Lambda]", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Array", "[", 
          RowBox[{"\[DoubleStruckC]", ",", " ", "nc"}], "]"}], ",", " ", 
         "\[Lambda]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "[", 
       RowBox[{"a", ",", " ", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.719762965018323*^9, {3.720144385385192*^9, 
   3.7201443855726767`*^9}},ExpressionUUID->"63cd8fb2-f413-4f49-b431-\
f7097bd19f95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", 
    RowBox[{"\"\<BipedalLocomotion`Model`\>\"", ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<GlobalVariables`\>\"", ",", " ", "\"\<RigidBodyDynamics`\>\"", ",",
        " ", "\"\<HybridDynamics`\>\"", ",", " ", 
       "\"\<BipedalLocomotion`\>\""}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLF", "[", 
     RowBox[{
      RowBox[{"x_:", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\[Lambda]_:", 
       RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", " ", "vJ"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RBDEOM", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RigidBodyDynamics`Private`UpperTriangularizeAb", "[", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Pfun", " ", "=", " ", 
           RowBox[{"Pfun", "[", 
            RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}]}], "}"}], ",", " ", 
         RowBox[{"Ucon", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"RigidBodyDynamics`Private`F", "[", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLH", "[", 
     RowBox[{
      RowBox[{"x_:", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\[Lambda]_:", 
       RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", " ", "vJ"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RBDIME", "[", 
        RowBox[{"x", ",", " ", "\[Lambda]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RigidBodyDynamics`Private`H", "[", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7186307344821634`*^9, 3.71863073513842*^9}, {
   3.718631316409791*^9, 3.7186313428944283`*^9}, 3.7186315726154475`*^9, {
   3.7186316170846524`*^9, 3.7186317015854874`*^9}, {3.718631841711857*^9, 
   3.7186318422587385`*^9}, {3.718631885509164*^9, 3.7186319106500373`*^9}, {
   3.7186320584171295`*^9, 3.71863217229325*^9}, {3.7186322222000084`*^9, 
   3.71863222501252*^9}, {3.7186323254041386`*^9, 3.7186323630451355`*^9}, {
   3.7186324650617685`*^9, 3.718632474405609*^9}, {3.7186325270936317`*^9, 
   3.7186325332499537`*^9}, 3.71863257746913*^9, {3.7186327761117325`*^9, 
   3.7186328187840147`*^9}, {3.718632851331209*^9, 3.7186328524405966`*^9}, {
   3.7186328938316298`*^9, 3.718632901847351*^9}, {3.7186329410196133`*^9, 
   3.7186329604729147`*^9}, {3.7186330009889545`*^9, 3.718633117849471*^9}, {
   3.7186332002252827`*^9, 3.7186332073034782`*^9}, {3.7186333737894983`*^9, 
   3.718633386852129*^9}, {3.718633423021131*^9, 3.7186334752872715`*^9}, {
   3.7186336631797667`*^9, 3.718633724445985*^9}, {3.718633940948127*^9, 
   3.7186339810735235`*^9}, {3.7186340182301407`*^9, 3.718634058793041*^9}, {
   3.718634154919007*^9, 3.718634208857024*^9}, 3.71863462522882*^9, 
   3.718634743589349*^9, {3.7186348073087454`*^9, 3.7186348302777214`*^9}, {
   3.718634868715602*^9, 3.7186348689499626`*^9}, {3.718634936044392*^9, 
   3.7186349510913982`*^9}, 3.7186350737019863`*^9, {3.7186368832155123`*^9, 
   3.718636890606204*^9}, {3.7193184167885284`*^9, 3.719318445335642*^9}, 
   3.7193185030392494`*^9, {3.719318628102807*^9, 3.7193186302434545`*^9}, {
   3.719318772588377*^9, 3.719318784760356*^9}, {3.7193189605430756`*^9, 
   3.7193190054340754`*^9}, {3.719329398432249*^9, 3.719329399104148*^9}, {
   3.7193294832142105`*^9, 3.7193295226207895`*^9}, {3.719329580558773*^9, 
   3.719329617746601*^9}, 3.7193296529500046`*^9, 3.719329835123404*^9, {
   3.7193298680768023`*^9, 3.7193299015614576`*^9}, {3.7193299517962523`*^9, 
   3.719329976546459*^9}, {3.7193300228437233`*^9, 3.7193300243906107`*^9}, {
   3.7193300569690104`*^9, 3.7193301213914366`*^9}, {3.719330173626234*^9, 
   3.719330257955065*^9}, {3.719330324533745*^9, 3.71933034075263*^9}, {
   3.7193308739445906`*^9, 3.7193310240708466`*^9}, {3.7193311454000006`*^9, 
   3.7193312339475994`*^9}, {3.71933171290473*^9, 3.7193318138118243`*^9}, 
   3.719340688974197*^9, {3.7193411366608467`*^9, 3.719341142364004*^9}, 
   3.7193412178802795`*^9, {3.719341882234809*^9, 3.7193419147663145`*^9}, {
   3.7193420132984047`*^9, 3.719342017142188*^9}, {3.71934205939254*^9, 
   3.7193420773770485`*^9}, {3.719342136955674*^9, 3.719342138049432*^9}, {
   3.7193681648018303`*^9, 3.719368173176901*^9}, {3.719527455024352*^9, 
   3.7195274572899857`*^9}, 3.719532877806651*^9, {3.71953406920368*^9, 
   3.7195340908132205`*^9}, {3.719534578192293*^9, 3.7195345875361395`*^9}, {
   3.7195350146959457`*^9, 3.7195350177740946`*^9}, {3.719535073212059*^9, 
   3.719535083040283*^9}, {3.719538699656804*^9, 3.71953871367253*^9}, {
   3.7195394699913564`*^9, 3.7195395088354425`*^9}, {3.719539617820729*^9, 
   3.7195396198519845`*^9}, {3.719539790994041*^9, 3.719539791556546*^9}, {
   3.719580101848796*^9, 3.7195802877409706`*^9}, {3.719582665665413*^9, 
   3.7195826739935927`*^9}, {3.7195828054946985`*^9, 3.71958280580721*^9}, {
   3.7195866734862647`*^9, 3.7195867306586185`*^9}, {3.7195868367180347`*^9, 
   3.719586850390026*^9}, {3.71958716368952*^9, 3.719587166970812*^9}, {
   3.7195873177064495`*^9, 3.719587401644651*^9}, {3.719589926262514*^9, 
   3.719589975169156*^9}, {3.7195901042015023`*^9, 3.719590106342146*^9}, {
   3.719607059744975*^9, 3.7196070640575256`*^9}, {3.719617444884921*^9, 
   3.7196174514474916`*^9}, 3.7196805805324306`*^9, {3.7196984554275465`*^9, 
   3.7196984594275856`*^9}, {3.7197624124116006`*^9, 
   3.7197624129116044`*^9}, {3.719763488611575*^9, 3.7197634900803385`*^9}, {
   3.719873495277441*^9, 3.719873534048448*^9}, {3.719873658454407*^9, 
   3.719873692418195*^9}, 
   3.7198822076579485`*^9},ExpressionUUID->"0b8a329e-2809-4168-b4aa-\
2319cd033c68"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.672922910157816*^9, 
  3.6729229104546924`*^9}},ExpressionUUID->"d30eff6b-0fdc-444a-83b5-\
90da54eb058a"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231090809507`*^9, 
  3.6729231097997046`*^9}},ExpressionUUID->"f830bc86-8ee8-41dd-b17b-\
859f0e7d2e45"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1373, 1509},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 95, "Section",ExpressionUUID->"9c8ea0b3-0f26-4d7b-a778-9c0a24e54b04"],
Cell[743, 27, 4959, 73, 222, "Input",ExpressionUUID->"e6160922-0389-4cb0-89f2-9999f824f16d",
 InitializationCell->True]
}, Open  ]],
Cell[5717, 103, 354, 6, 95, "Section",ExpressionUUID->"7c784083-9d6b-4a54-a2b7-120a0c46f4ab"],
Cell[CellGroupData[{
Cell[6096, 113, 369, 6, 81, "Section",ExpressionUUID->"6463c66c-ec44-435d-b7a0-ce9782c64439"],
Cell[6468, 121, 3031, 75, 422, "Input",ExpressionUUID->"a117767b-b97a-497b-8a70-109e0ab836e0",
 InitializationCell->True],
Cell[9502, 198, 14484, 270, 1662, "Input",ExpressionUUID->"8dc250a1-593d-44f8-9ae9-aa7695c6af78",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[24023, 473, 567, 8, 95, "Section",ExpressionUUID->"0fa4c3d9-4655-427e-ae2b-2212bea41d4d"],
Cell[24593, 483, 7872, 156, 1542, "Input",ExpressionUUID->"9207d3da-f29b-4319-9039-8d7f92e632e9",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[32502, 644, 464, 7, 95, "Section",ExpressionUUID->"5d6e7ec1-affc-4290-9543-e8bf1504e3fe"],
Cell[32969, 653, 2576, 74, 422, "Input",ExpressionUUID->"63cd8fb2-f413-4f49-b431-f7097bd19f95",
 InitializationCell->True],
Cell[35548, 729, 6488, 124, 822, "Input",ExpressionUUID->"0b8a329e-2809-4168-b4aa-2319cd033c68",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[42073, 858, 236, 5, 95, "Section",ExpressionUUID->"d30eff6b-0fdc-444a-83b5-90da54eb058a",
 InitializationCell->True],
Cell[42312, 865, 252, 6, 102, "Input",ExpressionUUID->"f830bc86-8ee8-41dd-b17b-859f0e7d2e45",
 InitializationCell->True]
}, Open  ]]
}
]
*)

