(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    384488,       7525]
NotebookOptionsPosition[    379223,       7424]
NotebookOutlinePosition[    379590,       7440]
CellTagsIndexPosition[    379547,       7437]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["TO DO", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.7420599808069344`*^9, 
  3.742059985587877*^9}},ExpressionUUID->"1820cd00-5a4a-4b18-832b-\
9ad8b6359c1f"],

Cell["\<\
need to expand options in BLPlotProjection from Projection to include options \
to FixAngles, probably should make FixAngles a global function\
\>", "Text",
 CellChangeTimes->{{3.742059987993923*^9, 
  3.742060022054002*^9}},ExpressionUUID->"3fa7116c-70f2-4244-878f-\
1fa822c0fa70"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 
  3.591487004222381*^9}},ExpressionUUID->"b07d7787-6827-4aed-ad8f-\
671de1d4f225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<BipedalLocomotion`\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<GlobalVariables`\>\"", ",", " ", "\"\<RigidBodyDynamics`\>\"", ",", 
      " ", "\"\<HybridDynamics`\>\"", ",", " ", 
      "\"\<BipedalLocomotion`Model`\>\"", ",", " ", "\"\<MaTeX`\>\""}], 
     "}"}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tol", " ", "=", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "5"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "minimum", " ", "distance", " ", "between", " ", "two", " ", "links"}], 
   " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lc", " ", "=", " ", "Gray"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"default", " ", "link", " ", "color"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jc", " ", "=", " ", "White"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sc", " ", "=", " ", 
   RowBox[{"{", "Black", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fc", " ", "=", " ", 
    RowBox[{"{", "LightGray", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ground", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"z6", ",", " ", 
      RowBox[{"I6", "\[LeftDoubleBracket]", 
       RowBox[{"mm", "+", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"widths", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0.01", ",", " ", "0.01", ",", " ", "0.01"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", " ", "=", " ", "0.025"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"joint", " ", "radius"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axes", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ignorejoint", " ", "=", " ", 
    RowBox[{"ignorelink", " ", "=", " ", 
     RowBox[{"ignore", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Root", ",", " ", "\"\<\[Theta]\>\""}], "}"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"poi", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scale", " ", "=", " ", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"paths", " ", "=", " ", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Local\>\"", " ", "\[Rule]", " ", 
       RowBox[{"DirectoryName", "@", "$InputFileName"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Figures\>\"", " ", "\[Rule]", " ", "\"\<../../../Figures\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<JSON\>\"", " ", "\[Rule]", " ", 
       "\"\<../../../GaitBrowser/src/bipeds\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
      "\"\<Images\>\"", " ", "\[Rule]", " ", 
       "\"\<../../../GaitBrowser/app/imgs\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Here\>\"", " ", "\[RuleDelayed]", "  ", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"___", "~~", "\"\<Models/\>\""}], " ", "\[Rule]", " ", 
          "\"\<../../../Models/\>\""}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLPath", "[", 
     RowBox[{"where_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "path", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"path", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"paths", ",", " ", "where", ",", " ", "$Failed"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"paths", "[", "\"\<Local\>\"", "]"}], ",", "path", ",", " ",
           "n"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLExportTo", "[", 
     RowBox[{"where_", ",", " ", "n_", ",", " ", "d_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"BLPath", "[", 
       RowBox[{"where", ",", " ", "n"}], "]"}], ",", " ", "d", ",", "opts"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLImportFrom", "[", 
     RowBox[{"where_", ",", " ", "n_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"BLPath", "[", 
       RowBox[{"where", ",", " ", "n"}], "]"}], ",", " ", "opts"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "BLSaveTo", "]"}], " ", "=", " ", 
   RowBox[{"{", "HoldRest", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLSaveTo", "[", 
     RowBox[{"where_", ",", " ", "n_", ",", " ", "d_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Save", "[", 
     RowBox[{
      RowBox[{"BLPath", "[", 
       RowBox[{"where", ",", " ", "n"}], "]"}], ",", " ", "d"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLGetFrom", "[", 
     RowBox[{"where_", ",", " ", "n_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Get", "[", 
     RowBox[{
      RowBox[{"BLPath", "[", 
       RowBox[{"where", ",", " ", "n"}], "]"}], ",", " ", "opts"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"IEEETran", "/", "LaTex"}], " ", "info"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BLLaTex", " ", "=", " ", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<text width\>\"", " ", "\[Rule]", " ", "485.1"}], ",", " ", 
       RowBox[{"\"\<text height\>\"", " ", "\[Rule]", " ", "696.0"}], ",", 
       " ", 
       RowBox[{"\"\<column width\>\"", " ", "\[Rule]", " ", "236.55"}], ",", 
       " ", 
       RowBox[{"\"\<image height\>\"", " ", "\[Rule]", " ", "500"}]}], 
      "|>"}]}], ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLLaTex", " ", "=", " ", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<text width\>\"", " ", "\[Rule]", " ", "516"}], ",", " ", 
      RowBox[{"\"\<text height\>\"", " ", "\[Rule]", " ", "696"}], ",", " ", 
      RowBox[{"\"\<column width\>\"", " ", "\[Rule]", " ", "252"}], ",", " ", 
      RowBox[{"\"\<image height\>\"", " ", "\[Rule]", " ", "500"}]}], 
     "|>"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLTeX", "[", 
    RowBox[{"e_", ",", " ", 
     RowBox[{"m_:", "5"}], ",", " ", 
     RowBox[{"pre_:", "\"\<\>\""}]}], "]"}], " ", ":=", " ", 
   RowBox[{"MaTeX", "[", 
    RowBox[{"e", ",", " ", 
     RowBox[{"Magnification", "\[Rule]", "m"}], ",", " ", 
     RowBox[{"\"\<Preamble\>\"", " ", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\\\\usepackage{\>\"", "<>", " ", "pre", " ", "<>", " ", 
        "\"\<,color,siunitx}\>\""}], "}"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367625062662*^9, 3.5933676251720285`*^9}, {
   3.704468357519539*^9, 3.704468459841198*^9}, {3.7044685529026203`*^9, 
   3.704468620873731*^9}, {3.7044692938575964`*^9, 3.704469294201355*^9}, {
   3.7044693718565884`*^9, 3.7044694237922263`*^9}, 3.7044696047095137`*^9, {
   3.704469723121451*^9, 3.7044697494763565`*^9}, {3.7044713775105753`*^9, 
   3.7044713779682055`*^9}, {3.7044721790672703`*^9, 3.704472195124174*^9}, {
   3.7100937038557262`*^9, 3.7100937138377705`*^9}, {3.710094467877513*^9, 
   3.7100944759752245`*^9}, {3.718967969224544*^9, 3.718967976177737*^9}, 
   3.71916004211183*^9, {3.7191663815473833`*^9, 3.719166477501439*^9}, {
   3.7191668135047617`*^9, 3.719166817067297*^9}, {3.719167489745819*^9, 
   3.719167506964756*^9}, {3.7191680417044163`*^9, 3.719168056876441*^9}, {
   3.719168126439624*^9, 3.7191681280958776`*^9}, {3.7191681615962257`*^9, 
   3.719168167393141*^9}, 3.7191688253527856`*^9, {3.7191694186552997`*^9, 
   3.719169427686659*^9}, {3.719169607516552*^9, 3.719169625766738*^9}, {
   3.719169936711547*^9, 3.7191699368990507`*^9}, {3.7192001221847486`*^9, 
   3.7192001223409824`*^9}, {3.7192001678883085`*^9, 3.719200179888439*^9}, {
   3.7192312450161033`*^9, 3.7192312752819977`*^9}, {3.7192317027507443`*^9, 
   3.71923170383801*^9}, {3.719231750919241*^9, 3.7192317512449694`*^9}, {
   3.719231786415862*^9, 3.7192317885548663`*^9}, {3.719232072420457*^9, 
   3.7192320757658167`*^9}, {3.7192328308766713`*^9, 
   3.7192328346110773`*^9}, {3.7192331029414616`*^9, 
   3.7192331068321037`*^9}, {3.719233153863763*^9, 3.719233153941874*^9}, {
   3.719236308681711*^9, 3.7192363124786177`*^9}, {3.7192381916264877`*^9, 
   3.719238193876506*^9}, {3.719628143079067*^9, 3.7196281469697256`*^9}, {
   3.7202296325982018`*^9, 3.720229634348221*^9}, {3.7202300253363085`*^9, 
   3.7202300290863404`*^9}, {3.7203202790828934`*^9, 
   3.7203202806766634`*^9}, {3.720322270535414*^9, 3.720322285238694*^9}, {
   3.7203223608800216`*^9, 3.720322378052061*^9}, {3.721831079973121*^9, 
   3.7218310978639307`*^9}, {3.7218311290986247`*^9, 
   3.7218311348018084`*^9}, {3.7302105363606887`*^9, 
   3.7302105656109505`*^9}, {3.730421014476018*^9, 3.7304211006156764`*^9}, {
   3.73042118975216*^9, 3.7304212235180655`*^9}, {3.730421392925746*^9, 
   3.7304213934726124`*^9}, {3.7304214251013966`*^9, 3.730421473142557*^9}, {
   3.730460455771121*^9, 3.7304604660837374`*^9}, {3.7304605596626005`*^9, 
   3.7304605691157885`*^9}, {3.7304606234912415`*^9, 
   3.7304606390070143`*^9}, {3.7304646668648434`*^9, 3.730464667364848*^9}, {
   3.7330119314900928`*^9, 3.7330119424240627`*^9}, {3.7372957691535797`*^9, 
   3.73729578112151*^9}, {3.7373154842766895`*^9, 3.7373155030409966`*^9}, {
   3.7373157226321545`*^9, 3.737315733803262*^9}, {3.7373159844023285`*^9, 
   3.737315997385816*^9}, {3.737876552458494*^9, 3.737876573035163*^9}, {
   3.791395492416254*^9, 3.79139549802722*^9}, {3.791396284249283*^9, 
   3.791396364992085*^9}, {3.7913964076504908`*^9, 3.791396410531374*^9}, {
   3.791396663278411*^9, 3.791396663788722*^9}, {3.791396720817009*^9, 
   3.7913967235079727`*^9}, {3.79139676423169*^9, 3.791396802868573*^9}, {
   3.7913968871513863`*^9, 3.7913969254292793`*^9}, {3.79145810575454*^9, 
   3.7914582127437468`*^9}, {3.791458368678586*^9, 3.791458373557519*^9}, {
   3.791459895084264*^9, 3.791459896642413*^9}, 3.79164731226517*^9, {
   3.7918970701628113`*^9, 3.791897071339463*^9}, {3.7918971048128147`*^9, 
   3.7918971593817883`*^9}, {3.7918972026183147`*^9, 
   3.7918972115592947`*^9}, {3.79189726069658*^9, 3.791897261100234*^9}, {
   3.7997017999233503`*^9, 3.799701840879322*^9}, 3.7997019811370707`*^9, {
   3.7997020324418907`*^9, 3.799702059557255*^9}, {3.799702128777595*^9, 
   3.79970216046867*^9}, {3.7997022333904448`*^9, 3.799702277013274*^9}, {
   3.799702317240107*^9, 3.799702326787369*^9}, {3.799702359286722*^9, 
   3.799702499975787*^9}, 3.799702603113812*^9, {3.799702704836351*^9, 
   3.7997027541137857`*^9}, {3.799702908184806*^9, 3.799702972738975*^9}, {
   3.79977089220341*^9, 3.799770894402432*^9}, {3.799770984417203*^9, 
   3.799770987855336*^9}, 3.799771578089758*^9, {3.799773775703718*^9, 
   3.799773786719696*^9}, {3.79977405411777*^9, 3.799774069193263*^9}, {
   3.7997742530392847`*^9, 3.799774273367434*^9}, 3.799774640444269*^9, {
   3.799778013594411*^9, 3.799778036832273*^9}, {3.799779055300522*^9, 
   3.7997790961190653`*^9}, 3.799779190265911*^9, {3.799785233102459*^9, 
   3.799785255300376*^9}, 3.799786409967573*^9, 3.799788183926444*^9, {
   3.7997884158084908`*^9, 3.7997884495822067`*^9}, {3.799788482983471*^9, 
   3.799788483295589*^9}, {3.799789065784812*^9, 3.799789085798614*^9}, {
   3.799888799522752*^9, 3.799888808545413*^9}, {3.799891514456737*^9, 
   3.79989151523433*^9}, {3.800132273842348*^9, 3.800132283278482*^9}, {
   3.800132442226842*^9, 3.800132488522319*^9}, {3.800132572051175*^9, 
   3.800132572304042*^9}, {3.80013261234809*^9, 3.8001326138110723`*^9}, {
   3.800132771501952*^9, 3.800132772191942*^9}, {3.800404292774763*^9, 
   3.800404310400627*^9}, 
   3.8004043802002687`*^9},ExpressionUUID->"93ec1d1d-810e-4a6c-bcb4-\
da22adfc4187"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set Drawing Parameters", "Section",
 CellChangeTimes->{{3.684678566296839*^9, 3.684678566812415*^9}, {
   3.684678602969049*^9, 3.6846786252973766`*^9}, {3.6846787712362127`*^9, 
   3.6846787718768377`*^9}, {3.6846794135590725`*^9, 
   3.6846794243138685`*^9}, {3.684679499221797*^9, 3.684679500708866*^9}, {
   3.6943224932304945`*^9, 3.694322498229063*^9}, 3.694322896850048*^9, {
   3.696876852021453*^9, 3.696876854640302*^9}, {3.719166459376278*^9, 
   3.7191664595325117`*^9}, {3.719167363385213*^9, 3.7191673692758904`*^9}, {
   3.719169818022891*^9, 
   3.7191698200697823`*^9}},ExpressionUUID->"fc88b6ae-c881-42c3-a8ce-\
1bb488318583"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLWidth", "[", "w_", "]"}], " ", ":=", " ", 
    RowBox[{"widths", " ", "=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VectorQ", "@", "w"}], ",", " ", 
       RowBox[{"w", "\[LeftDoubleBracket]", 
        RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"w", ",", " ", "w", ",", " ", "w"}], "}"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLRadius", "[", "w_", "]"}], " ", ":=", " ", 
    RowBox[{"r", " ", "=", " ", "w"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLLinkColor", "[", "c_", "]"}], " ", ":=", " ", 
    RowBox[{"lc", " ", "=", " ", "c"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLJointColor", "[", "c_", "]"}], " ", ":=", " ", 
    RowBox[{"jc", " ", "=", " ", "c"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLAxes", "[", "c_", "]"}], " ", ":=", " ", 
    RowBox[{"axes", " ", "=", " ", "c"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLScaleLengths", "[", 
     RowBox[{"n_:", "1"}], "]"}], " ", ":=", " ", 
    RowBox[{"scale", " ", "=", " ", "n"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLDontDraw", "[", 
    RowBox[{
     RowBox[{"lname_:", 
      RowBox[{"{", "}"}]}], ",", " ", 
     RowBox[{"jname_:", 
      RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ignorelink", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"ignore", ",", " ", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "lname", "}"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ignorejoint", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"ignore", ",", " ", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "jname", "}"}]}]}], "]"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7191673821510057`*^9, 3.719167400682455*^9}, {
   3.7191674563392396`*^9, 3.7191674573392606`*^9}, {3.719169511562468*^9, 
   3.7191696042352743`*^9}, {3.719169709646805*^9, 3.719169716099993*^9}, 
   3.7191698085071683`*^9, {3.719229895059347*^9, 3.7192298955437255`*^9}, {
   3.7192312284222164`*^9, 3.7192312412191963`*^9}, {3.7192317589158897`*^9, 
   3.719231794851819*^9}, {3.7192330920351048`*^9, 3.71923309866016*^9}, {
   3.719238218798588*^9, 3.71923823547062*^9}, 3.7198827912299414`*^9, {
   3.7202295026438336`*^9, 3.720229536081664*^9}, {3.720229614457409*^9, 
   3.7202296275200286`*^9}, {3.720322270535414*^9, 3.7203224245993767`*^9}, {
   3.721831062816695*^9, 3.721831065629224*^9}, {3.721831143630041*^9, 
   3.7218311550520325`*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"5e69507d-2b9c-499e-92c6-b7872f9540ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Draw Biped", "Section",
 CellChangeTimes->{{3.684678566296839*^9, 3.684678566812415*^9}, {
   3.684678602969049*^9, 3.6846786252973766`*^9}, {3.6846787712362127`*^9, 
   3.6846787718768377`*^9}, {3.6846794135590725`*^9, 
   3.6846794243138685`*^9}, {3.684679499221797*^9, 3.684679500708866*^9}, {
   3.6943224932304945`*^9, 3.694322498229063*^9}, 3.694322896850048*^9, {
   3.696876852021453*^9, 3.696876854640302*^9}, {3.719166459376278*^9, 
   3.7191664595325117`*^9}},ExpressionUUID->"33a201b4-c07a-455d-9634-\
2130ee09356c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Link", "[", 
     RowBox[{"p_", ",", " ", "c_", ",", " ", "color_", ",", " ", "axes_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "wl", ",", " ", "wu", ",", " ", "u", ",", " ", "v", ",", " ", "l", ",",
         " ", "m", ",", " ", "R", ",", " ", "C", ",", " ", "A"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"Length", "@", "p"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", 
        RowBox[{"c", " ", "-", " ", "p"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l", " ", "=", " ", 
        RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"u", " ", "=", " ", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"{", "l", "}"}], ",", " ", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "rectangular", " ", "bounding", " ", "box"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"wl", " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{
         "widths", "\[LeftDoubleBracket]", "axes", 
          "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wl", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", "0"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"wu", " ", "=", " ", 
        RowBox[{
        "widths", "\[LeftDoubleBracket]", "axes", "\[RightDoubleBracket]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"wu", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "=", " ", "l"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "ignore", " ", "\"\<RotationMatrix vectors do not define a plane\>\"",
          " ", "warning"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PossibleZeroQ", "[", "l", "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", 
            RowBox[{"{", 
             RowBox[{"m", ",", " ", "m"}], "}"}]}], "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Quiet", "[", 
           RowBox[{
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"u", ",", " ", "v"}], "}"}], "]"}], ",", " ", 
            RowBox[{"RotationMatrix", "::", "spln"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"Cuboid", "[", 
         RowBox[{"wl", ",", " ", "wu"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"AffineTransform", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", " ", "p"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", " ", "Black"}], "}"}], "]"}], ",", " ", 
         "color", ",", " ", "Thick", ",", " ", 
         RowBox[{"GeometricTransformation", "[", 
          RowBox[{"C", ",", " ", "A"}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Joint", "[", 
     RowBox[{"pos_", ",", " ", "color_"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", " ", "Black"}], "}"}], "]"}], ",", " ", "color",
       ",", " ", 
      RowBox[{"Ball", "[", 
       RowBox[{"pos", ",", " ", "r"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawFlatGround", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<axes\>\"", " ", "\[RuleDelayed]", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{
         RowBox[{"BLbiped", "[", 
          RowBox[{"\"\<draw\>\"", ",", " ", "\"\<axes\>\""}], "]"}], ",", " ",
          "axes"}], "]"}]}], ",", " ", 
      RowBox[{"\"\<g\>\"", " ", "\[Rule]", " ", "True"}], ",", " ", 
      RowBox[{"\"\<o\>\"", " ", "\[Rule]", " ", "z3"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawFlatGround", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", " ", "o"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<g\>\"", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "origin", " ", "is", " ", "assumed", " ", "to", " ", "be", " ", "in",
           " ", "axes", " ", "order"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"OptionValue", "[", "\"\<o\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", 
             RowBox[{"OptionValue", "[", "\"\<axes\>\"", "]"}]}], " ", 
            "\[Equal]", " ", "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"o", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"o", "+", "#"}], "&"}], " ", "/@", " ", 
              RowBox[{"ground", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", " ", 
                RowBox[{"4", ";;", "5"}]}], "\[RightDoubleBracket]"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{"sc", 
              RowBox[{"(*", "fc", "*)"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"InfiniteLine", "[", "o", "]"}], "}"}]}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "else", " ", "flat", " ", "ground", " ", "is", " ", "3", "D"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PiecewiseLinearSurface", "[", 
     RowBox[{"\[CurlyPhi]_", ",", " ", "d_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ax", ",", " ", "p", ",", " ", "g", ",", " ", "n", ",", " ", "pts", 
        ",", " ", "ends", ",", " ", "mids"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ax", " ", "=", " ", 
        RowBox[{"mm", " ", "+", " ", 
         RowBox[{"Lookup", "[", 
          RowBox[{"d", ",", " ", "\"\<axes\>\"", ",", " ", "axes"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "1", ",", " ", "All"}], "}"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "should", " ", "generalize", " ", "to", " ", "take", " ", "all", " ",
           "possible", " ", "slopes"}], ",", " ", 
         RowBox[{
         "or", " ", "use", " ", "opts", " ", "to", " ", "select", " ", 
          "specific", " ", "slopes"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"OptionValue", "[", "\"\<\[Sigma][i]\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"n", " ", "===", " ", "Automatic"}], ",", " ", 
           RowBox[{"n", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", "1", ",", " ", "All"}], "}"}]}]}],
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"BLGetFootFalls", "[", "\[CurlyPhi]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"p", " ", "===", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"p", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"Sequence", "@@", "n"}], ",", " ", "ax"}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"p", "/", 
         RowBox[{"Lookup", "[", 
          RowBox[{"d", ",", " ", "\"\<scale\>\"", ",", " ", "scale"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pts", " ", "=", " ", 
        RowBox[{"Join", "@@", "p"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "@", "pts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ends", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", " ", ">", " ", "2"}], ",", " ", 
          RowBox[{"HalfLine", " ", "/@", " ", 
           RowBox[{"pts", "\[LeftDoubleBracket]", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", 
              RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}], ",", 
          " ", 
          RowBox[{"List", "@", 
           RowBox[{"InfiniteLine", "@", "pts"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mids", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", " ", ">", " ", "3"}], ",", " ", 
          RowBox[{"Line", " ", "/@", " ", 
           RowBox[{"pts", "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"fc", ",", " ", 
         RowBox[{"{", 
          RowBox[{"InfiniteLine", "[", "g", "]"}], "}"}], ",", " ", "sc", ",",
          " ", "ends", ",", " ", "mids"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "OneSurface", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<m\>\"", " ", "\[RuleDelayed]", " ", 
      RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}]}], ",", " ", 
     RowBox[{"\"\<g\>\"", " ", "\[Rule]", " ", "True"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OneSurface", "[", 
     RowBox[{"\[CurlyPhi]_", ",", " ", "d_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", " ", "n", ",", " ", "\[Sigma]", ",", " ", "x", ",", " ", "c",
         ",", " ", "ax", ",", " ", "p", ",", " ", "g"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ax", " ", "=", " ", 
        RowBox[{"mm", " ", "+", " ", 
         RowBox[{"Lookup", "[", 
          RowBox[{"d", ",", " ", "\"\<axes\>\"", ",", " ", "axes"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"d", ",", " ", "\"\<\[Sigma]\>\"", ",", " ", "Automatic"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"compute", " ", "slope"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AssociationQ", "[", "\[CurlyPhi]", "]"}], ",", "  ", 
          RowBox[{
           RowBox[{"\[CurlyPhi]", "[", "\"\<c[t]\>\"", "]"}], "[", "0", "]"}],
           ",", " ", "\[CurlyPhi]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"devec", "[", 
         RowBox[{"c", ",", " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"c", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", 
          RowBox[{"1", ";;", "nx"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"get", " ", "post"}], "-", 
         RowBox[{"impact", " ", "m"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<m\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"m", " ", "=", " ", 
          RowBox[{"BLSide", "[", 
           RowBox[{"m", ",", " ", "Automatic", ",", " ", "2"}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"m", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"BLbiped", "[", "\"\<m\>\"", "]"}], "[", "m", "]"}], "[", 
         RowBox[{"x", ",", " ", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{
         RowBox[{"BLbiped", "[", 
          RowBox[{"\"\<\[Sigma]\>\"", ",", " ", "m"}], "]"}], "[", 
         RowBox[{"x", ",", " ", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{"\[Sigma]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "mm"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", 
         RowBox[{"(", 
          RowBox[{"post", "-", "impact"}], ")"}], " ", "stance", " ", "foot", 
         " ", "location"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"BLbiped", "[", 
           RowBox[{"\"\<\[Eta]a\>\"", ",", " ", "m"}], "]"}], "[", 
          RowBox[{"x", ",", " ", "c"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"ax", " ", "-", " ", "mm"}], "\[RightDoubleBracket]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"p", "/", 
         RowBox[{"Lookup", "[", 
          RowBox[{"d", ",", " ", "\"\<scale\>\"", ",", " ", "scale"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"DrawFlatGround", "[", 
         RowBox[{
          RowBox[{"\"\<o\>\"", " ", "\[Rule]", " ", "p"}], ",", " ", 
          RowBox[{"\"\<g\>\"", "\[Rule]", " ", 
           RowBox[{"OptionValue", "[", "\"\<g\>\"", "]"}]}], ",", " ", 
          RowBox[{"\"\<axes\>\"", " ", "\[Rule]", " ", "ax"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ax", "]"}], " ", "\[Equal]", " ", "2"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", " ", "===", " ", "Automatic"}], ",", " ", 
            RowBox[{
             RowBox[{"n", " ", "=", " ", 
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                    RowBox[{"mm", "+", "1"}], ",", " ", "nm"}], "]"}], ",", 
                  "  ", "ax"}], "]"}]}], "-", "mm"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]", " ", "=", " ", 
           RowBox[{
           "\[Sigma]", "\[LeftDoubleBracket]", "n", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{"g", ",", " ", 
            RowBox[{"{", 
             RowBox[{"sc", ",", " ", 
              RowBox[{"InfiniteLine", "[", 
               RowBox[{"p", ",", " ", 
                RowBox[{
                 RowBox[{"RotationMatrix", "[", "\[Sigma]", "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", " ", "0"}], "}"}]}]}], "]"}]}], "}"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"else", " ", "biped", " ", "is", " ", "3", "D"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", " ", "===", " ", "Automatic"}], ",", " ", 
            RowBox[{
             RowBox[{"n", " ", "=", " ", "ax"}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", 
           RowBox[{"n", " ", "-", " ", "mm"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]", " ", "=", " ", 
           RowBox[{
           "\[Sigma]", "\[LeftDoubleBracket]", "n", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"x", " ", "=", " ", 
           RowBox[{"IdentityMatrix", "[", "mm", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"sc", ",", " ", 
            RowBox[{"InfinitePlane", "[", 
             RowBox[{"p", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotationMatrix", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Sigma]", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", " ", 
                   RowBox[{"-", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ".", 
                 RowBox[{
                 "x", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], ",", " ", 
                RowBox[{
                 RowBox[{"RotationMatrix", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Sigma]", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", " ", 
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ".", 
                 RowBox[{
                 "x", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLWalkingSurface", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<b\>\"", " ", "\[RuleDelayed]", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{"BLbiped", ",", " ", "\"\<draw\>\"", ",", " ", 
         RowBox[{"<|", "|>"}]}], "]"}]}], ",", " ", 
      RowBox[{"\"\<\[Sigma][i]\>\"", " ", "\[Rule]", " ", "Automatic"}], ",", 
      " ", 
      RowBox[{"SurfaceData", " ", "\[Rule]", " ", "OneSurface"}], ",", " ", 
      RowBox[{"\"\<g\>\"", " ", "\[Rule]", " ", "True"}], ",", " ", 
      RowBox[{"\"\<SurfaceDataOptions\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLWalkingSurface", "[", 
    RowBox[{"\[CurlyPhi]_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", " ", "c", ",", " ", "f", ",", " ", "d", ",", " ", "g", ",", 
       " ", "ax", ",", " ", "\[Sigma]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[CurlyPhi]", " ", "===", " ", "None"}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ax", " ", "=", " ", 
       RowBox[{"mm", " ", "+", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"d", ",", " ", "\"\<axes\>\"", ",", " ", "axes"}], "]"}]}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "ax"}], " ", "\[Equal]", " ", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptionValue", "[", "SurfaceData", "]"}], "[", 
         RowBox[{"\[CurlyPhi]", ",", " ", "d", ",", " ", 
          RowBox[{"OptionValue", "[", "\"\<SurfaceDataOptions\>\"", "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OptionValue", "[", "SurfaceData", "]"}], "[", 
         RowBox[{"\[CurlyPhi]", ",", " ", "d", ",", " ", 
          RowBox[{"OptionValue", "[", "\"\<SurfaceDataOptions\>\"", "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6969403000216093`*^9, 3.696940327623665*^9}, {
   3.696940362111764*^9, 3.6969404438646836`*^9}, {3.696940623642353*^9, 
   3.696940678903527*^9}, {3.6969407878724575`*^9, 3.696940861058096*^9}, {
   3.696941110463431*^9, 3.696941179626219*^9}, {3.6969412369473457`*^9, 
   3.6969413213249936`*^9}, {3.6969413574661827`*^9, 3.696941392830496*^9}, {
   3.696941477445947*^9, 3.6969414986023827`*^9}, {3.6969418703626833`*^9, 
   3.696941900796776*^9}, {3.6969419349916363`*^9, 3.6969420303201876`*^9}, {
   3.6969420685062838`*^9, 3.696942213712734*^9}, {3.6969422991730967`*^9, 
   3.696942397467312*^9}, {3.6969424276411834`*^9, 3.696942471926179*^9}, {
   3.696942564622819*^9, 3.6969425950907803`*^9}, {3.6969427382309284`*^9, 
   3.696942747733961*^9}, {3.696942996946139*^9, 3.6969430125866566`*^9}, {
   3.696943189171723*^9, 3.6969431910623703`*^9}, {3.696964508290159*^9, 
   3.6969645120020657`*^9}, {3.719166448376153*^9, 3.7191665578616247`*^9}, 
   3.719166629862322*^9, {3.719166758238589*^9, 3.7191668559427013`*^9}, {
   3.719166907083828*^9, 3.719167079460515*^9}, {3.7191671251172314`*^9, 
   3.7191671910241327`*^9}, {3.719167511980426*^9, 3.719167556262101*^9}, {
   3.719167586496787*^9, 3.719167604215701*^9}, {3.7191676973416214`*^9, 
   3.7191677027948008`*^9}, {3.719167783920603*^9, 3.7191677938738375`*^9}, {
   3.7191678447337036`*^9, 3.719167914531267*^9}, {3.719168068814043*^9, 
   3.7191680728922086`*^9}, {3.719168122252088*^9, 3.7191681225645905`*^9}, {
   3.719168175893225*^9, 3.7191683369729424`*^9}, {3.719168369285762*^9, 
   3.7191683707545276`*^9}, {3.71916844448963*^9, 3.7191684763493195`*^9}, {
   3.7191685245060587`*^9, 3.719168642460338*^9}, {3.7191686821169806`*^9, 
   3.719168741789445*^9}, 3.719168782774241*^9, {3.7191688620406437`*^9, 
   3.719168864900035*^9}, {3.7191689953388257`*^9, 3.7191690206540947`*^9}, 
   3.7191693662172923`*^9, {3.7191694649213934`*^9, 3.7191694734058414`*^9}, {
   3.719169857679516*^9, 3.7191698656014695`*^9}, {3.719169942274104*^9, 
   3.719169967055599*^9}, {3.7191700524470654`*^9, 3.7191700588221292`*^9}, {
   3.7191700951506147`*^9, 3.7191701200258603`*^9}, {3.7191701635106654`*^9, 
   3.7191701668075733`*^9}, {3.719170219933098*^9, 3.7191703651711187`*^9}, {
   3.7191704696096506`*^9, 3.719170508469409*^9}, {3.7191706408769684`*^9, 
   3.7191707214871407`*^9}, {3.7191974950866585`*^9, 
   3.7191974997898293`*^9}, {3.719197571884291*^9, 3.7191975989939528`*^9}, {
   3.719197827112653*^9, 3.7191978454747314`*^9}, {3.719197884475116*^9, 
   3.7191979102253695`*^9}, 3.7191979823198495`*^9, {3.719198405230281*^9, 
   3.719198430839898*^9}, {3.719198464418347*^9, 3.7191985113719535`*^9}, {
   3.7191985452316456`*^9, 3.7191985474973097`*^9}, {3.7191988200156136`*^9, 
   3.719198827875081*^9}, {3.7191988704692526`*^9, 3.7191988931413355`*^9}, {
   3.7191989248135242`*^9, 3.71919892593855*^9}, {3.719199054455428*^9, 
   3.719199116924796*^9}, {3.719199238097885*^9, 3.719199239738509*^9}, {
   3.719199299582868*^9, 3.7191993746461105`*^9}, {3.719199409662077*^9, 
   3.7191994107402*^9}, {3.7191995438352823`*^9, 3.7191995452571716`*^9}, {
   3.719199598429555*^9, 3.7191996059921465`*^9}, {3.7191996431643896`*^9, 
   3.719199665883348*^9}, {3.719199697524285*^9, 3.7191997491498117`*^9}, {
   3.719199787384549*^9, 3.719199881822998*^9}, {3.719199928604706*^9, 
   3.719199941714198*^9}, 3.719199992745969*^9, 3.7192000238869*^9, {
   3.719200055824701*^9, 3.719200090168792*^9}, {3.7192001592319727`*^9, 
   3.719200161872637*^9}, {3.719200192154174*^9, 3.719200215982551*^9}, {
   3.7192003613120947`*^9, 3.7192003615152392`*^9}, {3.7192003926249213`*^9, 
   3.7192004038593903`*^9}, {3.7192007360345664`*^9, 3.719200737425189*^9}, {
   3.7192008763172026`*^9, 3.7192008770515842`*^9}, {3.7192012524771523`*^9, 
   3.7192014354477234`*^9}, {3.719201473323102*^9, 3.7192014745887413`*^9}, {
   3.719201568152165*^9, 3.7192015869492254`*^9}, {3.7192016199807854`*^9, 
   3.719201651652985*^9}, {3.7192016844646626`*^9, 3.7192016920584855`*^9}, {
   3.719201990670825*^9, 3.719202081062332*^9}, {3.719202119234582*^9, 
   3.719202188188407*^9}, {3.7192023105025125`*^9, 3.7192023359558897`*^9}, {
   3.719202366471816*^9, 3.7192024191598487`*^9}, {3.719202600364769*^9, 
   3.7192026010991507`*^9}, {3.719202685162467*^9, 3.719202699037619*^9}, {
   3.7192027409599085`*^9, 3.7192027460693173`*^9}, {3.7192028352420907`*^9, 
   3.7192028447265425`*^9}, {3.7192030826507854`*^9, 3.719203096354029*^9}, {
   3.719203261871307*^9, 3.7192032697776184`*^9}, {3.719203943581169*^9, 
   3.7192039662532687`*^9}, {3.7192040406133614`*^9, 3.71920410648903*^9}, {
   3.7192041382862043`*^9, 3.719204146786289*^9}, {3.7192043041628413`*^9, 
   3.719204320428645*^9}, {3.7192044574143734`*^9, 3.719204491414692*^9}, {
   3.7192228224660835`*^9, 3.7192228340286818`*^9}, {3.7192229349828043`*^9, 
   3.719222954201745*^9}, {3.7192306470887065`*^9, 3.7192306620107093`*^9}, {
   3.719230701667274*^9, 3.7192307042923126`*^9}, {3.7192307388707123`*^9, 
   3.7192307420582385`*^9}, {3.7192308707160983`*^9, 3.719230983232666*^9}, {
   3.7192310926398306`*^9, 3.7192310951398664`*^9}, {3.7192311869999943`*^9, 
   3.7192312015157394`*^9}, {3.7192312807507763`*^9, 
   3.7192313137823043`*^9}, {3.7192313863141613`*^9, 
   3.7192313889704504`*^9}, {3.7192314597991514`*^9, 
   3.7192314848618608`*^9}, {3.7192315265423574`*^9, 3.7192315271703*^9}, {
   3.7192316214420795`*^9, 3.719231622006479*^9}, {3.719231681951769*^9, 
   3.71923168679069*^9}, {3.719232105439197*^9, 3.7192321358457146`*^9}, {
   3.7192327351571198`*^9, 3.7192327494853663`*^9}, {3.7192328189234467`*^9, 
   3.719232851720597*^9}, {3.7192343894723387`*^9, 3.719234443910293*^9}, {
   3.719234602833498*^9, 3.7192346269899483`*^9}, {3.7192347439498773`*^9, 
   3.7192347526530733`*^9}, {3.7192371046041484`*^9, 
   3.7192371440732436`*^9}, {3.7192372293239417`*^9, 
   3.7192372340739965`*^9}, {3.719238275252186*^9, 3.7192382754084373`*^9}, 
   3.7203222705510387`*^9, {3.721831225101729*^9, 3.721831245289421*^9}, {
   3.721831293914919*^9, 3.721831308993198*^9}, {3.721831360850943*^9, 
   3.721831406788931*^9}, {3.721831474398984*^9, 3.721831567634315*^9}, {
   3.7218316554320917`*^9, 3.721831770917652*^9}, {3.7218318469965763`*^9, 
   3.721831847402812*^9}, {3.7218342312511687`*^9, 3.721834263282732*^9}, {
   3.7218343330178213`*^9, 3.7218343444867043`*^9}, {3.7218343977528615`*^9, 
   3.7218343982216167`*^9}, {3.721834441690811*^9, 3.721834442940826*^9}, {
   3.721847203512889*^9, 3.7218472091223345`*^9}, {3.721847504359727*^9, 
   3.7218475045472455`*^9}, {3.729959618951742*^9, 3.729959668674589*^9}, {
   3.72995977411698*^9, 3.729959815765004*^9}, {3.7299650271229057`*^9, 
   3.7299650315680494`*^9}, {3.730209285178765*^9, 3.7302092922257104`*^9}, {
   3.730209725254342*^9, 3.7302097528170576`*^9}, {3.7302097927549205`*^9, 
   3.7302098368333917`*^9}, {3.7302099013627477`*^9, 3.730209911284737*^9}, {
   3.7302099501131535`*^9, 3.730209953472618*^9}, {3.7302100133790216`*^9, 
   3.7302100335823174`*^9}, {3.730210423938854*^9, 3.730210427782682*^9}, {
   3.730210470610163*^9, 3.730210473610182*^9}, {3.7302105199855747`*^9, 
   3.730210531626292*^9}, {3.7302106000487833`*^9, 3.730210633049032*^9}, {
   3.730210665564912*^9, 3.730210679424418*^9}, {3.730210853535248*^9, 
   3.730210855832121*^9}, {3.7302109108325872`*^9, 3.730210961348635*^9}, {
   3.730211046443143*^9, 3.7302110691776776`*^9}, 3.730221416535482*^9, {
   3.7302214832860556`*^9, 3.7302214955674086`*^9}, {3.730221528536434*^9, 
   3.730221541067773*^9}, {3.7302228647114334`*^9, 3.730222892852344*^9}, {
   3.7302247316159887`*^9, 3.73022475763183*^9}, {3.73022577465591*^9, 
   3.7302257927029877`*^9}, {3.7302258765474377`*^9, 3.730225909016415*^9}, {
   3.730226058611416*^9, 3.730226087627284*^9}, {3.730229545157014*^9, 
   3.730229613001302*^9}, {3.7302416244123077`*^9, 3.7302417421111493`*^9}, {
   3.7302417820760202`*^9, 3.730241796201976*^9}, {3.7302418832934017`*^9, 
   3.7302419152736464`*^9}, {3.7302437625112867`*^9, 3.730243763043991*^9}, 
   3.7302438364088593`*^9, 3.7302438691458206`*^9, {3.7302439128110614`*^9, 
   3.7302439161025543`*^9}, {3.7302439623553805`*^9, 
   3.7302440082354193`*^9}, {3.7304070399841022`*^9, 
   3.7304070540935965`*^9}, {3.730411368600424*^9, 3.7304113839344954`*^9}, 
   3.7304114283131824`*^9, {3.7304153110950084`*^9, 3.7304155615658407`*^9}, {
   3.7304178177865877`*^9, 3.7304178208334723`*^9}, {3.7304178726620455`*^9, 
   3.73041793380315*^9}, {3.730417969881578*^9, 3.7304179782879133`*^9}, {
   3.7304180116475677`*^9, 3.730418097148279*^9}, {3.7304181323048267`*^9, 
   3.730418137445501*^9}, 3.7304190819714484`*^9, {3.7304191492219524`*^9, 
   3.730419165393976*^9}, {3.7304192206434364`*^9, 3.7304192375810475`*^9}, 
   3.7304193394450383`*^9, {3.730419370632798*^9, 3.730419415867551*^9}, {
   3.730419451305351*^9, 3.73041949405571*^9}, {3.7304195295403786`*^9, 
   3.730419556009363*^9}, {3.7304196987292953`*^9, 3.730419759542304*^9}, {
   3.7304204320538588`*^9, 3.7304204436477237`*^9}, {3.730420478538643*^9, 
   3.730420479179241*^9}, {3.7304205325234475`*^9, 3.730420563820568*^9}, {
   3.730421120709594*^9, 3.7304211468504543`*^9}, {3.7304211773301787`*^9, 
   3.7304211826583652`*^9}, {3.7304213017062197`*^9, 
   3.7304213210189133`*^9}, {3.730421354941043*^9, 3.730421367628657*^9}, {
   3.730442773177168*^9, 3.73044280284929*^9}, {3.7304434420470653`*^9, 
   3.7304435774544315`*^9}, 3.7304436127828484`*^9, {3.7304443378471484`*^9, 
   3.730444338815908*^9}, {3.7304447631885324`*^9, 3.730444806126392*^9}, {
   3.73044489739278*^9, 3.7304448988927794`*^9}, {3.73044496253395*^9, 
   3.7304449626902246`*^9}, {3.730445082113059*^9, 3.7304451429416933`*^9}, {
   3.7304452195361*^9, 3.7304452507082214`*^9}, {3.730446044278842*^9, 
   3.730446054466426*^9}, {3.730446125263894*^9, 3.730446136638988*^9}, {
   3.7304464954301767`*^9, 3.7304464956489134`*^9}, {3.7304466009154344`*^9, 
   3.7304466118061347`*^9}, {3.7304467207926903`*^9, 
   3.7304467215114045`*^9}, {3.7304467621211042`*^9, 3.730446782543169*^9}, 
   3.730456928520197*^9, {3.730456976520584*^9, 3.7304570032552137`*^9}, {
   3.7304570595994067`*^9, 3.7304571053654113`*^9}, {3.7304571474595175`*^9, 
   3.7304571834285803`*^9}, {3.7304572155538635`*^9, 
   3.7304572190538616`*^9}, {3.730457259538599*^9, 3.730457299038938*^9}, {
   3.7304573310235796`*^9, 3.7304573371017475`*^9}, {3.730457440118227*^9, 
   3.730457452825094*^9}, {3.730457502214016*^9, 3.730457508807804*^9}, 
   3.730457558917611*^9, {3.7304576159962015`*^9, 3.7304576262931604`*^9}, {
   3.730457661840333*^9, 3.730457685621783*^9}, {3.7304577696068587`*^9, 
   3.730457830628004*^9}, 3.730457872784604*^9, {3.7304580191451902`*^9, 
   3.7304580492392073`*^9}, {3.730458126646105*^9, 3.730458379648205*^9}, {
   3.730458453945739*^9, 3.730458460820771*^9}, {3.730458526774451*^9, 
   3.730458559649709*^9}, {3.7304586204261975`*^9, 3.730458671442233*^9}, {
   3.730458755692938*^9, 3.730458765739914*^9}, {3.7304588171778307`*^9, 
   3.7304588246935334`*^9}, {3.730458966991596*^9, 3.7304590201482897`*^9}, {
   3.7304590862931156`*^9, 3.7304591655906487`*^9}, 3.730459229091197*^9, {
   3.730459310294985*^9, 3.730459354685981*^9}, {3.7304594421711025`*^9, 
   3.7304594953434067`*^9}, {3.7304595381719093`*^9, 3.730459640610263*^9}, {
   3.7304596860950203`*^9, 3.730459705673313*^9}, {3.730459883096666*^9, 
   3.730460027752493*^9}, {3.730460135425253*^9, 3.7304601706442986`*^9}, {
   3.7304603794272814`*^9, 3.7304603944430285`*^9}, {3.730460426723996*^9, 
   3.7304604367396984`*^9}, {3.730460495099543*^9, 3.7304605550688114`*^9}, {
   3.730460654929006*^9, 3.730460716085784*^9}, {3.73046077257063*^9, 
   3.7304607756487827`*^9}, 3.730460831868002*^9, {3.730461743787143*^9, 
   3.730461753052924*^9}, {3.730461878226132*^9, 3.7304619165234175`*^9}, {
   3.730461965789504*^9, 3.7304619764458685`*^9}, {3.7304620689312305`*^9, 
   3.7304620693844132`*^9}, 3.7304621148536205`*^9, {3.7304623335992904`*^9, 
   3.7304623339586706`*^9}, {3.7304623885051603`*^9, 
   3.7304623885051603`*^9}, {3.730462430786876*^9, 3.7304624512558727`*^9}, {
   3.730463489954368*^9, 3.7304634941106606`*^9}, {3.7304636257482443`*^9, 
   3.7304636287326355`*^9}, {3.7304638492349825`*^9, 
   3.7304638717196283`*^9}, {3.730464452687408*^9, 3.7304644786564445`*^9}, {
   3.7315908020324936`*^9, 3.7315908118919683`*^9}, {3.7315908806269903`*^9, 
   3.7315908993147125`*^9}, {3.7315910179722104`*^9, 
   3.7315910233472185`*^9}, {3.731591155145441*^9, 3.7315911572236085`*^9}, {
   3.731591215755429*^9, 3.7315912200054827`*^9}, {3.7330103556600723`*^9, 
   3.733010357779338*^9}, {3.733011923012903*^9, 3.73301192359752*^9}, {
   3.7330121576356373`*^9, 3.733012223303772*^9}, {3.733012302232736*^9, 
   3.733012305771906*^9}, {3.733012336597705*^9, 3.7330123388555336`*^9}, {
   3.733012380946134*^9, 3.73301238317*^9}, {3.733101739027917*^9, 
   3.7331017392493563`*^9}, {3.7332461777824583`*^9, 3.733246198954536*^9}, {
   3.734143690879919*^9, 3.7341437193489447`*^9}, 3.7341439303980017`*^9, {
   3.7341440633681183`*^9, 3.7341440869464846`*^9}, 3.7341441217437*^9, {
   3.7341441724942207`*^9, 3.73414417313487*^9}, {3.7341442219166164`*^9, 
   3.7341442418074446`*^9}, {3.7341448542699986`*^9, 3.734144856066885*^9}, 
   3.734144887395328*^9, {3.7341449280207453`*^9, 3.734144950020971*^9}, {
   3.734145030428046*^9, 3.734145083600479*^9}, {3.7341451194133344`*^9, 
   3.734145121163355*^9}, {3.73414517350764*^9, 3.734145195585993*^9}, {
   3.7341452944307747`*^9, 3.7341452949932637`*^9}, {3.7341453386191483`*^9, 
   3.7341453396816616`*^9}, {3.7373076833009224`*^9, 
   3.7373076855351276`*^9}, {3.7373077551709585`*^9, 3.737307864551795*^9}, {
   3.737307895518425*^9, 3.737307907876953*^9}, {3.7373079957928133`*^9, 
   3.7373080021205053`*^9}, {3.737308038399289*^9, 3.737308091286297*^9}, {
   3.737308174374342*^9, 3.737308271680187*^9}, {3.737308313989791*^9, 
   3.7373085211627836`*^9}, {3.737308574034127*^9, 3.7373086956976767`*^9}, {
   3.737308732601404*^9, 3.7373087876913815`*^9}, {3.73730883717237*^9, 
   3.7373088715606456`*^9}, {3.737308926525632*^9, 3.7373089273068595`*^9}, {
   3.7373091382923903`*^9, 3.7373092830166035`*^9}, {3.7373093203961163`*^9, 
   3.7373094417638865`*^9}, {3.7373096032684555`*^9, 
   3.7373096667016525`*^9}, {3.7373097002930813`*^9, 
   3.7373097004493055`*^9}, {3.7373097344313555`*^9, 
   3.7373097393841405`*^9}, {3.7373098235033865`*^9, 
   3.7373098598290243`*^9}, {3.7373099110442996`*^9, 
   3.7373099632750688`*^9}, {3.7373100753455276`*^9, 
   3.7373100819075775`*^9}, {3.7373102027830133`*^9, 
   3.7373102460236626`*^9}, {3.737377733127162*^9, 3.7373778213419185`*^9}, {
   3.7373778595580697`*^9, 3.737377905914266*^9}, 3.737382808786025*^9, {
   3.7373828506737814`*^9, 3.737382902404632*^9}, {3.7373829694156733`*^9, 
   3.7373829700406137`*^9}, {3.737415435634447*^9, 3.737415471524769*^9}, {
   3.7427691790608187`*^9, 3.74276921199868*^9}, {3.743990116720713*^9, 
   3.7439901490933733`*^9}, {3.7439903514694686`*^9, 3.743990354016162*^9}, {
   3.7439924962624598`*^9, 3.743992496746768*^9}, {3.743993543286973*^9, 
   3.743993577236391*^9}, 3.7439936107652597`*^9, {3.743993668292323*^9, 
   3.743993858372447*^9}, {3.7439938908075924`*^9, 3.7439938909169636`*^9}, {
   3.7439939303828955`*^9, 3.743993938085436*^9}, {3.7439939997060432`*^9, 
   3.7439940632170706`*^9}, {3.7439941236189957`*^9, 3.743994124900155*^9}, {
   3.7444079144756155`*^9, 3.744407917725431*^9}, {3.7444081384904423`*^9, 
   3.74440816778515*^9}, {3.7444082098445644`*^9, 3.7444082103445272`*^9}, {
   3.7444082657467127`*^9, 3.744408292760355*^9}, {3.745582096522628*^9, 
   3.745582106100114*^9}, {3.7455821581745186`*^9, 3.7455821662364464`*^9}, {
   3.745582302604249*^9, 3.7455823341176357`*^9}, {3.7455823723336816`*^9, 
   3.745582378645727*^9}, {3.745582546852592*^9, 3.7455826923423076`*^9}, {
   3.745582725371231*^9, 3.7455827754770527`*^9}, 3.745582810177724*^9, 
   3.745582852705956*^9, {3.745582900811944*^9, 3.745582934622059*^9}, 
   3.745583051066944*^9, {3.7455831993811436`*^9, 3.745583199568581*^9}, {
   3.745620620710107*^9, 3.7456206803308716`*^9}, {3.74562074320143*^9, 
   3.745620778652048*^9}, {3.7456208879568186`*^9, 3.7456209143455935`*^9}, {
   3.7456210078702307`*^9, 3.7456210352120357`*^9}, {3.7456210678503475`*^9, 
   3.7456211456261063`*^9}, {3.745621191404127*^9, 3.7456212806321783`*^9}, {
   3.745621325613369*^9, 3.745621326253952*^9}, 3.7456213854372845`*^9, {
   3.7456214306684294`*^9, 3.7456214929140263`*^9}, {3.745621611093172*^9, 
   3.74562170933624*^9}, {3.745621911387766*^9, 3.7456219121221094`*^9}, {
   3.7456219509162445`*^9, 3.745621998100404*^9}, {3.7456220307699494`*^9, 
   3.7456220361602135`*^9}, 3.7456220817351103`*^9, {3.7456221880088305`*^9, 
   3.745622273455916*^9}, {3.7456223330298576`*^9, 3.745622408493271*^9}, {
   3.74562253262511*^9, 3.7456225745908694`*^9}, {3.745622605698068*^9, 
   3.745623127520537*^9}, {3.7456231716111717`*^9, 3.7456232262791653`*^9}, {
   3.7456233028206573`*^9, 3.745623396314017*^9}, {3.7456234592783303`*^9, 
   3.74562348444841*^9}, {3.7456235258517485`*^9, 3.745623526429838*^9}, {
   3.7456236302337527`*^9, 3.7456236323742266`*^9}, {3.7456237072751727`*^9, 
   3.7456237346951027`*^9}, {3.745623852780486*^9, 3.7456238684200373`*^9}, {
   3.7456239161353817`*^9, 3.7456239330092025`*^9}, {3.74562401092557*^9, 
   3.745624067671543*^9}, {3.745624132010756*^9, 3.7456241379790864`*^9}, 
   3.745624216645396*^9, 3.7456242731726522`*^9, 3.7456243207005253`*^9, {
   3.74562437260311*^9, 3.7456244634872847`*^9}, {3.74562450110963*^9, 
   3.7456245013439875`*^9}, {3.745624604336618*^9, 3.7456246045084815`*^9}, 
   3.745624667878982*^9, {3.7456247304058304`*^9, 3.745624737108467*^9}, {
   3.7456248089940224`*^9, 3.7456248716927137`*^9}, {3.745624902831121*^9, 
   3.7456249559211187`*^9}, {3.745625243853899*^9, 3.7456252787264185`*^9}, {
   3.745625354955408*^9, 3.745625389421731*^9}, {3.745625427625249*^9, 
   3.7456254971047077`*^9}, {3.745625596238728*^9, 3.7456255985667057`*^9}, {
   3.7456256324236546`*^9, 3.745625634517275*^9}, {3.7456258300971966`*^9, 
   3.7456258931083655`*^9}, {3.7456259417768044`*^9, 3.74562596243157*^9}, {
   3.7456262991577845`*^9, 3.745626326343356*^9}, {3.745626520611227*^9, 
   3.7456265249859185`*^9}, {3.745626772140324*^9, 3.745626830964283*^9}, {
   3.7456268782734365`*^9, 3.7456269156770287`*^9}, {3.7456269729229774`*^9, 
   3.7456269897030582`*^9}, 3.746204373208952*^9, {3.7462045368006334`*^9, 
   3.746204583266009*^9}, {3.750603883783511*^9, 3.7506039275458956`*^9}, {
   3.750604222795131*^9, 3.7506042230607185`*^9}, {3.7506042600267286`*^9, 
   3.750604261011034*^9}, {3.7506795936337214`*^9, 3.7506797063754616`*^9}, {
   3.7506798156248426`*^9, 3.750679816656019*^9}, {3.7506798588404245`*^9, 
   3.7506798590748367`*^9}, {3.7506799416970716`*^9, 
   3.7506799459936495`*^9}, {3.7506799878655624`*^9, 
   3.7506799949744043`*^9}, {3.750680077515234*^9, 3.750680077733983*^9}, {
   3.7507669651460495`*^9, 3.75076697159872*^9}, {3.7507674959512663`*^9, 
   3.750767521749438*^9}, {3.750767592275568*^9, 3.7507675929942665`*^9}, {
   3.7507692452197876`*^9, 3.7507692693899145`*^9}, {3.762985275358675*^9, 
   3.7629852817350235`*^9}, 3.7629854511645403`*^9, {3.7633922907273684`*^9, 
   3.7633922982270136`*^9}, {3.7633940947852187`*^9, 
   3.7633940960566845`*^9}, {3.7645172100945997`*^9, 3.764517241217329*^9}, {
   3.76451772307517*^9, 3.764517728262289*^9}, {3.7645177876329308`*^9, 
   3.7645178195659423`*^9}, {3.764517961249733*^9, 3.764517976436119*^9}, {
   3.7645180253447504`*^9, 3.764518029188236*^9}, {3.7645180951990185`*^9, 
   3.7645181159356904`*^9}, {3.7645187736585836`*^9, 
   3.7645188078123384`*^9}, {3.7645188740694127`*^9, 
   3.7645188774754105`*^9}, {3.7645190249678764`*^9, 3.764519027780162*^9}, {
   3.7645191178629293`*^9, 3.764519167408841*^9}, {3.7645192185186486`*^9, 
   3.7645192190498543`*^9}, {3.76451926543708*^9, 3.764519272436561*^9}, {
   3.7645193348933077`*^9, 3.764519352517026*^9}, {3.76451953294591*^9, 
   3.764519533289648*^9}, {3.764519749122831*^9, 3.7645197805580087`*^9}, {
   3.7645198482411337`*^9, 3.764519852022127*^9}, 3.7645199049071603`*^9, {
   3.764520002043088*^9, 3.7645200068708735`*^9}, {3.764520687057459*^9, 
   3.7645206924164515`*^9}, {3.7645212123110113`*^9, 3.764521238996525*^9}, {
   3.764521281300886*^9, 3.764521299987001*^9}, 3.764521330109797*^9, {
   3.764521489107724*^9, 3.7645214971539927`*^9}, 3.766246534051634*^9, {
   3.7788109665844584`*^9, 3.778810970176818*^9}, 3.7788131810497913`*^9, {
   3.7788142861004267`*^9, 3.778814369187365*^9}, {3.778815041180129*^9, 
   3.778815041918047*^9}, {3.799718734580114*^9, 3.799718735413413*^9}, 
   3.799718769761869*^9, {3.799718806811058*^9, 3.799718807617086*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"da0f07e5-9343-408a-bff2-5759ece12e09"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "LinkPositions", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<b\>\"", " ", "\[RuleDelayed]", " ", 
      RowBox[{"Lookup", "[", 
       RowBox[{"BLbiped", ",", " ", "\"\<draw\>\"", ",", " ", 
        RowBox[{"<|", "|>"}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LinkPositions", "[", 
   RowBox[{"x_", ",", " ", "c_", ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", " ", "b", ",", " ", "d", ",", " ", "X", ",", " ", "L", ",", 
      " ", "f", ",", " ", "pos", ",", " ", "ax"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", " ", "=", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", "x", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "nx"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"b", " ", "=", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", "c", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "nc"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"extract", " ", "draw", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "get", " ", "position", " ", "of", " ", "link", " ", "in", " ", "world",
        " ", "frame"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"X", " ", "=", " ", 
      RowBox[{"XL0fun", "[", 
       RowBox[{"a", ",", " ", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"L", " ", "=", " ", 
      RowBox[{"RBDGetLinkInfo", "[", "\"\<p\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"RBDSpatialPosition", "[", 
         RowBox[{"X", ",", " ", "z3", ",", " ", "#", ",", " ", 
          RowBox[{"\"\<x\>\"", " ", "\[Rule]", " ", "a"}], ",", " ", 
          RowBox[{"\"\<\[Lambda]\>\"", " ", "\[Rule]", " ", "b"}]}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pos", "[", "k", "]"}], " ", "=", " ", 
        RowBox[{"f", "[", "k", "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", 
         RowBox[{"Keys", "@", "L"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pos", "[", "Root", "]"}], " ", "=", " ", "z3"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"add", " ", "POIs"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ax", " ", "=", " ", 
      RowBox[{"Lookup", "[", 
       RowBox[{"d", ",", " ", "\"\<poi\>\"", ",", " ", 
        RowBox[{"<|", "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"RBDSpatialPosition", "[", 
         RowBox[{"X", ",", " ", "#3", ",", " ", "#1"}], "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"4", ";;", "6"}], "\[RightDoubleBracket]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"L", "[", "k", "]"}], " ", "=", " ", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[DoubleStruckB]", " ", "=", " ", 
             RowBox[{"#1", "&"}]}], "}"}], ",", " ", 
           RowBox[{"ax", "[", "k", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pos", "[", "k", "]"}], " ", "=", " ", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[DoubleStruckB]", " ", "=", " ", "f"}], "}"}], ",", " ", 
           RowBox[{"ax", "[", "k", "]"}]}], "]"}]}], ";"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", " ", 
         RowBox[{"Keys", "@", "ax"}]}], "}"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "hack", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DoubleStruckX]", "[", "i_", "]"}], " ", 
            "\[RuleDelayed]", " ", 
            RowBox[{
            "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ",", " ", 
           RowBox[{
            RowBox[{"\[DoubleStruckC]", "[", "i_", "]"}], " ", 
            "\[RuleDelayed]", " ", 
            RowBox[{
            "b", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
          "}"}]}], "&"}], " ", "/@", " ", "pos"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "scale", " ", "model", " ", "and", " ", "get", " ", "axes", " ", "to", 
       " ", "draw", " ", "on"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ax", " ", "=", " ", 
      RowBox[{"Lookup", "[", 
       RowBox[{"d", ",", " ", "\"\<axes\>\"", ",", " ", "axes"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{"pos", "/", 
       RowBox[{"Lookup", "[", 
        RowBox[{"d", ",", " ", "\"\<scale\>\"", ",", " ", "scale"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pos", " ", "=", " ", 
      RowBox[{"pos", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", " ", "ax"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"pos", ",", " ", "L"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737896312131295*^9, 3.737896357612417*^9}, {
   3.73789649955546*^9, 3.737896500149122*^9}, {3.7378967264298697`*^9, 
   3.737896733132469*^9}, {3.737896778394846*^9, 3.737896803549312*^9}, {
   3.7378974339731307`*^9, 3.737897434363742*^9}, {3.737897485719447*^9, 
   3.7378974867349987`*^9}, {3.737919282074359*^9, 3.737919305182073*^9}, {
   3.7427777991142597`*^9, 3.7427778395890226`*^9}, {3.761998902732646*^9, 
   3.7619989477946405`*^9}, 3.7619990167582455`*^9, 3.7619991780473733`*^9},
 CellLabel->
  "In[294]:=",ExpressionUUID->"096ec56f-966c-4447-9a81-c289deb0136b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BLWrap", "[", 
    RowBox[{"f_", ",", " ", "c_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "C", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"BLc", "[", 
        RowBox[{
         RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "c"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"C", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", " ", 
          RowBox[{"1", ";;", "nx"}]}], "\[RightDoubleBracket]"}], ",", " ", 
        "C", ",", " ", "opts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737896312131295*^9, 3.737896357612417*^9}, {
  3.73789649955546*^9, 3.737896500149122*^9}, {3.7378967264298697`*^9, 
  3.737896733132469*^9}, {3.737896778394846*^9, 3.737896803549312*^9}, {
  3.7378974339731307`*^9, 3.737897434363742*^9}, {3.737897485719447*^9, 
  3.7378974867349987`*^9}, {3.737919282074359*^9, 3.7379193006355553`*^9}, {
  3.7379194630626097`*^9, 3.7379194670935707`*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"7dd0b128-8957-46b7-a463-60f58d1e4c3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLDrawBiped", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Graphics", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<b\>\"", " ", "\[RuleDelayed]", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{"BLbiped", ",", " ", "\"\<draw\>\"", ",", " ", 
         RowBox[{"<|", "|>"}]}], "]"}]}], ",", " ", 
      RowBox[{"\"\<\[CurlyPhi]\>\"", " ", "\[Rule]", " ", "None"}], ",", " ", 
      RowBox[{"BLWalkingSurface", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLDrawBiped", "[", 
     RowBox[{"x_", ",", " ", "c_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ax", ",", " ", "a", ",", " ", "b", ",", " ", "d", ",", " ", "X", ",", 
        " ", "L", ",", " ", "J", ",", " ", "f", ",", " ", "pos", ",", " ", 
        "\[Sigma]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "draw", " ", "options"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ax", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"d", ",", " ", "\"\<axes\>\"", ",", " ", "axes"}], "]"}]}], 
       ";", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "axes", " ", "to", " ", "draw", " ", "on"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", ",", " ", "L"}], "}"}], " ", "=", " ", 
        RowBox[{"LinkPositions", "[", 
         RowBox[{"x", ",", " ", "c", ",", " ", 
          RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "d"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "lengths"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", " ", "\[Rule]", " ", 
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{"pos", "[", "#", "]"}], "-", 
              RowBox[{"pos", "[", 
               RowBox[{"L", "@", "#"}], "]"}]}], "]"}]}], "&"}], " ", "/@", 
          " ", 
          RowBox[{"Keys", "@", "L"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "graphics", " ", "of", " ", "links"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"d", ",", " ", "\"\<lc\>\"", ",", " ", 
          RowBox[{"<|", "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{"#1", " ", "\[Rule]", " ", 
          RowBox[{"Link", "[", 
           RowBox[{
            RowBox[{"pos", "[", "#2", "]"}], ",", " ", 
            RowBox[{"pos", "[", "#1", "]"}], ",", " ", 
            RowBox[{"Lookup", "[", 
             RowBox[{"b", ",", " ", "#1", ",", " ", "lc"}], "]"}], ",", " ", 
            "ax"}], "]"}]}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"L", " ", "=", " ", 
        RowBox[{"KeyValueMap", "[", 
         RowBox[{"f", ",", " ", "L"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "drop", " ", "unwanted", " ", "links", " ", "and", " ", "joints"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", "#", "]"}], " ", "===", " ", "Root"}], " ", "||",
           " ", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"ignorelink", ",", " ", "#"}], "]"}], "||", 
          RowBox[{
           RowBox[{"a", "[", "#", "]"}], " ", "\[LessEqual]", " ", "tol"}]}], 
         "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Keys", "@", "L"}], ",", " ", "f"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"L", " ", "=", " ", 
        RowBox[{"Values", "@", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"L", ",", " ", "a"}], "]"}]}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"d", ",", " ", "\"\<jc\>\"", ",", " ", 
          RowBox[{"<|", "|>"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"RBDGetLinkNames", "[", "]"}], ",", " ", "ignorejoint"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Joint", "[", 
           RowBox[{
            RowBox[{"pos", "[", "#", "]"}], ",", " ", 
            RowBox[{"Lookup", "[", 
             RowBox[{"b", ",", " ", "#", ",", " ", "jc"}], "]"}]}], "]"}], 
          "&"}], " ", "/@", " ", "a"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"draw", " ", "slope"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<\[CurlyPhi]\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", " ", "=", " ", 
        RowBox[{"BLWalkingSurface", "[", 
         RowBox[{"\[Sigma]", ",", " ", 
          RowBox[{"OptionValue", "[", "BLWalkingSurface", "]"}], ",", " ", 
          RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "d"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"d", ",", " ", "\"\<f\>\"", ",", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "}"}], "&"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", " ", "L", ",", " ", "J", ",", " ", 
          RowBox[{"f", "[", 
           RowBox[{"x", ",", " ", "c"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "ax"}], " ", "\[Equal]", " ", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics", "[", 
          RowBox[{"X", ",", " ", 
           RowBox[{"OptionValue", "[", "Graphics", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"X", ",", " ", 
           RowBox[{"OptionValue", "[", "Graphics", "]"}], ",", " ", 
           RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", " ", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BLDrawAxes", "]"}], " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<axlen\>\"", " ", "\[Rule]", "  ", 
       RowBox[{"1", "/", "8"}]}], "}"}], ",", " ", 
     RowBox[{"Options", "[", "BLDrawBiped", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLDrawAxes", "[", 
    RowBox[{"x_", ",", " ", "c_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "l", ",", " ", "A", ",", " ", "T", ",", " ", "C"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"RBDGetLinkNames", "[", "]"}], ",", " ", "ignorelink"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<axlen\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"StringTemplate", "[", "\"\<``-axis-``\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{
         "#2", ",", " ", "4", ",", " ", "Red", ",", " ", "5", ",", " ", 
          "Green", ",", " ", "6", ",", " ", "Blue"}], "]"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "[", "##", "]"}], " ", "\[Rule]", " ", 
           RowBox[{"\[DoubleStruckB]", "[", 
            RowBox[{"#1", ",", " ", 
             RowBox[{"{", 
              RowBox[{"4", ",", " ", "5", ",", " ", "6"}], "}"}], ",", " ", 
             RowBox[{"l", " ", 
              RowBox[{
              "I6", "\[LeftDoubleBracket]", "#2", 
               "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"T", "[", "##", "]"}], " ", "\[Rule]", " ", 
           RowBox[{"C", "[", "##", "]"}]}]}], "}"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"k", ",", " ", "r"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "  ", "n"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"r", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "\"\<poi\>\"", "]"}], " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"A", ",", " ", "\"\<poi\>\"", ",", " ", 
           RowBox[{"<|", "|>"}]}], "]"}], ",", " ", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "\"\<lc\>\"", "]"}], " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"A", ",", " ", "\"\<lc\>\"", ",", " ", 
           RowBox[{"<|", "|>"}]}], "]"}], ",", " ", "C"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BLDrawBiped", "[", 
       RowBox[{"x", ",", " ", "c", ",", " ", 
        RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "A"}], ",", " ", "opts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6969403000216093`*^9, 3.696940327623665*^9}, {
   3.696940362111764*^9, 3.6969404438646836`*^9}, {3.696940623642353*^9, 
   3.696940678903527*^9}, {3.6969407878724575`*^9, 3.696940861058096*^9}, {
   3.696941110463431*^9, 3.696941179626219*^9}, {3.6969412369473457`*^9, 
   3.6969413213249936`*^9}, {3.6969413574661827`*^9, 3.696941392830496*^9}, {
   3.696941477445947*^9, 3.6969414986023827`*^9}, {3.6969418703626833`*^9, 
   3.696941900796776*^9}, {3.6969419349916363`*^9, 3.6969420303201876`*^9}, {
   3.6969420685062838`*^9, 3.696942213712734*^9}, {3.6969422991730967`*^9, 
   3.696942397467312*^9}, {3.6969424276411834`*^9, 3.696942471926179*^9}, {
   3.696942564622819*^9, 3.6969425950907803`*^9}, {3.6969427382309284`*^9, 
   3.696942747733961*^9}, {3.696942996946139*^9, 3.6969430125866566`*^9}, {
   3.696943189171723*^9, 3.6969431910623703`*^9}, {3.696964508290159*^9, 
   3.6969645120020657`*^9}, {3.719166448376153*^9, 3.7191665578616247`*^9}, 
   3.719166629862322*^9, {3.719166758238589*^9, 3.7191668559427013`*^9}, {
   3.719166907083828*^9, 3.719167079460515*^9}, {3.7191671251172314`*^9, 
   3.7191671910241327`*^9}, {3.719167511980426*^9, 3.719167556262101*^9}, {
   3.719167586496787*^9, 3.719167604215701*^9}, {3.7191676973416214`*^9, 
   3.7191677027948008`*^9}, {3.719167783920603*^9, 3.7191677938738375`*^9}, {
   3.7191678447337036`*^9, 3.719167914531267*^9}, {3.719168068814043*^9, 
   3.7191680728922086`*^9}, {3.719168122252088*^9, 3.7191681225645905`*^9}, {
   3.719168175893225*^9, 3.7191683369729424`*^9}, {3.719168369285762*^9, 
   3.7191683707545276`*^9}, {3.71916844448963*^9, 3.7191684763493195`*^9}, {
   3.7191685245060587`*^9, 3.719168642460338*^9}, {3.7191686821169806`*^9, 
   3.719168741789445*^9}, 3.719168782774241*^9, {3.7191688620406437`*^9, 
   3.719168864900035*^9}, {3.7191689953388257`*^9, 3.7191690206540947`*^9}, 
   3.7191693662172923`*^9, {3.7191694649213934`*^9, 3.7191694734058414`*^9}, {
   3.719169857679516*^9, 3.7191698656014695`*^9}, {3.719169942274104*^9, 
   3.719169967055599*^9}, {3.7191700524470654`*^9, 3.7191700588221292`*^9}, {
   3.7191700951506147`*^9, 3.7191701200258603`*^9}, {3.7191701635106654`*^9, 
   3.7191701668075733`*^9}, {3.719170219933098*^9, 3.7191703651711187`*^9}, {
   3.7191704696096506`*^9, 3.719170508469409*^9}, {3.7191706408769684`*^9, 
   3.7191707214871407`*^9}, {3.7191974950866585`*^9, 
   3.7191974997898293`*^9}, {3.719197571884291*^9, 3.7191975989939528`*^9}, {
   3.719197827112653*^9, 3.7191978454747314`*^9}, {3.719197884475116*^9, 
   3.7191979102253695`*^9}, 3.7191979823198495`*^9, {3.719198405230281*^9, 
   3.719198430839898*^9}, {3.719198464418347*^9, 3.7191985113719535`*^9}, {
   3.7191985452316456`*^9, 3.7191985474973097`*^9}, {3.7191988200156136`*^9, 
   3.719198827875081*^9}, {3.7191988704692526`*^9, 3.7191988931413355`*^9}, {
   3.7191989248135242`*^9, 3.71919892593855*^9}, {3.719199054455428*^9, 
   3.719199116924796*^9}, {3.719199238097885*^9, 3.719199239738509*^9}, {
   3.719199299582868*^9, 3.7191993746461105`*^9}, {3.719199409662077*^9, 
   3.7191994107402*^9}, {3.7191995438352823`*^9, 3.7191995452571716`*^9}, {
   3.719199598429555*^9, 3.7191996059921465`*^9}, {3.7191996431643896`*^9, 
   3.719199665883348*^9}, {3.719199697524285*^9, 3.7191997491498117`*^9}, {
   3.719199787384549*^9, 3.719199881822998*^9}, {3.719199928604706*^9, 
   3.719199941714198*^9}, 3.719199992745969*^9, 3.7192000238869*^9, {
   3.719200055824701*^9, 3.719200090168792*^9}, {3.7192001592319727`*^9, 
   3.719200161872637*^9}, {3.719200192154174*^9, 3.719200215982551*^9}, {
   3.7192003613120947`*^9, 3.7192003615152392`*^9}, {3.7192003926249213`*^9, 
   3.7192004038593903`*^9}, {3.7192007360345664`*^9, 3.719200737425189*^9}, {
   3.7192008763172026`*^9, 3.7192008770515842`*^9}, {3.7192012524771523`*^9, 
   3.7192014354477234`*^9}, {3.719201473323102*^9, 3.7192014745887413`*^9}, {
   3.719201568152165*^9, 3.7192015869492254`*^9}, {3.7192016199807854`*^9, 
   3.719201651652985*^9}, {3.7192016844646626`*^9, 3.7192016920584855`*^9}, {
   3.719201990670825*^9, 3.719202081062332*^9}, {3.719202119234582*^9, 
   3.719202188188407*^9}, {3.7192023105025125`*^9, 3.7192023359558897`*^9}, {
   3.719202366471816*^9, 3.7192024191598487`*^9}, {3.719202600364769*^9, 
   3.7192026010991507`*^9}, {3.719202685162467*^9, 3.719202699037619*^9}, {
   3.7192027409599085`*^9, 3.7192027460693173`*^9}, {3.7192028352420907`*^9, 
   3.7192028447265425`*^9}, {3.7192030826507854`*^9, 3.719203096354029*^9}, {
   3.719203261871307*^9, 3.7192032697776184`*^9}, {3.719203943581169*^9, 
   3.7192039662532687`*^9}, {3.7192040406133614`*^9, 3.71920410648903*^9}, {
   3.7192041382862043`*^9, 3.719204146786289*^9}, {3.7192043041628413`*^9, 
   3.719204320428645*^9}, {3.7192044574143734`*^9, 3.719204491414692*^9}, {
   3.7192228224660835`*^9, 3.7192228340286818`*^9}, {3.7192229349828043`*^9, 
   3.719222954201745*^9}, {3.7192306470887065`*^9, 3.7192306620107093`*^9}, {
   3.719230701667274*^9, 3.7192307042923126`*^9}, {3.7192307388707123`*^9, 
   3.7192307420582385`*^9}, {3.7192308707160983`*^9, 3.719230983232666*^9}, {
   3.7192310926398306`*^9, 3.7192310951398664`*^9}, {3.7192311869999943`*^9, 
   3.7192312015157394`*^9}, {3.7192312807507763`*^9, 
   3.7192313137823043`*^9}, {3.7192313863141613`*^9, 
   3.7192313889704504`*^9}, {3.7192314597991514`*^9, 
   3.7192314848618608`*^9}, {3.7192315265423574`*^9, 3.7192315271703*^9}, {
   3.7192316214420795`*^9, 3.719231622006479*^9}, {3.719231681951769*^9, 
   3.71923168679069*^9}, {3.719232105439197*^9, 3.7192321358457146`*^9}, {
   3.7192327351571198`*^9, 3.7192327494853663`*^9}, {3.7192328189234467`*^9, 
   3.719233062925503*^9}, {3.719234773012618*^9, 3.7192347881065116`*^9}, {
   3.7192348487788763`*^9, 3.7192348775916185`*^9}, {3.719234932904582*^9, 
   3.719234975029934*^9}, {3.719235009639597*^9, 3.7192350221240788`*^9}, {
   3.719235053530591*^9, 3.719235065311937*^9}, {3.7192353408767424`*^9, 
   3.7192354062522907`*^9}, {3.7192354417525873`*^9, 3.719235470284074*^9}, {
   3.7192355025812187`*^9, 3.7192356783170657`*^9}, {3.7192357697240815`*^9, 
   3.7192358453653374`*^9}, {3.7192359051470866`*^9, 
   3.7192359068502274`*^9}, {3.719236008444826*^9, 3.719236049070181*^9}, {
   3.7192360806485558`*^9, 3.719236160227346*^9}, {3.7192361918838606`*^9, 
   3.719236294775346*^9}, {3.7192363322287846`*^9, 3.7192363347288218`*^9}, {
   3.719236377666666*^9, 3.7192365226678767`*^9}, {3.719236591262216*^9, 
   3.719236619996815*^9}, {3.7192366635596943`*^9, 3.7192366778566756`*^9}, {
   3.719236730513381*^9, 3.7192367553104568`*^9}, {3.7192368224828997`*^9, 
   3.71923682560791*^9}, {3.719236963577814*^9, 3.719236990421788*^9}, {
   3.719237187870469*^9, 3.719237188214223*^9}, {3.719237237855262*^9, 
   3.719237238152139*^9}, {3.719237292949473*^9, 3.7192373321685505`*^9}, {
   3.719237397794115*^9, 3.719237402497265*^9}, {3.719237538480401*^9, 
   3.7192375451992226`*^9}, {3.7192375924496036`*^9, 
   3.7192376101372643`*^9}, {3.7192376686064887`*^9, 3.719237681622223*^9}, {
   3.71923778302932*^9, 3.7192377837012005`*^9}, {3.719237816185852*^9, 
   3.719237825810929*^9}, {3.7192379024209447`*^9, 3.719237905858473*^9}, {
   3.719237967593364*^9, 3.719237996859248*^9}, {3.7197665016130476`*^9, 
   3.7197665357696247`*^9}, {3.719766597504549*^9, 3.719766633646527*^9}, {
   3.719769120011508*^9, 3.7197691229959106`*^9}, {3.720229872069232*^9, 
   3.720229895116312*^9}, {3.720230388949128*^9, 3.7202303950273113`*^9}, {
   3.7202338103730583`*^9, 3.7202338175450153`*^9}, 3.720321875250408*^9, 
   3.720321931438443*^9, {3.720321970235684*^9, 3.7203219778295226`*^9}, {
   3.7203222705510387`*^9, 3.7203222705666647`*^9}, {3.7203224503652472`*^9, 
   3.720322456537181*^9}, {3.72183191565693*^9, 3.7218319363133917`*^9}, {
   3.721833362240303*^9, 3.7218333764435744`*^9}, {3.721833453131877*^9, 
   3.721833563289242*^9}, {3.721834132953268*^9, 3.7218341487190557`*^9}, {
   3.7218344700973516`*^9, 3.7218344705973577`*^9}, {3.7218461768461013`*^9, 
   3.7218462091120586`*^9}, {3.7218462493468466`*^9, 3.721846280769044*^9}, {
   3.7218463133006277`*^9, 3.721846321097583*^9}, {3.7218463755200157`*^9, 
   3.721846423114257*^9}, {3.721846501693188*^9, 3.7218465380685596`*^9}, {
   3.721846591709735*^9, 3.721846599678567*^9}, {3.7218467714615793`*^9, 
   3.7218467908524203`*^9}, {3.7218468476186285`*^9, 
   3.7218468482748704`*^9}, {3.7218468943847165`*^9, 3.721846896587881*^9}, {
   3.7218469322444816`*^9, 3.721846972166777*^9}, {3.721847128715249*^9, 
   3.7218471339028015`*^9}, {3.721847303310788*^9, 3.7218473054201975`*^9}, {
   3.7218474908908386`*^9, 3.7218474934846153`*^9}, {3.722099374202464*^9, 
   3.722099392733904*^9}, {3.722099445421929*^9, 3.722099448593852*^9}, {
   3.7220995894702992`*^9, 3.722099613548671*^9}, {3.7220997128465605`*^9, 
   3.7220997161599984`*^9}, {3.722099786377222*^9, 3.7220998228619537`*^9}, {
   3.722099998707511*^9, 3.7221000011762967`*^9}, 3.72210039699286*^9, {
   3.7304201001545563`*^9, 3.7304201136546383`*^9}, {3.7304202735056744`*^9, 
   3.7304202880370283`*^9}, {3.7304203205372963`*^9, 3.730420377537793*^9}, {
   3.730420568883117*^9, 3.730420569226864*^9}, {3.730462074337536*^9, 
   3.730462153228998*^9}, {3.7304622488483887`*^9, 3.730462253957819*^9}, 
   3.73046238852078*^9, {3.7304624870687246`*^9, 3.730462512037739*^9}, {
   3.730462564585174*^9, 3.730462580132213*^9}, 3.7304635719195604`*^9, {
   3.737377629571762*^9, 3.737377642727129*^9}, {3.737897345182602*^9, 
   3.7378973802269864`*^9}, {3.7378974373791513`*^9, 
   3.7378974665957966`*^9}, {3.7378984923523645`*^9, 3.737898493008571*^9}, {
   3.7379188599064407`*^9, 3.7379190270243397`*^9}, {3.737919313525236*^9, 
   3.737919321274672*^9}, {3.7379194582192087`*^9, 3.737919459578501*^9}, {
   3.7427393911164784`*^9, 3.742739406427843*^9}, {3.742739453439999*^9, 
   3.742739519216358*^9}, 3.742739603600727*^9, {3.742739668736523*^9, 
   3.7427396872820063`*^9}, {3.7427398331149487`*^9, 3.742739868118846*^9}, {
   3.7427399757358494`*^9, 3.742740029639122*^9}, {3.7427400603555956`*^9, 
   3.7427400809321795`*^9}, {3.7427401733472366`*^9, 3.7427401739253025`*^9}, 
   3.742740476986205*^9, {3.7428671516814847`*^9, 3.74286720313078*^9}, {
   3.7437724007473674`*^9, 3.7437724174492598`*^9}, {3.7450572563101788`*^9, 
   3.7450572807303076`*^9}, {3.76298521897519*^9, 3.7629852595684776`*^9}, {
   3.7695223433561335`*^9, 3.769522349819268*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"8520fc03-a8f5-426f-8dfe-64f6e4b34c76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLDrawCOM", "]"}], " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<r\>\"", " ", "\[Rule]", "  ", 
        RowBox[{"1", "/", "8"}]}], "}"}], ",", " ", 
      RowBox[{"Options", "[", "BLDrawBiped", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLDrawCOM", "[", 
    RowBox[{"x_", ",", " ", "c_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "L", ",", " ", "A", ",", " ", "T", ",", " ", "C"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"RBDGetLinkNames", "[", "]"}], ",", " ", "ignorelink"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", " ", "=", " ", 
       RowBox[{
        RowBox[{"RBDGetLinkInfo", "[", "\"\<inertia\>\"", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", 
         RowBox[{"5", ";;", "7"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"StringTemplate", "[", "\"\<``-com-``\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"Yellow", "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"T", "[", "##", "]"}], " ", "\[Rule]", " ", 
           RowBox[{"\[DoubleStruckB]", "[", 
            RowBox[{"#1", ",", " ", 
             RowBox[{"{", 
              RowBox[{"4", ",", " ", "5", ",", " ", "6"}], "}"}], ",", " ", 
             RowBox[{"L", "[", "#1", "]"}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"T", "[", "##", "]"}], " ", "\[Rule]", " ", 
           RowBox[{"C", "[", "##", "]"}]}]}], "}"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"k", ",", " ", "r"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "  ", "n"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"r", ",", 
            RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"C", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "\"\<poi\>\"", "]"}], " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"A", ",", " ", "\"\<poi\>\"", ",", " ", 
           RowBox[{"<|", "|>"}]}], "]"}], ",", " ", "T"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "\"\<lc\>\"", "]"}], " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"A", ",", " ", "\"\<lc\>\"", ",", " ", 
           RowBox[{"<|", "|>"}]}], "]"}], ",", " ", "C"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BLDrawBiped", "[", 
       RowBox[{"x", ",", " ", "c", ",", " ", 
        RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "A"}], ",", " ", "opts"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6969403000216093`*^9, 3.696940327623665*^9}, {
   3.696940362111764*^9, 3.6969404438646836`*^9}, {3.696940623642353*^9, 
   3.696940678903527*^9}, {3.6969407878724575`*^9, 3.696940861058096*^9}, {
   3.696941110463431*^9, 3.696941179626219*^9}, {3.6969412369473457`*^9, 
   3.6969413213249936`*^9}, {3.6969413574661827`*^9, 3.696941392830496*^9}, {
   3.696941477445947*^9, 3.6969414986023827`*^9}, {3.6969418703626833`*^9, 
   3.696941900796776*^9}, {3.6969419349916363`*^9, 3.6969420303201876`*^9}, {
   3.6969420685062838`*^9, 3.696942213712734*^9}, {3.6969422991730967`*^9, 
   3.696942397467312*^9}, {3.6969424276411834`*^9, 3.696942471926179*^9}, {
   3.696942564622819*^9, 3.6969425950907803`*^9}, {3.6969427382309284`*^9, 
   3.696942747733961*^9}, {3.696942996946139*^9, 3.6969430125866566`*^9}, {
   3.696943189171723*^9, 3.6969431910623703`*^9}, {3.696964508290159*^9, 
   3.6969645120020657`*^9}, {3.719166448376153*^9, 3.7191665578616247`*^9}, 
   3.719166629862322*^9, {3.719166758238589*^9, 3.7191668559427013`*^9}, {
   3.719166907083828*^9, 3.719167079460515*^9}, {3.7191671251172314`*^9, 
   3.7191671910241327`*^9}, {3.719167511980426*^9, 3.719167556262101*^9}, {
   3.719167586496787*^9, 3.719167604215701*^9}, {3.7191676973416214`*^9, 
   3.7191677027948008`*^9}, {3.719167783920603*^9, 3.7191677938738375`*^9}, {
   3.7191678447337036`*^9, 3.719167914531267*^9}, {3.719168068814043*^9, 
   3.7191680728922086`*^9}, {3.719168122252088*^9, 3.7191681225645905`*^9}, {
   3.719168175893225*^9, 3.7191683369729424`*^9}, {3.719168369285762*^9, 
   3.7191683707545276`*^9}, {3.71916844448963*^9, 3.7191684763493195`*^9}, {
   3.7191685245060587`*^9, 3.719168642460338*^9}, {3.7191686821169806`*^9, 
   3.719168741789445*^9}, 3.719168782774241*^9, {3.7191688620406437`*^9, 
   3.719168864900035*^9}, {3.7191689953388257`*^9, 3.7191690206540947`*^9}, 
   3.7191693662172923`*^9, {3.7191694649213934`*^9, 3.7191694734058414`*^9}, {
   3.719169857679516*^9, 3.7191698656014695`*^9}, {3.719169942274104*^9, 
   3.719169967055599*^9}, {3.7191700524470654`*^9, 3.7191700588221292`*^9}, {
   3.7191700951506147`*^9, 3.7191701200258603`*^9}, {3.7191701635106654`*^9, 
   3.7191701668075733`*^9}, {3.719170219933098*^9, 3.7191703651711187`*^9}, {
   3.7191704696096506`*^9, 3.719170508469409*^9}, {3.7191706408769684`*^9, 
   3.7191707214871407`*^9}, {3.7191974950866585`*^9, 
   3.7191974997898293`*^9}, {3.719197571884291*^9, 3.7191975989939528`*^9}, {
   3.719197827112653*^9, 3.7191978454747314`*^9}, {3.719197884475116*^9, 
   3.7191979102253695`*^9}, 3.7191979823198495`*^9, {3.719198405230281*^9, 
   3.719198430839898*^9}, {3.719198464418347*^9, 3.7191985113719535`*^9}, {
   3.7191985452316456`*^9, 3.7191985474973097`*^9}, {3.7191988200156136`*^9, 
   3.719198827875081*^9}, {3.7191988704692526`*^9, 3.7191988931413355`*^9}, {
   3.7191989248135242`*^9, 3.71919892593855*^9}, {3.719199054455428*^9, 
   3.719199116924796*^9}, {3.719199238097885*^9, 3.719199239738509*^9}, {
   3.719199299582868*^9, 3.7191993746461105`*^9}, {3.719199409662077*^9, 
   3.7191994107402*^9}, {3.7191995438352823`*^9, 3.7191995452571716`*^9}, {
   3.719199598429555*^9, 3.7191996059921465`*^9}, {3.7191996431643896`*^9, 
   3.719199665883348*^9}, {3.719199697524285*^9, 3.7191997491498117`*^9}, {
   3.719199787384549*^9, 3.719199881822998*^9}, {3.719199928604706*^9, 
   3.719199941714198*^9}, 3.719199992745969*^9, 3.7192000238869*^9, {
   3.719200055824701*^9, 3.719200090168792*^9}, {3.7192001592319727`*^9, 
   3.719200161872637*^9}, {3.719200192154174*^9, 3.719200215982551*^9}, {
   3.7192003613120947`*^9, 3.7192003615152392`*^9}, {3.7192003926249213`*^9, 
   3.7192004038593903`*^9}, {3.7192007360345664`*^9, 3.719200737425189*^9}, {
   3.7192008763172026`*^9, 3.7192008770515842`*^9}, {3.7192012524771523`*^9, 
   3.7192014354477234`*^9}, {3.719201473323102*^9, 3.7192014745887413`*^9}, {
   3.719201568152165*^9, 3.7192015869492254`*^9}, {3.7192016199807854`*^9, 
   3.719201651652985*^9}, {3.7192016844646626`*^9, 3.7192016920584855`*^9}, {
   3.719201990670825*^9, 3.719202081062332*^9}, {3.719202119234582*^9, 
   3.719202188188407*^9}, {3.7192023105025125`*^9, 3.7192023359558897`*^9}, {
   3.719202366471816*^9, 3.7192024191598487`*^9}, {3.719202600364769*^9, 
   3.7192026010991507`*^9}, {3.719202685162467*^9, 3.719202699037619*^9}, {
   3.7192027409599085`*^9, 3.7192027460693173`*^9}, {3.7192028352420907`*^9, 
   3.7192028447265425`*^9}, {3.7192030826507854`*^9, 3.719203096354029*^9}, {
   3.719203261871307*^9, 3.7192032697776184`*^9}, {3.719203943581169*^9, 
   3.7192039662532687`*^9}, {3.7192040406133614`*^9, 3.71920410648903*^9}, {
   3.7192041382862043`*^9, 3.719204146786289*^9}, {3.7192043041628413`*^9, 
   3.719204320428645*^9}, {3.7192044574143734`*^9, 3.719204491414692*^9}, {
   3.7192228224660835`*^9, 3.7192228340286818`*^9}, {3.7192229349828043`*^9, 
   3.719222954201745*^9}, {3.7192306470887065`*^9, 3.7192306620107093`*^9}, {
   3.719230701667274*^9, 3.7192307042923126`*^9}, {3.7192307388707123`*^9, 
   3.7192307420582385`*^9}, {3.7192308707160983`*^9, 3.719230983232666*^9}, {
   3.7192310926398306`*^9, 3.7192310951398664`*^9}, {3.7192311869999943`*^9, 
   3.7192312015157394`*^9}, {3.7192312807507763`*^9, 
   3.7192313137823043`*^9}, {3.7192313863141613`*^9, 
   3.7192313889704504`*^9}, {3.7192314597991514`*^9, 
   3.7192314848618608`*^9}, {3.7192315265423574`*^9, 3.7192315271703*^9}, {
   3.7192316214420795`*^9, 3.719231622006479*^9}, {3.719231681951769*^9, 
   3.71923168679069*^9}, {3.719232105439197*^9, 3.7192321358457146`*^9}, {
   3.7192327351571198`*^9, 3.7192327494853663`*^9}, {3.7192328189234467`*^9, 
   3.719233062925503*^9}, {3.719234773012618*^9, 3.7192347881065116`*^9}, {
   3.7192348487788763`*^9, 3.7192348775916185`*^9}, {3.719234932904582*^9, 
   3.719234975029934*^9}, {3.719235009639597*^9, 3.7192350221240788`*^9}, {
   3.719235053530591*^9, 3.719235065311937*^9}, {3.7192353408767424`*^9, 
   3.7192354062522907`*^9}, {3.7192354417525873`*^9, 3.719235470284074*^9}, {
   3.7192355025812187`*^9, 3.7192356783170657`*^9}, {3.7192357697240815`*^9, 
   3.7192358453653374`*^9}, {3.7192359051470866`*^9, 
   3.7192359068502274`*^9}, {3.719236008444826*^9, 3.719236049070181*^9}, {
   3.7192360806485558`*^9, 3.719236160227346*^9}, {3.7192361918838606`*^9, 
   3.719236294775346*^9}, {3.7192363322287846`*^9, 3.7192363347288218`*^9}, {
   3.719236377666666*^9, 3.7192365226678767`*^9}, {3.719236591262216*^9, 
   3.719236619996815*^9}, {3.7192366635596943`*^9, 3.7192366778566756`*^9}, {
   3.719236730513381*^9, 3.7192367553104568`*^9}, {3.7192368224828997`*^9, 
   3.71923682560791*^9}, {3.719236963577814*^9, 3.719236990421788*^9}, {
   3.719237187870469*^9, 3.719237188214223*^9}, {3.719237237855262*^9, 
   3.719237238152139*^9}, {3.719237292949473*^9, 3.7192373321685505`*^9}, {
   3.719237397794115*^9, 3.719237402497265*^9}, {3.719237538480401*^9, 
   3.7192375451992226`*^9}, {3.7192375924496036`*^9, 
   3.7192376101372643`*^9}, {3.7192376686064887`*^9, 3.719237681622223*^9}, {
   3.71923778302932*^9, 3.7192377837012005`*^9}, {3.719237816185852*^9, 
   3.719237825810929*^9}, {3.7192379024209447`*^9, 3.719237905858473*^9}, {
   3.719237967593364*^9, 3.719237996859248*^9}, {3.7197665016130476`*^9, 
   3.7197665357696247`*^9}, {3.719766597504549*^9, 3.719766633646527*^9}, {
   3.719769120011508*^9, 3.7197691229959106`*^9}, {3.720229872069232*^9, 
   3.720229895116312*^9}, {3.720230388949128*^9, 3.7202303950273113`*^9}, {
   3.7202338103730583`*^9, 3.7202338175450153`*^9}, 3.720321875250408*^9, 
   3.720321931438443*^9, {3.720321970235684*^9, 3.7203219778295226`*^9}, {
   3.7203222705510387`*^9, 3.7203222705666647`*^9}, {3.7203224503652472`*^9, 
   3.720322456537181*^9}, {3.72183191565693*^9, 3.7218319363133917`*^9}, {
   3.721833362240303*^9, 3.7218333764435744`*^9}, {3.721833453131877*^9, 
   3.721833563289242*^9}, {3.721834132953268*^9, 3.7218341487190557`*^9}, {
   3.7218344700973516`*^9, 3.7218344705973577`*^9}, {3.7218461768461013`*^9, 
   3.7218462091120586`*^9}, {3.7218462493468466`*^9, 3.721846280769044*^9}, {
   3.7218463133006277`*^9, 3.721846321097583*^9}, {3.7218463755200157`*^9, 
   3.721846423114257*^9}, {3.721846501693188*^9, 3.7218465380685596`*^9}, {
   3.721846591709735*^9, 3.721846599678567*^9}, {3.7218467714615793`*^9, 
   3.7218467908524203`*^9}, {3.7218468476186285`*^9, 
   3.7218468482748704`*^9}, {3.7218468943847165`*^9, 3.721846896587881*^9}, {
   3.7218469322444816`*^9, 3.721846972166777*^9}, {3.721847128715249*^9, 
   3.7218471339028015`*^9}, {3.721847303310788*^9, 3.7218473054201975`*^9}, {
   3.7218474908908386`*^9, 3.7218474934846153`*^9}, {3.722099374202464*^9, 
   3.722099392733904*^9}, {3.722099445421929*^9, 3.722099448593852*^9}, {
   3.7220995894702992`*^9, 3.722099613548671*^9}, {3.7220997128465605`*^9, 
   3.7220997161599984`*^9}, {3.722099786377222*^9, 3.7220998228619537`*^9}, {
   3.722099998707511*^9, 3.7221000011762967`*^9}, 3.72210039699286*^9, {
   3.7379193997390237`*^9, 3.737919451735299*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"4a7fc853-0d0e-4cbb-81fb-4a16e25a339a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"BLAddPOI", ",", " ", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLAddPOI", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<J\>\"", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
      RowBox[{"\"\<C\>\"", " ", "\[Rule]", " ", "Automatic"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLAddPOI", "[", 
     RowBox[{"name_", ",", " ", "len_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", " ", "l", ",", " ", "A", ",", " ", "T", ",", " ", "C"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<J\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", " ", "===", " ", "Automatic"}], ",", " ", 
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"BLValues", "[", 
           RowBox[{"\"\<\>\"", ",", " ", "\"\<r\>\""}], "]"}]}]}], "]"}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"match", " ", 
         RowBox[{"\[DoubleStruckQ]", "[", 
          RowBox[{"name", ",", " ", 
           RowBox[{"dof", "-", "as", "-", "string"}]}], "]"}], " ", "to", " ",
          "dof", " ", "axis"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{
         RowBox[{"Switch", "[", 
          RowBox[{"#2", ",", " ", 
           RowBox[{"\"\<px\>\"", "|", "\"\<rx\>\""}], ",", " ", "4", ",", " ", 
           RowBox[{"\"\<py\>\"", "|", "\"\<ry\>\""}], ",", " ", "5", ",", " ", 
           RowBox[{"\"\<pz\>\"", "|", "\"\<rz\>\""}], ",", " ", "6"}], "]"}], 
         "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", "#1"}], ",", " ", 
            RowBox[{"C", "@@", "#1"}]}], "}"}], "&"}], " ", "/@", " ", 
         "n"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"naming", " ", "convention"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"\"\<``-``-\>\"", "<>", " ", "name"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"StringTemplate", "[", "T", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"match", " ", "dof", " ", "axis", " ", "to", " ", "color"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<C\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"C", " ", "===", " ", "Automatic"}], ",", " ", 
         RowBox[{"C", " ", "=", " ", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{
            "#3", ",", " ", "4", ",", " ", "Blue", ",", " ", "5", ",", " ", 
             "Red", ",", " ", "6", ",", " ", "Green"}], "]"}], "&"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"put", " ", "name", " ", "into", " ", 
         RowBox[{"\[DoubleStruckB]", "[", "...", "]"}], " ", "and", " ", 
         "name", " ", "to", " ", "color"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", "##", "]"}], " ", "\[Rule]", " ", 
            RowBox[{"\[DoubleStruckB]", "[", 
             RowBox[{"#1", ",", " ", 
              RowBox[{"{", 
               RowBox[{"4", ",", " ", "5", ",", " ", "6"}], "}"}], ",", " ", 
              RowBox[{"len", " ", 
               RowBox[{
               "I6", "\[LeftDoubleBracket]", "#3", 
                "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"T", "[", "##", "]"}], " ", "\[Rule]", " ", 
            RowBox[{"C", "[", "##", "]"}]}]}], "}"}], "&"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"MapThread", "[", 
         RowBox[{"A", ",", 
          RowBox[{"n", "\[Transpose]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<poi\>\"", " ", "\[Rule]", " ", "T"}], ",", " ", 
         RowBox[{"\"\<lc\>\"", " ", "\[Rule]", " ", "C"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLDrawJoints", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<len\>\"", " ", "\[Rule]", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "64"}], ",", " ", 
         RowBox[{"1", "/", "64"}], ",", " ", 
         RowBox[{"1", "/", "28"}]}], "}"}]}], ",", " ", 
      RowBox[{"BLAddPOI", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<b\>\"", " ", "\[RuleDelayed]", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{"BLbiped", ",", " ", "\"\<draw\>\"", ",", " ", 
         RowBox[{"<|", "|>"}]}], "]"}]}], ",", " ", 
      RowBox[{"\"\<L\>\"", " ", "\[Rule]", " ", "0.0075"}], ",", " ", 
      RowBox[{"\"\<A\>\"", " ", "\[Rule]", " ", 
       RowBox[{"{", "0.01", "}"}]}], ",", " ", 
      RowBox[{"\"\<C\>\"", " ", "\[Rule]", " ", "0.03"}], ",", " ", 
      RowBox[{"Graphics", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<O\>\"", " ", "\[Rule]", " ", 
       RowBox[{"1", "/", "28"}]}], ",", " ", 
      RowBox[{"AxesOrigin", " ", "\[Rule]", " ", "Automatic"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLDrawJoints", "[", 
    RowBox[{"x_", ",", " ", "c_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "A", ",", " ", "B", ",", " ", "O", ",", " ", "pos", ",", " ", "L", ",", 
       " ", "dof", ",", " ", "lnks", ",", " ", "ax", ",", " ", "cyl", ",", 
       " ", "o", ",", " ", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"get", " ", "draw", " ", "settings"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "POI"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"OptionValue", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<len\>\"", ",", " ", "BLAddPOI"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"Sequence", "@@", 
        RowBox[{
        "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"BLAddPOI", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<cyl-b\>\"", ",", " ", "\"\<cyl-f\>\"", ",", " ", 
           "\"\<axis\>\""}], "}"}], ",", " ", 
         RowBox[{"Sequence", "@@", "B"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"Merge", "[", 
        RowBox[{"B", ",", " ", 
         RowBox[{
          RowBox[{"Join", "@@", "#"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"O", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<O\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"O", " ", "=", " ", 
       RowBox[{"BLAddPOI", "[", 
        RowBox[{"\"\<origin\>\"", ",", " ", "O", ",", " ", 
         RowBox[{"\"\<J\>\"", " ", "\[Rule]", " ", 
          RowBox[{"BLValues", "[", 
           RowBox[{
            RowBox[{"BLGetBipedBase", "[", "]"}], ",", " ", "\"\<p\>\""}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "pos"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "\"\<poi\>\"", "]"}], " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", " ", "B", ",", " ", "O"}], "}"}], ",", " ", 
          "\"\<poi\>\"", ",", " ", 
          RowBox[{"<|", "|>"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "[", "\"\<lc\>\"", "]"}], " ", "=", " ", 
       RowBox[{"Join", "@@", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", " ", "B", ",", " ", "O"}], "}"}], ",", " ", 
          "\"\<lc\>\"", ",", " ", 
          RowBox[{"<|", "|>"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", " ", "L"}], "}"}], " ", "=", " ", 
       RowBox[{"LinkPositions", "[", 
        RowBox[{"x", ",", " ", "c", ",", " ", 
         RowBox[{"\"\<b\>\"", " ", "\[Rule]", " ", "A"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "links"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"ignorelink", ",", " ", 
         RowBox[{"{", 
          RowBox[{"\"\<axis\>\"", ",", " ", "\"\<cyl\>\""}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"dof", ",", " ", "StringQ"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", 
       RowBox[{"KeySelect", "[", 
        RowBox[{"L", ",", " ", 
         RowBox[{
          RowBox[{"StringFreeQ", "[", 
           RowBox[{"#", ",", " ", "dof"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"Thickness", "[", 
        RowBox[{"OptionValue", "[", "\"\<L\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lnks", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B", ",", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{
            RowBox[{"A", "[", "\"\<lc\>\"", "]"}], ",", " ", "#1", ",", " ", 
            "lc"}], "]"}], ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"pos", " ", "/@", " ", 
            RowBox[{"Reverse", "@", 
             RowBox[{"{", "##", "}"}]}]}], "]"}]}], "}"}], "&"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"lnks", " ", "=", " ", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{"lnks", ",", " ", "dof"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "arrows"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", "\"\<axis\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", 
       RowBox[{"KeySelect", "[", 
        RowBox[{"L", ",", " ", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", " ", "dof"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<A\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", 
          RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], ",", " ", 
         RowBox[{"Arrowheads", "[", 
          RowBox[{"B", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ax", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{"B", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"A", "[", 
           RowBox[{"\"\<lc\>\"", ",", " ", "#1"}], "]"}], ",", " ", 
          RowBox[{"Arrow", "[", 
           RowBox[{"pos", " ", "/@", " ", 
            RowBox[{"Reverse", "@", 
             RowBox[{"{", "##", "}"}]}]}], "]"}]}], "}"}], "&"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ax", " ", "=", " ", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{"ax", ",", " ", "dof"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "cylinders"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", "\"\<cyl-b\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", 
       RowBox[{"KeySelect", "[", 
        RowBox[{"L", ",", " ", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", " ", "dof"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dof", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", " ", 
           RowBox[{
            RowBox[{"StringPart", "[", 
             RowBox[{"#1", ",", 
              RowBox[{";;", 
               RowBox[{"-", "2"}]}]}], "]"}], " ", "<>", " ", "\"\<f\>\""}]}],
           "}"}], "&"}], " ", "/@", " ", 
        RowBox[{"Keys", "@", "dof"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<C\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyl", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{"pos", " ", "/@", " ", "#"}], ",", " ", "B"}], "]"}], 
          "}"}], "&"}], " ", "/@", " ", "dof"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "world", " ", "frame"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "AxesOrigin", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"d", " ", "=!=", " ", "False"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dof", " ", "=", " ", "\"\<origin\>\""}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dof", " ", "=", " ", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"L", ",", " ", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", " ", "dof"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"d", " ", "===", " ", "Automatic"}], ",", " ", 
           RowBox[{"d", " ", "=", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0", ",", " ", 
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", " ", "3"}], "\[RightDoubleBracket]"}]}], 
              "}"}], "&"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"B", " ", "=", " ", 
          RowBox[{"OptionValue", "[", "\"\<A\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"B", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", 
             RowBox[{
             "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ",", " ", 
            RowBox[{"Arrowheads", "[", 
             RowBox[{"B", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}]}], "}"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"O", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], "-", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"d", "@", "#"}], ",", " ", "2"}], "]"}]}], "&"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
              " ", 
             RowBox[{"B", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
             RowBox[{"A", "[", 
              RowBox[{"\"\<lc\>\"", ",", " ", "#1"}], "]"}], ",", " ", 
             RowBox[{"Arrow", "@", 
              RowBox[{"O", "[", 
               RowBox[{"pos", " ", "/@", " ", 
                RowBox[{"Reverse", "@", 
                 RowBox[{"{", "##", "}"}]}]}], "]"}]}]}], "}"}], "&"}]}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"KeyValueMap", "[", 
           RowBox[{"o", ",", " ", "dof"}], "]"}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lnks", ",", " ", "cyl", ",", " ", "ax", ",", " ", "o"}], 
         "}"}], ",", " ", 
        RowBox[{"OptionValue", "[", "Graphics", "]"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"BLLaTex", "[", "\"\<text width\>\"", "]"}]}], ",", " ", 
        RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.745057336741886*^9, 3.7450573847071667`*^9}, {
   3.745057417017338*^9, 3.7450575263063035`*^9}, {3.745057589661112*^9, 
   3.7450576374389153`*^9}, {3.7450690237405844`*^9, 
   3.7450690262403975`*^9}, {3.745069109578119*^9, 3.745069173635968*^9}, {
   3.7450694975025654`*^9, 3.7450695141107244`*^9}, {3.745069777263607*^9, 
   3.745069800402547*^9}, {3.7450698335720415`*^9, 3.7450698454461665`*^9}, {
   3.74506988097486*^9, 3.745069891911591*^9}, 3.7450700529780965`*^9, {
   3.7450701068023205`*^9, 3.745070175859846*^9}, {3.7450702378865857`*^9, 
   3.74507030717844*^9}, {3.745070772530628*^9, 3.745070775780411*^9}, {
   3.745070840275738*^9, 3.745070840713235*^9}, 3.7450715961132374`*^9, 
   3.7450717004338427`*^9, {3.745073328812826*^9, 3.74507332979713*^9}, {
   3.745073415447185*^9, 3.7450735063312387`*^9}, {3.7450736805530453`*^9, 
   3.745073684912059*^9}, {3.7450737164410458`*^9, 3.7450738230739555`*^9}, {
   3.745073860211911*^9, 3.745073872523537*^9}, {3.7450740825864587`*^9, 
   3.7450741115531645`*^9}, 3.7450741457538047`*^9, {3.745074266229491*^9, 
   3.7450743822835765`*^9}, {3.74507442990514*^9, 3.7450745133209867`*^9}, {
   3.745074561473755*^9, 3.7450745680201626`*^9}, {3.7450746110506163`*^9, 
   3.7450746627031174`*^9}, {3.7450747006378956`*^9, 
   3.7450747059812603`*^9}, {3.745074824707054*^9, 3.7450749448390465`*^9}, {
   3.7450750180056133`*^9, 3.7450750273018417`*^9}, {3.7450752140695744`*^9, 
   3.7450753130257096`*^9}, {3.745075345391513*^9, 3.745075363827669*^9}, {
   3.7450753947160797`*^9, 3.7450754606983967`*^9}, {3.745075527865416*^9, 
   3.745075548020205*^9}, {3.745075579674158*^9, 3.745075607687775*^9}, {
   3.7450756396542387`*^9, 3.745075653528214*^9}, {3.7450756898693237`*^9, 
   3.7450757938774357`*^9}, {3.745075838749237*^9, 3.7450758633568087`*^9}, {
   3.745075921946327*^9, 3.745075922868119*^9}, {3.7450759675680532`*^9, 
   3.7450759889102697`*^9}, 3.7450760268137827`*^9, 3.745076076872622*^9, {
   3.7450769565273066`*^9, 3.7450769759790382`*^9}, {3.7450770065080805`*^9, 
   3.745077029117741*^9}, {3.745077325001613*^9, 3.745077410854787*^9}, {
   3.7450791398081994`*^9, 3.7450792036629777`*^9}, {3.7450792567060375`*^9, 
   3.7450794940052457`*^9}, {3.745079530096389*^9, 3.745079562305913*^9}, {
   3.745079595928515*^9, 3.7450795962565994`*^9}, {3.745079634315634*^9, 
   3.7450797031387863`*^9}, {3.745079782961131*^9, 3.745079817797738*^9}, {
   3.745079879418275*^9, 3.7450798813244033`*^9}, {3.7450800426149693`*^9, 
   3.7450801332738113`*^9}, {3.7450801693649716`*^9, 
   3.7450801728959365`*^9}, {3.74508025546811*^9, 3.7450803514191923`*^9}, {
   3.745080419758036*^9, 3.7450806030729094`*^9}, {3.7450806369767075`*^9, 
   3.7450806649193497`*^9}, {3.74508071427516*^9, 3.7450807270242686`*^9}, {
   3.7450808301730685`*^9, 3.745080839875458*^9}, {3.745080870170149*^9, 
   3.7450809027927933`*^9}, {3.7450809985983553`*^9, 3.745081147837608*^9}, {
   3.7450812172700768`*^9, 3.7450812179887924`*^9}, {3.745081354391382*^9, 
   3.745081362234583*^9}, 3.745083464227115*^9, {3.7450837364633884`*^9, 
   3.745083915950426*^9}, {3.7450840964217806`*^9, 3.7450841126549816`*^9}, {
   3.745084264711799*^9, 3.745084304005846*^9}, {3.745084382012247*^9, 
   3.7450843855745363`*^9}, {3.7450844290401*^9, 3.7450844321492505`*^9}, {
   3.7450844856141543`*^9, 3.745084487801482*^9}, {3.7450845480002565`*^9, 
   3.7450845698893013`*^9}, {3.745084621119976*^9, 3.745084621354334*^9}, {
   3.7450846683665476`*^9, 3.7450846713819556`*^9}, {3.7450859400586567`*^9, 
   3.7450859437146482`*^9}, {3.7450859898988247`*^9, 
   3.7450859976482463`*^9}, {3.7450860283647757`*^9, 
   3.7450860325363507`*^9}, {3.745086130529289*^9, 3.745086147481188*^9}, 
   3.745086264519597*^9, {3.745086316343978*^9, 3.7450863195781507`*^9}, {
   3.7597080555561132`*^9, 3.759708158360948*^9}, {3.759708220153242*^9, 
   3.759708261603289*^9}, {3.759708295616398*^9, 3.75970829956923*^9}, {
   3.7597088837801046`*^9, 3.759708887514187*^9}, {3.759709527779208*^9, 
   3.7597095431374598`*^9}, {3.7597095741507854`*^9, 
   3.7597096080857544`*^9}, {3.7597096442080917`*^9, 3.759709854489362*^9}, {
   3.7597098893930264`*^9, 3.7597098924552965`*^9}, {3.75970992367175*^9, 
   3.759709928890113*^9}, {3.7597099738287644`*^9, 3.7597100920511646`*^9}, {
   3.759710136110405*^9, 3.7597101474220657`*^9}, 3.7620005693704615`*^9, {
   3.781016025009369*^9, 3.7810160330827723`*^9}, {3.781016123289979*^9, 
   3.781016128970343*^9}, {3.7810163703082438`*^9, 3.781016374612878*^9}, {
   3.7918934705827847`*^9, 3.791893500815868*^9}, {3.79189652722922*^9, 
   3.7918966000897818`*^9}, {3.7918966332250566`*^9, 3.791896639057743*^9}, {
   3.7918967376476393`*^9, 3.79189674059413*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"0b1cc9e9-c7c8-467c-ae21-188e75a9645f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Animate", "Section",
 CellChangeTimes->{{3.684678566296839*^9, 3.684678566812415*^9}, {
   3.684678602969049*^9, 3.6846786252973766`*^9}, {3.6846787712362127`*^9, 
   3.6846787718768377`*^9}, {3.6846794135590725`*^9, 
   3.6846794243138685`*^9}, {3.684679499221797*^9, 3.684679500708866*^9}, {
   3.6943224932304945`*^9, 3.694322498229063*^9}, 3.694322896850048*^9, {
   3.696876852021453*^9, 3.696876854640302*^9}, {3.696878168489704*^9, 
   3.696878192633685*^9}, 3.696943982592585*^9, {3.7202264890806656`*^9, 
   3.7202264899244237`*^9}},ExpressionUUID->"91686825-73a1-40f8-be4b-\
bb6adb227328"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLSim", "[", 
     RowBox[{"p_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"BLSim", "[", 
     RowBox[{
      RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "p", ",", " ", 
      "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLSim", "[", 
    RowBox[{"m_String", ",", " ", "p_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BLMap", "[", 
    RowBox[{
     RowBox[{"Sequence", "@@", 
      RowBox[{"BLmxcp", "[", 
       RowBox[{"m", ",", " ", "p"}], "]"}]}], ",", " ", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7205114489461083`*^9, 3.7205114617587423`*^9}, 
   3.720920153843154*^9, {3.7247675857835307`*^9, 3.724767592057084*^9}, {
   3.7330100011219254`*^9, 3.733010008922*^9}, {3.740849509093859*^9, 
   3.7408495104843655`*^9}, {3.740849631897333*^9, 3.7408496324129205`*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"59066b35-2e6f-4b66-b381-6346ea838312"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLAnimateBiped", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BLDrawBiped", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Animate", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"BLSim", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<\[CurlyPhi]\>\"", " ", "\[Rule]", " ", "Automatic"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLAnimateBiped", "[", 
    RowBox[{
     RowBox[{"c_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", " ", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BLAnimateBiped", "[", 
    RowBox[{
     RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "c", ",", " ", 
     "opts"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLAnimateBiped", "[", 
    RowBox[{"m_String", ",", " ", "c_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BLAnimateBiped", "[", 
    RowBox[{
     RowBox[{"BLSim", "[", 
      RowBox[{"m", ",", " ", "c", ",", " ", 
       RowBox[{"OptionValue", "[", "BLSim", "]"}]}], "]"}], ",", " ", 
     "opts"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLAnimateBiped", "[", 
    RowBox[{"\[CurlyPhi]_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", " ", "c", ",", " ", "T", ",", " ", "\[Sigma]", ",", " ", 
       "o"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
       "\[CurlyPhi]", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{
       "\[CurlyPhi]", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"x", "[", "\"\<Domain\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<\[CurlyPhi]\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", " ", "===", " ", "Automatic"}], ",", " ", 
        RowBox[{
         RowBox[{"\[Sigma]", " ", "=", " ", "\[CurlyPhi]"}], ";"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"compute", " ", "a", " ", "bounding", " ", 
        RowBox[{"box", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"OptionValue", "[", "BLDrawBiped", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KeyFreeQ", "[", 
          RowBox[{"o", ",", " ", "Graphics"}], "]"}], " ", "||", " ", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{
            RowBox[{"o", "[", "Graphics", "]"}], ",", " ", "PlotRange", ",", 
            " ", "Automatic"}], "]"}], " ", "===", " ", "Automatic"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"o", "[", "Graphics", "]"}], " ", "=", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"o", ",", " ", "Graphics", ",", " ", 
               RowBox[{"{", "}"}]}], "]"}], ",", " ", 
             RowBox[{"PlotRange", " ", "\[Rule]", " ", 
              RowBox[{"BLBoundingBox", "[", "\[CurlyPhi]", "]"}]}]}], "}"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"Normal", "@", "o"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Animate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BLDrawBiped", "[", 
         RowBox[{
          RowBox[{"x", "[", "t", "]"}], ",", " ", 
          RowBox[{"c", "[", "t", "]"}], ",", " ", "o", ",", " ", 
          RowBox[{"\"\<\[CurlyPhi]\>\"", " ", "\[Rule]", " ", "\[Sigma]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", " ", 
          RowBox[{"T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{
          "T", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"OptionValue", "[", "Animate", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.719628209485877*^9, 3.719628302846033*^9}, {
   3.7196283464557743`*^9, 3.7196283683465815`*^9}, {3.7196284102687902`*^9, 
   3.719628421737653*^9}, {3.719628452644161*^9, 3.7196285576919146`*^9}, 
   3.7196286851929803`*^9, {3.7196287574123344`*^9, 3.7196287590998445`*^9}, {
   3.720321281551423*^9, 3.7203214041463375`*^9}, {3.7217231055097656`*^9, 
   3.7217231286664395`*^9}, {3.730209336898007*^9, 3.730209407007967*^9}, {
   3.7302095663998804`*^9, 3.730209567571762*^9}, {3.7304206767788687`*^9, 
   3.7304206864664354`*^9}, {3.7304215249554944`*^9, 3.730421541299384*^9}, {
   3.7304215827997417`*^9, 3.730421628268843*^9}, 3.730462263098569*^9, {
   3.7304626617893343`*^9, 3.7304626698050423`*^9}, {3.730462703696057*^9, 
   3.7304627049148207`*^9}, {3.730462765774844*^9, 3.730462791259492*^9}, {
   3.730462823775463*^9, 3.7304628327911844`*^9}, {3.750168751415016*^9, 
   3.7501687737414904`*^9}, {3.7501688521732054`*^9, 
   3.7501688603913307`*^9}, {3.7501689111688538`*^9, 
   3.7501689502284737`*^9}, {3.7501690063962364`*^9, 
   3.7501690818234024`*^9}, {3.7501691197393517`*^9, 3.750169127801241*^9}, {
   3.7501691678764095`*^9, 3.7501691891560907`*^9}, {3.7501693281721673`*^9, 
   3.750169354873343*^9}, {3.750169428711643*^9, 3.7501694802703404`*^9}, {
   3.7501695212829227`*^9, 3.7501695291105003`*^9}, {3.7501695608112717`*^9, 
   3.7501695638579245`*^9}, {3.7501696081359186`*^9, 3.7501696256502438`*^9}, 
   3.75017000292739*^9, {3.7501700398309355`*^9, 3.750170072890997*^9}, {
   3.750170108372739*^9, 3.7501701595252333`*^9}, {3.7501702042719336`*^9, 
   3.7501702169428587`*^9}, {3.7501702686109223`*^9, 
   3.7501702810318823`*^9}, {3.750170601345888*^9, 3.7501706151261215`*^9}, {
   3.7501707383682675`*^9, 3.750170747289448*^9}, {3.7501710989602613`*^9, 
   3.7501711744390693`*^9}, {3.7501712137174273`*^9, 3.750171222263651*^9}, {
   3.7501713848454266`*^9, 3.750171451621752*^9}, {3.750171487931573*^9, 
   3.750171607813374*^9}, {3.750171713899302*^9, 3.750171720930016*^9}, {
   3.750171761380172*^9, 3.7501717784570227`*^9}, {3.7501718130638604`*^9, 
   3.750171813985668*^9}, {3.750171883886731*^9, 3.7501719079318657`*^9}, {
   3.7501719467883415`*^9, 3.7501720016905475`*^9}, {3.7633031660947495`*^9, 
   3.7633031790469475`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"33538e80-6c20-4b82-99cc-5da64730cc59"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Animate Kinematics Only", "Section",
 CellChangeTimes->{{3.684678566296839*^9, 3.684678566812415*^9}, {
   3.684678602969049*^9, 3.6846786252973766`*^9}, {3.6846787712362127`*^9, 
   3.6846787718768377`*^9}, {3.6846794135590725`*^9, 
   3.6846794243138685`*^9}, {3.684679499221797*^9, 3.684679500708866*^9}, {
   3.6943224932304945`*^9, 3.694322498229063*^9}, 3.694322896850048*^9, {
   3.696876852021453*^9, 3.696876854640302*^9}, {3.696878168489704*^9, 
   3.696878192633685*^9}, 3.696943982592585*^9, {3.7373068587570534`*^9, 
   3.7373068594132137`*^9}, {3.7373139778595886`*^9, 3.737313978265811*^9}, {
   3.760325262585273*^9, 
   3.7603252685535765`*^9}},ExpressionUUID->"7af25095-5040-4680-b6eb-\
8981e254f844"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xAt", "[", 
     RowBox[{
      RowBox[{"x_", "?", "VectorQ"}], ",", " ", "M_", ",", " ", "n_"}], "]"}],
     " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CurlyPhi]", ",", " ", "T", ",", " ", "A", ",", " ", "p", ",", " ", 
        "b", ",", " ", "r", ",", " ", "p0", ",", " ", "pT", ",", " ", "d"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "[", "\"\<T\>\"", "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]", " ", "=", " ", 
        RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"floating", "-", 
         RowBox[{"base", " ", "offset"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"BLIndices", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<\[Theta]\>\"", ",", " ", 
            RowBox[{"BLGetBipedBase", "[", "]"}]}], "}"}], ",", " ", 
          "\"\<p\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p0", " ", "=", " ", 
        RowBox[{
         RowBox[{"\[CurlyPhi]", "[", "0", "]"}], "\[LeftDoubleBracket]", "p", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pT", " ", "=", " ", 
        RowBox[{
         RowBox[{"\[CurlyPhi]", "[", "T", "]"}], "\[LeftDoubleBracket]", "p", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", "p"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "positions", " ", "to", " ", "offset", " ", "by", " ", "multiples", 
         " ", "of", " ", "n"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"BLbiped", "[", "\"\<A\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"Diagonal", "[", 
         RowBox[{"A", "\[LeftDoubleBracket]", 
          RowBox[{"p", " ", ",", "p"}], "\[RightDoubleBracket]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p", " ", "=", " ", 
        RowBox[{"Pick", "[", 
         RowBox[{"p", ",", " ", "r", ",", " ", 
          RowBox[{"_", "?", "Positive"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"get", " ", "out"}], "-", "of", "-", 
         RowBox[{"plane", " ", "axis"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"d", ",", " ", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"x", " ", "at", " ", "step", " ", "n"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", " ", "=", " ", 
           RowBox[{"PadRight", "[", 
            RowBox[{
             RowBox[{"pT", "-", "p0"}], ",", " ", "nx"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "b", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{"n", " ", 
            RowBox[{
            "b", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "b", "\[LeftDoubleBracket]", "d", "\[RightDoubleBracket]"}], " ", 
           "=", " ", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"x", " ", "+", " ", "b"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"b", " ", "=", " ", 
           RowBox[{"PadRight", "[", 
            RowBox[{
             RowBox[{"pT", "-", 
              RowBox[{"r", " ", "p0"}]}], ",", " ", "nx"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "b", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{"n", " ", 
            RowBox[{
            "b", "\[LeftDoubleBracket]", "p", "\[RightDoubleBracket]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"mirrored", " ", "x", " ", "at", " ", "step", " ", "n"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A", ".", "x"}], " ", "+", " ", "b"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TAt", "[", 
     RowBox[{"t_", ",", " ", "M_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", " ", "T", ",", " ", "s", ",", " ", "n"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Lenght", "@", 
        RowBox[{"BLbiped", "[", 
         RowBox[{"\"\<t\>\"", ",", " ", 
          RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}]}], "]"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", " ", "=", " ", 
        RowBox[{
         RowBox[{"M", "[", "\"\<T\>\"", "]"}], "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"t", ",", " ", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", 
        RowBox[{"Quotient", "[", 
         RowBox[{"t", ",", " ", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"T", ",", " ", "s", ",", " ", "n"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"xAt", "[", 
     RowBox[{"t_", ",", " ", "M_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "T", ",", " ", "s", ",", " ", "n"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"M", "[", "\"\<x[t]\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", " ", "s", ",", " ", "n"}], "}"}], " ", "=", " ", 
        RowBox[{"TAt", "[", 
         RowBox[{"t", ",", " ", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xAt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "s", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "nx"}], "\[RightDoubleBracket]"}], ",", " ", "M",
          ",", " ", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mAt", "[", 
     RowBox[{"t_", ",", " ", "M_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", " ", "T", ",", " ", "s", ",", " ", "n"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"t", " ", "=", 
        RowBox[{">", " ", 
         RowBox[{"t", "+"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"M", "[", "\"\<m[t]\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", " ", "s", ",", " ", "n"}], "}"}], " ", "=", " ", 
        RowBox[{"TAt", "[", 
         RowBox[{"t", ",", " ", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "n", "]"}], ",", " ", 
          RowBox[{"m", "[", "s", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"BLbiped", "[", 
            RowBox[{"\"\<m\>\"", ",", " ", 
             RowBox[{"m", "[", "s", "]"}]}], "]"}], "[", "]"}]}], "]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "n", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"BLbiped", "[", 
           RowBox[{"\"\<m\>\"", ",", " ", 
            RowBox[{"m", "[", "s", "]"}]}], "]"}], "[", "]"}], ",", " ", 
         RowBox[{"m", "[", "s", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cAt", "[", 
    RowBox[{"t_", ",", " ", "M_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "T", ",", " ", "s", ",", " ", "n", ",", " ", "c", ",", " ", "x", ",", 
       " ", "m0", ",", " ", "x0"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T", ",", " ", "s", ",", " ", "n"}], "}"}], " ", "=", " ", 
       RowBox[{"TAt", "[", 
        RowBox[{"t", ",", " ", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"project", " ", "pre"}], "-", 
        RowBox[{
        "impact", " ", "state", " ", "n", " ", "steps", " ", "ahead"}]}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"xAt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"M", "[", "\"\<x-\>\"", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", " ", 
           RowBox[{"1", ";;", "nx"}]}], "\[RightDoubleBracket]"}], ",", " ", 
         "M", ",", " ", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "controls"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "n", "]"}], ",", " ", "1", ",", " ", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{
          RowBox[{"M", "[", "\"\<c\>\"", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"c", ",", " ", 
           RowBox[{
            RowBox[{"nx", "+", "1"}], ";;", "nc"}]}], 
          "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"project", " ", "post"}], "-", 
        RowBox[{"impact", " ", "state", " ", "n"}], "+", 
        RowBox[{"1", " ", "steps", " ", "ahead"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"m0", " ", "=", " ", 
       RowBox[{"mAt", "[", 
        RowBox[{
         RowBox[{"n", " ", "T"}], ",", " ", "M"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x0", " ", "=", " ", 
       RowBox[{"xAt", "[", 
        RowBox[{
         RowBox[{"n", " ", "T"}], ",", " ", "M"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "quick", " ", "hack", " ", "to", " ", "cover", " ", "1", "st", " ", 
        "derivative", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"devec", "[", "\"\<o\>\"", "]"}], " ", "\[Equal]", " ", 
         "0"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x0", " ", "=", " ", 
          RowBox[{"{", "x0", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{"{", "c", "}"}]}], ";"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", " ", "nc", ",", " ", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x0", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"x0", ",", " ", 
            RowBox[{"n", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "nx"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"c", ",", " ", "n"}], "}"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BLc", "[", 
        RowBox[{"m0", ",", " ", "x0", ",", " ", "c"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "nc"}], "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7603233558524885`*^9, 3.7603233574773817`*^9}, {
   3.760323431893713*^9, 3.760323432549961*^9}, {3.760323544088477*^9, 
   3.7603235441353455`*^9}, 3.760324052365396*^9, {3.7603242874744787`*^9, 
   3.7603242926616025`*^9}, {3.760324368030979*^9, 3.7603243686247125`*^9}, {
   3.76032443216682*^9, 3.7603244386819944`*^9}, {3.760324581589125*^9, 
   3.760324761841319*^9}, {3.7603251938403797`*^9, 3.7603251944497256`*^9}, {
   3.7603253462733545`*^9, 3.7603254380008955`*^9}, {3.7603254752637434`*^9, 
   3.7603254759199605`*^9}, {3.7603255160107307`*^9, 3.76032559281748*^9}, {
   3.7603273842688136`*^9, 3.7603273897371883`*^9}, {3.760327504587988*^9, 
   3.7603275109000187`*^9}, {3.76032757200484*^9, 3.7603275723954306`*^9}, {
   3.7603276431401634`*^9, 3.7603276594045773`*^9}, 3.7603277177283535`*^9, {
   3.760327885715829*^9, 3.760327885840813*^9}, {3.7607079421134906`*^9, 
   3.7607079430509224`*^9}, {3.7607086561912723`*^9, 3.760708682845628*^9}, {
   3.7607087235302773`*^9, 3.760708764480449*^9}, {3.7607091159867263`*^9, 
   3.7607091175803795`*^9}, {3.760709551796609*^9, 3.7607095728263636`*^9}, {
   3.7607096049959526`*^9, 3.7607096106986666`*^9}, {3.7607108005213175`*^9, 
   3.760710818145034*^9}, {3.760710851220811*^9, 3.760710943917345*^9}, {
   3.7607115407872295`*^9, 3.760711625812441*^9}, {3.760711720727547*^9, 
   3.7607117287269983`*^9}, {3.7607117787390532`*^9, 
   3.7607117817700877`*^9}, {3.760711822126594*^9, 3.760711880419341*^9}, {
   3.7607119802715993`*^9, 3.760711993083186*^9}, {3.7607132581084585`*^9, 
   3.760713278044541*^9}, {3.760742106760729*^9, 3.760742116245152*^9}, {
   3.7607454549066267`*^9, 3.760745534491788*^9}, {3.760745566699813*^9, 
   3.7607456399453573`*^9}, {3.7607456792879777`*^9, 
   3.7607456797979345`*^9}, {3.7607457993106875`*^9, 
   3.7607459053392305`*^9}, {3.7607461088118553`*^9, 3.760746187177102*^9}, {
   3.7607463119594946`*^9, 3.7607463349530845`*^9}, {3.7607464305922794`*^9, 
   3.760746439661742*^9}, {3.7607464808042293`*^9, 3.7607465050327387`*^9}, {
   3.7607465579045353`*^9, 3.7607465793032227`*^9}, {3.760746683006915*^9, 
   3.7607467883905153`*^9}, {3.7607471511605463`*^9, 
   3.7607472026955953`*^9}, {3.7607472433431377`*^9, 
   3.7607472664567327`*^9}, {3.7607473358925095`*^9, 3.760747372275296*^9}, {
   3.760747402828438*^9, 3.760747426526997*^9}, {3.7608836855744867`*^9, 
   3.76088368974605*^9}, {3.760883977235261*^9, 3.760883980906849*^9}, {
   3.760884192279152*^9, 3.7608843193634205`*^9}, {3.7608843723438625`*^9, 
   3.7608844689928937`*^9}, {3.760884536894103*^9, 3.7608845407844505`*^9}, {
   3.7608846414120717`*^9, 3.760884658317071*^9}, {3.760884710063222*^9, 
   3.7608847174064245`*^9}, 3.7608848342727127`*^9, {3.7608852039320335`*^9, 
   3.7608852929410415`*^9}, {3.760885438398938*^9, 3.7608854435079308`*^9}, {
   3.760885570951559*^9, 3.760885602355487*^9}, {3.760885639883958*^9, 
   3.76088565622649*^9}, {3.761788530609381*^9, 3.7617885846679964`*^9}, {
   3.761788757514936*^9, 3.7617887637332377`*^9}, {3.7617889767804327`*^9, 
   3.761789055181053*^9}, {3.7617898418209267`*^9, 3.7617898744127884`*^9}, {
   3.761789930617216*^9, 3.761789979848073*^9}, 3.761790144670576*^9, {
   3.761790219727683*^9, 3.761790397724226*^9}, {3.7617905036697865`*^9, 
   3.761790617958401*^9}, {3.7617906578613653`*^9, 3.7617907232785273`*^9}, {
   3.7619122454310675`*^9, 3.76191224622788*^9}, {3.769819631274626*^9, 
   3.769819634578365*^9}, {3.769819685056493*^9, 3.7698196869089265`*^9}, {
   3.7698206498714123`*^9, 3.769820653095708*^9}, {3.7698207272467384`*^9, 
   3.769820759837603*^9}, {3.7698209607255306`*^9, 3.769820980422055*^9}, {
   3.770047525173377*^9, 3.770047653506188*^9}, {3.770047709606981*^9, 
   3.770047814230393*^9}, {3.770047919121079*^9, 3.7700479197616696`*^9}, {
   3.778812754048704*^9, 3.7788127610672007`*^9}, {3.778812907790778*^9, 
   3.778812940145347*^9}, {3.778812994975108*^9, 3.778813003004258*^9}, {
   3.7896406631780767`*^9, 3.789640693174005*^9}, {3.789641099820971*^9, 
   3.7896411029600067`*^9}, {3.789641142469356*^9, 3.789641159544754*^9}, {
   3.789641279350205*^9, 3.7896412798524113`*^9}, {3.7896414019444523`*^9, 
   3.789641406562504*^9}, {3.789641705806738*^9, 3.78964174156221*^9}, {
   3.789641812508486*^9, 3.7896418142497473`*^9}, {3.7896419425246563`*^9, 
   3.789641944013384*^9}, {3.789658258568372*^9, 3.789658302617436*^9}, 
   3.789658578688875*^9, {3.789659640998128*^9, 3.7896596584417477`*^9}, {
   3.789659751159025*^9, 3.7896597995150747`*^9}, {3.789659972879548*^9, 
   3.789659992543583*^9}, {3.789660108163808*^9, 3.7896601089306593`*^9}, {
   3.789660328080922*^9, 3.789660331747587*^9}, 3.7896606870099573`*^9, {
   3.789660830523199*^9, 3.7896608493730373`*^9}, {3.789661218509694*^9, 
   3.7896612421632967`*^9}, {3.789661412636547*^9, 3.789661436854609*^9}, {
   3.789661579982955*^9, 3.789661581903619*^9}, {3.789661613256308*^9, 
   3.789661679151369*^9}, {3.789661728549241*^9, 3.7896617342816067`*^9}, 
   3.7896641600950413`*^9, {3.789665856363945*^9, 3.789665882592136*^9}, {
   3.789666281888953*^9, 3.789666313737121*^9}, {3.78966649929923*^9, 
   3.789666502559969*^9}, {3.7896665780437737`*^9, 3.789666586645501*^9}, {
   3.7896666585938683`*^9, 3.789666701945858*^9}, {3.789667056896398*^9, 
   3.7896670573091803`*^9}, {3.7896671158975554`*^9, 
   3.7896671161627398`*^9}, {3.789667372846634*^9, 3.789667406367517*^9}, {
   3.789668220684956*^9, 3.789668282442185*^9}, {3.789668320846977*^9, 
   3.78966832742908*^9}, {3.7896683957957087`*^9, 3.789668406940084*^9}, {
   3.7896687550714417`*^9, 3.78966877192006*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"af2dcc1b-5f61-4466-adf1-91bf1f1749f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLGaitKinematics", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BLSim", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<n\>\"", " ", "\[Rule]", " ", "5"}], ",", " ", 
      RowBox[{"\"\<T\>\"", " ", "\[Rule]", " ", "2"}], ",", " ", 
      RowBox[{"\"\<at\>\"", " ", "\[Rule]", " ", "True"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLGaitKinematics", "[", 
    RowBox[{
     RowBox[{"c_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VectorQ", "[", 
         RowBox[{"#", ",", " ", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BLGaitKinematics", "[", 
    RowBox[{
     RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", "c", ",", " ", 
     "opts"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLGaitKinematics", "[", 
    RowBox[{"m_String", ",", " ", "c_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"BLGaitKinematics", "[", 
    RowBox[{
     RowBox[{"BLSim", "[", 
      RowBox[{"m", ",", " ", "c", ",", " ", 
       RowBox[{"OptionValue", "[", "BLSim", "]"}]}], "]"}], ",", " ", 
     "opts"}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLGaitKinematics", "[", 
    RowBox[{"\[CurlyPhi]_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "n", ",", " ", "M", ",", " ", "t", ",", " ", "x", ",", " ", "T", ",", 
       " ", "A", ",", " ", "X", ",", " ", "o", ",", " ", "at"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", " ", "=", " ", "\[CurlyPhi]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<n\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", " ", "=", " ", 
       RowBox[{
        RowBox[{"M", "[", "\"\<T\>\"", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"OptionValue", "[", "\"\<T\>\"", "]"}], 
        "\[RightDoubleBracket]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"period", " ", "of", " ", "gait"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"at", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<at\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<x[t]\>\"", ",", " ", "\"\<c[t]\>\"", ",", " ", 
             "\"\<m[t]\>\""}], "}"}], " ", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"xAt", ",", " ", "cAt", ",", " ", "mAt"}], "}"}]}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"else", ",", " ", 
           RowBox[{
           "keep", " ", "original", " ", "values", " ", "and", " ", "filter", 
            " ", "time", " ", "stamps"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"f", " ", "=", " ", "#"}], "}"}], ",", " ", 
             RowBox[{
              RowBox[{"f", "[", "#", "]"}], "&"}]}], "]"}], "&"}], " ", "/@", 
          " ", 
          RowBox[{"M", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<x[t]\>\"", ",", " ", "\"\<c[t]\>\"", ",", " ", 
             "\"\<m[t]\>\""}], "}"}], "\[RightDoubleBracket]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Assert", "[", 
       RowBox[{
        RowBox[{"n", " ", ">", " ", "0"}], " ", "&&", " ", 
        RowBox[{"IntegerQ", "@", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"x", " ", "=", " ", 
          RowBox[{"M", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{"Flatten", "@", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"x", "[", "\"\<Grid\>\"", "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"_", "?", "Negative"}], "}"}], ",", " ", 
             RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"t", " ", "+", " ", 
              RowBox[{"i", " ", "T"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "0", ",", " ", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"some", " ", "trajectories", " ", 
            RowBox[{"don", "'"}], "t", " ", "have", " ", "t"}], " ", "=", " ",
            "0"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{"Prepend", "[", 
           RowBox[{"t", ",", " ", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"MMA", " ", "bug"}], ",", " ", 
           RowBox[{
            RowBox[{"<|", "|>"}], " ", "below", " ", "should", " ", "get", 
            " ", "rid", " ", "of", " ", "duplicates", " ", "too"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"t", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], " ", "\[LessEqual]", " ", 
              RowBox[{"10", "^", 
               RowBox[{"-", 
                RowBox[{"(*", "12", "*)"}], "6"}]}]}], 
             RowBox[{"(*", 
              RowBox[{"100", "$MachineEpsilon"}], "*)"}], "&"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"X", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"at", "[", "k", "]"}], "[", 
             RowBox[{"#", ",", " ", "M"}], "]"}], "&"}], " ", "/@", " ", 
           "t"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "If", " ", "crazy", " ", "interpolation", " ", "values", " ", 
            "appear"}], ",", " ", 
           RowBox[{"like", " ", "with"}]}], " ", "*)"}], 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Marlo", " ", 
            RowBox[{"rootman", "\[LeftDoubleBracket]", 
             RowBox[{"12", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], ",", 
           " ", 
           RowBox[{"try", " ", "increasing", " ", "multiplier"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"to", " ", "$MachineEpsilon", " ", 
           RowBox[{"above", ".", "  ", "Problem"}], " ", "might", " ", "be", 
           " ", "caused"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "by", " ", "time", " ", "stamps", " ", "being", " ", "too", " ", 
           "close", " ", "to", " ", "each", " ", 
           RowBox[{"other", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InterpolationOrder", "\[Rule]", 
             RowBox[{"First", "@", 
              RowBox[{"x", "[", "\"\<InterpolationOrder\>\"", "]"}]}]}], ",", 
            " ", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"x", "[", "\"\<InterpolationMethod\>\"", "]"}]}]}], 
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", "[", "k", "]"}], " ", "=", " ", 
          RowBox[{"Interpolation", "[", 
           RowBox[{
            RowBox[{"KeyValueMap", "[", 
             RowBox[{"List", ",", " ", 
              RowBox[{"AssociationThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", "t", "}"}], "\[Transpose]"}], " ", "\[Rule]", 
                " ", "X"}], "]"}]}], "]"}], ",", " ", "o"}], "]"}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", " ", 
          RowBox[{"{", 
           RowBox[{
           "\"\<x[t]\>\"", ",", " ", "\"\<c[t]\>\"", ",", " ", 
            "\"\<m[t]\>\""}], "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "M"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7603233558524885`*^9, 3.7603233574773817`*^9}, {
   3.760323431893713*^9, 3.760323432549961*^9}, {3.760323544088477*^9, 
   3.7603235441353455`*^9}, 3.760324052365396*^9, {3.7603242874744787`*^9, 
   3.7603242926616025`*^9}, {3.760324368030979*^9, 3.7603243686247125`*^9}, {
   3.76032443216682*^9, 3.7603244386819944`*^9}, {3.760324581589125*^9, 
   3.760324761841319*^9}, {3.7603251938403797`*^9, 3.7603251944497256`*^9}, {
   3.7603253462733545`*^9, 3.7603254380008955`*^9}, {3.7603254752637434`*^9, 
   3.7603254759199605`*^9}, {3.7603255160107307`*^9, 3.76032559281748*^9}, {
   3.76032562450264*^9, 3.7603256465790877`*^9}, {3.760325948146044*^9, 
   3.7603259875336905`*^9}, {3.7603262085343685`*^9, 
   3.7603262383446293`*^9}, {3.760326268561146*^9, 3.760326301621166*^9}, {
   3.7603265407031426`*^9, 3.760326583996786*^9}, {3.76032664663275*^9, 
   3.760326647632674*^9}, {3.7603267105498457`*^9, 3.7603267391258726`*^9}, {
   3.7603268327907686`*^9, 3.760326864491516*^9}, {3.760327820658204*^9, 
   3.760327863483121*^9}, {3.76088589607331*^9, 3.760885920728592*^9}, 
   3.7620002971479645`*^9, {3.7620003733211575`*^9, 3.7620003941807833`*^9}, {
   3.7620006504218884`*^9, 3.7620006751134944`*^9}, {3.762000715704251*^9, 
   3.7620007290360208`*^9}, {3.762000950460107*^9, 3.7620010293182173`*^9}, {
   3.7620010694050727`*^9, 3.7620010731135073`*^9}, 3.762001128062516*^9, {
   3.762001177617545*^9, 3.7620011956318417`*^9}, {3.7620012460784245`*^9, 
   3.762001247589485*^9}, {3.762002042191676*^9, 3.7620020453877463`*^9}, 
   3.7620021786273704`*^9, {3.7620022527070713`*^9, 3.76200240963773*^9}, {
   3.762002860547592*^9, 3.762002874393908*^9}, {3.7620037972294784`*^9, 
   3.7620038354891768`*^9}, {3.762016935605553*^9, 3.7620169745401835`*^9}, {
   3.7620170244427567`*^9, 3.762017029301773*^9}, {3.762017279087832*^9, 
   3.7620173197453313`*^9}, 3.762017704228527*^9, {3.76201773624055*^9, 
   3.7620177683886333`*^9}, {3.762017886382283*^9, 3.76201790179418*^9}, {
   3.762018205764511*^9, 3.76201821271725*^9}, {3.7768624447473383`*^9, 
   3.776862486572771*^9}, {3.7768625180705347`*^9, 3.7768625487420073`*^9}, {
   3.776862618593677*^9, 3.776862645217641*^9}, {3.776862683222252*^9, 
   3.776862706820689*^9}, {3.776862984820724*^9, 3.7768630750958233`*^9}, {
   3.77686320029488*^9, 3.7768632011495237`*^9}, 3.789393853338973*^9, 
   3.789393941214448*^9, {3.789394103327447*^9, 3.789394103524043*^9}, {
   3.789394236831284*^9, 3.789394240057925*^9}, {3.7893942710896807`*^9, 
   3.789394273006939*^9}, {3.789394363599709*^9, 3.78939441796677*^9}, 
   3.789394823677672*^9, 3.789394912445619*^9, {3.789394951131248*^9, 
   3.789394970263857*^9}, {3.789439327023673*^9, 3.7894393303518*^9}, {
   3.789439390103128*^9, 3.789439444199177*^9}, {3.789577847031746*^9, 
   3.789577894851491*^9}, 3.7895779271885147`*^9, {3.7895782035111027`*^9, 
   3.7895782035775757`*^9}, {3.789578392409773*^9, 3.789578393026177*^9}, {
   3.7896419684935827`*^9, 3.789641988758767*^9}, {3.789642090823627*^9, 
   3.789642207581711*^9}, {3.7896422452471657`*^9, 3.7896422489184732`*^9}, {
   3.7896575724474697`*^9, 3.789657633692067*^9}, {3.789664175508891*^9, 
   3.789664176444767*^9}, {3.789664255013328*^9, 3.7896642575964727`*^9}, {
   3.789664409869817*^9, 3.789664411671332*^9}, {3.789664467154586*^9, 
   3.789664479112339*^9}, {3.789664523972649*^9, 3.78966453105899*^9}, 
   3.7896699016951313`*^9, {3.799718843741108*^9, 3.7997188447668753`*^9}, {
   3.80067713746579*^9, 
   3.800677138976234*^9}},ExpressionUUID->"faa61ae4-9416-4167-954c-\
b315a29a51d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLSimGaitKinematics", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BLAnimateBiped", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"BLGaitKinematics", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLSimGaitKinematics", "[", 
     RowBox[{
      RowBox[{"c_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"VectorQ", "[", 
          RowBox[{"#", ",", " ", "NumericQ"}], "]"}], "&"}], ")"}]}], ",", 
      " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"BLGaitKinematics", "[", 
         RowBox[{"c", ",", " ", 
          RowBox[{"OptionValue", "[", "BLGaitKinematics", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"BLAnimateBiped", "[", 
        RowBox[{"M", ",", " ", 
         RowBox[{"OptionValue", "[", "BLAnimateBiped", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLSimGaitKinematics", "[", 
     RowBox[{"m_String", ",", " ", "c_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", " ", "=", " ", 
        RowBox[{"BLGaitKinematics", "[", 
         RowBox[{"m", ",", " ", "c", ",", " ", 
          RowBox[{"OptionValue", "[", "BLGaitKinematics", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"BLAnimateBiped", "[", 
        RowBox[{"M", ",", " ", 
         RowBox[{"OptionValue", "[", "BLAnimateBiped", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLSimGaitKinematics", "[", 
    RowBox[{"\[CurlyPhi]_", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"BLGaitKinematics", "[", 
        RowBox[{"\[CurlyPhi]", ",", " ", 
         RowBox[{"OptionValue", "[", "BLGaitKinematics", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"BLAnimateBiped", "[", 
       RowBox[{"M", ",", " ", 
        RowBox[{"OptionValue", "[", "BLAnimateBiped", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7603233558524885`*^9, 3.7603233574773817`*^9}, {
   3.760323431893713*^9, 3.760323432549961*^9}, {3.760323544088477*^9, 
   3.7603235441353455`*^9}, 3.760324052365396*^9, {3.7603242874744787`*^9, 
   3.7603242926616025`*^9}, {3.760324368030979*^9, 3.7603243686247125`*^9}, {
   3.76032443216682*^9, 3.7603244386819944`*^9}, {3.760324581589125*^9, 
   3.760324761841319*^9}, {3.7603251938403797`*^9, 3.7603251944497256`*^9}, {
   3.7603253462733545`*^9, 3.7603254380008955`*^9}, {3.7603254752637434`*^9, 
   3.7603254759199605`*^9}, {3.7603255160107307`*^9, 3.76032559281748*^9}, {
   3.76032562450264*^9, 3.7603256465790877`*^9}, {3.760325948146044*^9, 
   3.7603259875336905`*^9}, {3.7603262085343685`*^9, 
   3.7603262383446293`*^9}, {3.760326268561146*^9, 3.760326301621166*^9}, {
   3.7603265407031426`*^9, 3.760326583996786*^9}, {3.76032664663275*^9, 
   3.760326647632674*^9}, {3.7603267105498457`*^9, 3.7603267391258726`*^9}, {
   3.7603268327907686`*^9, 3.760326864491516*^9}, {3.760327802503289*^9, 
   3.760327803222002*^9}, {3.760327897808688*^9, 3.760327935305894*^9}, {
   3.760328012409541*^9, 3.760328015940494*^9}, {3.760328194568013*^9, 
   3.7603282343775463`*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"c74ccd4b-6eca-4bce-a47d-acce6e65a8c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Draw Gait", "Section",
 CellChangeTimes->{{3.684678566296839*^9, 3.684678566812415*^9}, {
   3.684678602969049*^9, 3.6846786252973766`*^9}, {3.6846787712362127`*^9, 
   3.6846787718768377`*^9}, {3.6846794135590725`*^9, 
   3.6846794243138685`*^9}, {3.684679499221797*^9, 3.684679500708866*^9}, {
   3.6943224932304945`*^9, 3.694322498229063*^9}, 3.694322896850048*^9, {
   3.696876852021453*^9, 3.696876854640302*^9}, {3.696878168489704*^9, 
   3.696878192633685*^9}, 3.696943982592585*^9, {3.7373068587570534`*^9, 
   3.7373068594132137`*^9}, {3.7373139778595886`*^9, 
   3.737313978265811*^9}},ExpressionUUID->"b19ae68d-64ea-4c1d-a349-\
b7fc2cd8b872"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLGetPOI", "[", "c_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m0", ",", " ", "X", ",", " ", "C"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m0", " ", "=", " ", 
        RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", ",", " ", "C"}], "}"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"BLmxcp", "[", 
          RowBox[{"m0", ",", " ", "c"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", "3"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BLGetPOI", "[", 
        RowBox[{"X", ",", " ", "C"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLGetPOI", "[", 
     RowBox[{"x_", ",", " ", "c_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"BLbiped", "\[LeftDoubleBracket]", 
         RowBox[{"\"\<draw\>\"", ",", " ", "\"\<poi\>\""}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"RBDSpatialPosition", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", 
           RowBox[{"\"\<x\>\"", " ", "\[Rule]", " ", "x"}], ",", " ", 
           RowBox[{"\"\<\[Lambda]\>\"", " ", "\[Rule]", " ", "c"}]}], "]"}], 
         "&"}], " ", "/@", " ", "f"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLManifold", "[", "M_Association", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"P", ",", " ", "x", ",", " ", "c", ",", " ", "TcM"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BLmxcp", "[", 
           RowBox[{
            RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}], ",", " ", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", "3"}], "\[RightDoubleBracket]"}], "&"}], " ", "/@",
         " ", "M"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"P", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"P", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", " ", "2"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TcM", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           ".", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "&"}], " ", "/@", " ", "M"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"devec", "[", 
          RowBox[{"#", ",", " ", "nx"}], "]"}], "&"}], " ", "/@", " ", 
        "x"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"devec", "[", 
          RowBox[{"#", ",", " ", "nc"}], "]"}], "&"}], " ", "/@", " ", 
        "c"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"KeyValueMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", " ", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", " ", 
             RowBox[{
              RowBox[{
              "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ".", 
              RowBox[{"TcM", "[", "#1", "]"}]}]}], "}"}], "&"}], ",", " ", 
          "x"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", " ", "=", " ", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"KeyValueMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", " ", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", " ", 
             RowBox[{
              RowBox[{
              "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ".", 
              RowBox[{"TcM", "[", "#1", "]"}]}]}], "}"}], "&"}], ",", " ", 
          "c"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", " ", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"KeyValueMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", " ", 
             RowBox[{
             "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", " ", 
             RowBox[{"TcM", "[", "#1", "]"}]}], "}"}], "&"}], ",", " ", "M"}],
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<x[s]\>\"", " ", "\[Rule]", " ", "x"}], ",", " ", 
        RowBox[{"\"\<c[s]\>\"", " ", "\[Rule]", " ", "c"}], ",", " ", 
        RowBox[{"\"\<M[s]\>\"", " ", "\[Rule]", " ", "P"}]}], "|>"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, 
   3.6968781986494007`*^9, {3.696878504573948*^9, 3.696878628425725*^9}, {
   3.696878671270988*^9, 3.6968787581074247`*^9}, {3.6968788322547226`*^9, 
   3.696878847707986*^9}, {3.696878877880124*^9, 3.696878929150913*^9}, {
   3.696879048128265*^9, 3.6968790482063875`*^9}, {3.6968790789382405`*^9, 
   3.6968791449965725`*^9}, {3.6968792398396196`*^9, 
   3.6968792799173737`*^9}, {3.69687938273899*^9, 3.696879394051574*^9}, 
   3.6968794269201946`*^9, {3.696879529191115*^9, 3.6968795297379932`*^9}, {
   3.6968795627373867`*^9, 3.6968795907353067`*^9}, {3.6968796220181103`*^9, 
   3.696879622424399*^9}, {3.699973212543885*^9, 3.699973215101559*^9}, {
   3.7157953012239027`*^9, 3.7157953025989213`*^9}, {3.715795529555254*^9, 
   3.7157955330396643`*^9}, {3.7157958155748863`*^9, 
   3.7157958169967823`*^9}, {3.715795867356866*^9, 3.7157959359203296`*^9}, {
   3.715796068765946*^9, 3.715796245299679*^9}, {3.7157963093318295`*^9, 
   3.7157963169725637`*^9}, {3.715796410708272*^9, 3.715796460146452*^9}, {
   3.7157965133815765`*^9, 3.7157965253192596`*^9}, {3.730422145508054*^9, 
   3.730422199758527*^9}, {3.730422284993619*^9, 3.73042228619674*^9}, {
   3.730422349322275*^9, 3.730422414432195*^9}, {3.730422459104444*^9, 
   3.7304225039485683`*^9}, {3.73042263343151*^9, 3.730422669119306*^9}, {
   3.730422699900817*^9, 3.730422716275941*^9}, {3.730422759260687*^9, 
   3.7304228449020305`*^9}, {3.7304229411840687`*^9, 
   3.7304229442466097`*^9}, {3.730423010278412*^9, 3.7304230133096714`*^9}, {
   3.730423086075921*^9, 3.730423112857379*^9}, {3.730423179576703*^9, 
   3.7304231985768614`*^9}, {3.7304232605148635`*^9, 3.73042330190584*^9}, {
   3.7304233678241296`*^9, 3.7304233683397264`*^9}, {3.73042345352262*^9, 
   3.7304234742571497`*^9}, {3.730423543273368*^9, 3.730423574033922*^9}, {
   3.7304236581127157`*^9, 3.7304236591439905`*^9}, {3.7304640132992315`*^9, 
   3.7304640151117783`*^9}, {3.7331014769846296`*^9, 
   3.7331014885628777`*^9}, {3.7372952504344816`*^9, 3.737295261027506*^9}, {
   3.7372955094792547`*^9, 3.7372956549693303`*^9}, {3.7372957322296376`*^9, 
   3.737295763870722*^9}, 3.7373103671091146`*^9, {3.737313131025056*^9, 
   3.737313154648444*^9}, {3.737313988827631*^9, 3.7373139947334332`*^9}, {
   3.7373141364772005`*^9, 3.7373141369927745`*^9}, {3.737322161564064*^9, 
   3.7373221624858713`*^9}, {3.7373224825686636`*^9, 3.737322539026576*^9}, {
   3.7373226756458516`*^9, 3.7373226891136637`*^9}, {3.737322735268933*^9, 
   3.7373227520334167`*^9}, {3.7373229082005386`*^9, 
   3.7373229314413266`*^9}, {3.73732299296926*^9, 3.737322997112234*^9}, {
   3.7373231616208954`*^9, 3.7373231688547792`*^9}, {3.7373233366265783`*^9, 
   3.737323364249689*^9}, {3.737323399278543*^9, 3.737323567392021*^9}, {
   3.737324485269184*^9, 3.7373245058396487`*^9}, {3.737324622691033*^9, 
   3.7373247203856697`*^9}, {3.737324812363782*^9, 3.7373248768023186`*^9}, {
   3.7373249349389825`*^9, 3.737325048321848*^9}, {3.7373251475531044`*^9, 
   3.737325221585741*^9}, {3.7373259178897395`*^9, 3.737325919405276*^9}, {
   3.737326031022622*^9, 3.7373261466709585`*^9}, {3.737326188652477*^9, 
   3.737326194355197*^9}, {3.737326260710028*^9, 3.7373262766464396`*^9}, {
   3.7373263814361596`*^9, 3.7373264672403326`*^9}, {3.7373299995224853`*^9, 
   3.737330005350168*^9}, {3.7373303068913193`*^9, 3.7373304064962945`*^9}, {
   3.7373304544148784`*^9, 3.737330455367939*^9}, {3.7373305400340185`*^9, 
   3.737330602779727*^9}, {3.7373308145152493`*^9, 3.7373308746205125`*^9}, {
   3.7373309061808667`*^9, 3.7373309403660116`*^9}, {3.7373309796289506`*^9, 
   3.737330986878454*^9}, {3.7373310234548798`*^9, 3.7373310446096973`*^9}, {
   3.7373311168547535`*^9, 3.737331210738939*^9}, {3.737331275859481*^9, 
   3.737331342370586*^9}, {3.737331375011425*^9, 3.7373314220863295`*^9}, {
   3.7373314945969763`*^9, 3.737331588028098*^9}, {3.737331625728673*^9, 
   3.737331749702303*^9}, {3.737331794183633*^9, 3.737331797511531*^9}, {
   3.7373318401180134`*^9, 3.737331846258196*^9}, {3.737331947345029*^9, 
   3.7373319506572905`*^9}, {3.737332024699108*^9, 3.7373320277926707`*^9}, {
   3.737332138347581*^9, 3.737332141206763*^9}, {3.737332176969942*^9, 
   3.7373321981872253`*^9}, {3.7373322325911336`*^9, 3.7373322436372547`*^9}, 
   3.7373323062735786`*^9, 3.737332344661604*^9, {3.7373323959549704`*^9, 
   3.737332440858116*^9}, {3.7373697462445135`*^9, 3.737369756134466*^9}, {
   3.73736997800395*^9, 3.737369979863186*^9}, {3.737370033672018*^9, 
   3.7373700934491777`*^9}, {3.737370297154006*^9, 3.7373703073959093`*^9}, {
   3.7373706217373333`*^9, 3.7373706940520153`*^9}, 3.737370770148033*^9, {
   3.7373709099715633`*^9, 3.7373709117995605`*^9}, {3.7373709839098845`*^9, 
   3.737371010861167*^9}, {3.737371171582487*^9, 3.737371183984087*^9}, {
   3.7373712228656225`*^9, 3.7373712520042715`*^9}, {3.7373712949075546`*^9, 
   3.7373712962355995`*^9}, {3.737373653014276*^9, 3.7373736987645917`*^9}, {
   3.737374776950369*^9, 3.737374778950242*^9}, {3.7378885188678346`*^9, 
   3.737888614657832*^9}, {3.737888693995942*^9, 3.7378887603036427`*^9}, {
   3.750709316656705*^9, 3.7507093298276153`*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"bf8cac45-2e81-47f7-b2ff-dee952163339"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BLBoundingBox", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<b\>\"", " ", "\[RuleDelayed]", " ", 
      RowBox[{"BLbiped", "[", "\"\<draw\>\"", "]"}]}], ",", " ", 
     RowBox[{"Padding", " ", "\[Rule]", " ", "4"}], ",", " ", 
     RowBox[{"\"\<t\>\"", " ", "\[Rule]", " ", "Automatic"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBoundingBox", "[", 
     RowBox[{"\[CurlyPhi]_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "x", ",", " ", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"\[CurlyPhi]", ",", " ", "\"\<x[t]\>\"", ",", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{"\[CurlyPhi]", ",", " ", "\"\<x[s]\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"\[CurlyPhi]", ",", " ", "\"\<c[t]\>\"", ",", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{"\[CurlyPhi]", ",", " ", "\"\<c[s]\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"t", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "\"\<t\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"t", " ", "===", " ", "Automatic"}], ",", " ", 
         RowBox[{"t", " ", "=", " ", 
          RowBox[{"Flatten", "@", 
           RowBox[{"x", "[", "\"\<Grid\>\"", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BLBoundingBox", "[", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], ",", " ", 
         RowBox[{"c", "[", "t", "]"}], ",", " ", "opts"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLBoundingBox", "[", 
    RowBox[{"x_", ",", " ", "c_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", " ", "d", ",", " ", "w"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<b\>\"", "]"}], ",", " ", 
         "\"\<axes\>\"", ",", " ", "axes"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"w", " ", "=", " ", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Padding", "]"}], "  ", 
        RowBox[{
        "widths", "\[LeftDoubleBracket]", "d", "\[RightDoubleBracket]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"d", " ", "+", " ", "mm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Values", "@", 
           RowBox[{"First", "@", 
            RowBox[{"LinkPositions", "[", "##", "]"}]}]}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "c"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Join", "@@", "p"}], ")"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Min", " ", "/@", " ", "d"}], ")"}], " ", "-", "  ", "w"}],
          ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Max", " ", "/@", " ", "d"}], ")"}], "+", " ", "w"}]}], 
        "}"}], "\[Transpose]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, 
   3.6968781986494007`*^9, {3.696878504573948*^9, 3.696878628425725*^9}, {
   3.696878671270988*^9, 3.6968787581074247`*^9}, {3.6968788322547226`*^9, 
   3.696878847707986*^9}, {3.696878877880124*^9, 3.696878929150913*^9}, {
   3.696879048128265*^9, 3.6968790482063875`*^9}, {3.6968790789382405`*^9, 
   3.6968791449965725`*^9}, {3.6968792398396196`*^9, 
   3.6968792799173737`*^9}, {3.69687938273899*^9, 3.696879394051574*^9}, 
   3.6968794269201946`*^9, {3.696879529191115*^9, 3.6968795297379932`*^9}, {
   3.6968795627373867`*^9, 3.6968795907353067`*^9}, {3.6968796220181103`*^9, 
   3.696879622424399*^9}, {3.699973212543885*^9, 3.699973215101559*^9}, {
   3.7157953012239027`*^9, 3.7157953025989213`*^9}, {3.715795529555254*^9, 
   3.7157955330396643`*^9}, {3.7157958155748863`*^9, 
   3.7157958169967823`*^9}, {3.715795867356866*^9, 3.7157959359203296`*^9}, {
   3.715796068765946*^9, 3.715796245299679*^9}, {3.7157963093318295`*^9, 
   3.7157963169725637`*^9}, {3.715796410708272*^9, 3.715796460146452*^9}, {
   3.7157965133815765`*^9, 3.7157965253192596`*^9}, {3.730422145508054*^9, 
   3.730422199758527*^9}, {3.730422284993619*^9, 3.73042228619674*^9}, {
   3.730422349322275*^9, 3.730422414432195*^9}, {3.730422459104444*^9, 
   3.7304225039485683`*^9}, {3.73042263343151*^9, 3.730422669119306*^9}, {
   3.730422699900817*^9, 3.730422716275941*^9}, {3.730422759260687*^9, 
   3.7304228449020305`*^9}, {3.7304229411840687`*^9, 
   3.7304229442466097`*^9}, {3.730423010278412*^9, 3.7304230133096714`*^9}, {
   3.730423086075921*^9, 3.730423112857379*^9}, {3.730423179576703*^9, 
   3.7304231985768614`*^9}, {3.7304232605148635`*^9, 3.73042330190584*^9}, {
   3.7304233678241296`*^9, 3.7304233683397264`*^9}, {3.73042345352262*^9, 
   3.7304234742571497`*^9}, {3.730423543273368*^9, 3.730423574033922*^9}, {
   3.7304236581127157`*^9, 3.7304236591439905`*^9}, {3.7304640132992315`*^9, 
   3.7304640151117783`*^9}, {3.7331014769846296`*^9, 
   3.7331014885628777`*^9}, {3.7372952504344816`*^9, 3.737295261027506*^9}, {
   3.7372955094792547`*^9, 3.7372956549693303`*^9}, {3.7372957322296376`*^9, 
   3.737295763870722*^9}, 3.7373103671091146`*^9, {3.737313131025056*^9, 
   3.737313154648444*^9}, {3.737313988827631*^9, 3.7373139947334332`*^9}, {
   3.7373141364772005`*^9, 3.7373141369927745`*^9}, {3.737322161564064*^9, 
   3.7373221624858713`*^9}, {3.7373224825686636`*^9, 3.737322539026576*^9}, {
   3.7373226756458516`*^9, 3.7373226891136637`*^9}, {3.737322735268933*^9, 
   3.7373227520334167`*^9}, {3.7373229082005386`*^9, 
   3.7373229314413266`*^9}, {3.73732299296926*^9, 3.737322997112234*^9}, {
   3.7373231616208954`*^9, 3.7373231688547792`*^9}, {3.7373233366265783`*^9, 
   3.737323364249689*^9}, {3.737323399278543*^9, 3.737323567392021*^9}, {
   3.737324485269184*^9, 3.7373245058396487`*^9}, {3.737324622691033*^9, 
   3.7373247203856697`*^9}, {3.737324812363782*^9, 3.7373248768023186`*^9}, {
   3.7373249349389825`*^9, 3.737325048321848*^9}, {3.7373251475531044`*^9, 
   3.737325221585741*^9}, {3.7373259178897395`*^9, 3.737325919405276*^9}, {
   3.737326031022622*^9, 3.7373261466709585`*^9}, {3.737326188652477*^9, 
   3.737326194355197*^9}, {3.737326260710028*^9, 3.7373262766464396`*^9}, {
   3.7373263814361596`*^9, 3.7373264672403326`*^9}, {3.7373299995224853`*^9, 
   3.737330005350168*^9}, {3.7373303068913193`*^9, 3.7373304064962945`*^9}, {
   3.7373304544148784`*^9, 3.737330455367939*^9}, {3.7373305400340185`*^9, 
   3.737330602779727*^9}, {3.7373308145152493`*^9, 3.7373308746205125`*^9}, {
   3.7373309061808667`*^9, 3.7373309403660116`*^9}, {3.7373309796289506`*^9, 
   3.737330986878454*^9}, {3.7373310234548798`*^9, 3.7373310446096973`*^9}, {
   3.7373311168547535`*^9, 3.737331210738939*^9}, {3.737331275859481*^9, 
   3.737331342370586*^9}, {3.737331375011425*^9, 3.7373314220863295`*^9}, {
   3.7373314945969763`*^9, 3.737331588028098*^9}, {3.737331625728673*^9, 
   3.737331749702303*^9}, {3.737331794183633*^9, 3.737331797511531*^9}, {
   3.7373318401180134`*^9, 3.737331846258196*^9}, {3.737331947345029*^9, 
   3.7373319506572905`*^9}, {3.737332024699108*^9, 3.7373320277926707`*^9}, {
   3.737332138347581*^9, 3.737332141206763*^9}, {3.737332176969942*^9, 
   3.7373321981872253`*^9}, {3.7373322325911336`*^9, 3.7373322436372547`*^9}, 
   3.7373323062735786`*^9, 3.737332344661604*^9, {3.7373323959549704`*^9, 
   3.737332440858116*^9}, {3.7373697462445135`*^9, 3.737369756134466*^9}, {
   3.73736997800395*^9, 3.737369979863186*^9}, {3.737370033672018*^9, 
   3.7373700934491777`*^9}, {3.737370297154006*^9, 3.7373703073959093`*^9}, {
   3.7373706217373333`*^9, 3.7373706940520153`*^9}, 3.737370770148033*^9, {
   3.7373709099715633`*^9, 3.7373709117995605`*^9}, {3.7373709839098845`*^9, 
   3.737371010861167*^9}, {3.737371171582487*^9, 3.737371183984087*^9}, {
   3.7373712228656225`*^9, 3.7373712520042715`*^9}, {3.7373712949075546`*^9, 
   3.7373712962355995`*^9}, {3.737373653014276*^9, 3.7373736987645917`*^9}, 
   3.737374776950369*^9, {3.7373780013296185`*^9, 3.7373780088134665`*^9}, {
   3.7378982581972113`*^9, 3.7378984246071987`*^9}, {3.737898462010786*^9, 
   3.737898466526092*^9}, {3.7378986220462236`*^9, 3.737898622514985*^9}, {
   3.7619986151132326`*^9, 3.7619986315495205`*^9}, 3.761998676358715*^9, 
   3.7619987169964075`*^9, {3.7619987629929523`*^9, 3.761998763477354*^9}, {
   3.761999066410898*^9, 3.7619990812653003`*^9}, {3.7619991144034805`*^9, 
   3.761999142281651*^9}, {3.762000605150696*^9, 3.7620006103222485`*^9}, {
   3.7620014829794497`*^9, 3.7620015171206446`*^9}, {3.762001610769909*^9, 
   3.762001616650158*^9}, {3.7620017180995426`*^9, 3.7620017671292024`*^9}, {
   3.7620018024588394`*^9, 3.7620018083991632`*^9}, {3.7620019240985837`*^9, 
   3.7620019279983873`*^9}},
 CellLabel->
  "In[330]:=",ExpressionUUID->"e8c9905a-c824-4dcb-ae0e-4f3da5128a6b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BLCreateGridPoints", "[", 
    RowBox[{"T_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"get", " ", "interval"}], ",", " ", 
       RowBox[{
       "T", " ", "is", " ", "either", " ", "vector", " ", "of", " ", "points",
         " ", "or", " ", "an", " ", "interpolating", " ", "function"}]}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", " ", "=", " ", 
       RowBox[{"MinMax", "@", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VectorQ", "[", "T", "]"}], ",", " ", "T", ",", " ", 
          RowBox[{"Chop", "@", 
           RowBox[{"T", "[", "\"\<Domain\>\"", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", " ", "\[Equal]", " ", "1"}], ",", " ", 
        RowBox[{"t", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{"t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
             RowBox[{
             "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"n", "-", "1"}], ")"}]}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLCreateGridPoints", "[", 
     RowBox[{"HoldPattern", "[", 
      RowBox[{"T_", " ", "\[Rule]", " ", "n_"}], "]"}], "]"}], " ", ":=", " ", 
    RowBox[{"BLCreateGridPoints", "[", 
     RowBox[{"T", ",", " ", "n"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLCreateGridPoints", "[", "n_", "]"}], " ", ":=", " ", "n"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, 
   3.6968781986494007`*^9, {3.696878504573948*^9, 3.696878628425725*^9}, {
   3.696878671270988*^9, 3.6968787581074247`*^9}, {3.6968788322547226`*^9, 
   3.696878847707986*^9}, {3.696878877880124*^9, 3.696878929150913*^9}, {
   3.696879048128265*^9, 3.6968790482063875`*^9}, {3.6968790789382405`*^9, 
   3.6968791449965725`*^9}, {3.6968792398396196`*^9, 
   3.6968792799173737`*^9}, {3.69687938273899*^9, 3.696879394051574*^9}, 
   3.6968794269201946`*^9, {3.696879529191115*^9, 3.6968795297379932`*^9}, {
   3.6968795627373867`*^9, 3.6968795907353067`*^9}, {3.6968796220181103`*^9, 
   3.696879622424399*^9}, {3.699973212543885*^9, 3.699973215101559*^9}, {
   3.7157953012239027`*^9, 3.7157953025989213`*^9}, {3.715795529555254*^9, 
   3.7157955330396643`*^9}, {3.7157958155748863`*^9, 
   3.7157958169967823`*^9}, {3.715795867356866*^9, 3.7157959359203296`*^9}, {
   3.715796068765946*^9, 3.715796245299679*^9}, {3.7157963093318295`*^9, 
   3.7157963169725637`*^9}, {3.715796410708272*^9, 3.715796460146452*^9}, {
   3.7157965133815765`*^9, 3.7157965253192596`*^9}, {3.730422145508054*^9, 
   3.730422199758527*^9}, {3.730422284993619*^9, 3.73042228619674*^9}, {
   3.730422349322275*^9, 3.730422414432195*^9}, {3.730422459104444*^9, 
   3.7304225039485683`*^9}, {3.73042263343151*^9, 3.730422669119306*^9}, {
   3.730422699900817*^9, 3.730422716275941*^9}, {3.730422759260687*^9, 
   3.7304228449020305`*^9}, {3.7304229411840687`*^9, 
   3.7304229442466097`*^9}, {3.730423010278412*^9, 3.7304230133096714`*^9}, {
   3.730423086075921*^9, 3.730423112857379*^9}, {3.730423179576703*^9, 
   3.7304231985768614`*^9}, {3.7304232605148635`*^9, 3.73042330190584*^9}, {
   3.7304233678241296`*^9, 3.7304233683397264`*^9}, {3.73042345352262*^9, 
   3.7304234742571497`*^9}, {3.730423543273368*^9, 3.730423574033922*^9}, {
   3.7304236581127157`*^9, 3.7304236591439905`*^9}, {3.7304640132992315`*^9, 
   3.7304640151117783`*^9}, {3.7331014769846296`*^9, 
   3.7331014885628777`*^9}, {3.7372952504344816`*^9, 3.737295261027506*^9}, {
   3.7372955094792547`*^9, 3.7372956549693303`*^9}, {3.7372957322296376`*^9, 
   3.737295763870722*^9}, 3.7373103671091146`*^9, {3.737313131025056*^9, 
   3.737313154648444*^9}, {3.737313988827631*^9, 3.7373139947334332`*^9}, {
   3.7373141364772005`*^9, 3.7373141369927745`*^9}, {3.737322161564064*^9, 
   3.7373221624858713`*^9}, {3.7373224825686636`*^9, 3.737322539026576*^9}, {
   3.7373226756458516`*^9, 3.7373226891136637`*^9}, {3.737322735268933*^9, 
   3.7373227520334167`*^9}, {3.7373229082005386`*^9, 
   3.7373229314413266`*^9}, {3.73732299296926*^9, 3.737322997112234*^9}, {
   3.7373231616208954`*^9, 3.7373231688547792`*^9}, {3.7373233366265783`*^9, 
   3.737323364249689*^9}, {3.737323399278543*^9, 3.737323567392021*^9}, {
   3.737324485269184*^9, 3.7373245058396487`*^9}, {3.737324622691033*^9, 
   3.7373247203856697`*^9}, {3.737324812363782*^9, 3.7373248768023186`*^9}, {
   3.7373249349389825`*^9, 3.737325048321848*^9}, {3.7373251475531044`*^9, 
   3.737325221585741*^9}, {3.7373259178897395`*^9, 3.737325919405276*^9}, {
   3.737326031022622*^9, 3.7373261466709585`*^9}, {3.737326188652477*^9, 
   3.737326194355197*^9}, {3.737326260710028*^9, 3.7373262766464396`*^9}, {
   3.7373263814361596`*^9, 3.7373264672403326`*^9}, {3.7373299995224853`*^9, 
   3.737330005350168*^9}, {3.7373303068913193`*^9, 3.7373304064962945`*^9}, {
   3.7373304544148784`*^9, 3.737330455367939*^9}, {3.7373305400340185`*^9, 
   3.737330602779727*^9}, {3.7373308145152493`*^9, 3.7373308746205125`*^9}, {
   3.7373309061808667`*^9, 3.7373309403660116`*^9}, {3.7373309796289506`*^9, 
   3.737330986878454*^9}, {3.7373310234548798`*^9, 3.7373310446096973`*^9}, {
   3.7373311168547535`*^9, 3.737331210738939*^9}, {3.737331275859481*^9, 
   3.737331342370586*^9}, {3.737331375011425*^9, 3.7373314220863295`*^9}, {
   3.7373314945969763`*^9, 3.737331588028098*^9}, {3.737331625728673*^9, 
   3.737331749702303*^9}, {3.737331794183633*^9, 3.737331797511531*^9}, {
   3.7373318401180134`*^9, 3.737331846258196*^9}, {3.737331947345029*^9, 
   3.7373319506572905`*^9}, {3.737332024699108*^9, 3.7373320277926707`*^9}, {
   3.737332138347581*^9, 3.737332141206763*^9}, {3.737332176969942*^9, 
   3.7373321981872253`*^9}, {3.7373322325911336`*^9, 3.7373322436372547`*^9}, 
   3.7373323062735786`*^9, 3.737332344661604*^9, {3.7373323959549704`*^9, 
   3.737332440858116*^9}, {3.7373697462445135`*^9, 3.737369756134466*^9}, {
   3.73736997800395*^9, 3.737369979863186*^9}, {3.737370033672018*^9, 
   3.7373700934491777`*^9}, {3.737370297154006*^9, 3.7373703073959093`*^9}, {
   3.7373706217373333`*^9, 3.7373706940520153`*^9}, 3.737370770148033*^9, {
   3.7373709099715633`*^9, 3.7373709117995605`*^9}, {3.7373709839098845`*^9, 
   3.737371010861167*^9}, {3.737371171582487*^9, 3.737371183984087*^9}, {
   3.7373712228656225`*^9, 3.7373712520042715`*^9}, {3.7373712949075546`*^9, 
   3.7373712962355995`*^9}, {3.737373653014276*^9, 3.7373736987645917`*^9}, 
   3.737374776950369*^9, {3.7373780013296185`*^9, 3.73737806149739*^9}, {
   3.73737809232342*^9, 3.7373781348829794`*^9}, {3.737378174942737*^9, 
   3.7373782293140383`*^9}, {3.7373783181048107`*^9, 
   3.7373784100360394`*^9}, {3.73737848676515*^9, 3.73737851796614*^9}, {
   3.737378698375668*^9, 3.737378698953754*^9}, {3.7373816246918907`*^9, 
   3.7373816514400773`*^9}, {3.7373838501811275`*^9, 3.737383851587281*^9}},
 CellLabel->
  "In[333]:=",ExpressionUUID->"c987e037-13ad-408e-966e-6e93c1adc458"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLBipedGrid", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<n\>\"", " ", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{"Automatic", "\[Rule]", " ", "9"}], ")"}]}], ",", " ", 
      RowBox[{"BLDrawBiped", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"ImageSize", " ", "\[Rule]", "  ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"BLLaTex", "[", "\"\<text width\>\"", "]"}], ",", " ", 
         RowBox[{"BLLaTex", "[", "\"\<image height\>\"", "]"}]}], "}"}]}], 
      ",", " ", 
      RowBox[{"BLBoundingBox", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"\"\<\[CurlyPhi]\>\"", " ", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "&"}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedGrid", "[", 
     RowBox[{"M_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CurlyPhi]", ",", " ", "x", ",", " ", "c", ",", " ", "n"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "M", " ", "is", " ", "a", " ", "vector", " ", "in", " ", "the", " ",
            "state"}], "-", "time", "-", 
          RowBox[{"control", " ", "space"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"VectorQ", "[", 
          RowBox[{"M", ",", " ", "NumericQ"}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CurlyPhi]", " ", "=", " ", 
          RowBox[{"BLSim", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "M", " ", "is", " ", "a", " ", "pair", " ", "of", " ", 
           "trajectories", " ", 
           RowBox[{"(", 
            RowBox[{
            "manifolds", " ", "have", " ", "interpolation", " ", "errors"}], 
            ")"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"VectorQ", "[", "M", "]"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Length", "@", "M"}], " ", "\[Equal]", " ", "2"}]}], ",", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"\[CurlyPhi]", " ", "=", " ", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<x[t]\>\"", ",", " ", "\"\<c[t]\>\""}], "}"}], " ", 
            "\[Rule]", " ", "M"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"M", " ", "is", " ", "a", " ", "trajectory"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"M", ",", " ", "\"\<x[t]\>\""}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CurlyPhi]", " ", "=", " ", "M"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"M", " ", "is", " ", "a", " ", "manifold"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"M", ",", " ", "\"\<x[s]\>\""}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CurlyPhi]", " ", "=", " ", "M"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"M", " ", "is", " ", "a", " ", "manifold", " ", 
           RowBox[{"(", 
            RowBox[{"output", " ", "of", " ", "continuation", " ", "method"}],
             ")"}]}], " ", "*)"}], "\[IndentingNewLine]", "True", ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CurlyPhi]", " ", "=", " ", 
           RowBox[{"BLManifold", "[", "M", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"\[CurlyPhi]", ",", " ", "\"\<x[t]\>\"", ",", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{"\[CurlyPhi]", ",", " ", "\"\<x[s]\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"\[CurlyPhi]", ",", " ", "\"\<c[t]\>\"", ",", " ", 
          RowBox[{"Lookup", "[", 
           RowBox[{"\[CurlyPhi]", ",", " ", "\"\<c[s]\>\"", ",", " ", 
            RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"BLCreateGridPoints", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<n\>\"", "]"}], " ", "/.", " ", 
           RowBox[{"Automatic", " ", "\[Rule]", " ", "x"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BLBipedGrid", "[", 
        RowBox[{
         RowBox[{"x", "[", "n", "]"}], ",", " ", 
         RowBox[{"c", "[", "n", "]"}], ",", " ", "opts"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BLBipedGrid", "[", 
   RowBox[{
    RowBox[{"x_", "?", "MatrixQ"}], ",", " ", 
    RowBox[{"c_", "?", "MatrixQ"}], ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "is", ",", " ", "d", ",", " ", "o", ",", " ", "n", ",", " ", "t0", ",", 
      " ", "tf"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"image", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"is", " ", "=", "  ", 
      RowBox[{"OptionValue", "[", "ImageSize", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"BLDrawBiped", " ", "options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"BLBoundingBox", "[", 
       RowBox[{"x", ",", " ", "c", ",", " ", 
        RowBox[{"OptionValue", "[", "BLBoundingBox", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ImageSize", "\[Rule]", " ", "is"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", " ", "d"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"o", " ", "=", " ", 
      RowBox[{"Association", "@", 
       RowBox[{"OptionValue", "[", "BLDrawBiped", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"o", "[", "Graphics", "]"}], " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"d", ",", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"o", ",", " ", "Graphics", ",", " ", 
          RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"o", " ", "=", " ", 
      RowBox[{"Normal", "@", "o"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"d", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "\"\<\[CurlyPhi]\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"create", " ", "grid"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BLDrawBiped", "[", 
         RowBox[{"##", ",", " ", 
          RowBox[{"\"\<\[CurlyPhi]\>\"", " ", "\[Rule]", " ", 
           RowBox[{"d", "[", 
            RowBox[{"#2", ",", " ", "c"}], "]"}]}], ",", " ", "o"}], "]"}], 
        "&"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "c"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, 
   3.6968781986494007`*^9, {3.696878504573948*^9, 3.696878628425725*^9}, {
   3.696878671270988*^9, 3.6968787581074247`*^9}, {3.6968788322547226`*^9, 
   3.696878847707986*^9}, {3.696878877880124*^9, 3.696878929150913*^9}, {
   3.696879048128265*^9, 3.6968790482063875`*^9}, {3.6968790789382405`*^9, 
   3.6968791449965725`*^9}, {3.6968792398396196`*^9, 
   3.6968792799173737`*^9}, {3.69687938273899*^9, 3.696879394051574*^9}, 
   3.6968794269201946`*^9, {3.696879529191115*^9, 3.6968795297379932`*^9}, {
   3.6968795627373867`*^9, 3.6968795907353067`*^9}, {3.6968796220181103`*^9, 
   3.696879622424399*^9}, {3.699973212543885*^9, 3.699973215101559*^9}, {
   3.7157953012239027`*^9, 3.7157953025989213`*^9}, {3.715795529555254*^9, 
   3.7157955330396643`*^9}, {3.7157958155748863`*^9, 
   3.7157958169967823`*^9}, {3.715795867356866*^9, 3.7157959359203296`*^9}, {
   3.715796068765946*^9, 3.715796245299679*^9}, {3.7157963093318295`*^9, 
   3.7157963169725637`*^9}, {3.715796410708272*^9, 3.715796460146452*^9}, {
   3.7157965133815765`*^9, 3.7157965253192596`*^9}, {3.730422145508054*^9, 
   3.730422199758527*^9}, {3.730422284993619*^9, 3.73042228619674*^9}, {
   3.730422349322275*^9, 3.730422414432195*^9}, {3.730422459104444*^9, 
   3.7304225039485683`*^9}, {3.73042263343151*^9, 3.730422669119306*^9}, {
   3.730422699900817*^9, 3.730422716275941*^9}, {3.730422759260687*^9, 
   3.7304228449020305`*^9}, {3.7304229411840687`*^9, 
   3.7304229442466097`*^9}, {3.730423010278412*^9, 3.7304230133096714`*^9}, {
   3.730423086075921*^9, 3.730423112857379*^9}, {3.730423179576703*^9, 
   3.7304231985768614`*^9}, {3.7304232605148635`*^9, 3.73042330190584*^9}, {
   3.7304233678241296`*^9, 3.7304233683397264`*^9}, {3.73042345352262*^9, 
   3.7304234742571497`*^9}, {3.730423543273368*^9, 3.730423574033922*^9}, {
   3.7304236581127157`*^9, 3.7304236591439905`*^9}, {3.7304640132992315`*^9, 
   3.7304640151117783`*^9}, {3.7331014769846296`*^9, 
   3.7331014885628777`*^9}, {3.7372952504344816`*^9, 3.737295261027506*^9}, {
   3.7372955094792547`*^9, 3.7372956549693303`*^9}, {3.7372957322296376`*^9, 
   3.737295763870722*^9}, 3.7373103671091146`*^9, {3.737313131025056*^9, 
   3.737313154648444*^9}, {3.737313988827631*^9, 3.7373139947334332`*^9}, {
   3.7373141364772005`*^9, 3.7373141369927745`*^9}, {3.737322161564064*^9, 
   3.7373221624858713`*^9}, {3.7373224825686636`*^9, 3.737322539026576*^9}, {
   3.7373226756458516`*^9, 3.7373226891136637`*^9}, {3.737322735268933*^9, 
   3.7373227520334167`*^9}, {3.7373229082005386`*^9, 
   3.7373229314413266`*^9}, {3.73732299296926*^9, 3.737322997112234*^9}, {
   3.7373231616208954`*^9, 3.7373231688547792`*^9}, {3.7373233366265783`*^9, 
   3.737323364249689*^9}, {3.737323399278543*^9, 3.737323567392021*^9}, {
   3.737324485269184*^9, 3.7373245058396487`*^9}, {3.737324622691033*^9, 
   3.7373247203856697`*^9}, {3.737324812363782*^9, 3.7373248768023186`*^9}, {
   3.7373249349389825`*^9, 3.737325048321848*^9}, {3.7373251475531044`*^9, 
   3.737325221585741*^9}, {3.7373259178897395`*^9, 3.737325919405276*^9}, {
   3.737326031022622*^9, 3.7373261466709585`*^9}, {3.737326188652477*^9, 
   3.737326194355197*^9}, {3.737326260710028*^9, 3.7373262766464396`*^9}, {
   3.7373263814361596`*^9, 3.7373264672403326`*^9}, {3.7373299995224853`*^9, 
   3.737330005350168*^9}, {3.7373303068913193`*^9, 3.7373304064962945`*^9}, {
   3.7373304544148784`*^9, 3.737330455367939*^9}, {3.7373305400340185`*^9, 
   3.737330602779727*^9}, {3.7373308145152493`*^9, 3.7373308746205125`*^9}, {
   3.7373309061808667`*^9, 3.7373309403660116`*^9}, {3.7373309796289506`*^9, 
   3.737330986878454*^9}, {3.7373310234548798`*^9, 3.7373310446096973`*^9}, {
   3.7373311168547535`*^9, 3.737331210738939*^9}, {3.737331275859481*^9, 
   3.737331342370586*^9}, {3.737331375011425*^9, 3.7373314220863295`*^9}, {
   3.7373314945969763`*^9, 3.737331588028098*^9}, {3.737331625728673*^9, 
   3.737331749702303*^9}, {3.737331794183633*^9, 3.737331797511531*^9}, {
   3.7373318401180134`*^9, 3.737331846258196*^9}, {3.737331947345029*^9, 
   3.7373319506572905`*^9}, {3.737332024699108*^9, 3.7373320277926707`*^9}, {
   3.737332138347581*^9, 3.737332141206763*^9}, {3.737332176969942*^9, 
   3.7373321981872253`*^9}, {3.7373322325911336`*^9, 3.7373322436372547`*^9}, 
   3.7373323062735786`*^9, 3.737332344661604*^9, {3.7373323959549704`*^9, 
   3.737332440858116*^9}, {3.7373697462445135`*^9, 3.7373697828923035`*^9}, {
   3.7373698286391735`*^9, 3.7373698292485065`*^9}, {3.7373739482163086`*^9, 
   3.7373739823858137`*^9}, {3.737374030288786*^9, 3.7373740332573404`*^9}, {
   3.7373740730202665`*^9, 3.737374141343687*^9}, {3.73737417315401*^9, 
   3.737374250095791*^9}, {3.7373742932959604`*^9, 3.7373743099042006`*^9}, {
   3.7373743779307923`*^9, 3.7373744344425516`*^9}, {3.7373744935166597`*^9, 
   3.737374669457719*^9}, {3.7373748723657103`*^9, 3.737374894567315*^9}, {
   3.737374931955413*^9, 3.7373749372675047`*^9}, {3.737374974577466*^9, 
   3.7373750086220016`*^9}, {3.737375126442073*^9, 3.737375159299199*^9}, {
   3.737375277056767*^9, 3.737375462893374*^9}, {3.7373755055081124`*^9, 
   3.7373755202102327`*^9}, {3.737375555910914*^9, 3.7373756347336445`*^9}, {
   3.737375875424919*^9, 3.7373759324210014`*^9}, {3.7373760396800346`*^9, 
   3.7373760489762754`*^9}, {3.7373761164404078`*^9, 3.737376121283826*^9}, {
   3.7373762161210866`*^9, 3.737376284397664*^9}, {3.737376430184578*^9, 
   3.7373764363456717`*^9}, {3.7373765234334483`*^9, 3.737376527683179*^9}, {
   3.7373766336771717`*^9, 3.737376637364445*^9}, {3.7373766783303747`*^9, 
   3.7373770319780493`*^9}, {3.7373770630384474`*^9, 
   3.7373771081290884`*^9}, {3.7373771537665973`*^9, 
   3.7373772033881903`*^9}, {3.7373773661115556`*^9, 
   3.7373773742047544`*^9}, {3.73737741928926*^9, 3.737377422164095*^9}, {
   3.7373774840192366`*^9, 3.73737757634103*^9}, {3.7373785504170427`*^9, 
   3.7373785733998528`*^9}, {3.7373786126315365`*^9, 3.7373786174593306`*^9}, 
   3.7373787045939765`*^9, {3.7373789138921547`*^9, 3.7373789194607754`*^9}, {
   3.737380469317665*^9, 3.7373804949877872`*^9}, {3.7373805274386883`*^9, 
   3.7373805812162576`*^9}, {3.7373819324923425`*^9, 
   3.7373819377107353`*^9}, {3.737381973733954*^9, 3.7373820822101507`*^9}, {
   3.7373821534240274`*^9, 3.7373822549795837`*^9}, {3.737382636871793*^9, 
   3.7373826568389716`*^9}, {3.737382716073601*^9, 3.737382717760998*^9}, {
   3.7373830154281178`*^9, 3.73738302564619*^9}, {3.7373831135348954`*^9, 
   3.7373831556758842`*^9}, {3.737383187189353*^9, 3.7373831880955367`*^9}, {
   3.7373832651460743`*^9, 3.7373832925973434`*^9}, {3.7373833342405367`*^9, 
   3.737383334709255*^9}, {3.7373835823798084`*^9, 3.7373835989894595`*^9}, {
   3.737385230348874*^9, 3.7373852338174024`*^9}, {3.7373867636809793`*^9, 
   3.7373867707586355`*^9}, {3.73738682256433*^9, 3.7373868401568766`*^9}, {
   3.737386972944666*^9, 3.7373869832252116`*^9}, {3.737387238779995*^9, 
   3.7373872834019113`*^9}, {3.7373873224461155`*^9, 3.737387334523428*^9}, {
   3.7373873788172703`*^9, 3.7373873891290503`*^9}, {3.7373874243766565`*^9, 
   3.737387629243641*^9}, {3.7373876925361843`*^9, 3.7373876956141157`*^9}, {
   3.737387748516728*^9, 3.737387771593275*^9}, {3.737387823074112*^9, 
   3.7373878270738525`*^9}, {3.7373878596497498`*^9, 
   3.7373878858042145`*^9}, {3.737895915197689*^9, 3.737895918994337*^9}, {
   3.737898442652791*^9, 3.737898442809016*^9}, {3.737902665410061*^9, 
   3.73790267278458*^9}, {3.7379027650435658`*^9, 3.7379028072592974`*^9}, {
   3.7379028453111715`*^9, 3.7379028479828424`*^9}, {3.737902950857033*^9, 
   3.737902997431842*^9}, {3.737903270557232*^9, 3.737903270697879*^9}, {
   3.737905455741523*^9, 3.7379054616629953`*^9}, 3.761998090977086*^9, {
   3.761998141176445*^9, 3.7619981452074013`*^9}, {3.7619981815797153`*^9, 
   3.761998229783886*^9}, {3.7619982766976657`*^9, 3.761998293074488*^9}, {
   3.7619988337064857`*^9, 3.761998849580315*^9}, {3.761999328189029*^9, 
   3.7619994093643875`*^9}, 3.7619994745477705`*^9, {3.7620006255330987`*^9, 
   3.762000626658013*^9}, 3.7620135795041013`*^9, {3.7620136696224413`*^9, 
   3.76201369430385*^9}, {3.7629850212357492`*^9, 3.76298502877787*^9}, {
   3.762985061099207*^9, 3.7629851066634817`*^9}},
 CellLabel->
  "In[336]:=",ExpressionUUID->"aac6c8bc-6e19-461f-8a55-f1ed9085c2a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedTimeGridStringFunction", "[", "\"\<Path\>\"", "]"}], " ", 
    ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
          "\"\<p = p(0)\>\"", ",", " ", 
          RowBox[{"#", " ", "\[Equal]", " ", "1"}], ",", " ", "\"\<p(1)\>\"", 
          ",", " ", "True", ",", " ", 
          RowBox[{"\"\<p(\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"N", "@", "#"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}], " ", "<>", " ", 
           "\"\<)\>\""}]}], "]"}], "&"}], ")"}], ",", " ", "True"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedTimeGridStringFunction", "[", "\"\<ArcLength\>\"", "]"}], 
    " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
           "\"\<\\\\alpha = \>\"", ",", " ", "\"\<\>\""}], "]"}], " ", "<>", 
         " ", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<\\\\alpha_{``}\>\"", ",", " ", 
            RowBox[{"ToString", "@", 
             RowBox[{"Round", "[", "#", "]"}]}]}], "]"}]}]}], "&"}], ")"}], 
      ",", " ", "False"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLBipedTimeGridStringFunction", "[", "\"\<Trajectory\>\"", "]"}], 
   " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
         "\"\<t = \\\\SI{0}{s}\>\"", ",", " ", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<\\\\SI{``}{s}\>\"", ",", " ", 
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"N", "@", "#"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}], 
       "&"}], ")"}], ",", " ", "False"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "BLBipedTimeGridStringFunction", "[", "\"\<SwitchingTime\>\"", "]"}], " ", 
   ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
         "\"\<t = \\\\SI{0}{s}\>\"", ",", " ", 
         RowBox[{"#", " ", "\[Equal]", " ", "1"}], ",", " ", 
         "\"\<\\\\tau \\\\in \\\\mathbb{R}\>\"", ",", " ", "True", ",", " ", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<\\\\SI{``}{\\\\tau}\>\"", ",", " ", 
           RowBox[{"ToString", "@", 
            RowBox[{"NumberForm", "[", 
             RowBox[{
              RowBox[{"N", "@", "#"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}], 
       "&"}], ")"}], ",", " ", "True"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, 
   3.6968781986494007`*^9, {3.696878504573948*^9, 3.696878628425725*^9}, {
   3.696878671270988*^9, 3.6968787581074247`*^9}, {3.6968788322547226`*^9, 
   3.696878847707986*^9}, {3.696878877880124*^9, 3.696878929150913*^9}, {
   3.696879048128265*^9, 3.6968790482063875`*^9}, {3.6968790789382405`*^9, 
   3.6968791449965725`*^9}, {3.6968792398396196`*^9, 
   3.6968792799173737`*^9}, {3.69687938273899*^9, 3.696879394051574*^9}, 
   3.6968794269201946`*^9, {3.696879529191115*^9, 3.6968795297379932`*^9}, {
   3.6968795627373867`*^9, 3.6968795907353067`*^9}, {3.6968796220181103`*^9, 
   3.696879622424399*^9}, {3.699973212543885*^9, 3.699973215101559*^9}, {
   3.7157953012239027`*^9, 3.7157953025989213`*^9}, {3.715795529555254*^9, 
   3.7157955330396643`*^9}, {3.7157958155748863`*^9, 
   3.7157958169967823`*^9}, {3.715795867356866*^9, 3.7157959359203296`*^9}, {
   3.715796068765946*^9, 3.715796245299679*^9}, {3.7157963093318295`*^9, 
   3.7157963169725637`*^9}, {3.715796410708272*^9, 3.715796460146452*^9}, {
   3.7157965133815765`*^9, 3.7157965253192596`*^9}, {3.730422145508054*^9, 
   3.730422199758527*^9}, {3.730422284993619*^9, 3.73042228619674*^9}, {
   3.730422349322275*^9, 3.730422414432195*^9}, {3.730422459104444*^9, 
   3.7304225039485683`*^9}, {3.73042263343151*^9, 3.730422669119306*^9}, {
   3.730422699900817*^9, 3.730422716275941*^9}, {3.730422759260687*^9, 
   3.7304228449020305`*^9}, {3.7304229411840687`*^9, 
   3.7304229442466097`*^9}, {3.730423010278412*^9, 3.7304230133096714`*^9}, {
   3.730423086075921*^9, 3.730423112857379*^9}, {3.730423179576703*^9, 
   3.7304231985768614`*^9}, {3.7304232605148635`*^9, 3.73042330190584*^9}, {
   3.7304233678241296`*^9, 3.7304233683397264`*^9}, {3.73042345352262*^9, 
   3.7304234742571497`*^9}, {3.730423543273368*^9, 3.730423574033922*^9}, {
   3.7304236581127157`*^9, 3.7304236591439905`*^9}, {3.7304640132992315`*^9, 
   3.7304640151117783`*^9}, {3.7331014769846296`*^9, 
   3.7331014885628777`*^9}, {3.7372952504344816`*^9, 3.737295261027506*^9}, {
   3.7372955094792547`*^9, 3.7372956549693303`*^9}, {3.7372957322296376`*^9, 
   3.737295763870722*^9}, 3.7373103671091146`*^9, {3.737313131025056*^9, 
   3.737313154648444*^9}, {3.737313988827631*^9, 3.7373139947334332`*^9}, {
   3.7373141364772005`*^9, 3.7373141369927745`*^9}, {3.737322161564064*^9, 
   3.7373221624858713`*^9}, {3.7373224825686636`*^9, 3.737322539026576*^9}, {
   3.7373226756458516`*^9, 3.7373226891136637`*^9}, {3.737322735268933*^9, 
   3.7373227520334167`*^9}, {3.7373229082005386`*^9, 
   3.7373229314413266`*^9}, {3.73732299296926*^9, 3.737322997112234*^9}, {
   3.7373231616208954`*^9, 3.7373231688547792`*^9}, {3.7373233366265783`*^9, 
   3.737323364249689*^9}, {3.737323399278543*^9, 3.737323567392021*^9}, {
   3.737324485269184*^9, 3.7373245058396487`*^9}, {3.737324622691033*^9, 
   3.7373247203856697`*^9}, {3.737324812363782*^9, 3.7373248768023186`*^9}, {
   3.7373249349389825`*^9, 3.737325048321848*^9}, {3.7373251475531044`*^9, 
   3.737325221585741*^9}, {3.7373259178897395`*^9, 3.737325919405276*^9}, {
   3.737326031022622*^9, 3.7373261466709585`*^9}, {3.737326188652477*^9, 
   3.737326194355197*^9}, {3.737326260710028*^9, 3.7373262766464396`*^9}, {
   3.7373263814361596`*^9, 3.7373264672403326`*^9}, {3.7373299995224853`*^9, 
   3.737330005350168*^9}, {3.7373303068913193`*^9, 3.7373304064962945`*^9}, {
   3.7373304544148784`*^9, 3.737330455367939*^9}, {3.7373305400340185`*^9, 
   3.737330602779727*^9}, {3.7373308145152493`*^9, 3.7373308746205125`*^9}, {
   3.7373309061808667`*^9, 3.7373309403660116`*^9}, {3.7373309796289506`*^9, 
   3.737330986878454*^9}, {3.7373310234548798`*^9, 3.7373310446096973`*^9}, {
   3.7373311168547535`*^9, 3.737331210738939*^9}, {3.737331275859481*^9, 
   3.737331342370586*^9}, {3.737331375011425*^9, 3.7373314220863295`*^9}, {
   3.7373314945969763`*^9, 3.737331588028098*^9}, {3.737331625728673*^9, 
   3.737331749702303*^9}, {3.737331794183633*^9, 3.737331797511531*^9}, {
   3.7373318401180134`*^9, 3.737331846258196*^9}, {3.737331947345029*^9, 
   3.7373319506572905`*^9}, {3.737332024699108*^9, 3.7373320277926707`*^9}, {
   3.737332138347581*^9, 3.737332141206763*^9}, {3.737332176969942*^9, 
   3.7373321981872253`*^9}, {3.7373322325911336`*^9, 3.7373322436372547`*^9}, 
   3.7373323062735786`*^9, 3.737332344661604*^9, {3.7373323959549704`*^9, 
   3.737332440858116*^9}, {3.7373697462445135`*^9, 3.7373697828923035`*^9}, {
   3.7373698286391735`*^9, 3.7373698292485065`*^9}, {3.7373739482163086`*^9, 
   3.7373739823858137`*^9}, {3.737374030288786*^9, 3.7373740332573404`*^9}, {
   3.7373740730202665`*^9, 3.737374141343687*^9}, {3.73737417315401*^9, 
   3.737374250095791*^9}, {3.7373742932959604`*^9, 3.7373743099042006`*^9}, {
   3.7373743779307923`*^9, 3.7373744344425516`*^9}, {3.7373744935166597`*^9, 
   3.737374669457719*^9}, {3.7373748723657103`*^9, 3.737374894567315*^9}, {
   3.737374931955413*^9, 3.7373749372675047`*^9}, {3.737374974577466*^9, 
   3.7373750086220016`*^9}, {3.737375126442073*^9, 3.737375159299199*^9}, {
   3.737375277056767*^9, 3.737375462893374*^9}, {3.7373755055081124`*^9, 
   3.7373755202102327`*^9}, {3.737375555910914*^9, 3.7373756347336445`*^9}, {
   3.737375875424919*^9, 3.7373759324210014`*^9}, {3.7373760396800346`*^9, 
   3.7373760489762754`*^9}, {3.7373761164404078`*^9, 3.737376121283826*^9}, {
   3.7373762161210866`*^9, 3.737376284397664*^9}, {3.737376430184578*^9, 
   3.7373764363456717`*^9}, {3.7373765234334483`*^9, 3.737376527683179*^9}, {
   3.7373766336771717`*^9, 3.737376637364445*^9}, {3.7373766783303747`*^9, 
   3.7373770319780493`*^9}, {3.7373770630384474`*^9, 
   3.7373771081290884`*^9}, {3.7373771537665973`*^9, 
   3.7373772033881903`*^9}, {3.7373773661115556`*^9, 
   3.7373773742047544`*^9}, {3.73737741928926*^9, 3.737377422164095*^9}, {
   3.7373774840192366`*^9, 3.73737757634103*^9}, {3.7373785504170427`*^9, 
   3.7373785733998528`*^9}, {3.7373786126315365`*^9, 3.7373786174593306`*^9}, 
   3.7373787045939765`*^9, {3.7373789138921547`*^9, 3.7373789194607754`*^9}, {
   3.737380469317665*^9, 3.7373804949877872`*^9}, {3.7373805274386883`*^9, 
   3.7373805812162576`*^9}, {3.7373819324923425`*^9, 
   3.7373819377107353`*^9}, {3.737381973733954*^9, 3.7373820822101507`*^9}, {
   3.7373821534240274`*^9, 3.7373822549795837`*^9}, {3.737382636871793*^9, 
   3.7373826568389716`*^9}, {3.737382716073601*^9, 3.737382717760998*^9}, {
   3.7373830154281178`*^9, 3.73738302564619*^9}, {3.7373831135348954`*^9, 
   3.7373831556758842`*^9}, {3.737383187189353*^9, 3.7373831880955367`*^9}, {
   3.7373832651460743`*^9, 3.7373832925973434`*^9}, {3.7373833342405367`*^9, 
   3.737383334709255*^9}, {3.7373835823798084`*^9, 3.7373835989894595`*^9}, {
   3.737385230348874*^9, 3.7373853047931504`*^9}, {3.7373853359003935`*^9, 
   3.737385457760353*^9}, {3.7373855513789644`*^9, 3.737385639866916*^9}, {
   3.737385676926886*^9, 3.7373857451931925`*^9}, {3.7373857922055845`*^9, 
   3.7373858286562457`*^9}, {3.737385873043791*^9, 3.7373858737468805`*^9}, {
   3.7373859224935613`*^9, 3.7373859408673105`*^9}, {3.737386204892682*^9, 
   3.7373862050489225`*^9}, {3.7373865475098577`*^9, 
   3.7373865692099295`*^9}, {3.737388075759947*^9, 3.737388080103431*^9}, {
   3.7373881755552273`*^9, 3.7373882754233932`*^9}, {3.7373886627116528`*^9, 
   3.737388673539055*^9}, {3.7373887127687664`*^9, 3.737388713081215*^9}, {
   3.7373889357691*^9, 3.737388992280888*^9}, {3.737389212892622*^9, 
   3.7373892390782967`*^9}, {3.7373894518762507`*^9, 
   3.7373894520793467`*^9}, {3.7373894854677024`*^9, 
   3.7373895530568333`*^9}, {3.7374062378685083`*^9, 
   3.7374062383841085`*^9}, {3.7913948181083117`*^9, 3.7913948300927267`*^9}, 
   3.791394874684197*^9, {3.791396060844571*^9, 3.79139609730182*^9}, 
   3.7913961431022577`*^9, {3.791396678362989*^9, 3.7913966866579742`*^9}, {
   3.79145821983407*^9, 3.791458222741898*^9}, {3.791458615891741*^9, 
   3.791458625949381*^9}, {3.791458839892256*^9, 3.7914589596177893`*^9}, {
   3.791458993645103*^9, 3.791459010528295*^9}, {3.7914591142182417`*^9, 
   3.7914591226658*^9}, {3.7914593227055492`*^9, 3.791459344036618*^9}, {
   3.7914597540825872`*^9, 3.791459829876588*^9}, {3.791459877662148*^9, 
   3.791459887273785*^9}, {3.791459971029191*^9, 3.7914600069209633`*^9}, {
   3.7914601392277613`*^9, 3.79146018260495*^9}, {3.791460339787809*^9, 
   3.791460437480878*^9}, 3.79146285175255*^9, {3.791462902641575*^9, 
   3.791462924192957*^9}, {3.7914630016273317`*^9, 3.7914630311096563`*^9}, {
   3.791463192999301*^9, 3.791463194412108*^9}, {3.791463251874971*^9, 
   3.791463269588646*^9}, {3.799718891464472*^9, 3.799718891832823*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"2071aeb5-8298-4af6-9558-a3df5a5b930a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLBipedTimeGrid", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\"\<d\>\"", " ", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", " ", "3"}], "}"}]}], ","}], " ", 
      "*)"}], 
     RowBox[{
      RowBox[{"\"\<n\>\"", " ", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{"Automatic", "\[Rule]", " ", "9"}], ")"}]}], ",", " ", 
      RowBox[{"\"\<T\>\"", " ", "\[Rule]", " ", "\"\<Trajectory\>\""}], ",", 
      " ", 
      RowBox[{"ImageSize", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"5", 
         RowBox[{"(*", "16", "*)"}], ",", " ", 
         RowBox[{"1", "/", "3"}], ",", " ", 
         RowBox[{"1", "/", "15"}]}], "}"}]}], ",", " ", 
      RowBox[{"BLBipedGrid", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"ImageData", " ", "\[Rule]", " ", "False"}], ",", " ", 
      RowBox[{"ImageCrop", " ", "\[Rule]", " ", "False"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedTimeGrid", "[", 
     RowBox[{"M_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[CurlyPhi]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "M", "]"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CurlyPhi]", " ", "=", " ", 
          RowBox[{"BLSim", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BLBipedTimeGrid", "[", 
          RowBox[{
           RowBox[{"\[CurlyPhi]", "[", "\"\<x[t]\>\"", "]"}], ",", " ", 
           RowBox[{"\[CurlyPhi]", "[", "\"\<c[t]\>\"", "]"}], ",", " ", 
           "opts"}], "]"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CurlyPhi]", " ", "=", " ", 
          RowBox[{"BLManifold", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BLBipedTimeGrid", "[", 
          RowBox[{
           RowBox[{"\[CurlyPhi]", "[", "\"\<x[s]\>\"", "]"}], ",", " ", 
           RowBox[{"\[CurlyPhi]", "[", "\"\<c[s]\>\"", "]"}], ",", " ", 
           "opts", ",", " ", 
           RowBox[{"\"\<T\>\"", " ", "\[Rule]", " ", "\"\<Path\>\""}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLBipedTimeGrid", "[", 
    RowBox[{"x_", ",", " ", "c_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "t", ",", " ", "grid", ",", " ", "arrow", ",", " ", "T", ",", " ", 
       "time", ",", " ", "motion", ",", " ", "o", ",", " ", "n", ",", " ", 
       "ts", ",", " ", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"image", " ", "size"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ts", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", 
         RowBox[{"BLLaTex", "[", "\"\<text width\>\"", "]"}], ",", " ", 
         RowBox[{"BLLaTex", "[", "\"\<image height\>\"", "]"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ts", " ", "=", " ", 
       RowBox[{
        RowBox[{"OptionValue", "[", "ImageSize", "]"}], " ", "ts"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"time", " ", "grid", " ", "values"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"t", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<n\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"time", " ", "to", " ", "string", " ", "function"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T", ",", " ", "n"}], "}"}], " ", "=", " ", 
       RowBox[{"BLBipedTimeGridStringFunction", "@", 
        RowBox[{"OptionValue", "[", "\"\<T\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "&&", " ", 
         RowBox[{"VectorQ", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"create", " ", "time", " ", "grid"}], ",", " ", 
          RowBox[{"make", " ", "sure", " ", "n", " ", 
           RowBox[{"in", " ", "[", 
            RowBox[{"0", ",", " ", "1"}], "]"}], " ", "using", " ", "values", 
           " ", "in", " ", "t"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"MinMax", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"PossibleZeroQ", "[", 
             RowBox[{
              RowBox[{
              "n", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", " ", 
            RowBox[{"{", "0", "}"}], ",", " ", 
            RowBox[{"Chop", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "-", 
                RowBox[{
                "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "n", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "-", 
                RowBox[{
                "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                ")"}]}], "]"}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", "n", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "create", " ", "time", " ", "grid", " ", "with", " ", "n", " ", 
           RowBox[{"in", " ", "[", 
            RowBox[{"0", ",", " ", "1"}], "]"}], " ", "using", " ", 
           RowBox[{
           "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], " ",
           "=", " ", 
          RowBox[{"#", " ", "of", " ", "points"}]}], "  ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"BLCreateGridPoints", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{
            "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", "True",
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"use", " ", "regular", " ", "grid", " ", "points"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", " ", "=", " ", 
          RowBox[{"BLCreateGridPoints", "[", 
           RowBox[{"t", " ", "/.", " ", 
            RowBox[{"Automatic", " ", "\[Rule]", " ", "x"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"time", " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"time", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"BLTeX", "[", 
            RowBox[{
             RowBox[{"T", "[", "s", "]"}], ",", " ", 
             RowBox[{
             "ts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", " ", 
           RowBox[{"ImageSize", "\[Rule]", " ", 
            RowBox[{"ts", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;", "3"}], "\[RightDoubleBracket]"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"motion", " ", "list"}], ",", " ", 
        RowBox[{
        "use", " ", "our", " ", "time", " ", "grid", " ", "values"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"motion", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "ImageData", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "motion", "]"}], ",", " ", 
        RowBox[{"motion", " ", "=", " ", 
         RowBox[{"BLImportFrom", "[", 
          RowBox[{"\"\<Images\>\"", ",", " ", "motion"}], "]"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"VectorQ", "[", "motion", "]"}], " ", "&&", " ", 
         RowBox[{
          RowBox[{"Length", "@", "motion"}], " ", "\[Equal]", " ", 
          RowBox[{"Length", "@", "time"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"motion", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Image", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"Magnification", "\[Rule]", "1"}]}], "]"}], "&"}], " ", 
           "/@", " ", "motion"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"motion", " ", "=", " ", 
          RowBox[{"BLBipedGrid", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", " ", "c"}], "}"}], ",", " ", 
            RowBox[{"\"\<n\>\"", " ", "\[Rule]", " ", "t"}], ",", " ", 
            RowBox[{"OptionValue", "[", "BLBipedGrid", "]"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "ImageCrop", "]"}], ",", " ", 
        RowBox[{"motion", " ", "=", " ", 
         RowBox[{"ImageCrop", " ", "/@", " ", "motion"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"time", ",", " ", "motion"}], "}"}], ",", " ", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", " ", 
        RowBox[{"Dividers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", " ", 
           RowBox[{"Flatten", "@", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Directive", "[", 
                 RowBox[{"Thick", ",", " ", "Black"}], "]"}], ",", " ", 
                "Gray"}], "}"}], ",", " ", "3"}], "]"}]}]}], "}"}]}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, 
   3.6968781986494007`*^9, {3.696878504573948*^9, 3.696878628425725*^9}, {
   3.696878671270988*^9, 3.6968787581074247`*^9}, {3.6968788322547226`*^9, 
   3.696878847707986*^9}, {3.696878877880124*^9, 3.696878929150913*^9}, {
   3.696879048128265*^9, 3.6968790482063875`*^9}, {3.6968790789382405`*^9, 
   3.6968791449965725`*^9}, {3.6968792398396196`*^9, 
   3.6968792799173737`*^9}, {3.69687938273899*^9, 3.696879394051574*^9}, 
   3.6968794269201946`*^9, {3.696879529191115*^9, 3.6968795297379932`*^9}, {
   3.6968795627373867`*^9, 3.6968795907353067`*^9}, {3.6968796220181103`*^9, 
   3.696879622424399*^9}, {3.699973212543885*^9, 3.699973215101559*^9}, {
   3.7157953012239027`*^9, 3.7157953025989213`*^9}, {3.715795529555254*^9, 
   3.7157955330396643`*^9}, {3.7157958155748863`*^9, 
   3.7157958169967823`*^9}, {3.715795867356866*^9, 3.7157959359203296`*^9}, {
   3.715796068765946*^9, 3.715796245299679*^9}, {3.7157963093318295`*^9, 
   3.7157963169725637`*^9}, {3.715796410708272*^9, 3.715796460146452*^9}, {
   3.7157965133815765`*^9, 3.7157965253192596`*^9}, {3.730422145508054*^9, 
   3.730422199758527*^9}, {3.730422284993619*^9, 3.73042228619674*^9}, {
   3.730422349322275*^9, 3.730422414432195*^9}, {3.730422459104444*^9, 
   3.7304225039485683`*^9}, {3.73042263343151*^9, 3.730422669119306*^9}, {
   3.730422699900817*^9, 3.730422716275941*^9}, {3.730422759260687*^9, 
   3.7304228449020305`*^9}, {3.7304229411840687`*^9, 
   3.7304229442466097`*^9}, {3.730423010278412*^9, 3.7304230133096714`*^9}, {
   3.730423086075921*^9, 3.730423112857379*^9}, {3.730423179576703*^9, 
   3.7304231985768614`*^9}, {3.7304232605148635`*^9, 3.73042330190584*^9}, {
   3.7304233678241296`*^9, 3.7304233683397264`*^9}, {3.73042345352262*^9, 
   3.7304234742571497`*^9}, {3.730423543273368*^9, 3.730423574033922*^9}, {
   3.7304236581127157`*^9, 3.7304236591439905`*^9}, {3.7304640132992315`*^9, 
   3.7304640151117783`*^9}, {3.7331014769846296`*^9, 
   3.7331014885628777`*^9}, {3.7372952504344816`*^9, 3.737295261027506*^9}, {
   3.7372955094792547`*^9, 3.7372956549693303`*^9}, {3.7372957322296376`*^9, 
   3.737295763870722*^9}, 3.7373103671091146`*^9, {3.737313131025056*^9, 
   3.737313154648444*^9}, {3.737313988827631*^9, 3.7373139947334332`*^9}, {
   3.7373141364772005`*^9, 3.7373141369927745`*^9}, {3.737322161564064*^9, 
   3.7373221624858713`*^9}, {3.7373224825686636`*^9, 3.737322539026576*^9}, {
   3.7373226756458516`*^9, 3.7373226891136637`*^9}, {3.737322735268933*^9, 
   3.7373227520334167`*^9}, {3.7373229082005386`*^9, 
   3.7373229314413266`*^9}, {3.73732299296926*^9, 3.737322997112234*^9}, {
   3.7373231616208954`*^9, 3.7373231688547792`*^9}, {3.7373233366265783`*^9, 
   3.737323364249689*^9}, {3.737323399278543*^9, 3.737323567392021*^9}, {
   3.737324485269184*^9, 3.7373245058396487`*^9}, {3.737324622691033*^9, 
   3.7373247203856697`*^9}, {3.737324812363782*^9, 3.7373248768023186`*^9}, {
   3.7373249349389825`*^9, 3.737325048321848*^9}, {3.7373251475531044`*^9, 
   3.737325221585741*^9}, {3.7373259178897395`*^9, 3.737325919405276*^9}, {
   3.737326031022622*^9, 3.7373261466709585`*^9}, {3.737326188652477*^9, 
   3.737326194355197*^9}, {3.737326260710028*^9, 3.7373262766464396`*^9}, {
   3.7373263814361596`*^9, 3.7373264672403326`*^9}, {3.7373299995224853`*^9, 
   3.737330005350168*^9}, {3.7373303068913193`*^9, 3.7373304064962945`*^9}, {
   3.7373304544148784`*^9, 3.737330455367939*^9}, {3.7373305400340185`*^9, 
   3.737330602779727*^9}, {3.7373308145152493`*^9, 3.7373308746205125`*^9}, {
   3.7373309061808667`*^9, 3.7373309403660116`*^9}, {3.7373309796289506`*^9, 
   3.737330986878454*^9}, {3.7373310234548798`*^9, 3.7373310446096973`*^9}, {
   3.7373311168547535`*^9, 3.737331210738939*^9}, {3.737331275859481*^9, 
   3.737331342370586*^9}, {3.737331375011425*^9, 3.7373314220863295`*^9}, {
   3.7373314945969763`*^9, 3.737331588028098*^9}, {3.737331625728673*^9, 
   3.737331749702303*^9}, {3.737331794183633*^9, 3.737331797511531*^9}, {
   3.7373318401180134`*^9, 3.737331846258196*^9}, {3.737331947345029*^9, 
   3.7373319506572905`*^9}, {3.737332024699108*^9, 3.7373320277926707`*^9}, {
   3.737332138347581*^9, 3.737332141206763*^9}, {3.737332176969942*^9, 
   3.7373321981872253`*^9}, {3.7373322325911336`*^9, 3.7373322436372547`*^9}, 
   3.7373323062735786`*^9, 3.737332344661604*^9, {3.7373323959549704`*^9, 
   3.737332440858116*^9}, 3.7373697462445135`*^9, {3.7373708288627663`*^9, 
   3.7373708410963*^9}, {3.73737568535518*^9, 3.7373756857613907`*^9}, {
   3.7373757771660013`*^9, 3.737375795039774*^9}, {3.737378803243493*^9, 
   3.737378816476962*^9}, {3.7373788610676613`*^9, 3.737378885487849*^9}, {
   3.737378985112522*^9, 3.737378985862481*^9}, {3.737379034959858*^9, 
   3.7373790727385445`*^9}, {3.7373791051388326`*^9, 
   3.7373793197291527`*^9}, {3.737379377194002*^9, 3.7373793803812838`*^9}, 
   3.7373794171600246`*^9, {3.7373796061110935`*^9, 3.737379606767313*^9}, {
   3.737379637655826*^9, 3.737379652607942*^9}, {3.737379693058298*^9, 
   3.737379770146743*^9}, {3.7373798677807245`*^9, 3.7373798691868563`*^9}, {
   3.737380000552867*^9, 3.737380066985815*^9}, {3.7373800979681034`*^9, 
   3.7373801034989314`*^9}, {3.7373801376997175`*^9, 3.737380382167379*^9}, {
   3.737380616354474*^9, 3.737380757454199*^9}, {3.7373808322147217`*^9, 
   3.737380838564123*^9}, {3.737380896841386*^9, 3.737380906121996*^9}, {
   3.7373811041396904`*^9, 3.7373812167257357`*^9}, {3.737381252910785*^9, 
   3.7373813482011237`*^9}, {3.7373814248831344`*^9, 
   3.7373814251799593`*^9}, {3.737381471129923*^9, 3.7373815440099225`*^9}, {
   3.7373839112934513`*^9, 3.737383914590116*^9}, {3.737383988460061*^9, 
   3.737383994537755*^9}, {3.737384228521776*^9, 3.7373843031416473`*^9}, {
   3.7373843355144343`*^9, 3.737384472770688*^9}, {3.73738451456467*^9, 
   3.7373845283918767`*^9}, {3.7373845615458345`*^9, 3.737384592387515*^9}, {
   3.7373846447589006`*^9, 3.7373846559044*^9}, {3.7373847245715647`*^9, 
   3.7373847371957126`*^9}, {3.7373847872860365`*^9, 3.737384982457297*^9}, {
   3.7373850971704874`*^9, 3.7373851054667916`*^9}, {3.7373860051128902`*^9, 
   3.7373860219398503`*^9}, {3.7373862145013857`*^9, 3.73738648702962*^9}, {
   3.73738802146679*^9, 3.737388023935382*^9}, {3.737389157896367*^9, 
   3.7373891884255285`*^9}, {3.737389272638505*^9, 3.7373893076517425`*^9}, {
   3.7373893787250085`*^9, 3.7373894068949428`*^9}, 3.7414325146897016`*^9, {
   3.780675517071074*^9, 3.78067568396489*^9}, {3.780676761280828*^9, 
   3.7806768099552183`*^9}, {3.780676845888689*^9, 3.7806768790009537`*^9}, {
   3.780677796696451*^9, 3.780677860439377*^9}, {3.780677937406056*^9, 
   3.780677968132976*^9}, {3.780678005872931*^9, 3.780678008197003*^9}, {
   3.780678097681849*^9, 3.7806781409991417`*^9}, {3.780678218481317*^9, 
   3.780678220894259*^9}, {3.780678892175531*^9, 3.780678939781212*^9}, {
   3.7806789758367577`*^9, 3.78067901866746*^9}, {3.791458677170411*^9, 
   3.791458690182*^9}, {3.791458778537012*^9, 3.791458794888842*^9}, {
   3.791459411973341*^9, 3.791459439326529*^9}, {3.7914594800557127`*^9, 
   3.791459553081649*^9}, {3.791459606431469*^9, 3.791459618485524*^9}, {
   3.791459854687125*^9, 3.791459872813334*^9}, {3.791459923197504*^9, 
   3.791459923537766*^9}, {3.791460319002714*^9, 3.791460320981328*^9}, {
   3.7914635413360653`*^9, 3.791463566488372*^9}, {3.791463641086775*^9, 
   3.791463681634444*^9}, 3.791647312274597*^9, {3.791819629135145*^9, 
   3.791819656276269*^9}, {3.791819717312584*^9, 3.791819717777614*^9}, {
   3.7918197617853413`*^9, 3.791819762299943*^9}, {3.799718914313097*^9, 
   3.799718922531461*^9}, {3.799782864140242*^9, 3.799782870330378*^9}, 
   3.799788410766069*^9},
 CellLabel->
  "In[343]:=",ExpressionUUID->"f0900d11-8c80-4c8b-83e6-33ed8b06c86f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLBipedFFMPEG", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Duration", " ", "\[Rule]", " ", "4"}], ",", " ", 
      RowBox[{"Directory", " ", "\[Rule]", " ", "\"\<./img/\>\""}], ",", " ", 
      RowBox[{"Delete", " ", "\[Rule]", " ", "True"}], ",", " ", 
      RowBox[{"BLBipedGrid", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"BLGaitKinematics", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedFFMPEG", "::", "err"}], " ", "=", " ", 
    "\"\<ffmpeg command did not run successfully, return value ``.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedFFMPEG", "[", 
     RowBox[{"O_Association", ",", " ", "M_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "N", ",", " ", "A", ",", " ", "i", ",", " ", "m", ",", " ", "a", ",", 
        " ", "c", ",", " ", "G"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"preproces", " ", "O", " ", "so", " ", "that", " ", 
        RowBox[{"it", "'"}], "s", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", " ", "index"}], ",", " ", 
          RowBox[{"M", " ", "index"}]}], "}"}], " ", "pair"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"N", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "#"}], " ", "\[Equal]", " ", "1"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", " ", "1"}], "}"}], ",", " ", "True", ",", " ", "#"}], 
           "]"}], "&"}], " ", "/@", " ", "O"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AssociationQ", "[", "M", "]"}], ",", " ", 
          RowBox[{"{", "M", "}"}], ",", " ", "M"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "m"}], "}"}], " ", "=", " ", 
           RowBox[{"N", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a", " ", "=", " ", 
           RowBox[{
           "A", "\[LeftDoubleBracket]", "m", "\[RightDoubleBracket]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"c", " ", "=", " ", 
           RowBox[{"First", "@", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"VectorQ", "[", "i", "]"}], ",", " ", 
              RowBox[{"a", "[", "i", "]"}], ",", " ", 
              RowBox[{
              "a", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"G", " ", "=", " ", 
           RowBox[{"BLGaitKinematics", "[", 
            RowBox[{"c", ",", " ", 
             RowBox[{"OptionValue", "[", "BLGaitKinematics", "]"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"BLBipedFFMPEG", "[", 
           RowBox[{"k", ",", " ", "G", ",", " ", "opts"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", 
           RowBox[{"Keys", "@", "N"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLBipedFFMPEG", "[", 
     RowBox[{"out_String", ",", " ", "\[CurlyPhi]_Association", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"BLBipedFFMPEG", "[", 
     RowBox[{"out", ",", " ", 
      RowBox[{"BLBipedGrid", "[", 
       RowBox[{"\[CurlyPhi]", ",", " ", 
        RowBox[{"OptionValue", "[", "BLBipedGrid", "]"}]}], "]"}], ",", " ", 
      "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLBipedFFMPEG", "[", 
    RowBox[{"out_String", ",", " ", "L_", ",", " ", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", " ", "n", ",", " ", "fps", ",", " ", "o", ",", " ", "cmd", 
       ",", " ", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Directory", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"CreateDirectory", "[", "d", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "@", "L"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"IntegerLength", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fps", " ", "=", " ", 
       RowBox[{"n", " ", "/", " ", 
        RowBox[{"OptionValue", "[", "Duration", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"create", " ", "images", " ", "in", " ", "directory"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"d", " ", "<>", " ", 
        RowBox[{"StringPadLeft", "[", 
         RowBox[{"\"\<1\>\"", ",", " ", "m", ",", " ", "\"\<0\>\""}], "]"}], 
        " ", "<>", " ", "\"\<.jpg\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Export", "[", 
        RowBox[{"o", ",", " ", "L", ",", "\"\<VideoFrames\>\""}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"create", " ", ".", "mp4"}], " ", "file", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"yes", " ", "|", " ", "..."}], " ", "=", 
          RowBox[{">", " ", 
           RowBox[{"overwrite", " ", "file"}]}]}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"out", " ", "<>", " ", "\"\<.mp4\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cmd", " ", "=", " ", 
       RowBox[{
       "StringTemplate", "[", 
        "\"\<bash -c \\\"yes | ffmpeg -r `` -i ``%0``d.jpg ``\\\"\>\"", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cmd", " ", "=", " ", 
       RowBox[{"Run", "@", 
        RowBox[{"cmd", "[", 
         RowBox[{"fps", ",", " ", "d", ",", " ", "m", ",", " ", "o"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"clean", " ", "up"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Delete", "]"}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DeleteFile", "[", "n", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"DeleteDirectory", "[", "d", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "would", " ", "like", " ", "to", " ", "play", " ", "saved", " ", 
         "vido"}], ",", " ", 
        RowBox[{"but", " ", "Import", " ", "fails"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cmd", " ", "=!=", " ", "0"}], ",", "  ", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"BLBipedFFMPEG", "::", "err"}], ",", " ", "o"}], "]"}], ",",
         " ", 
        RowBox[{"ListAnimate", "[", "L", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.761945629214286*^9, 3.7619459668497086`*^9}, {
   3.7619460380577154`*^9, 3.761946057899938*^9}, {3.7619461046040053`*^9, 
   3.7619462981522307`*^9}, {3.7619463291187124`*^9, 3.76194632941555*^9}, {
   3.761946616238163*^9, 3.7619466259093113`*^9}, {3.7619466565320606`*^9, 
   3.76194685915773*^9}, {3.761946932441124*^9, 3.7619469791618395`*^9}, {
   3.761947022002411*^9, 3.7619470230179853`*^9}, {3.7619470794483633`*^9, 
   3.7619470815107107`*^9}, {3.7619471183517647`*^9, 
   3.7619473561192675`*^9}, {3.7619474637050657`*^9, 
   3.7619474729387608`*^9}, {3.7619475488543468`*^9, 
   3.7619475492606077`*^9}, {3.761947584679857*^9, 3.761947615568179*^9}, {
   3.761947659440005*^9, 3.7619477123579125`*^9}, 3.76194783338186*^9, {
   3.761947921558136*^9, 3.76194800108352*^9}, {3.7619480863897285`*^9, 
   3.7619481218558617`*^9}, {3.7619481622747564`*^9, 3.761948186038628*^9}, {
   3.7619483097965097`*^9, 3.761948458535481*^9}, {3.7619485309426775`*^9, 
   3.761948676320402*^9}, {3.761948706427558*^9, 3.7619487071931486`*^9}, {
   3.7619488082066903`*^9, 3.7619488165341997`*^9}, {3.7619488490027313`*^9, 
   3.761948863001665*^9}, {3.7619489944747257`*^9, 3.761949033971834*^9}, {
   3.762004537364318*^9, 3.762004689375085*^9}, {3.762004824634303*^9, 
   3.7620048527844744`*^9}, {3.7620049025431767`*^9, 
   3.7620049037272263`*^9}, {3.7620049600371966`*^9, 3.762004984515137*^9}, {
   3.7620053356821365`*^9, 3.762005472294942*^9}, {3.7620055035612755`*^9, 
   3.7620055353711977`*^9}, {3.7620056713103952`*^9, 
   3.7620058163929415`*^9}, {3.7620058534333878`*^9, 
   3.7620061038383694`*^9}, {3.7620061431721263`*^9, 3.762006179677719*^9}, 
   3.7620104771774483`*^9, {3.762011157864075*^9, 3.7620111948537436`*^9}, {
   3.762011535895638*^9, 3.7620115776306877`*^9}, {3.762011608285438*^9, 
   3.7620116104317236`*^9}, {3.7620116431414847`*^9, 
   3.7620116483114543`*^9}, {3.762011735653479*^9, 3.7620117365213118`*^9}, {
   3.762012365823432*^9, 3.7620123720417285`*^9}, {3.7620124479192853`*^9, 
   3.762012456996736*^9}, 3.7620135152900867`*^9, {3.762014676331238*^9, 
   3.7620146864379625`*^9}, {3.7620147654008884`*^9, 3.762014815007227*^9}, {
   3.762014847723564*^9, 3.762014879236848*^9}, {3.7620153001684065`*^9, 
   3.762015302605728*^9}, {3.779204231849792*^9, 3.779204234478713*^9}, {
   3.7792052203787518`*^9, 3.779205220821377*^9}},
 CellLabel->
  "In[346]:=",ExpressionUUID->"8772b01e-d4fd-4d88-86ca-8009e657b9ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BipedGIF", "]"}], " ", "=", " ", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Options", "@", "BipedList"}], ",", " ", 
     RowBox[{"AnimationRepetitions", " ", "\[Rule]", " ", "0"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BipedGIF", "[", 
   RowBox[{"f_", ",", " ", "n_", ",", " ", "c_", ",", " ", "range_", ",", " ", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", " ", "N"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"g", " ", "=", " ", 
      RowBox[{"BipedList", "[", 
       RowBox[{"n", ",", " ", "c", ",", " ", "range", ",", " ", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "@", "BipedList"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", " ", "=", " ", 
      RowBox[{"OptionValue", "@", "AnimationRepetitions"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringQ", "@", "f"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"StringLength", "@", "f"}], " ", ">", " ", "0"}]}], ",", " ", 
       RowBox[{"Export", "[", 
        RowBox[{"f", ",", " ", "g", ",", " ", 
         RowBox[{"\"\<AnimationRepetitions\>\"", " ", "\[Rule]", " ", "N"}]}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ListAnimate", "[", 
      RowBox[{"g", ",", " ", 
       RowBox[{"AnimationRepetitions", " ", "\[Rule]", " ", 
        RowBox[{"N", "+", "1"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, {
   3.6968781986494007`*^9, 3.6968782207120533`*^9}, {3.696880339313559*^9, 
   3.6968803472042146`*^9}, {3.6968806145957856`*^9, 
   3.6968806904558244`*^9}, {3.6968807308936787`*^9, 3.6968808644142923`*^9}, 
   3.696880927209197*^9, {3.696880969076576*^9, 3.696881004699669*^9}, {
   3.6968810466850977`*^9, 3.696881047888233*^9}, {3.6968810841202526`*^9, 
   3.6968810969644012`*^9}, {3.6996659684019566`*^9, 
   3.6996660381644883`*^9}, {3.6996660758519363`*^9, 
   3.6996661574330044`*^9}, {3.699666188411018*^9, 3.699666188512089*^9}, {
   3.699666346918497*^9, 3.6996663487427855`*^9}, {3.699721083001706*^9, 
   3.6997212462842393`*^9}, {3.699721307534171*^9, 3.699721312266079*^9}, {
   3.6997530035654902`*^9, 3.699753131931875*^9}, {3.6997538834846873`*^9, 
   3.6997538849304504`*^9}, {3.6997540342259245`*^9, 3.699754041493998*^9}, {
   3.699754246990873*^9, 3.699754319586684*^9}, {3.6997543664781384`*^9, 
   3.6997543746783204`*^9}, {3.7619977582688313`*^9, 3.761997765404114*^9}},
 CellLabel->
  "In[351]:=",ExpressionUUID->"8bd6ef11-854e-4c0f-8098-bf8fa02ddbee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Draw Indicator Function and Projections", "Section",
 CellChangeTimes->{{3.684678566296839*^9, 3.684678566812415*^9}, {
   3.684678602969049*^9, 3.6846786252973766`*^9}, {3.6846787712362127`*^9, 
   3.6846787718768377`*^9}, {3.6846794135590725`*^9, 
   3.6846794243138685`*^9}, {3.684679499221797*^9, 3.684679500708866*^9}, {
   3.6943224932304945`*^9, 3.694322498229063*^9}, 3.694322896850048*^9, {
   3.696876852021453*^9, 3.696876854640302*^9}, {3.696878168489704*^9, 
   3.696878192633685*^9}, {3.696943982592585*^9, 3.6969440080803204`*^9}, {
   3.696956703071368*^9, 
   3.6969567052347217`*^9}},ExpressionUUID->"4bfdd6ac-9fc0-44de-98bd-\
741cdd2a0fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "color", " ", "of", " ", "singular", " ", "and", " ", "regular", " ", 
    "points", " ", "on", " ", "connected", " ", "component"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RPColor", " ", "=", " ", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"0", ",", 
       RowBox[{"176", "/", "255"}], ",", 
       RowBox[{"80", "/", "255"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SPColor", " ", "=", " ", "Red"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EPSize", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "25"}], ",", " ", 
       RowBox[{"1", "/", "35"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EPLeaderThickness", " ", "=", " ", 
     RowBox[{"1", "/", "200"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EPCallout", "[", 
      RowBox[{"p_", ",", " ", "g_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", " ", "=", " ", 
         RowBox[{
         "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"Negative", "[", "r", "]"}], ",", " ", "Below", ",", " ", 
           RowBox[{"Positive", "[", "r", "]"}], ",", " ", "Above", ",", " ", 
           "True", ",", " ", "Before"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Callout", "[", 
         RowBox[{"p", ",", " ", "g", ",", " ", "r", ",", " ", 
          RowBox[{"Background", "\[Rule]", "None"}], ",", " ", 
          RowBox[{"CalloutStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", "EPLeaderThickness", "]"}], ",", " ", 
             "Black"}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SEP", "[", 
      RowBox[{"p_", ",", " ", 
       RowBox[{"ps_:", "Automatic"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "sz", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sz", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ps", " ", "===", " ", "Automatic"}], ",", " ", "EPSize", 
           ",", " ", "ps"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"SPColor", ",", " ", 
          RowBox[{"PointSize", "@", 
           RowBox[{
           "sz", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", " ", 
          RowBox[{"Point", "[", "p", "]"}], ",", " ", "Black", ",", " ", 
          RowBox[{"PointSize", "@", 
           RowBox[{
           "sz", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ",", " ", 
          RowBox[{"Point", "[", "p", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"REP", "[", 
      RowBox[{"p_", ",", " ", 
       RowBox[{"ps_:", "Automatic"}]}], "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "sz", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sz", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ps", " ", "===", " ", "Automatic"}], ",", " ", "EPSize", 
           ",", " ", "ps"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"RPColor", ",", " ", 
          RowBox[{"PointSize", "@", 
           RowBox[{
           "sz", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", " ", 
          RowBox[{"Point", "[", "p", "]"}], ",", " ", "Black", ",", " ", 
          RowBox[{"PointSize", "@", 
           RowBox[{
           "sz", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ",", " ", 
          RowBox[{"Point", "[", "p", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SEPLine", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", 
        RowBox[{"2", "/", "200"}], "]"}], ",", " ", "SPColor", ",", " ", 
       RowBox[{"InfiniteLine", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "BLSingularPointQ", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<P\>\"", " ", "\[Rule]", " ", "BLP"}], ",", " ", 
       RowBox[{"\"\<nstol\>\"", " ", "\[Rule]", " ", "Automatic"}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BLSingularPointQ", "[", 
      RowBox[{"C_", ",", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"N", ",", " ", "m0", ",", " ", "c0", ",", " ", "h"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m0", " ", "=", " ", 
         RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c0", " ", "=", " ", 
         RowBox[{
         "C", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", " ", 
         RowBox[{
         "C", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"requires", " ", "Jacobian", " ", "to", " ", "exist"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"N", " ", "=", " ", 
         RowBox[{"NullSpace", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<P\>\"", "]"}], "[", "c0", "]"}],
             "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"Tolerance", "\[Rule]", 
            RowBox[{"OptionValue", "[", "\"\<nstol\>\"", "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "@", "N"}], " ", ">", " ", 
         RowBox[{"Length", "@", "h"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737866426101036*^9, 3.737866463348359*^9}, {
   3.737872176419568*^9, 3.7378722556014085`*^9}, {3.7378730878150806`*^9, 
   3.7378730911117306`*^9}, {3.737873985620098*^9, 3.7378739908697395`*^9}, {
   3.737874024304896*^9, 3.737874125250765*^9}, {3.7378741684039273`*^9, 
   3.7378741816217313`*^9}, {3.7378744315882874`*^9, 3.73787451520728*^9}, {
   3.737876393494897*^9, 3.737876394104227*^9}, {3.737876529678871*^9, 
   3.7378765364752607`*^9}, {3.737876917669817*^9, 3.737876921294574*^9}, {
   3.7378843947029524`*^9, 3.7378844203417606`*^9}, {3.737904012181202*^9, 
   3.737904048053576*^9}, {3.73790412818849*^9, 3.7379041307820697`*^9}, {
   3.737904241705533*^9, 3.7379043368443127`*^9}, {3.737904419791464*^9, 
   3.737904426212879*^9}, {3.737904691506465*^9, 3.737904764349532*^9}, 
   3.7379048431564455`*^9, 3.737904883434803*^9, {3.7379063318381333`*^9, 
   3.737906364882591*^9}, {3.7379064033642263`*^9, 3.737906403817319*^9}, {
   3.73790644823602*^9, 3.7379065583843813`*^9}, {3.7379066664235497`*^9, 
   3.737906703170912*^9}, {3.737906743246167*^9, 3.7379067626354256`*^9}, {
   3.737907231619746*^9, 3.737907253165081*^9}, {3.7379073504081306`*^9, 
   3.7379074312929735`*^9}, {3.737907497725712*^9, 3.737907520302241*^9}, {
   3.737907563627268*^9, 3.737907563970992*^9}, {3.737907627528937*^9, 
   3.7379077347087903`*^9}, {3.7598516085191903`*^9, 3.7598517209796047`*^9}, 
   3.759851845237853*^9, {3.800443648638093*^9, 
   3.800443666671257*^9}},ExpressionUUID->"3362278a-1fff-4d2c-90f6-\
12b40c9635ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"compute", " ", "slope"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "\[Sigma]", "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", "mm"}], ",", " ", 
       RowBox[{"FixAngles", " ", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"C_List", ",", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "c", ",", " ", "s", ",", " ", "i"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<i\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "i", "]"}], ",", " ", "i", ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", " ", "\"\<x\>\""}], "]"}], ",", " ", "1", ",", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", " ", "\"\<y\>\""}], "]"}], ",", " ", "2", ",", 
           " ", "\[IndentingNewLine]", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", " ", "\"\<z\>\""}], "]"}], ",", " ", "3", ",", 
           "\[IndentingNewLine]", "True", ",", " ", "mm"}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"get", " ", "slope"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"m", " ", "=", " ", 
         RowBox[{"BLbiped", "[", "\"\<m[0]\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", " ", "=", " ", 
         RowBox[{
         "C", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"s", " ", "=", " ", 
         RowBox[{
          RowBox[{"BLmxcp", "[", 
           RowBox[{"m", ",", " ", "c"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"2", ";;", "3"}], "\[RightDoubleBracket]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "c"}], "}"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         " ", "=", " ", 
         RowBox[{"devec", "[", 
          RowBox[{
           RowBox[{
           "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           " ", "nx"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         " ", "=", " ", 
         RowBox[{"devec", "[", 
          RowBox[{
           RowBox[{
           "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           " ", "nc"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"s", " ", "=", " ", 
         RowBox[{
          RowBox[{"BLAngle", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"BLbiped", "[", 
              RowBox[{"\"\<\[Sigma]\>\"", ",", " ", "m"}], "]"}], "[", 
             RowBox[{
              RowBox[{
              "s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{
              "s", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "]"}], "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "]"}], "/", "Degree"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", " ", "s"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]", "[", 
      RowBox[{"A__Association", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
     RowBox[{"FixAngles", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"#", ",", " ", "opts"}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", "A", "}"}], ",", " ", 
         RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", 
       RowBox[{"OptionValue", "[", "FixAngles", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737856143422205*^9, 3.737856147375002*^9}, {
  3.7378677671890135`*^9, 3.737867768095198*^9}, {3.737871061957506*^9, 
  3.7378710735504584`*^9}, {3.7378712125869093`*^9, 3.737871215633505*^9}, {
  3.7379120300858927`*^9, 3.737912044459923*^9}, {3.74205903362084*^9, 
  3.742059048776012*^9}, {3.742059099334935*^9, 3.7420591353026104`*^9}, {
  3.742059180127555*^9, 3.7420592097348194`*^9}, {3.7420598334681835`*^9, 
  3.7420598687625046`*^9}, {3.7420599707295265`*^9, 3.742059975619803*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"5f334efc-ae18-48ea-8007-2cdd7cb856fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"qt", "[", 
    RowBox[{"A__Association", ",", " ", 
     RowBox[{"i_Integer:", "2"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"B", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", " ", "1", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", " ", "i"}], "}"}]}], 
          "\[RightDoubleBracket]"}], "&"}], " ", "/@", " ", 
        RowBox[{"{", "A", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"BLAngle", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}], "/", "Degree"}]}], "}"}], "&"}], ",", " ", "B", ",", " ", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FixAngles", "[", "B", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.737856143422205*^9, 3.737856147375002*^9}, {
   3.7378677671890135`*^9, 3.737867768095198*^9}, {3.737871061957506*^9, 
   3.7378710735504584`*^9}, {3.73788146108066*^9, 3.7378814653303566`*^9}, {
   3.7378816321660037`*^9, 3.7378816621013627`*^9}, {3.737881867537568*^9, 
   3.7378818714591465`*^9}, {3.737881910159522*^9, 3.73788192740829*^9}, {
   3.737882914571719*^9, 3.737882914977894*^9}, {3.73788311749467*^9, 
   3.737883150945404*^9}, 3.7378832211903844`*^9, {3.737883269905651*^9, 
   3.7378832798424253`*^9}, {3.73788332666722*^9, 3.737883352259142*^9}, {
   3.7378834462524223`*^9, 3.7378835079511228`*^9}, {3.73788359908525*^9, 
   3.737883601033518*^9}, {3.737911809961012*^9, 3.7379118142263327`*^9}, {
   3.7379119041574063`*^9, 3.7379119130161467`*^9}, {3.800136862108592*^9, 
   3.800136866013936*^9}, {3.8001369714203978`*^9, 
   3.8001369720311117`*^9}},ExpressionUUID->"dbc61366-08de-4d95-9f84-\
56da7bf6b8e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"FixAngle", ",", " ", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixAngle", "[", 
     RowBox[{"b_", ",", " ", "a_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", " ", "d"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"assumes", " ", "angles", " ", "in", " ", "degrees"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"b", " ", "-", " ", "a"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"Abs", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"d", " ", ">", " ", "90"}], " ", "&&", " ", 
           RowBox[{"s", " ", ">", " ", "0"}]}], ",", " ", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"s", ",", " ", "180"}], "]"}], ",", " ", 
          RowBox[{"d", " ", ">", " ", "90"}], ",", " ", 
          RowBox[{"Floor", "[", 
           RowBox[{"s", ",", " ", "180"}], "]"}], ",", " ", "True", ",", " ", 
          "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d", " ", "=", " ", 
        RowBox[{"b", "-", "s"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"recurse", " ", "to", " ", "double"}], "-", 
         RowBox[{"check", " ", "d", " ", "is", " ", 
          RowBox[{"w", "/", "i"}], " ", "bounds", " ", "to", " ", "avoid", 
          " ", "edge", " ", "cases"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"s", " ", "\[Equal]", " ", "0"}], ",", " ", "d", ",", " ", 
         RowBox[{"FixAngle", "[", 
          RowBox[{"d", ",", " ", "a"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"ex", ".", " ", 
     RowBox[{"FixAngle", "[", 
      RowBox[{
       RowBox[{"-", "26"}], ",", " ", "155"}], "]"}]}], " ", "leads", " ", 
    "to", " ", "334", " ", "not", " ", "154", " ", 
    RowBox[{"w", "/", "o"}], " ", "recursion"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "FixAngles", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<K\>\"", " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"\"\<V\>\"", " ", "\[Rule]", " ", "2"}], ",", " ", 
      RowBox[{"\"\<a\>\"", " ", "\[Rule]", " ", "Automatic"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixAngles", "[", 
     RowBox[{
      RowBox[{"{", "A__Association", "}"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"FixAngles", "[", 
     RowBox[{"A", ",", " ", "opts"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FixAngles", "[", 
   RowBox[{"A__Association", ",", " ", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "M", ",", " ", "f", ",", " ", "s", ",", " ", "k", ",", " ", "v", ",", 
      " ", "\[Theta]", ",", " ", "z"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "\"\<K\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "\"\<V\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", " ", "=", " ", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", "v", ",", " ", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "walking", " ", "slope"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"M", " ", "=", " ", "a"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"fix", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"f", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Keys", "@", "M"}], ",", " ", 
           RowBox[{
            RowBox[{"Positive", "@", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<a\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Theta]", " ", "===", " ", "Automatic"}], ",", " ", 
          RowBox[{"\[Theta]", " ", "=", " ", 
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"a", ",", " ", 
              RowBox[{"Key", "@", 
               RowBox[{"{", "0", "}"}]}], ",", " ", "z"}], "]"}], 
            "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}]}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{
              RowBox[{"M", "[", "i", "]"}], ",", " ", 
              RowBox[{"v", " ", "\[Rule]", " ", 
               RowBox[{"FixAngle", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"M", "[", "i", "]"}], "\[LeftDoubleBracket]", "v", 
                  "\[RightDoubleBracket]"}], ",", " ", "\[Theta]"}], 
                "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Theta]", " ", "=", " ", 
            RowBox[{
             RowBox[{"M", "[", "i", "]"}], "\[LeftDoubleBracket]", "v", 
             "\[RightDoubleBracket]"}]}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "f"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"f", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Keys", "@", "M"}], ",", " ", 
           RowBox[{
            RowBox[{"Negative", "@", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<a\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Theta]", " ", "===", " ", "Automatic"}], ",", " ", 
          RowBox[{"\[Theta]", " ", "=", " ", 
           RowBox[{
            RowBox[{"Lookup", "[", 
             RowBox[{"a", ",", " ", 
              RowBox[{"Key", "@", 
               RowBox[{"{", "0", "}"}]}], ",", " ", "z"}], "]"}], 
            "\[LeftDoubleBracket]", "v", "\[RightDoubleBracket]"}]}]}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"M", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{
              RowBox[{"M", "[", "i", "]"}], ",", " ", 
              RowBox[{"v", " ", "\[Rule]", " ", 
               RowBox[{"FixAngle", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"M", "[", "i", "]"}], "\[LeftDoubleBracket]", "v", 
                  "\[RightDoubleBracket]"}], ",", " ", "\[Theta]"}], 
                "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Theta]", " ", "=", " ", 
            RowBox[{
             RowBox[{"M", "[", "i", "]"}], "\[LeftDoubleBracket]", "v", 
             "\[RightDoubleBracket]"}]}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "f"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "M"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"a", ",", " ", 
         RowBox[{"{", "A", "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7379116560188894`*^9, 3.737911701828116*^9}, {
   3.7379117737448483`*^9, 3.737911793305952*^9}, {3.737911914859765*^9, 
   3.737911941982826*^9}, {3.7379119725431423`*^9, 3.737911992838612*^9}, 
   3.737912482740496*^9, {3.7379125375178432`*^9, 3.737912588186097*^9}, {
   3.7379129522624493`*^9, 3.737912982197792*^9}, {3.7379130448183327`*^9, 
   3.737913093955434*^9}, {3.737913126156255*^9, 3.7379131282811165`*^9}, {
   3.737913162481799*^9, 3.73791319379206*^9}, 3.737913228273971*^9, {
   3.7379133733952703`*^9, 3.737913425329013*^9}, {3.737913463466895*^9, 
   3.7379134916523976`*^9}, {3.7379135323057313`*^9, 
   3.7379136041756067`*^9}, {3.737913638235671*^9, 3.7379136587810783`*^9}, {
   3.7379138498143153`*^9, 3.737913864391398*^9}, {3.737913903326123*^9, 
   3.7379139119817314`*^9}, {3.737913966884058*^9, 3.7379139810705447`*^9}, {
   3.737914020770831*^9, 3.7379140877035475`*^9}, {3.7379141237478466`*^9, 
   3.7379142203570757`*^9}, {3.737914394497633*^9, 3.7379144511498175`*^9}, {
   3.737914657760067*^9, 3.7379147560186696`*^9}, {3.73791488669683*^9, 
   3.737914890665281*^9}, {3.737914955363782*^9, 3.737915000735549*^9}, {
   3.7379150349518595`*^9, 3.7379151177428255`*^9}, {3.737915161052204*^9, 
   3.7379152084863157`*^9}, {3.737915317134862*^9, 3.73791545543742*^9}, {
   3.7379155230455313`*^9, 3.737915591165663*^9}, {3.737915633303276*^9, 
   3.7379156605045013`*^9}, {3.7420033996524663`*^9, 
   3.7420034852870197`*^9}, {3.7420035461576843`*^9, 
   3.7420037969211154`*^9}, {3.742003925017123*^9, 3.7420039256264553`*^9}, {
   3.7420042076971006`*^9, 3.742004208681447*^9}, {3.742004240628693*^9, 
   3.742004254272853*^9}, {3.7420043306892767`*^9, 3.7420043364232597`*^9}, {
   3.742004525925414*^9, 3.742004529331435*^9}, {3.7420067159448442`*^9, 
   3.742006957865142*^9}, {3.7420070916369143`*^9, 3.742007199926091*^9}, {
   3.7420075106044827`*^9, 3.7420075348371525`*^9}, {3.742007615097072*^9, 
   3.742007621362235*^9}, {3.742030077951255*^9, 3.742030154689335*^9}, 
   3.7420304046415305`*^9, {3.7420304399671607`*^9, 3.74203046290303*^9}, {
   3.742031551626248*^9, 3.7420315666251807`*^9}, {3.7420316585476856`*^9, 
   3.7420316655940623`*^9}, {3.742031709408638*^9, 3.7420317278135796`*^9}, {
   3.7420334501391416`*^9, 3.742033454607561*^9}, {3.7420336850365553`*^9, 
   3.742033701816627*^9}, {3.74203412047435*^9, 3.7420341808294334`*^9}, {
   3.7420342196704674`*^9, 3.7420343081797714`*^9}, {3.7420356238892317`*^9, 
   3.7420356934323187`*^9}, {3.742035777145114*^9, 3.742035814126862*^9}, {
   3.742035884824526*^9, 3.7420359300087676`*^9}, {3.742036034836435*^9, 
   3.7420360631000643`*^9}, {3.742036132635029*^9, 3.742036178897395*^9}, {
   3.7420590296211567`*^9, 3.7420590417452617`*^9}, {3.799718940366085*^9, 
   3.799718940962616*^9}, {3.800137014665338*^9, 3.800137051340436*^9}, {
   3.800137256294752*^9, 3.80013726804883*^9}, {3.800137429284362*^9, 
   3.8001374674514*^9}, {3.800137563885764*^9, 3.800137580641102*^9}, {
   3.8001376717968903`*^9, 3.800137676293027*^9}, {3.80013780576047*^9, 
   3.800137843342382*^9}, {3.800137877627843*^9, 3.800137902327331*^9}, 
   3.8001379505124702`*^9, {3.8001379922354813`*^9, 
   3.8001380154599133`*^9}},ExpressionUUID->"68899a55-b62f-40b9-82a8-\
dfa456196a9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLPlotProjection", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Projection", " ", "\[Rule]", " ", "2"}], ",", " ", 
      RowBox[{"ListPlot", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"BLSingularPointQ", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Magnification", " ", "\[Rule]", " ", "5"}], ",", " ", 
      RowBox[{"FrameStyle", " ", "\[Rule]", " ", "18"}], ",", " ", 
      RowBox[{"Callout", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"PointSize", " ", "\[Rule]", " ", "EPSize"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLPlotProjection", "[", 
     RowBox[{
      RowBox[{"{", "A__Association", "}"}], ",", " ", "o___"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"BLPlotProjection", "[", 
     RowBox[{"A", ",", " ", "o"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLPlotProjection", "[", 
    RowBox[{"A__Association", ",", " ", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "B", ",", " ", "e", ",", " ", "AP", ",", " ", "BP", ",", " ", "lb", ",",
        " ", "o", ",", " ", "ps", ",", " ", "mag"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Projection", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IntegerQ", "@", "e"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"B", " ", "=", " ", 
          RowBox[{"qt", "[", 
           RowBox[{"A", ",", " ", "e"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lb", " ", "=", " ", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
            "\"\<q_`` \\\\; \\\\text{(joint angle)}\>\"", ",", " ", "e"}], 
            "]"}]}]}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"B", " ", "=", " ", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"A", ",", " ", 
            RowBox[{"\"\<i\>\"", " ", "\[Rule]", " ", "e"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "lb", " ", "=", " ", "\"\<\\\\sigma \\\\; \\\\text{(slope)}\>\""}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lb", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\\\\tau \\\\; \\\\text{(switching time)}\>\"", ",", " ", "lb"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"format", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AP", " ", "=", " ", 
       RowBox[{"DeleteMissing", "@", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "A", "}"}], ",", " ", 
          RowBox[{"Key", "@", 
           RowBox[{"{", "0", "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BP", " ", "=", " ", 
       RowBox[{"DeleteMissing", "@", 
        RowBox[{"Lookup", "[", 
         RowBox[{"B", ",", " ", 
          RowBox[{"Key", "@", 
           RowBox[{"{", "0", "}"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "mark", " ", "initial", " ", "points", " ", "as", " ", "regular", " ", 
        "or", " ", "singular", " ", "points"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{
        RowBox[{"BLSingularPointQ", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"OptionValue", "@", "BLSingularPointQ"}]}], "]"}], "&"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"e", " ", "/@", " ", "AP"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "branch", " ", "of", " ", 
        RowBox[{"EPs", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AP", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Or", "@@", "e"}], ",", " ", "SEPLine", ",", " ", 
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "REPs", " ", "and", " ", "SEPs"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ps", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "PointSize", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "ps", "]"}], ",", " ", 
        RowBox[{"ps", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"ps", ",", " ", "ps"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"SEP", "[", 
             RowBox[{"#2", ",", " ", 
              RowBox[{
              "ps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], ",", " ", 
            RowBox[{"REP", "[", 
             RowBox[{"#2", ",", " ", 
              RowBox[{
              "ps", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "]"}]}], "]"}], "&"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"e", ",", " ", "BP"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"add", " ", "callouts"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BP", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "Callout", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"o", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"PossibleZeroQ", "@", 
               RowBox[{"Norm", "[", "j", "]"}]}], ",", " ", 
              RowBox[{"{", "}"}], ",", " ", 
              RowBox[{"REP", "[", 
               RowBox[{
                RowBox[{"B", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"Key", "@", "j"}]}], "\[RightDoubleBracket]"}], ",",
                 " ", 
                RowBox[{
                "ps", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", " ", "o"}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Key", "@", "j"}]}], "\[RightDoubleBracket]"}], " ", "=", 
          " ", 
          RowBox[{"EPCallout", "[", 
           RowBox[{
            RowBox[{"B", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", " ", 
              RowBox[{"Key", "@", "j"}]}], "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{"BP", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}]}], ",", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Keys", "@", "BP"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"Keys", "@", 
           RowBox[{"BP", "[", "i", "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"e", " ", "=", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", 
         RowBox[{"e", ",", " ", "o"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"format", " ", "plot"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mag", " ", "=", " ", 
       RowBox[{"OptionValue", "@", "Magnification"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "mag", "]"}], ",", " ", 
        RowBox[{"mag", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"mag", ",", " ", 
           RowBox[{"0.5", "mag"}]}], "}"}]}]}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"for", " ", "backwards", " ", "compatibility"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"lb", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"BLTeX", "[", 
          RowBox[{"#", ",", 
           RowBox[{
           "mag", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "&"}], " ", "/@", " ", "lb"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"<|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FrameLabel", " ", "\[Rule]", " ", "lb"}], ",", " ", 
          RowBox[{"Prolog", " ", "\[Rule]", " ", "AP"}], ",", " ", 
          RowBox[{"Epilog", " ", "\[Rule]", " ", "e"}], ",", " ", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", 
             RowBox[{"OptionValue", "@", "FrameStyle"}]}], "]"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", " ", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Thickness", "[", 
              RowBox[{"1.5", "/", "200"}], "]"}], ",", " ", "RPColor"}], 
            "]"}]}], ",", " ", 
          RowBox[{"ImageSize", "\[Rule]", 
           RowBox[{"BLLaTex", "[", "\"\<text width\>\"", "]"}]}]}], "}"}], 
        "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"o", " ", "=", " ", 
       RowBox[{"Normal", "@", 
        RowBox[{"Join", "[", 
         RowBox[{"o", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"OptionValue", "[", "ListPlot", "]"}], "|>"}]}], "]"}]}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"extract", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"B", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Values", "@", 
          RowBox[{"KeySort", "@", "#"}]}], "&"}], " ", "/@", " ", "B"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"BLFramePlot", "[", 
       RowBox[{"B", ",", " ", 
        RowBox[{"ListPlot", "\[Rule]", " ", "o"}], ",", " ", 
        RowBox[{"Format", " ", "\[Rule]", " ", 
         RowBox[{"BLFormatPlot", "[", 
          RowBox[{
          "mag", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, {
   3.6968781986494007`*^9, 3.69687821482136*^9}, {3.6969462436478467`*^9, 
   3.696946246392369*^9}, {3.6969462766362886`*^9, 3.6969462767144117`*^9}, {
   3.6969463151924877`*^9, 3.6969463402969275`*^9}, {3.6969464096396184`*^9, 
   3.6969464173950396`*^9}, {3.6969464563417397`*^9, 3.696946458638674*^9}, {
   3.696946502514059*^9, 3.696946502732808*^9}, {3.696946576013099*^9, 
   3.6969466861456985`*^9}, {3.696946955377613*^9, 3.6969469588653774`*^9}, {
   3.696947021787747*^9, 3.696947031714991*^9}, {3.6969470637000704`*^9, 
   3.6969470870938225`*^9}, {3.696947263349216*^9, 3.6969473135565715`*^9}, {
   3.6969474362097797`*^9, 3.696947437131663*^9}, {3.6969474914522*^9, 
   3.696947681493259*^9}, {3.696947727840291*^9, 3.6969477287084255`*^9}, {
   3.696947795680422*^9, 3.6969477960241737`*^9}, {3.6969484778477926`*^9, 
   3.6969484810363865`*^9}, 3.6969537095209227`*^9, {3.6969546410854034`*^9, 
   3.6969547305495205`*^9}, {3.6969548148397813`*^9, 
   3.6969551182589464`*^9}, {3.6969551487436275`*^9, 
   3.6969551860678587`*^9}, {3.696955248912175*^9, 3.6969552761179485`*^9}, {
   3.6969553345247073`*^9, 3.696955778801341*^9}, {3.696955822926671*^9, 
   3.696955880601979*^9}, {3.6969559577358203`*^9, 3.696955981894024*^9}, {
   3.696956023210822*^9, 3.6969560362675886`*^9}, {3.6969560763617177`*^9, 
   3.696956107832202*^9}, {3.696956139378803*^9, 3.696956231901595*^9}, {
   3.6969563184625587`*^9, 3.696956361770336*^9}, {3.6969563940983677`*^9, 
   3.696956523658641*^9}, {3.6969566769589033`*^9, 3.696956677818286*^9}, {
   3.710074902250582*^9, 3.7100749251884212`*^9}, {3.7100938231000166`*^9, 
   3.71009383453008*^9}, {3.710094060028901*^9, 3.710094062281494*^9}, {
   3.7100941402946568`*^9, 3.7100941420839214`*^9}, {3.7100942270993037`*^9, 
   3.710094228969609*^9}, {3.710094271052358*^9, 3.7100942983856936`*^9}, {
   3.715894142424486*^9, 3.715894163331047*^9}, {3.715894725026432*^9, 
   3.715894732026528*^9}, {3.7158949118884497`*^9, 3.7158949284043083`*^9}, {
   3.715902396493719*^9, 3.7159024933075647`*^9}, {3.715902529276821*^9, 
   3.7159025692774*^9}, {3.715902989658298*^9, 3.7159030048616357`*^9}, {
   3.7159030420652847`*^9, 3.7159030591592903`*^9}, {3.7159031527387314`*^9, 
   3.7159031543793645`*^9}, {3.7159032313960714`*^9, 3.715903242911871*^9}, 
   3.715903298428281*^9, {3.715903562760124*^9, 3.7159039063586907`*^9}, {
   3.7159039509374585`*^9, 3.715903972906502*^9}, {3.7159040300166793`*^9, 
   3.7159040398918347`*^9}, {3.715904083033066*^9, 3.715904119236684*^9}, {
   3.7159041653310814`*^9, 3.715904187956417*^9}, {3.7159042259881864`*^9, 
   3.7159042870828066`*^9}, {3.715904393271804*^9, 3.7159045110859613`*^9}, {
   3.7202265226278706`*^9, 3.7202265345185976`*^9}, 3.7373064512894077`*^9, {
   3.737313742951949*^9, 3.737313743045677*^9}, {3.7373137791369553`*^9, 
   3.737313803182185*^9}, 3.73739836881415*^9, {3.7373986523558464`*^9, 
   3.7373986559024715`*^9}, {3.7378551358639407`*^9, 3.737855145503893*^9}, {
   3.7378561111588407`*^9, 3.7378561327666717`*^9}, {3.737856184872322*^9, 
   3.737856213276544*^9}, 3.737856269210046*^9, {3.737860511969168*^9, 
   3.7378605275149374`*^9}, {3.73786056916825*^9, 3.737860652334135*^9}, {
   3.7378607716224856`*^9, 3.7378607726067853`*^9}, {3.7378659046539145`*^9, 
   3.7378659509006095`*^9}, {3.7378659885229206`*^9, 
   3.7378659887572656`*^9}, {3.7378660303011847`*^9, 
   3.7378660697514906`*^9}, {3.7378662760179977`*^9, 
   3.7378663025629597`*^9}, {3.7378665024862013`*^9, 3.737866546014326*^9}, {
   3.737867066489438*^9, 3.7378672345556064`*^9}, {3.737867300847698*^9, 
   3.7378673825918565`*^9}, {3.737867779547505*^9, 3.737867829340811*^9}, {
   3.7378679935322266`*^9, 3.737867998766212*^9}, {3.7378680698392735`*^9, 
   3.7378680888066516`*^9}, {3.7378711736990185`*^9, 3.737871197619184*^9}, {
   3.7378712446470566`*^9, 3.7378712866753654`*^9}, {3.73787137257543*^9, 
   3.737871399667244*^9}, {3.7378714348834763`*^9, 3.7378714777085247`*^9}, {
   3.737872090082034*^9, 3.737872111955408*^9}, {3.7378721451561785`*^9, 
   3.737872154858634*^9}, {3.7378731946980543`*^9, 3.737873357016938*^9}, {
   3.7378733901239357`*^9, 3.73787340332613*^9}, {3.7378736329109488`*^9, 
   3.7378737057651052`*^9}, {3.7378737484183187`*^9, 3.737873937795456*^9}, {
   3.737874235305394*^9, 3.737874273443295*^9}, {3.737874395465869*^9, 
   3.7378744018247757`*^9}, {3.737874619199832*^9, 3.737874752534057*^9}, {
   3.7378748074363832`*^9, 3.7378748444337316`*^9}, {3.7378749080073*^9, 
   3.7378749846268387`*^9}, {3.737875055543666*^9, 3.737875064902399*^9}, {
   3.7378751008842025`*^9, 3.737875208517089*^9}, {3.7378752422802887`*^9, 
   3.737875282058707*^9}, {3.737876329077612*^9, 3.7378763359209332`*^9}, {
   3.73787652966326*^9, 3.737876536490901*^9}, {3.737876790069623*^9, 
   3.737876835081969*^9}, {3.7378768994211316`*^9, 3.737876908779846*^9}, {
   3.737876981917742*^9, 3.7378769875267124`*^9}, {3.7378773903886137`*^9, 
   3.737877397653719*^9}, {3.7378785224005036`*^9, 3.7378785292906637`*^9}, {
   3.737878567944128*^9, 3.7378785742561765`*^9}, {3.7378786471415925`*^9, 
   3.737878649094578*^9}, {3.737878699184747*^9, 3.7378787005909433`*^9}, {
   3.737879140624775*^9, 3.7378791818718376`*^9}, {3.73787922380634*^9, 
   3.73787931972136*^9}, {3.737879414464589*^9, 3.7378794279167547`*^9}, {
   3.737879546252045*^9, 3.737879551767276*^9}, {3.737879589327092*^9, 
   3.7378796119036484`*^9}, {3.737879646401122*^9, 3.7378796467448635`*^9}, {
   3.7378797393319798`*^9, 3.7378797404881463`*^9}, {3.737879799030837*^9, 
   3.737879825716449*^9}, {3.7378798604951997`*^9, 3.7378798709163256`*^9}, {
   3.737879979018036*^9, 3.737879997563563*^9}, 3.737880032973421*^9, {
   3.737880196258625*^9, 3.7378802375994034`*^9}, {3.7378802698158846`*^9, 
   3.7378803926977253`*^9}, {3.7378804517091136`*^9, 
   3.7378804548963904`*^9}, {3.737880621025129*^9, 3.737880635789735*^9}, 
   3.737880905801648*^9, 3.7378809793277044`*^9, 3.737881014106423*^9, {
   3.7378810715710664`*^9, 3.737881071805424*^9}, {3.737882114380823*^9, 
   3.737882119302347*^9}, {3.7378822097157955`*^9, 3.7378822114188013`*^9}, {
   3.7378823619392943`*^9, 3.7378823852032404`*^9}, {3.737882439246314*^9, 
   3.7378824835868387`*^9}, {3.737882559347061*^9, 3.7378825961256657`*^9}, 
   3.737882908087761*^9, {3.7378829547406635`*^9, 3.737882964568099*^9}, {
   3.737883674801295*^9, 3.73788367556688*^9}, {3.737883868318737*^9, 
   3.7378838688811736`*^9}, {3.73788401305837*^9, 3.7378840796473618`*^9}, {
   3.737884497961196*^9, 3.7378844983361874`*^9}, {3.737898861599075*^9, 
   3.7378988646926055`*^9}, {3.737901372207986*^9, 3.7379013739890776`*^9}, {
   3.7379014780754523`*^9, 3.737901483028194*^9}, {3.7379015433311415`*^9, 
   3.7379015790629625`*^9}, {3.73790160987834*^9, 3.737901727432454*^9}, {
   3.7379017704137564`*^9, 3.7379018261597843`*^9}, {3.737901867438059*^9, 
   3.7379018824994946`*^9}, 3.7379019423545914`*^9, {3.737902095827997*^9, 
   3.737902126966381*^9}, {3.737902316288262*^9, 3.737902316600738*^9}, {
   3.73790256183654*^9, 3.737902564086382*^9}, {3.737904061505756*^9, 
   3.7379041029715567`*^9}, {3.7379058989285917`*^9, 3.737906099007985*^9}, {
   3.737906158410001*^9, 3.7379062585278287`*^9}, {3.759852031255312*^9, 
   3.7598521418252406`*^9}, {3.7598634438008156`*^9, 3.759863475345353*^9}, {
   3.7633939446065607`*^9, 3.7633939484571996`*^9}, {3.791734981299678*^9, 
   3.791735012114156*^9}, {3.791735048621583*^9, 3.7917351927499933`*^9}, {
   3.7917352392458363`*^9, 3.791735273394006*^9}, {3.791735344818808*^9, 
   3.79173535758078*^9}, {3.7917354740527153`*^9, 3.791735514763892*^9}, {
   3.799701374064176*^9, 3.799701487566678*^9}, {3.7997189612817163`*^9, 
   3.799719009323009*^9}, {3.800135790027052*^9, 3.800135792113052*^9}, 
   3.800135840107503*^9, {3.800135937400229*^9, 3.800135946881291*^9}, 
   3.8001359920685053`*^9, {3.800136112224442*^9, 3.800136119562908*^9}},
 CellLabel->
  "In[372]:=",ExpressionUUID->"073c3475-a3fc-431e-9f9d-b32f74034537"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "might", " ", "need", " ", "to", " ", "be", " ", "updated", " ", "to", " ",
     "work", " ", "with", " ", "new", " ", "FramePlot"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PlotIndicatorFunction", "[", 
     RowBox[{"root_", ",", " ", "t_", ",", " ", 
      RowBox[{"tmax_:", "Automatic"}], ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "FindRoot", "]"}]}]}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", " ", "IF", ",", " ", "TD"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"T", ",", " ", "IF", ",", " ", "TD"}], "}"}], " ", "=", " ", 
        RowBox[{"FindBifurcation", "[", 
         RowBox[{"root", ",", " ", "t", ",", " ", "tmax", ",", " ", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"T", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", " ", "0"}], "}"}], "&"}], " ", "/@", " ", 
         "T"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FramePlot", "[", 
        RowBox[{"TD", ",", " ", 
         RowBox[{"\"\<sp\>\"", " ", "\[Rule]", " ", "T"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<tstr\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<`` s\>\"", ",", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"PossibleZeroQ", "@", "#"}], ",", " ", "0", ",", " ", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{"#", ",", " ", "2"}], "]"}]}], "]"}]}], "]"}], 
             "&"}], ",", " ", 
            RowBox[{
             RowBox[{"StringForm", "[", 
              RowBox[{"\"\<``\>\"", ",", " ", 
               RowBox[{"ScientificForm", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "]"}], "&"}]}], 
           "}"}]}], ",", " ", 
         RowBox[{"\"\<lbl\>\"", " ", "\[Rule]", " ", 
          RowBox[{"{", 
           RowBox[{
           "\"\<T (switching time, s)\>\"", ",", " ", "\"\<IF(T)\>\""}], 
           "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642952161395238*^9, 3.6429522402741957`*^9}, {
   3.6429523275402465`*^9, 3.642952348053528*^9}, {3.6430208845493383`*^9, 
   3.643020886041149*^9}, {3.64302196211767*^9, 3.643022002879298*^9}, {
   3.6430223138516445`*^9, 3.6430224313882875`*^9}, {3.643022462780467*^9, 
   3.6430224869050636`*^9}, {3.6430228346259403`*^9, 3.64302284019541*^9}, {
   3.6430229557856216`*^9, 3.643022957185566*^9}, {3.643041491855584*^9, 
   3.643041560668786*^9}, {3.643041611888159*^9, 3.6430416186069255`*^9}, {
   3.64304166366998*^9, 3.6430418457344866`*^9}, {3.643041897016303*^9, 
   3.6430419279072113`*^9}, {3.6430419666889467`*^9, 
   3.6430419815171785`*^9}, {3.6430420818307853`*^9, 3.643042086565268*^9}, {
   3.643042139362725*^9, 3.643042169816167*^9}, {3.643042227457388*^9, 
   3.643042257567095*^9}, 3.643042498350999*^9, {3.643042693970883*^9, 
   3.6430426982569056`*^9}, {3.643042745976494*^9, 3.643042777914348*^9}, {
   3.6430428108834624`*^9, 3.643042825930444*^9}, {3.643042950244314*^9, 
   3.643042951650636*^9}, {3.643043301435746*^9, 3.6430434115618997`*^9}, {
   3.643043444546754*^9, 3.643043444999916*^9}, {3.643043605845438*^9, 
   3.6430437527533226`*^9}, {3.6430438199728265`*^9, 
   3.6430438203322053`*^9}, {3.64304385252006*^9, 3.6430438635670576`*^9}, {
   3.6430439870996685`*^9, 3.6430440120061927`*^9}, {3.643044236118039*^9, 
   3.6430442629308066`*^9}, {3.643044347181794*^9, 3.6430443800258756`*^9}, {
   3.643044413760623*^9, 3.643044444979718*^9}, {3.6430445642310305`*^9, 
   3.643044600590806*^9}, {3.6430446320983963`*^9, 3.643044672114461*^9}, {
   3.643044797725252*^9, 3.64304481060034*^9}, {3.643044905304532*^9, 
   3.6430449681802254`*^9}, {3.6430450002743297`*^9, 
   3.6430450427279243`*^9}, {3.6430452269655595`*^9, 
   3.6430453738223705`*^9}, {3.6430460480676584`*^9, 3.643046051546996*^9}, 
   3.6431008667585535`*^9, 3.6431009190720825`*^9, {3.6431077478829646`*^9, 
   3.6431077519899535`*^9}, 3.643108190805813*^9, {3.643108241326172*^9, 
   3.6431082631437197`*^9}, {3.6431211478856974`*^9, 
   3.6431211492919235`*^9}, {3.6431212040894594`*^9, 3.64312123571476*^9}, {
   3.643127265186779*^9, 3.643127274936885*^9}, {3.643127355953402*^9, 
   3.643127402938295*^9}, {3.643127648519129*^9, 3.6431276488628817`*^9}, {
   3.6431291211078863`*^9, 3.6431291507644625`*^9}, {3.6431305122671003`*^9, 
   3.64313053594984*^9}, {3.643680120993415*^9, 3.643680125151243*^9}, {
   3.64368020161966*^9, 3.643680219306761*^9}, {3.6436808209340754`*^9, 
   3.643680858332092*^9}, {3.6436809254105844`*^9, 3.643680933251102*^9}, {
   3.643680972911271*^9, 3.643680997087881*^9}, {3.643681191662731*^9, 
   3.643681192400833*^9}, {3.643681406290268*^9, 3.6436814145491977`*^9}, {
   3.6436816109050007`*^9, 3.643681619186443*^9}, {3.6436816806171074`*^9, 
   3.6436816830425854`*^9}, {3.6437209782576632`*^9, 3.643720978767017*^9}, {
   3.6437216043735137`*^9, 3.6437216425739837`*^9}, {3.6437221906523175`*^9, 
   3.643722192979109*^9}, {3.64372223905238*^9, 3.6437222394854527`*^9}, {
   3.6437234507501154`*^9, 3.643723453470839*^9}, {3.6437234955739727`*^9, 
   3.6437235172546997`*^9}, {3.643723786280535*^9, 3.643723790092274*^9}, {
   3.651308129756042*^9, 3.65130813002293*^9}, {3.651308162399956*^9, 
   3.651308191535861*^9}, 3.651308252213359*^9, {3.6513264813899612`*^9, 
   3.6513264876476603`*^9}, {3.65132664503682*^9, 3.651326652849901*^9}, {
   3.6513267048385057`*^9, 3.651326741799168*^9}, {3.651326833149276*^9, 
   3.6513268845481863`*^9}, {3.6513271924487247`*^9, 
   3.6513272033502684`*^9}, {3.6513273152865705`*^9, 3.6513273307621408`*^9}, 
   3.651327421238448*^9, {3.6513275301275654`*^9, 3.6513275458570986`*^9}, {
   3.651327588362786*^9, 3.6513276377457714`*^9}, {3.6513277245219526`*^9, 
   3.6513277846177197`*^9}, 3.651328617864394*^9, {3.651328697518916*^9, 
   3.651328729415448*^9}, {3.651330182229252*^9, 3.6513301886597157`*^9}, {
   3.651330256737842*^9, 3.651330322952261*^9}, {3.651330367245513*^9, 
   3.651330371080572*^9}, {3.651330617836608*^9, 3.6513306526795797`*^9}, {
   3.651330687258107*^9, 3.651330693229362*^9}, {3.6513307763866444`*^9, 
   3.651330800969731*^9}, {3.6513308726675515`*^9, 3.651330887714779*^9}, {
   3.6513310509085608`*^9, 3.6513310519175205`*^9}, {3.6513312720341415`*^9, 
   3.651331371870974*^9}, 3.651331418498412*^9, 3.651331472724654*^9, {
   3.6513321529600735`*^9, 3.6513321730079036`*^9}, {3.651332554616257*^9, 
   3.6513325640054016`*^9}, {3.651332597485304*^9, 3.6513326611392584`*^9}, {
   3.651333180364394*^9, 3.6513331975553493`*^9}, {3.651333362950271*^9, 
   3.651333379534236*^9}, 3.651334170698415*^9, 3.651334220842021*^9, {
   3.6513342535622325`*^9, 3.651334338115249*^9}, {3.651334401399955*^9, 
   3.6513344198881197`*^9}, {3.651336612926279*^9, 3.651336614333071*^9}, {
   3.6513369630562887`*^9, 3.6513369749446783`*^9}, {3.6513373976686883`*^9, 
   3.6513374000863276`*^9}, {3.6523981166646576`*^9, 
   3.6523981627233686`*^9}, {3.6523984845287247`*^9, 3.652398490234329*^9}, {
   3.6523985829430647`*^9, 3.6523985834954195`*^9}, {3.652398619441248*^9, 
   3.6523987701974764`*^9}, {3.652493165448351*^9, 3.652493165681962*^9}, {
   3.6524934402697973`*^9, 3.6524934484393797`*^9}, 3.6524937542660227`*^9, {
   3.6968781986494007`*^9, 3.69687821482136*^9}, {3.6969462436478467`*^9, 
   3.696946246392369*^9}, {3.6969462766362886`*^9, 3.6969462767144117`*^9}, {
   3.6969463151924877`*^9, 3.6969463402969275`*^9}, {3.6969464096396184`*^9, 
   3.6969464173950396`*^9}, {3.6969464563417397`*^9, 3.696946458638674*^9}, {
   3.696946502514059*^9, 3.696946502732808*^9}, {3.696946576013099*^9, 
   3.6969466861456985`*^9}, {3.696946955377613*^9, 3.6969469588653774`*^9}, {
   3.696947021787747*^9, 3.696947031714991*^9}, {3.6969470637000704`*^9, 
   3.6969470870938225`*^9}, {3.696947263349216*^9, 3.6969473135565715`*^9}, {
   3.6969474362097797`*^9, 3.696947437131663*^9}, {3.6969474914522*^9, 
   3.696947681493259*^9}, 3.6969477345949097`*^9, {3.696947819404546*^9, 
   3.6969478197170486`*^9}, {3.6969482471226883`*^9, 
   3.6969482837988634`*^9}, {3.6969484951912975`*^9, 
   3.6969484994219985`*^9}, {3.696948613393721*^9, 3.6969486372392397`*^9}, {
   3.6969487128354645`*^9, 3.6969487672987957`*^9}, 3.696949090275387*^9, {
   3.6969494076491985`*^9, 3.696949411406398*^9}, {3.696949469066972*^9, 
   3.696949469432438*^9}, {3.6969515790126677`*^9, 3.6969515794657965`*^9}, {
   3.696951617889387*^9, 3.6969516256026793`*^9}, {3.696951696945004*^9, 
   3.696951721804349*^9}, {3.6969517543133883`*^9, 3.696951778631302*^9}, {
   3.6969518488037663`*^9, 3.6969518583228903`*^9}, {3.69695224230345*^9, 
   3.696952249131631*^9}, {3.6969528618431816`*^9, 3.696952869171127*^9}, {
   3.696953337740706*^9, 3.6969533432696*^9}, {3.6969534258240056`*^9, 
   3.6969534704329414`*^9}, {3.696953777563387*^9, 3.696953812732175*^9}, {
   3.69695387440261*^9, 3.696953881293295*^9}, 3.696954373424705*^9, {
   3.6969544051906075`*^9, 3.696954428832091*^9}, 3.6969545499287415`*^9, {
   3.6969545902087007`*^9, 3.6969545984034395`*^9}, {3.69695478875845*^9, 
   3.6969547961052265`*^9}, {3.696956661930525*^9, 3.6969566625711565`*^9}, {
   3.710094091751339*^9, 3.7100941026520452`*^9}, {3.715904824619105*^9, 
   3.7159048264941463`*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"55626226-c295-4d7d-8d15-36cf1904b9fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "BLFormatPlot", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Magnification", " ", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"NumberForm", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"3", ",", " ", "1"}], "}"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BLFormatPlot", "[", 
    RowBox[{
     RowBox[{"mag_:", "1"}], ",", " ", 
     RowBox[{"nf_:", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"BLTeX", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", " ", "\[Equal]", " ", "0"}], ",", " ", 
           "\"\<\\\\SI{0}{s}\>\"", ",", " ", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<\\\\SI{``}{s}\>\"", ",", " ", 
             RowBox[{"ToString", "@", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "@", "#"}], ",", " ", "nf"}], "]"}]}]}], "]"}]}],
           "]"}], ",", " ", "mag"}], "]"}], "&"}], ")"}], ",", " ", 
     RowBox[{
      RowBox[{"BLTeX", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "@", 
          RowBox[{"Round", "@", "#"}]}], " ", "<>", " ", 
         "\"\<^\\\\circ\>\""}], ",", " ", "mag"}], "]"}], "&"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "BLFramePlot", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Format", " ", "\[Rule]", " ", 
       RowBox[{"BLFormatPlot", "[", "]"}]}], ",", " ", 
      RowBox[{"ListPlot", " ", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"Ticks", "\[Rule]", " ", "Automatic"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BLFramePlot", "[", 
     RowBox[{"G_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "plot", ",", " ", "ft", ",", " ", "o", ",", " ", "ticks", ",", " ", 
        "f"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plot", " ", "=", " ", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"G", ",", " ", 
          RowBox[{"Joined", "\[Rule]", " ", "True"}], ",", " ", 
          RowBox[{"Ticks", "\[Rule]", " ", 
           RowBox[{"OptionValue", "[", "Ticks", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"get", " ", "x"}], "-", " ", 
         RowBox[{"and", " ", "y"}], "-", 
         RowBox[{
         "coordinate", " ", "tick", " ", "marks", " ", "and", " ", "relabel", 
          " ", "major", " ", "tick", " ", "marks"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ticks", " ", "=", " ", 
        RowBox[{"OptionValue", "[", "Format", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ft", " ", "=", " ", 
        RowBox[{"Ticks", " ", "/.", " ", 
         RowBox[{"First", "@", 
          RowBox[{"AbsoluteOptions", "[", 
           RowBox[{"plot", ",", " ", "Ticks"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"NumericQ", "[", 
            RowBox[{
            "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ",", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{
             RowBox[{"Delete", "[", 
              RowBox[{"#1", ",", " ", "2"}], "]"}], ",", " ", 
             RowBox[{"#2", "[", 
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}], ",", " ", "2"}], "]"}], ",", " ", "#"}], "]"}], "&"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "ft", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
             "ft", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ",", " ", 
             RowBox[{
              RowBox[{"NumericQ", "[", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "]"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "ft", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], " ", 
           "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"#", ",", " ", 
               RowBox[{
               "ticks", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}], "&"}], " ", "/@", " ", 
            RowBox[{
            "ft", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "@", "ft"}]}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ft", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "ft", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",",
             " ", "None"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "ft", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
             " ", "None"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "plot", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"o", " ", "=", " ", 
        RowBox[{"Sequence", "[", 
         RowBox[{
          RowBox[{"Frame", "\[Rule]", "True"}], ",", " ", 
          RowBox[{"Axes", " ", "\[Rule]", " ", "False"}], ",", " ", 
          RowBox[{"FrameTicks", " ", "\[Rule]", " ", "ft"}], ",", " ", 
          RowBox[{"OptionValue", "[", "ListPlot", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"G", ",", " ", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", " ", "o"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"[", "1", "]"}], " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "19859"}], "/", "plot"}], "-", "extract", "-", 
     "data", "-", "to", "-", "a", "-", "file"}]}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.69694769498372*^9, 3.696947716403393*^9}, {
   3.696947780014433*^9, 3.696947800685629*^9}, {3.6969478367183113`*^9, 
   3.6969479761876793`*^9}, {3.696948016893551*^9, 3.696948035102113*^9}, {
   3.6969481468883896`*^9, 3.696948162801972*^9}, {3.696948215068055*^9, 
   3.696948241169566*^9}, {3.6969483074400415`*^9, 3.6969483279605527`*^9}, {
   3.6969484128987985`*^9, 3.6969484510044346`*^9}, 3.696948487578636*^9, {
   3.696948523906585*^9, 3.69694856697888*^9}, {3.6969489019125056`*^9, 
   3.696948904881281*^9}, {3.6969490366605425`*^9, 3.6969490580875897`*^9}, {
   3.6969491179161787`*^9, 3.696949122275589*^9}, {3.696949176761716*^9, 
   3.696949255539898*^9}, {3.696949287656577*^9, 3.696949365766161*^9}, 
   3.696949399471492*^9, {3.696949448813241*^9, 3.696949458032432*^9}, {
   3.6969497488844204`*^9, 3.696949749321923*^9}, {3.6969513786903996`*^9, 
   3.6969514657235928`*^9}, {3.6969514986020927`*^9, 
   3.6969515326326795`*^9}, {3.696951816442746*^9, 3.6969518263672256`*^9}, {
   3.696951883788801*^9, 3.696951890258936*^9}, {3.6969519591442356`*^9, 
   3.6969520530458703`*^9}, {3.6969521185449934`*^9, 3.69695212616978*^9}, {
   3.696952194911135*^9, 3.6969523051315556`*^9}, {3.6969523555536075`*^9, 
   3.6969524228591676`*^9}, {3.6969524606927867`*^9, 3.69695246969134*^9}, {
   3.6969525339135466`*^9, 3.6969525616055174`*^9}, {3.696952636631816*^9, 
   3.6969527496335773`*^9}, {3.696952878495482*^9, 3.696952879495507*^9}, {
   3.6969529683672996`*^9, 3.696953003219738*^9}, {3.6969530936784563`*^9, 
   3.6969530945046625`*^9}, {3.6969531351121655`*^9, 
   3.6969531601423473`*^9}, {3.6969531901486588`*^9, 3.69695332262879*^9}, {
   3.6969533612323737`*^9, 3.696953395199074*^9}, {3.696953504507323*^9, 
   3.696953671256868*^9}, {3.6969539789347734`*^9, 3.696954336584613*^9}, {
   3.6969544651136675`*^9, 3.6969544776979733`*^9}, {3.6969547644404964`*^9, 
   3.6969547778481064`*^9}, 3.6969552228651085`*^9, {3.696956815739458*^9, 
   3.696956818708234*^9}, {3.710074947427184*^9, 3.710074980935937*^9}, 
   3.7159049846057415`*^9, {3.7159050650131273`*^9, 3.715905193561805*^9}, {
   3.7159052281560297`*^9, 3.7159052960007334`*^9}, {3.7372960450201406`*^9, 
   3.737296051769679*^9}, 3.737306540899231*^9, {3.737335091836088*^9, 
   3.737335102319758*^9}, {3.737398450667549*^9, 3.7373985229903383`*^9}, {
   3.737400513596142*^9, 3.7374005481561055`*^9}, {3.737401739330536*^9, 
   3.7374017422209654`*^9}, {3.7374017807337646`*^9, 3.737401782436764*^9}, {
   3.7374018165905085`*^9, 3.737401868586722*^9}, {3.7374030535044613`*^9, 
   3.737403053723194*^9}, {3.7374057797887864`*^9, 3.7374057850384007`*^9}, {
   3.737411017937687*^9, 3.737411054294381*^9}, {3.737412510911022*^9, 
   3.737412565257346*^9}, {3.7374153474719086`*^9, 3.737415369576794*^9}, {
   3.7374183971915636`*^9, 3.737418398722672*^9}, {3.73741843989154*^9, 
   3.7374184535936594`*^9}, {3.7374221077283487`*^9, 
   3.7374221392838354`*^9}, {3.7378563820925846`*^9, 
   3.7378563933574057`*^9}, {3.737856469758213*^9, 3.7378565000841684`*^9}, {
   3.737861211075438*^9, 3.7378612126222057`*^9}, {3.7378770732706037`*^9, 
   3.7378771037683926`*^9}, {3.737878469373048*^9, 3.7378785112919264`*^9}, {
   3.7378785421022263`*^9, 3.73787854341463*^9}, {3.73787951386375*^9, 
   3.737879515019925*^9}, {3.7378836812852077`*^9, 3.7378837098768964`*^9}, {
   3.737883750249028*^9, 3.737883762841878*^9}, {3.7378838209158974`*^9, 
   3.7378838523042164`*^9}, {3.737883882958308*^9, 3.73788393017369*^9}, {
   3.7378841435021734`*^9, 3.737884183358699*^9}, {3.7378842212310066`*^9, 
   3.7378842251526313`*^9}, {3.7378843023814416`*^9, 
   3.7378843067405214`*^9}, {3.73788434759696*^9, 3.7378843486281366`*^9}, {
   3.7378844269350395`*^9, 3.7378844271381335`*^9}, {3.7378848617633524`*^9, 
   3.7378848967608347`*^9}, {3.73790228633726*^9, 3.737902299617565*^9}, {
   3.737902329787278*^9, 3.737902354707389*^9}, {3.7379023982980084`*^9, 
   3.737902427514731*^9}, {3.7916436409594088`*^9, 3.791643668970312*^9}, {
   3.791643724897723*^9, 3.791643748866288*^9}, {3.7916439868514547`*^9, 
   3.7916440098113194`*^9}, {3.791644046689519*^9, 3.791644067679758*^9}, {
   3.7916441161396112`*^9, 3.7916441678243647`*^9}, {3.791644199747258*^9, 
   3.791644240488494*^9}, {3.7916456509973383`*^9, 3.791645790019249*^9}, {
   3.791645824663557*^9, 3.791645847756364*^9}, {3.791646167046671*^9, 
   3.7916462211060677`*^9}, {3.791646578850938*^9, 3.791646692174807*^9}, {
   3.791646833260508*^9, 3.791646833881274*^9}, {3.791647312278039*^9, 
   3.7916473122801037`*^9}},
 CellLabel->
  "In[376]:=",ExpressionUUID->"f7d0386e-a28f-408c-8fea-768cf354e284"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.672922910157816*^9, 
  3.6729229104546924`*^9}},ExpressionUUID->"5be3e160-d4ee-4dd4-b8c2-\
d217fd1851a5"],

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\n", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6729231090809507`*^9, 3.6729231097997046`*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"5e082c0a-0c33-4813-ba53-955e56d37b43"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1373, 1505},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 203, 4, 95, "Section",ExpressionUUID->"1820cd00-5a4a-4b18-832b-9ad8b6359c1f"],
Cell[786, 28, 292, 6, 92, "Text",ExpressionUUID->"3fa7116c-70f2-4244-878f-1fa822c0fa70"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1115, 39, 160, 3, 95, "Section",ExpressionUUID->"b07d7787-6827-4aed-ad8f-671de1d4f225"],
Cell[1278, 44, 14352, 305, 2542, "Input",ExpressionUUID->"93ec1d1d-810e-4a6c-bcb4-da22adfc4187",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[15667, 354, 650, 10, 95, "Section",ExpressionUUID->"fc88b6ae-c881-42c3-a8ce-1bb488318583"],
Cell[16320, 366, 3299, 84, 662, "Input",ExpressionUUID->"5e69507d-2b9c-499e-92c6-b7872f9540ac",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[19656, 455, 534, 8, 95, "Section",ExpressionUUID->"33a201b4-c07a-455d-9634-2130ee09356c"],
Cell[20193, 465, 42798, 800, 4742, "Input",ExpressionUUID->"da0f07e5-9343-408a-bff2-5759ece12e09",
 InitializationCell->True],
Cell[62994, 1267, 6823, 159, 1462, "Input",ExpressionUUID->"096ec56f-966c-4447-9a81-c289deb0136b",
 InitializationCell->True],
Cell[69820, 1428, 1337, 31, 182, "Input",ExpressionUUID->"7dd0b128-8957-46b7-a463-60f58d1e4c3b",
 InitializationCell->True],
Cell[71160, 1461, 22160, 420, 2342, "Input",ExpressionUUID->"8520fc03-a8f5-426f-8dfe-64f6e4b34c76",
 InitializationCell->True],
Cell[93323, 1883, 13355, 228, 822, "Input",ExpressionUUID->"4a7fc853-0d0e-4cbb-81fb-4a16e25a339a",
 InitializationCell->True],
Cell[106681, 2113, 23875, 520, 3905, "Input",ExpressionUUID->"0b1cc9e9-c7c8-467c-ae21-188e75a9645f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[130593, 2638, 605, 9, 95, "Section",ExpressionUUID->"91686825-73a1-40f8-be4b-bb6adb227328"],
Cell[131201, 2649, 1206, 31, 182, "Input",ExpressionUUID->"59066b35-2e6f-4b66-b381-6346ea838312",
 InitializationCell->True],
Cell[132410, 2682, 7579, 162, 1302, "Input",ExpressionUUID->"33538e80-6c20-4b82-99cc-5da64730cc59",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[140026, 2849, 725, 11, 95, "Section",ExpressionUUID->"7af25095-5040-4680-b6eb-8981e254f844"],
Cell[140754, 2862, 18589, 393, 3142, "Input",ExpressionUUID->"af2dcc1b-5f61-4466-adf1-91bf1f1749f5",
 InitializationCell->True],
Cell[159346, 3257, 12751, 270, 1902, "Input",ExpressionUUID->"faa61ae4-9416-4167-954c-b315a29a51d5",
 InitializationCell->True],
Cell[172100, 3529, 4250, 98, 742, "Input",ExpressionUUID->"c74ccd4b-6eca-4bce-a47d-acce6e65a8c5",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[176387, 3632, 659, 10, 95, "Section",ExpressionUUID->"b19ae68d-64ea-4c1d-a349-b7fc2cd8b872"],
Cell[177049, 3644, 16497, 296, 1062, "Input",ExpressionUUID->"bf8cac45-2e81-47f7-b2ff-dee952163339",
 InitializationCell->True],
Cell[193549, 3942, 15160, 258, 702, "Input",ExpressionUUID->"e8c9905a-c824-4dcb-ae0e-4f3da5128a6b",
 InitializationCell->True],
Cell[208712, 4202, 13033, 207, 382, "Input",ExpressionUUID->"c987e037-13ad-408e-966e-6e93c1adc458",
 InitializationCell->True],
Cell[221748, 4411, 21574, 375, 1902, "Input",ExpressionUUID->"aac6c8bc-6e19-461f-8a55-f1ed9085c2a6",
 InitializationCell->True],
Cell[243325, 4788, 17408, 285, 662, "Input",ExpressionUUID->"2071aeb5-8298-4af6-9558-a3df5a5b930a",
 InitializationCell->True],
Cell[260736, 5075, 24240, 442, 2342, "Input",ExpressionUUID->"f0900d11-8c80-4c8b-83e6-33ed8b06c86f",
 InitializationCell->True],
Cell[284979, 5519, 10611, 232, 2065, "Input",ExpressionUUID->"8772b01e-d4fd-4d88-86ca-8009e657b9ab",
 InitializationCell->True],
Cell[295593, 5753, 8140, 133, 342, "Input",ExpressionUUID->"8bd6ef11-854e-4c0f-8098-bf8fa02ddbee",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[303770, 5891, 665, 10, 95, "Section",ExpressionUUID->"4bfdd6ac-9fc0-44de-98bd-741cdd2a0fd7"],
Cell[304438, 5903, 8370, 193, 1462, "Input",ExpressionUUID->"3362278a-1fff-4d2c-90f6-12b40c9635ee",
 InitializationCell->True],
Cell[312811, 6098, 5432, 126, 1102, "Input",ExpressionUUID->"5f334efc-ae18-48ea-8007-2cdd7cb856fb",
 InitializationCell->True],
Cell[318246, 6226, 2325, 51, 222, "Input",ExpressionUUID->"dbc61366-08de-4d95-9f84-56da7bf6b8e5",
 InitializationCell->True],
Cell[320574, 6279, 12027, 253, 2062, "Input",ExpressionUUID->"68899a55-b62f-40b9-82a8-dfa456196a9b",
 InitializationCell->True],
Cell[332604, 6534, 24345, 448, 2422, "Input",ExpressionUUID->"073c3475-a3fc-431e-9f9d-b32f74034537",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[356952, 6984, 9852, 165, 422, "Input",ExpressionUUID->"55626226-c295-4d7d-8d15-36cf1904b9fd",
 InitializationCell->True],
Cell[366807, 7151, 11849, 252, 1382, "Input",ExpressionUUID->"f7d0386e-a28f-408c-8fea-768cf354e284",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[378693, 7408, 236, 5, 95, "Section",ExpressionUUID->"5be3e160-d4ee-4dd4-b8c2-d217fd1851a5",
 InitializationCell->True],
Cell[378932, 7415, 275, 6, 102, "Input",ExpressionUUID->"5e082c0a-0c33-4813-ba53-955e56d37b43",
 InitializationCell->True]
}, Open  ]]
}
]
*)

